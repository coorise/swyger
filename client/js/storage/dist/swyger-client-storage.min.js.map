{"version":3,"mappings":"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","names":["PACKET_TYPES","PACKET_TYPES_REVERSE","key","ERROR_PACKET","withNativeBlob","withNativeArrayBuffer","isView","obj","encodePacket","supportsBinary","callback","data","encodeBlobAsBase64","type","fileReader","content","chars","lookup","i","decode","base64","bufferLength","len","p","encoded1","encoded2","encoded3","encoded4","arraybuffer","bytes","decodePacket","encodedPacket","binaryType","mapBinary","decodeBase64Packet","decoded","SEPARATOR","encodePayload","packets","length","encodedPackets","count","packet","decodePayload","encodedPayload","decodedPacket","protocol","Emitter","mixin","event","fn","on","callbacks","cb","args","globalThisShim","pick","attr","acc","k","NATIVE_SET_TIMEOUT","globalThis","NATIVE_CLEAR_TIMEOUT","installTimerFunctions","opts","BASE64_OVERHEAD","byteLength","utf8Length","str","c","l","TransportError","reason","description","context","Transport","details","onPause","alphabet","map","seed","prev","encode","num","encoded","yeast","now","qs","qry","pairs","pair","value","err","hasCORS","XHR","xdomain","e","empty","hasXHR2","XMLHttpRequest","Polling","isSSL","port","forceBase64","pause","total","close","query","schema","encodedQuery","ipv6","Request","req","xhrStatus","uri","xhr","fromError","unloadHandler","terminationEvent","nextTick","setTimeoutFn","WebSocket","usingBrowserWebSocket","defaultBinaryType","isReactNative","WS","protocols","closeEvent","ev","lastPacket","transports","re","parts","parse","src","b","m","pathNames","queryKey","path","regx","names","$0","$1","$2","Socket","name","transport","failed","onTransportOpen","msg","cleanup","freezeTransport","onerror","error","onTransportClose","onclose","onupgrade","to","payloadSize","options","cleanupAndClose","waitForUpgrade","upgrades","filteredUpgrades","j","url","loc","host","toString","withNativeFile","isBinary","hasBinary","toJSON","deconstructPacket","buffers","packetData","pack","_deconstructPacket","placeholder","newData","reconstructPacket","_reconstructPacket","PacketType","Encoder","replacer","deconstruction","Decoder","reviver","isBinaryEvent","BinaryReconstructor","start","buf","next","payload","binData","RESERVED_EVENTS","io","nsp","id","ack","isTransportWritable","_a","timeout","timer","withErr","resolve","reject","arg1","arg2","responseArgs","force","listeners","listener","self","sent","pid","subDestroy","compress","Backoff","ms","rand","deviation","min","max","jitter","Manager","_parser","parser","v","Engine","socket","openSubDestroy","errorSub","nsps","delay","attempt","cache","parsed","source","sameNamespace","newConnection","SocketService","accessToken","extraHeaders","API_KEY","HOST_SERVER","ENV","_b","_c","r","t","n","o","a","bind","thisArg","getPrototypeOf","kindOf","thing","kindOfTest","typeOfTest","isArray","isUndefined","isBuffer","val","isFunction","isArrayBuffer","isArrayBufferView","result","isString","isNumber","isObject","isBoolean","isPlainObject","prototype","isDate","isFile","isBlob","isFileList","isStream","isFormData","kind","isURLSearchParams","trim","forEach","keys","allOwnKeys","findKey","_key","_global","isContextDefined","merge","assignValue","targetKey","caseless","extend","stripBOM","inherits","constructor","superConstructor","props","descriptors","toFlatObject","sourceObj","destObj","filter","propFilter","prop","merged","endsWith","searchString","position","lastIndex","toArray","arr","isTypedArray","TypedArray","forEachEntry","iterator","matchAll","regExp","matches","isHTMLForm","toCamelCase","p1","p2","hasOwnProperty","isRegExp","reduceDescriptors","reducer","reducedDescriptors","descriptor","freezeMethods","toObjectSet","arrayOrString","delimiter","define","noop","toFiniteNumber","defaultValue","ALPHA","DIGIT","ALPHABET","generateString","size","isSpecCompliantForm","toJSONObject","stack","visit","target","reducedValue","isAsyncFn","isThenable","utils","AxiosError","message","code","config","request","response","customProps","axiosError","isVisitable","removeBrackets","renderKey","dots","token","isFlatArray","predicates","toFormData","formData","option","metaTokens","visitor","defaultVisitor","indexes","useBlob","convertValue","el","index","exposedHelpers","build","charMap","match","AxiosURLSearchParams","params","encoder","_encode","buildURL","serializeFn","serializedParams","hashmarkIndex","InterceptorManager","fulfilled","rejected","h","transitionalDefaults","URLSearchParams$1","FormData$1","Blob$1","isStandardBrowserEnv","product","isStandardBrowserWebWorkerEnv","platform","URLSearchParams","FormData","Blob","toURLEncodedForm","helpers","parsePropPath","arrayToObject","formDataToJSON","buildPath","isNumericKey","isLast","DEFAULT_CONTENT_TYPE","stringifySafely","rawValue","defaults","headers","contentType","hasJSONContentType","isObjectPayload","_FormData","transitional","forcedJSONParsing","JSONRequested","strictJSONParsing","status","method","ignoreDuplicateOf","parseHeaders","rawHeaders","line","$internals","normalizeHeader","header","normalizeValue","parseTokens","tokens","tokensRE","isValidHeaderName","matchHeaderValue","isHeaderNameFilter","formatHeader","w","char","buildAccessors","accessorName","methodName","arg3","AxiosHeaders","valueOrRewrite","rewrite","setHeader","_value","_header","_rewrite","lHeader","setHeaders","matcher","deleted","deleteHeader","format","normalized","targets","asStrings","first","computed","accessors","defineAccessor","transformData","fns","isCancel","CanceledError","settle","validateStatus","cookies","expires","domain","secure","cookie","isAbsoluteURL","combineURLs","baseURL","relativeURL","buildFullPath","requestedURL","isURLSameOrigin","msie","urlParsingNode","originURL","resolveURL","href","requestURL","parseProtocol","speedometer","samplesCount","timestamps","head","tail","firstSampleTS","chunkLength","startedAt","bytesCount","passed","progressEventReducer","isDownloadStream","bytesNotified","_speedometer","loaded","progressBytes","rate","inRange","isXHRAdapterSupported","xhrAdapter","requestData","requestHeaders","responseType","onCanceled","done","username","password","fullPath","onloadend","responseHeaders","timeoutErrorMessage","xsrfValue","cancel","knownAdapters","httpAdapter","adapters","nameOrAdapter","adapter","throwIfCancellationRequested","dispatchRequest","headersToObject","mergeConfig","config1","config2","getMergedValue","mergeDeepProperties","valueFromConfig2","defaultToConfig2","mergeDirectKeys","mergeMap","configValue","VERSION","validators","deprecatedWarnings","validator","version","formatMessage","opt","desc","assertOptions","allowUnknown","Axios","instanceConfig","configOrUrl","paramsSerializer","contextHeaders","requestInterceptorChain","synchronousRequestInterceptors","interceptor","responseInterceptorChain","promise","chain","newConfig","onFulfilled","onRejected","generateHTTPMethod","isForm","CancelToken","executor","resolvePromise","onfulfilled","_resolve","spread","isAxiosError","HttpStatusCode","createInstance","defaultConfig","instance","axios","promises","axios$1","AxiosService","_0","resp","_d","getRandomValues","rnds8","rng","byteToHex","unsafeStringify","offset","randomUUID","native","v4","rnds","has","prefix","Events","EE","once","addListener","emitter","evt","clearEvent","EventEmitter","events","handlers","ee","a1","a2","a3","a4","a5","module","undefined","root","hasOwnProp","reverseDupArray","array","arrayMaxIndex","Dottie","object","memoized","defaultVal","pieces","current","piece","piecesLength","transformed","seperator","flattened","nested","prefixes","paths","runCallback","_subscriptions","_oneTimeEvents","SimpleEventEmitter","s","ourCallback","eventEmitter","getPathKeys","PathInfo","childKey","parentKeys","varPath","pathKeys","variables","pathKey","varName","mergedPath","vars","otherPath","other","otherKey","descendantPath","descendant","ancestorPath","ancestor","getChild","snapshot","previous","child","getChildren","DataSnapshot","ref","isRemoved","prevValue","snap","MutationsDataSnapshot","mutations","warn","mutation","EventSubscription","stop","activated","cancelReason","EventPublisher","publish","EventStream","eventPublisherCallback","subscribers","noMoreSubscribersCallback","activationState","STATE_STOPPED","activationCallback","sub","checkActiveSubscribers","ret","allSubscriptionsStoppedCallback","publisher","pad","env","globalCount","mimeTypesLength","clientId","fingerprint","blockSize","base","discreteValues","randomBlock","safeCounter","cuid","timebias","letter","timestamp","counter","print","random","timeBias","ID","bias","PathReference","process$2","PartialArray","sparseArray","numberToBytes","number","bytesToNumber","bin","big","bigintToBytes","negative","byte","bytesToBigint","encodeString","nextCode","b1","b2","b3","b4","decodeString","buffer","decoder","typedArray","concatTypedArrays","cloneObject","original","checkAndFixTypedArray","cloneValue","clone","valuesAreEqual","val1","val2","item","typed1","typed2","keys1","keys2","ObjectDifferences","added","removed","changed","ch","compareValues","oldVal","newVal","sortedResults","voids","getKeys","oldKeys","newKeys","removedKeys","addedKeys","changedKeys","getMutations","process","compareResult","changes","childChanges","getChildValues","oldValue","newValue","defer","getGlobalObject","_shimRequested","_observable","__async","global","__vitePreload","Observable","SimpleObservable","getObservable","setObservable","create","subscriber","observer","RelativeNodeTarget","t1","t2","isProxy","LiveDataProxy","DataReference","latestCursor","proxy","proxyId","clientSubscriptions","clientEventEmitter","cursor","applyChange","trailKeys","syncFallback","reload","subscription","isRemote","changeRef","changeSnap","localMutationsEmitter","processPromise","mutationQueue","transactions","pushLocalMutations","getTargetValue","mutationRef","mutationSnap","updates","parentTarget","parentRef","parentUpdate","update","cacheValue","setTargetValue","syncInProgress","syncPromises","syncCompleted","rs","processQueueTimeout","scheduleSync","flagOverwritten","addOnChangeHandler","mutationsHandler","causedByOurProxy","previousValue","singleMutation","currentValue","last","keepSubscription","origin","cs","handleFlag","flag","subscribe","tx","createProxy","assertProxyAvailable","targetRef","getTargetRef","newSnap","mutationsSnap","targetObject","childProxies","handler","receiver","childProxy","proxifyChildValue","newChildProxy","unproxyValue","childRef","sortFn","orderProperty","orderIncrement","OrderedCollectionProxy","parent","writeArray","action","cleanArrayValues","values","removeVoidProperties","items","deleteCount","compareFn","initialValue","proxyAccess","proxiedValue","collection","newArray","from","minOrder","maxOrder","order","fromKey","otherItem","otherOrder","orders","gap","fromIndex","toIndex","DataRetrievalOptions","QueryDataRetrievalOptions","_private","db","currentContext","newContext","currentPath","info","childPath","targetPath","onComplete","throwError","cancelCallback","eventPublisher","eventStream","eventContext","callbackObject","advancedOptions","cancelSubscription","authorized","childSnap","skip","more","children","stopSubs","optionsOrCallback","DataReferenceQuery","write","writeFn","read","isOptionsArg","resolved","updateCache","mutatedPath","callbackOrOptions","summary","cursorOrDate","op","compare","ascending","eventData","res","results","snaps","DataSnapshotsArray","refs","DataReferencesArray","originalTake","parentUpdates","parents","parentPath","get","mappings","mappedPath","mpath","mkeys","mkey","mapDeep","entryPath","startPath","isMatch","mapping","mTrailKeys","change","_mappings","TypeMappings","DebugLogger","level","text","isRunKit","FontCode","ColorCode","BgColorCode","ResetCode","ColorStyle","ColorsSupported","_enabled","SetColorsEnabled","enabled","Colorize","style","openCodes","closeCodes","addStyle","open","AceBaseBaseSettings","AceBaseBase","dbname","logoStyle","logo","ObservableImpl","filePath","warnOnly","isUpdate","NotImplementedError","Api","settings","input","remainder","x","ascii85","y","d","deserialize","deserializeValue","serialize","ser","serialized","calculateExpiryTime","expirySeconds","SimpleCache","interval","entry","oldest","definition","pos","consumeSpaces","consumeCharacter","readProperty","readType","quote","nr","types","readTypes","pattern","flags","checkObject","properties","partial","invalidProperties","checkProperty","property","hasValue","checkType","namedProperties","failedProperty","wildcardProperty","wildcardChildKeys","ok","getConstructorType","SchemaDefinition","handling","toTS","NotSupported","AceBaseStorageSettings","AceBaseStorage","SQLiteStorageSettings","SQLiteStorage","MSSQLStorageSettings","MSSQLStorage","nodeValueTypes","VALUE_TYPES","getValueTypeName","valueType","NodeInfo","pathInfo","assert","condition","DEFAULT_LOCK_TIMEOUT","LOCK_STATE","NodeLocker","debug","lockTimeout","tid","forWriting","conflict","otherLock","lock","quitError","check","_1","comment","proceed","NodeLock","timeoutCount","timeoutHandler","lockOrId","processQueue","lastid","locker","priority","newLock","NodeNotFoundError","NodeRevisionError","AceBaseIPCPeerExitingError","AceBaseIPCPeer","storage","othersAlreadyNotifying","remoteSubscription","forPeerId","bye","sendReply","helloMessage","ignoreUnknown","peer","peerId","subscribeCallback","eventMessage","movedLock","lockRequest","removeLock","lockDetails","lockInfo","createIPCLock","parentLock","rj","requestMessage","reply","notification","IPCPeer","notImplemented","messageId","Transport.serialize","acebase","Transport.deserialize","allPeerIds","requests","released","movedToParent","helloMsg","pfs","DataIndex","FullTextIndex","GeoIndex","ArrayIndex","createIndex","rebuild","indexType","includeKeys","existingIndex","ipc","indexOptions","__spreadValues","__spreadProps","Utils","SUPPORTED_EVENTS","NOOP","SchemaValidationError","StorageSettings","Storage","indexKeys","files","fileName","needsStoragePrefix","hasStoragePrefix","indexPromise","pathSubs","ps","valueSubscribers","subscriptionPath","eventPath","dataPath","ipcName","NetIPCServer","ipcSettings","IPCSocketPeer","RemoteIPCPeer","suppressEvents","topEventPath","hasValueSubscribers","eventSubscriptions","keysFilter","topIndex","topIndexPath","validation","transaction","topEventData","updateImpact","writeNode","eventPathKeys","transactionLoggingEnabled","trailPath","eventNodeInfo","valueOptions","newTopEventData","modifiedData","shallowCopy","dataChanges","removeNulls","indexUpdates","indexPathKeys","getAllIndexUpdates","subKey","allKeys","childValues","subTrailPath","childResults","callSubscriberWithValues","trigger","variable","prepareMutationEvents","batch","childBatch","compareResults","triggerAllEvents","keyOrIndex","isOnParentPath","isNotifyEvent","prevVal","useFakeLock","changeCallback","node","checkRevision","criteria","checkNode","criteriaKeys","cr","unseenKeys","delayedMatchPromises","childInfo","keyCriteria","keyResult","checkChild","childCriteria","childPromise","f","contains","includes","stringifyValue","escape","objStart","objEnd","nodeInfo","output","outputCount","pending","state","readNextChunk","append","Utils.decodeString","readBytes","assertBytes","consumeToken","spaces","peekBytes","peekValueType","readString","unescape","readBoolean","readNumber","nrChars","readValue","getTypeSafeValue","childOptions","importObject","childCount","flushedBefore","flushObject","importArray","flushArray","pushChild","ka","kb","childValue","CustomStorageHelpers","columnName","NodeAddress","address","CustomStorageTransaction","nodes","CustomStorageSettings","useLocking","nodeLocker","rollback","commit","CustomStorageNodeInfo","CustomStorage","getTypedChildValue","unprocessed","diff","currentRow","revision","mainNode","childNodeValues","currentIsObjectOrArray","newIsObjectOrArray","currentObject","checkExecuted","includeChildCheck","addChildPath","writePromises","childDiff","currentChildValue","movingNodes","deletePromises","deletePaths","includeDescendantCheck","descPath","addDescendant","generator","valueCallback","canceled","addChildNode","filtered","targetNode","lockPath","parentNode","childValueInfo","convertFilterArray","includeFilter","excludeFilter","applyFiltersOnInlineData","checkPathInfo","remove","targetProp","hasIncludeOnChild","excludes","metadata","include","descRows","row","objectToArray","targetPathKeys","otherNode","nodeType","nodeValue","checkKeys","AsyncTaskBatch","limit","task","executeQuery","_2","api","queryFilters","querySort","sortMatches","left","right","loadResultsData","preResults","maxBatchSize","stepsExecuted","isWildcardPath","availableIndexes","usingIndexes","hasExplicitFilterValues","isRealtime","combinations","filterValues","prevCombinations","fv","filters","loadData","set","_e","_f","indexesOnKey","otherFilterKeys","sortKeys","beneficialIndexes","availableKeys","forOtherFilters","forSorting","forBoth","points","bestBenificialIndex","sort","indexDescriptions","tableScanFilters","specialOpsRegex","allowedTableScanOperators","indexScanPromises","resultFilters","sortIndex","metadataSort","indexResultSets","indexedResults","resultSet","shortestSet","otherSets","otherResult","loadPartialResults","indexKeyFilter","preliminaryStop","loadPartialData","_","matchNode","monitor","matchedPaths","removeMatch","addMatch","stopMonitoring","childChangedCallback","childAddedCallback","childRemovedCallback","wasMatch","keepMonitoring","seenKeys","missingKeys","filterQueue","simpleFilters","indexFilters","keysToLoad","loadOptions","LocalApi","init","readyCallback","storageEnv","storageSettings","isObjectOrArray","stream","LocalStorageSettings","LocalStorageTransaction","json","checkCallback","addCallback","createLocalStorageInstance","localStorage","AceBase","IndexedDBStorageSettings","AceBaseLocalSettings","apiSettings","_requestToPromise","IndexedDBStorageTransaction","copy","processed","handleError","handleSuccess","r1","r2","succeeded","store","keepGoing","createIndexedDBInstance","idb","readyPromise","deprecatedConstructorError","BrowserAceBase","generateQuickGuid","privateRequest","crudRoute","listenRoute","authRoute","storageRoute","SwygerClient","__privateAdd","__publicField","__privateGet","_config","offlineDatabaseHandler","dataRef","trans","_db","_i","_l","__privateSet","_dataBaseConnected","axiosData","_storage","_storageConfig","_mail","elt","file","checkHttpAuthorization","_requireAuth","_redirectTo","_g","_h","listenSocket","listenLocal","_listen","eventName","listenEmitter","API_VERSION","_eventEmitter","socketListener","_extrasRef","listenReq","emitterListener","AxiosReq","authRequest","onRequest","dataRequest","extractArgs","reqOn","localDatabase","search","_k","_n","_q","_syncWithLocal","_t","_w","ready","apiService","local","generatedUID","listen","location","shouldSync","sync","requireAuth","requestRef","required","redirect","customPath","arg","OFFLINE_DB_NAME","doInInactivity","userInfo","jwtDecode","_basePath","RemoteService","Config","ClientConfig","SwygerStorageClient","service","extendStatics","__extends","__","__awaiter","_arguments","P","adopt","step","__generator","body","g","verb","__values","__read","ar","__spreadArray","__await","__asyncGenerator","q","resume","fulfill","__asyncValues","createErrorClass","createImpl","_super","ctorFunc","UnsubscriptionError","errors","arrRemove","Subscription","initialTeardown","e_1","e_2","_parentage","_parentage_1","_parentage_1_1","parent_1","e_1_1","initialFinalizer","_finalizers","_finalizers_1","_finalizers_1_1","finalizer","execFinalizer","e_2_1","teardown","EMPTY_SUBSCRIPTION","isSubscription","timeoutProvider","delegate","handle","reportUnhandledError","onUnhandledError","COMPLETE_NOTIFICATION","createNotification","errorNotification","nextNotification","errorContext","isRoot","errorThrown","captureError","Subscriber","destination","_this","EMPTY_OBSERVER","complete","SafeSubscriber","handleStoppedNotification","_bind","ConsumerObserver","partialObserver","handleUnhandledError","observerOrNext","context_1","defaultErrorHandler","onStoppedNotification","observable","identity","pipe","pipeFromArray","operator","isSubscriber","sink","promiseCtor","getPromiseCtor","Symbol_observable","operations","isObserver","hasLift","operate","liftedSource","createOperatorSubscriber","onNext","onError","onFinalize","OperatorSubscriber","shouldUnsubscribe","closed_1","refCount","connection","refCounter","sharedConnection","conn","ConnectableObservable","subjectFactory","subject","_connection","subject_1","higherOrderRefCount","performanceTimestampProvider","animationFrameProvider","animationFrames","timestampProvider","animationFramesFactory","DEFAULT_ANIMATION_FRAMES","provider","run","ObjectUnsubscribedError","Subject","AnonymousSubject","observers","hasError","isStopped","thrownError","BehaviorSubject","dateTimestampProvider","ReplaySubject","_bufferSize","_windowTime","_timestampProvider","_buffer","_infiniteTimeWindow","adjustedBufferSize","AsyncSubject","_hasValue","_isComplete","Action","scheduler","work","intervalProvider","AsyncAction","_id","_scheduler","_delay","errored","errorValue","actions","nextHandle","activeHandles","findAndClearHandle","Immediate","setImmediate","clearImmediate","immediateProvider","AsapAction","Scheduler","schedulerActionCtor","AsyncScheduler","SchedulerAction","AsapScheduler","flushId","asapScheduler","asap","asyncScheduler","async","QueueAction","QueueScheduler","queueScheduler","queue","AnimationFrameAction","AnimationFrameScheduler","animationFrameScheduler","animationFrame","VirtualTimeScheduler","maxFrames","VirtualAction","EMPTY","emptyScheduled","isScheduler","popResultSelector","popScheduler","popNumber","isArrayLike","isPromise","isInteropObservable","isAsyncIterable","createInvalidObservableTypeError","getSymbolIterator","isIterable","Symbol_iterator","readableStreamLikeToAsyncGenerator","readableStream","reader","isReadableStreamLike","innerFrom","fromInteropObservable","fromArrayLike","fromPromise","fromAsyncIterable","fromIterable","fromReadableStreamLike","obs","iterable","iterable_1","iterable_1_1","asyncIterable","asyncIterable_1","asyncIterable_1_1","executeSchedule","parentSubscription","repeat","scheduleSubscription","observeOn","subscribeOn","scheduleObservable","schedulePromise","scheduleArray","scheduleIterable","scheduleAsyncIterable","scheduleReadableStreamLike","scheduled","of","errorOrErrorFactory","errorFactory","NotificationKind","Notification","observeNotification","nextHandler","errorHandler","completeHandler","nextOrObserver","isObservable","EmptyError","lastValueFrom","hasConfig","firstValueFrom","ArgumentOutOfRangeError","NotFoundError","SequenceError","isValidDate","TimeoutError","schedulerArg","each","_with","timeoutErrorFactory","meta","originalSourceSubscription","timerSubscription","lastValue","seen","startTimer","project","callOrApply","mapOneOrManyArgs","bindCallbackInternals","isNodeStyle","callbackFunc","resultSelector","uninitialized","subs","isAsync_1","isComplete_1","bindCallback","bindNodeCallback","objectProto","argsArgArrayOrObject","first_1","isPOJO","createObject","combineLatest","observables","combineLatestInit","valueTransform","maybeSchedule","active","remainingFirstValues","_loop_1","hasFirstValue","execute","mergeInternals","concurrent","onBeforeNext","expand","innerSubScheduler","additionalFinalizer","isComplete","checkComplete","outerNext","doInnerSub","innerComplete","innerValue","bufferedValue","ii","mergeAll","concatAll","concat","observableFactory","DEFAULT_CONFIG","connectable","connector","resetOnDisconnect","forkJoin","sources","remainingCompletions","remainingEmissions","sourceIndex","nodeEventEmitterMethods","eventTargetMethods","jqueryMethods","fromEvent","isEventTarget","isNodeStyleEventEmitter","toCommonHandlerRegistry","isJQueryStyleEventEmitter","add","subTarget","fromEventPattern","addHandler","removeHandler","retValue","generate","initialStateOrOptions","iterate","resultSelectorOrScheduler","initialState","gen","iif","trueResult","falseResult","dueTime","intervalOrScheduler","intervalDuration","due","period","NEVER","never","argsOrArgArray","onErrorResumeNext","nextSources","subscribeNext","nextSource","innerSubscriber","not","pred","predicate","partition","race","raceInit","subscriptions","range","end","using","resourceFactory","resource","zip","completed","audit","durationSelector","durationSubscriber","endDuration","cleanupDuration","auditTime","duration","closingNotifier","currentBuffer","bufferCount","bufferSize","startBufferEvery","toEmit","buffers_1","buffers_1_1","toEmit_1","toEmit_1_1","e_3","buffers_2","buffers_2_1","e_3_1","bufferTime","bufferTimeSpan","otherArgs","bufferCreationInterval","maxBufferSize","bufferRecords","restartOnEmit","emit","record","startBuffer","record_1","bufferTimeSubscriber","recordsCopy","recordsCopy_1","recordsCopy_1_1","bufferToggle","openings","closingSelector","openValue","closingSubscription","emitBuffer","bufferWhen","closingSubscriber","openBuffer","catchError","selector","innerSub","syncUnsub","handledResult","scanInternals","accumulator","hasSeed","emitOnNext","emitBeforeComplete","hasState","reduce","arrReducer","joinAllInternals","joinFn","combineLatestAll","combineAll","combineLatestWith","otherSources","concatMap","concatMapTo","innerObservable","concatWith","fromSubscribable","subscribable","connect","debounce","debounceTime","activeTask","lastTime","emitWhenIdle","targetTime","defaultIfEmpty","take","ignoreElements","mapTo","delayWhen","delayDurationSelector","subscriptionDelay","dematerialize","distinct","keySelector","flushes","distinctKeys","distinctUntilChanged","comparator","defaultCompare","previousKey","currentKey","distinctUntilKeyChanged","throwIfEmpty","defaultErrorFactory","elementAt","hasDefaultValue","endWith","every","exhaustMap","outerValue","exhaustAll","exhaust","finalize","find","createFind","findIndex","groupBy","elementOrOptions","element","groups","notify","consumer","activeGroups","teardownAttempted","groupBySourceSubscriber","key_1","group_1","grouped","createGroupedObservable","durationSubscriber_1","groupSubject","groupSubscriber","isEmpty","takeLast","buffer_1","buffer_1_1","materialize","comparer","flatMap","mergeMapTo","mergeScan","mergeWith","multicast","subjectOrSubjectFactory","onErrorResumeNextWith","oERNCreate","pairwise","hasPrev","pluck","currentProp","publishBehavior","publishLast","publishReplay","windowTime","selectorOrScheduler","raceWith","countOrConfig","soFar","sourceSub","resubscribe","notifier","notifierSubscriber_1","subscribeToSource","repeatWhen","syncResub","completions$","isNotifierComplete","isMainComplete","getCompletionSubject","subscribeForRepeatWhen","retry","configOrCount","resetOnSuccess","subscribeForRetry","resub_1","retryWhen","errors$","subscribeForRetryWhen","sample","sampleTime","scan","sequenceEqual","compareTo","aState","createState","bState","isEqual","createSubscriber","selfState","otherState","sequenceEqualSubscriber","share","resetOnError","resetOnComplete","resetOnRefCountZero","wrapperSource","resetConnection","hasCompleted","hasErrored","cancelReset","reset","resetAndUnsubscribe","dest","handleReset","onSubscriber","shareReplay","configOrBufferSize","single","singleValue","seenValue","skipLast","skipCount","ring","valueIndex","skipUntil","taking","skipSubscriber","skipWhile","startWith","switchMap","innerIndex","outerIndex","switchAll","switchMapTo","switchScan","takeUntil","takeWhile","inclusive","tap","tapObserver","isUnsub","throttle","leading","trailing","sendValue","throttled","endThrottling","send","cleanupThrottling","startThrottle","throttleTime","duration$","timeInterval","TimeInterval","timeoutWith","withObservable","window","windowBoundaries","windowSubject","windowCount","windowSize","startWindowEvery","startEvery","windows","starts","windows_1","windows_1_1","window_1","window_2","windowTimeSpan","windowCreationInterval","maxWindowSize","windowRecords","restartOnClose","closeWindow","startWindow","loop","terminate","windowToggle","windowsCopy","windowsCopy_1","windowsCopy_1_1","windowWhen","openWindow","withLatestFrom","inputs","otherValues","zipAll","zipStatic","zipWith","otherInputs"],"sources":["../node_modules/engine.io-parser/build/esm/commons.js","../node_modules/engine.io-parser/build/esm/encodePacket.browser.js","../node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","../node_modules/engine.io-parser/build/esm/decodePacket.browser.js","../node_modules/engine.io-parser/build/esm/index.js","../node_modules/@socket.io/component-emitter/index.mjs","../node_modules/engine.io-client/build/esm/globalThis.browser.js","../node_modules/engine.io-client/build/esm/util.js","../node_modules/engine.io-client/build/esm/transport.js","../node_modules/engine.io-client/build/esm/contrib/yeast.js","../node_modules/engine.io-client/build/esm/contrib/parseqs.js","../node_modules/engine.io-client/build/esm/contrib/has-cors.js","../node_modules/engine.io-client/build/esm/transports/xmlhttprequest.browser.js","../node_modules/engine.io-client/build/esm/transports/polling.js","../node_modules/engine.io-client/build/esm/transports/websocket-constructor.browser.js","../node_modules/engine.io-client/build/esm/transports/websocket.js","../node_modules/engine.io-client/build/esm/transports/index.js","../node_modules/engine.io-client/build/esm/contrib/parseuri.js","../node_modules/engine.io-client/build/esm/socket.js","../node_modules/socket.io-client/build/esm/url.js","../node_modules/socket.io-parser/build/esm/is-binary.js","../node_modules/socket.io-parser/build/esm/binary.js","../node_modules/socket.io-parser/build/esm/index.js","../node_modules/socket.io-client/build/esm/on.js","../node_modules/socket.io-client/build/esm/socket.js","../node_modules/socket.io-client/build/esm/contrib/backo2.js","../node_modules/socket.io-client/build/esm/manager.js","../node_modules/socket.io-client/build/esm/index.js","../src/api/socket_io/index.service.js","../node_modules/jwt-decode/build/jwt-decode.esm.js","../node_modules/axios/lib/helpers/bind.js","../node_modules/axios/lib/utils.js","../node_modules/axios/lib/core/AxiosError.js","../node_modules/axios/lib/helpers/null.js","../node_modules/axios/lib/helpers/toFormData.js","../node_modules/axios/lib/helpers/AxiosURLSearchParams.js","../node_modules/axios/lib/helpers/buildURL.js","../node_modules/axios/lib/core/InterceptorManager.js","../node_modules/axios/lib/defaults/transitional.js","../node_modules/axios/lib/platform/browser/classes/URLSearchParams.js","../node_modules/axios/lib/platform/browser/classes/FormData.js","../node_modules/axios/lib/platform/browser/classes/Blob.js","../node_modules/axios/lib/platform/browser/index.js","../node_modules/axios/lib/helpers/toURLEncodedForm.js","../node_modules/axios/lib/helpers/formDataToJSON.js","../node_modules/axios/lib/defaults/index.js","../node_modules/axios/lib/helpers/parseHeaders.js","../node_modules/axios/lib/core/AxiosHeaders.js","../node_modules/axios/lib/core/transformData.js","../node_modules/axios/lib/cancel/isCancel.js","../node_modules/axios/lib/cancel/CanceledError.js","../node_modules/axios/lib/core/settle.js","../node_modules/axios/lib/helpers/cookies.js","../node_modules/axios/lib/helpers/isAbsoluteURL.js","../node_modules/axios/lib/helpers/combineURLs.js","../node_modules/axios/lib/core/buildFullPath.js","../node_modules/axios/lib/helpers/isURLSameOrigin.js","../node_modules/axios/lib/helpers/parseProtocol.js","../node_modules/axios/lib/helpers/speedometer.js","../node_modules/axios/lib/adapters/xhr.js","../node_modules/axios/lib/adapters/adapters.js","../node_modules/axios/lib/core/dispatchRequest.js","../node_modules/axios/lib/core/mergeConfig.js","../node_modules/axios/lib/env/data.js","../node_modules/axios/lib/helpers/validator.js","../node_modules/axios/lib/core/Axios.js","../node_modules/axios/lib/cancel/CancelToken.js","../node_modules/axios/lib/helpers/spread.js","../node_modules/axios/lib/helpers/isAxiosError.js","../node_modules/axios/lib/helpers/HttpStatusCode.js","../node_modules/axios/lib/axios.js","../src/api/axios/index.service.js","../node_modules/uuid/dist/esm-browser/rng.js","../node_modules/uuid/dist/esm-browser/stringify.js","../node_modules/uuid/dist/esm-browser/native.js","../node_modules/uuid/dist/esm-browser/v4.js","../node_modules/eventemitter3/index.js","../node_modules/dottie/dottie.js","../node_modules/acebase-core/dist/esm/simple-event-emitter.js","../node_modules/acebase-core/dist/esm/path-info.js","../node_modules/acebase-core/dist/esm/data-snapshot.js","../node_modules/acebase-core/dist/esm/subscription.js","../node_modules/acebase-core/dist/esm/cuid/pad.js","../node_modules/acebase-core/dist/esm/cuid/fingerprint/browser.js","../node_modules/acebase-core/dist/esm/cuid/index.js","../node_modules/acebase-core/dist/esm/id.js","../node_modules/acebase-core/dist/esm/path-reference.js","../node_modules/acebase-core/dist/esm/process/browser.js","../node_modules/acebase-core/dist/esm/partial-array.js","../node_modules/acebase-core/dist/esm/utils.js","../node_modules/acebase-core/dist/esm/optional-observable.js","../node_modules/acebase-core/dist/esm/data-proxy.js","../node_modules/acebase-core/dist/esm/data-reference.js","../node_modules/acebase-core/dist/esm/type-mappings.js","../node_modules/acebase-core/dist/esm/debug.js","../node_modules/acebase-core/dist/esm/simple-colors.js","../node_modules/acebase-core/dist/esm/acebase-base.js","../node_modules/acebase-core/dist/esm/api.js","../node_modules/acebase-core/dist/esm/ascii85.js","../node_modules/acebase-core/dist/esm/transport.js","../node_modules/acebase-core/dist/esm/simple-cache.js","../node_modules/acebase-core/dist/esm/schema.js","../node_modules/acebase/dist/esm/not-supported.js","../node_modules/acebase/dist/esm/storage/binary/browser.js","../node_modules/acebase/dist/esm/storage/sqlite/browser.js","../node_modules/acebase/dist/esm/storage/mssql/browser.js","../node_modules/acebase/dist/esm/node-value-types.js","../node_modules/acebase/dist/esm/node-info.js","../node_modules/acebase/dist/esm/assert.js","../node_modules/acebase/dist/esm/node-lock.js","../node_modules/acebase/dist/esm/node-errors.js","../node_modules/acebase/dist/esm/ipc/ipc.js","../node_modules/acebase/dist/esm/ipc/browser.js","../node_modules/acebase/dist/esm/promise-fs/browser.js","../node_modules/acebase/dist/esm/data-index/browser.js","../node_modules/acebase/dist/esm/storage/create-index.js","../node_modules/acebase/dist/esm/storage/index.js","../node_modules/acebase/dist/esm/storage/custom/helpers.js","../node_modules/acebase/dist/esm/node-address.js","../node_modules/acebase/dist/esm/storage/custom/index.js","../node_modules/acebase/dist/esm/async-task-batch.js","../node_modules/acebase/dist/esm/query.js","../node_modules/acebase/dist/esm/api-local.js","../node_modules/acebase/dist/esm/storage/custom/local-storage/settings.js","../node_modules/acebase/dist/esm/storage/custom/local-storage/transaction.js","../node_modules/acebase/dist/esm/storage/custom/local-storage/index.js","../node_modules/acebase/dist/esm/storage/custom/indexed-db/settings.js","../node_modules/acebase/dist/esm/acebase-local.js","../node_modules/acebase/dist/esm/storage/custom/indexed-db/transaction.js","../node_modules/acebase/dist/esm/storage/custom/indexed-db/index.js","../node_modules/acebase/dist/esm/acebase-browser.js","../node_modules/acebase/dist/esm/browser.js","../src/api/api-route.js","../src/api/index.js","../src/api/env.js","../src/index.js","../node_modules/tslib/tslib.es6.js","../node_modules/rxjs/dist/esm5/internal/util/isFunction.js","../node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js","../node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js","../node_modules/rxjs/dist/esm5/internal/util/arrRemove.js","../node_modules/rxjs/dist/esm5/internal/Subscription.js","../node_modules/rxjs/dist/esm5/internal/config.js","../node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js","../node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js","../node_modules/rxjs/dist/esm5/internal/util/noop.js","../node_modules/rxjs/dist/esm5/internal/NotificationFactories.js","../node_modules/rxjs/dist/esm5/internal/util/errorContext.js","../node_modules/rxjs/dist/esm5/internal/Subscriber.js","../node_modules/rxjs/dist/esm5/internal/symbol/observable.js","../node_modules/rxjs/dist/esm5/internal/util/identity.js","../node_modules/rxjs/dist/esm5/internal/util/pipe.js","../node_modules/rxjs/dist/esm5/internal/Observable.js","../node_modules/rxjs/dist/esm5/internal/util/lift.js","../node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js","../node_modules/rxjs/dist/esm5/internal/operators/refCount.js","../node_modules/rxjs/dist/esm5/internal/observable/ConnectableObservable.js","../node_modules/rxjs/dist/esm5/internal/scheduler/performanceTimestampProvider.js","../node_modules/rxjs/dist/esm5/internal/scheduler/animationFrameProvider.js","../node_modules/rxjs/dist/esm5/internal/observable/dom/animationFrames.js","../node_modules/rxjs/dist/esm5/internal/util/ObjectUnsubscribedError.js","../node_modules/rxjs/dist/esm5/internal/Subject.js","../node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js","../node_modules/rxjs/dist/esm5/internal/scheduler/dateTimestampProvider.js","../node_modules/rxjs/dist/esm5/internal/ReplaySubject.js","../node_modules/rxjs/dist/esm5/internal/AsyncSubject.js","../node_modules/rxjs/dist/esm5/internal/scheduler/Action.js","../node_modules/rxjs/dist/esm5/internal/scheduler/intervalProvider.js","../node_modules/rxjs/dist/esm5/internal/scheduler/AsyncAction.js","../node_modules/rxjs/dist/esm5/internal/util/Immediate.js","../node_modules/rxjs/dist/esm5/internal/scheduler/immediateProvider.js","../node_modules/rxjs/dist/esm5/internal/scheduler/AsapAction.js","../node_modules/rxjs/dist/esm5/internal/Scheduler.js","../node_modules/rxjs/dist/esm5/internal/scheduler/AsyncScheduler.js","../node_modules/rxjs/dist/esm5/internal/scheduler/AsapScheduler.js","../node_modules/rxjs/dist/esm5/internal/scheduler/asap.js","../node_modules/rxjs/dist/esm5/internal/scheduler/async.js","../node_modules/rxjs/dist/esm5/internal/scheduler/QueueAction.js","../node_modules/rxjs/dist/esm5/internal/scheduler/QueueScheduler.js","../node_modules/rxjs/dist/esm5/internal/scheduler/queue.js","../node_modules/rxjs/dist/esm5/internal/scheduler/AnimationFrameAction.js","../node_modules/rxjs/dist/esm5/internal/scheduler/AnimationFrameScheduler.js","../node_modules/rxjs/dist/esm5/internal/scheduler/animationFrame.js","../node_modules/rxjs/dist/esm5/internal/scheduler/VirtualTimeScheduler.js","../node_modules/rxjs/dist/esm5/internal/observable/empty.js","../node_modules/rxjs/dist/esm5/internal/util/isScheduler.js","../node_modules/rxjs/dist/esm5/internal/util/args.js","../node_modules/rxjs/dist/esm5/internal/util/isArrayLike.js","../node_modules/rxjs/dist/esm5/internal/util/isPromise.js","../node_modules/rxjs/dist/esm5/internal/util/isInteropObservable.js","../node_modules/rxjs/dist/esm5/internal/util/isAsyncIterable.js","../node_modules/rxjs/dist/esm5/internal/util/throwUnobservableError.js","../node_modules/rxjs/dist/esm5/internal/symbol/iterator.js","../node_modules/rxjs/dist/esm5/internal/util/isIterable.js","../node_modules/rxjs/dist/esm5/internal/util/isReadableStreamLike.js","../node_modules/rxjs/dist/esm5/internal/observable/innerFrom.js","../node_modules/rxjs/dist/esm5/internal/util/executeSchedule.js","../node_modules/rxjs/dist/esm5/internal/operators/observeOn.js","../node_modules/rxjs/dist/esm5/internal/operators/subscribeOn.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleObservable.js","../node_modules/rxjs/dist/esm5/internal/scheduled/schedulePromise.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleArray.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleIterable.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleAsyncIterable.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduleReadableStreamLike.js","../node_modules/rxjs/dist/esm5/internal/scheduled/scheduled.js","../node_modules/rxjs/dist/esm5/internal/observable/from.js","../node_modules/rxjs/dist/esm5/internal/observable/of.js","../node_modules/rxjs/dist/esm5/internal/observable/throwError.js","../node_modules/rxjs/dist/esm5/internal/Notification.js","../node_modules/rxjs/dist/esm5/internal/util/isObservable.js","../node_modules/rxjs/dist/esm5/internal/util/EmptyError.js","../node_modules/rxjs/dist/esm5/internal/lastValueFrom.js","../node_modules/rxjs/dist/esm5/internal/firstValueFrom.js","../node_modules/rxjs/dist/esm5/internal/util/ArgumentOutOfRangeError.js","../node_modules/rxjs/dist/esm5/internal/util/NotFoundError.js","../node_modules/rxjs/dist/esm5/internal/util/SequenceError.js","../node_modules/rxjs/dist/esm5/internal/util/isDate.js","../node_modules/rxjs/dist/esm5/internal/operators/timeout.js","../node_modules/rxjs/dist/esm5/internal/operators/map.js","../node_modules/rxjs/dist/esm5/internal/util/mapOneOrManyArgs.js","../node_modules/rxjs/dist/esm5/internal/observable/bindCallbackInternals.js","../node_modules/rxjs/dist/esm5/internal/observable/bindCallback.js","../node_modules/rxjs/dist/esm5/internal/observable/bindNodeCallback.js","../node_modules/rxjs/dist/esm5/internal/util/argsArgArrayOrObject.js","../node_modules/rxjs/dist/esm5/internal/util/createObject.js","../node_modules/rxjs/dist/esm5/internal/observable/combineLatest.js","../node_modules/rxjs/dist/esm5/internal/operators/mergeInternals.js","../node_modules/rxjs/dist/esm5/internal/operators/mergeMap.js","../node_modules/rxjs/dist/esm5/internal/operators/mergeAll.js","../node_modules/rxjs/dist/esm5/internal/operators/concatAll.js","../node_modules/rxjs/dist/esm5/internal/observable/concat.js","../node_modules/rxjs/dist/esm5/internal/observable/defer.js","../node_modules/rxjs/dist/esm5/internal/observable/connectable.js","../node_modules/rxjs/dist/esm5/internal/observable/forkJoin.js","../node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js","../node_modules/rxjs/dist/esm5/internal/observable/fromEventPattern.js","../node_modules/rxjs/dist/esm5/internal/observable/generate.js","../node_modules/rxjs/dist/esm5/internal/observable/iif.js","../node_modules/rxjs/dist/esm5/internal/observable/timer.js","../node_modules/rxjs/dist/esm5/internal/observable/interval.js","../node_modules/rxjs/dist/esm5/internal/observable/merge.js","../node_modules/rxjs/dist/esm5/internal/observable/never.js","../node_modules/rxjs/dist/esm5/internal/util/argsOrArgArray.js","../node_modules/rxjs/dist/esm5/internal/observable/onErrorResumeNext.js","../node_modules/rxjs/dist/esm5/internal/observable/pairs.js","../node_modules/rxjs/dist/esm5/internal/util/not.js","../node_modules/rxjs/dist/esm5/internal/operators/filter.js","../node_modules/rxjs/dist/esm5/internal/observable/partition.js","../node_modules/rxjs/dist/esm5/internal/observable/race.js","../node_modules/rxjs/dist/esm5/internal/observable/range.js","../node_modules/rxjs/dist/esm5/internal/observable/using.js","../node_modules/rxjs/dist/esm5/internal/observable/zip.js","../node_modules/rxjs/dist/esm5/internal/operators/audit.js","../node_modules/rxjs/dist/esm5/internal/operators/auditTime.js","../node_modules/rxjs/dist/esm5/internal/operators/buffer.js","../node_modules/rxjs/dist/esm5/internal/operators/bufferCount.js","../node_modules/rxjs/dist/esm5/internal/operators/bufferTime.js","../node_modules/rxjs/dist/esm5/internal/operators/bufferToggle.js","../node_modules/rxjs/dist/esm5/internal/operators/bufferWhen.js","../node_modules/rxjs/dist/esm5/internal/operators/catchError.js","../node_modules/rxjs/dist/esm5/internal/operators/scanInternals.js","../node_modules/rxjs/dist/esm5/internal/operators/reduce.js","../node_modules/rxjs/dist/esm5/internal/operators/toArray.js","../node_modules/rxjs/dist/esm5/internal/operators/joinAllInternals.js","../node_modules/rxjs/dist/esm5/internal/operators/combineLatestAll.js","../node_modules/rxjs/dist/esm5/internal/operators/combineAll.js","../node_modules/rxjs/dist/esm5/internal/operators/combineLatest.js","../node_modules/rxjs/dist/esm5/internal/operators/combineLatestWith.js","../node_modules/rxjs/dist/esm5/internal/operators/concatMap.js","../node_modules/rxjs/dist/esm5/internal/operators/concatMapTo.js","../node_modules/rxjs/dist/esm5/internal/operators/concat.js","../node_modules/rxjs/dist/esm5/internal/operators/concatWith.js","../node_modules/rxjs/dist/esm5/internal/observable/fromSubscribable.js","../node_modules/rxjs/dist/esm5/internal/operators/connect.js","../node_modules/rxjs/dist/esm5/internal/operators/count.js","../node_modules/rxjs/dist/esm5/internal/operators/debounce.js","../node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js","../node_modules/rxjs/dist/esm5/internal/operators/defaultIfEmpty.js","../node_modules/rxjs/dist/esm5/internal/operators/take.js","../node_modules/rxjs/dist/esm5/internal/operators/ignoreElements.js","../node_modules/rxjs/dist/esm5/internal/operators/mapTo.js","../node_modules/rxjs/dist/esm5/internal/operators/delayWhen.js","../node_modules/rxjs/dist/esm5/internal/operators/delay.js","../node_modules/rxjs/dist/esm5/internal/operators/dematerialize.js","../node_modules/rxjs/dist/esm5/internal/operators/distinct.js","../node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js","../node_modules/rxjs/dist/esm5/internal/operators/distinctUntilKeyChanged.js","../node_modules/rxjs/dist/esm5/internal/operators/throwIfEmpty.js","../node_modules/rxjs/dist/esm5/internal/operators/elementAt.js","../node_modules/rxjs/dist/esm5/internal/operators/endWith.js","../node_modules/rxjs/dist/esm5/internal/operators/every.js","../node_modules/rxjs/dist/esm5/internal/operators/exhaustMap.js","../node_modules/rxjs/dist/esm5/internal/operators/exhaustAll.js","../node_modules/rxjs/dist/esm5/internal/operators/exhaust.js","../node_modules/rxjs/dist/esm5/internal/operators/expand.js","../node_modules/rxjs/dist/esm5/internal/operators/finalize.js","../node_modules/rxjs/dist/esm5/internal/operators/find.js","../node_modules/rxjs/dist/esm5/internal/operators/findIndex.js","../node_modules/rxjs/dist/esm5/internal/operators/first.js","../node_modules/rxjs/dist/esm5/internal/operators/groupBy.js","../node_modules/rxjs/dist/esm5/internal/operators/isEmpty.js","../node_modules/rxjs/dist/esm5/internal/operators/takeLast.js","../node_modules/rxjs/dist/esm5/internal/operators/last.js","../node_modules/rxjs/dist/esm5/internal/operators/materialize.js","../node_modules/rxjs/dist/esm5/internal/operators/max.js","../node_modules/rxjs/dist/esm5/internal/operators/flatMap.js","../node_modules/rxjs/dist/esm5/internal/operators/mergeMapTo.js","../node_modules/rxjs/dist/esm5/internal/operators/mergeScan.js","../node_modules/rxjs/dist/esm5/internal/operators/merge.js","../node_modules/rxjs/dist/esm5/internal/operators/mergeWith.js","../node_modules/rxjs/dist/esm5/internal/operators/min.js","../node_modules/rxjs/dist/esm5/internal/operators/multicast.js","../node_modules/rxjs/dist/esm5/internal/operators/onErrorResumeNextWith.js","../node_modules/rxjs/dist/esm5/internal/operators/pairwise.js","../node_modules/rxjs/dist/esm5/internal/operators/pluck.js","../node_modules/rxjs/dist/esm5/internal/operators/publish.js","../node_modules/rxjs/dist/esm5/internal/operators/publishBehavior.js","../node_modules/rxjs/dist/esm5/internal/operators/publishLast.js","../node_modules/rxjs/dist/esm5/internal/operators/publishReplay.js","../node_modules/rxjs/dist/esm5/internal/operators/raceWith.js","../node_modules/rxjs/dist/esm5/internal/operators/repeat.js","../node_modules/rxjs/dist/esm5/internal/operators/repeatWhen.js","../node_modules/rxjs/dist/esm5/internal/operators/retry.js","../node_modules/rxjs/dist/esm5/internal/operators/retryWhen.js","../node_modules/rxjs/dist/esm5/internal/operators/sample.js","../node_modules/rxjs/dist/esm5/internal/operators/sampleTime.js","../node_modules/rxjs/dist/esm5/internal/operators/scan.js","../node_modules/rxjs/dist/esm5/internal/operators/sequenceEqual.js","../node_modules/rxjs/dist/esm5/internal/operators/share.js","../node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js","../node_modules/rxjs/dist/esm5/internal/operators/single.js","../node_modules/rxjs/dist/esm5/internal/operators/skip.js","../node_modules/rxjs/dist/esm5/internal/operators/skipLast.js","../node_modules/rxjs/dist/esm5/internal/operators/skipUntil.js","../node_modules/rxjs/dist/esm5/internal/operators/skipWhile.js","../node_modules/rxjs/dist/esm5/internal/operators/startWith.js","../node_modules/rxjs/dist/esm5/internal/operators/switchMap.js","../node_modules/rxjs/dist/esm5/internal/operators/switchAll.js","../node_modules/rxjs/dist/esm5/internal/operators/switchMapTo.js","../node_modules/rxjs/dist/esm5/internal/operators/switchScan.js","../node_modules/rxjs/dist/esm5/internal/operators/takeUntil.js","../node_modules/rxjs/dist/esm5/internal/operators/takeWhile.js","../node_modules/rxjs/dist/esm5/internal/operators/tap.js","../node_modules/rxjs/dist/esm5/internal/operators/throttle.js","../node_modules/rxjs/dist/esm5/internal/operators/throttleTime.js","../node_modules/rxjs/dist/esm5/internal/operators/timeInterval.js","../node_modules/rxjs/dist/esm5/internal/operators/timeoutWith.js","../node_modules/rxjs/dist/esm5/internal/operators/timestamp.js","../node_modules/rxjs/dist/esm5/internal/operators/window.js","../node_modules/rxjs/dist/esm5/internal/operators/windowCount.js","../node_modules/rxjs/dist/esm5/internal/operators/windowTime.js","../node_modules/rxjs/dist/esm5/internal/operators/windowToggle.js","../node_modules/rxjs/dist/esm5/internal/operators/windowWhen.js","../node_modules/rxjs/dist/esm5/internal/operators/withLatestFrom.js","../node_modules/rxjs/dist/esm5/internal/operators/zipAll.js","../node_modules/rxjs/dist/esm5/internal/operators/zip.js","../node_modules/rxjs/dist/esm5/internal/operators/zipWith.js"],"sourcesContent":["const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach(key => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = obj => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nexport default encodePacket;\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType)\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType)\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1)\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type]\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            return data instanceof ArrayBuffer ? new Blob([data]) : data;\n        case \"arraybuffer\":\n        default:\n            return data; // assuming the data is already an ArrayBuffer\n    }\n};\nexport default decodePacket;\n","import encodePacket from \"./encodePacket.js\";\nimport decodePacket from \"./decodePacket.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, encodedPacket => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload };\n","/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","export const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\n","import { globalThisShim as globalThis } from \"./globalThis.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nclass TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n}\n","// imported from https://github.com/unshiftio/yeast\n'use strict';\nconst alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split(''), length = 64, map = {};\nlet seed = 0, i = 0, prev;\n/**\n * Return a string representing the specified number.\n *\n * @param {Number} num The number to convert.\n * @returns {String} The string representation of the number.\n * @api public\n */\nexport function encode(num) {\n    let encoded = '';\n    do {\n        encoded = alphabet[num % length] + encoded;\n        num = Math.floor(num / length);\n    } while (num > 0);\n    return encoded;\n}\n/**\n * Return the integer value specified by the given string.\n *\n * @param {String} str The string to convert.\n * @returns {Number} The integer value represented by the string.\n * @api public\n */\nexport function decode(str) {\n    let decoded = 0;\n    for (i = 0; i < str.length; i++) {\n        decoded = decoded * length + map[str.charAt(i)];\n    }\n    return decoded;\n}\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns {String} A unique id.\n * @api public\n */\nexport function yeast() {\n    const now = encode(+new Date());\n    if (now !== prev)\n        return seed = 0, prev = now;\n    return now + '.' + encode(seed++);\n}\n//\n// Map each character to its index.\n//\nfor (; i < length; i++)\n    map[alphabet[i]] = i;\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","// browser shim for xmlhttprequest module\nimport { hasCORS } from \"../contrib/has-cors.js\";\nimport { globalThisShim as globalThis } from \"../globalThis.js\";\nexport function XHR(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { yeast } from \"../contrib/yeast.js\";\nimport { encode } from \"../contrib/parseqs.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nimport { XHR as XMLHttpRequest } from \"./xmlhttprequest.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globalThis.js\";\nfunction empty() { }\nconst hasXHR2 = (function () {\n    const xhr = new XMLHttpRequest({\n        xdomain: false,\n    });\n    return null != xhr.responseType;\n})();\nexport class Polling extends Transport {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        this.polling = false;\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n            this.xs = opts.secure !== isSSL;\n        }\n        /**\n         * XHR supports binary\n         */\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this.poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this.polling || !this.writable) {\n            let total = 0;\n            if (this.polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    poll() {\n        this.polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this.polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this.poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        let query = this.query || {};\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        let port = \"\";\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = yeast();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        // avoid port if default for schema\n        if (this.opts.port &&\n            ((\"https\" === schema && Number(this.opts.port) !== 443) ||\n                (\"http\" === schema && Number(this.opts.port) !== 80))) {\n            port = \":\" + this.opts.port;\n        }\n        const encodedQuery = encode(query);\n        const ipv6 = this.opts.hostname.indexOf(\":\") !== -1;\n        return (schema +\n            \"://\" +\n            (ipv6 ? \"[\" + this.opts.hostname + \"]\" : this.opts.hostname) +\n            port +\n            this.opts.path +\n            (encodedQuery.length ? \"?\" + encodedQuery : \"\"));\n    }\n    /**\n     * Creates a request.\n     *\n     * @param {String} method\n     * @private\n     */\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd, xs: this.xs }, this.opts);\n        return new Request(this.uri(), opts);\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(uri, opts) {\n        super();\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.method = opts.method || \"GET\";\n        this.uri = uri;\n        this.async = false !== opts.async;\n        this.data = undefined !== opts.data ? opts.data : null;\n        this.create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    create() {\n        const opts = pick(this.opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this.opts.xd;\n        opts.xscheme = !!this.opts.xs;\n        const xhr = (this.xhr = new XMLHttpRequest(opts));\n        try {\n            xhr.open(this.method, this.uri, this.async);\n            try {\n                if (this.opts.extraHeaders) {\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this.opts.extraHeaders) {\n                        if (this.opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this.opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this.method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this.opts.withCredentials;\n            }\n            if (this.opts.requestTimeout) {\n                xhr.timeout = this.opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this.onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this.onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this.data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this.onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this.index = Request.requestsCount++;\n            Request.requests[this.index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    onError(err) {\n        this.emitReserved(\"error\", err, this.xhr);\n        this.cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    cleanup(fromError) {\n        if (\"undefined\" === typeof this.xhr || null === this.xhr) {\n            return;\n        }\n        this.xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this.xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this.index];\n        }\n        this.xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    onLoad() {\n        const data = this.xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this.cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this.cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\n","import { globalThisShim as globalThis } from \"../globalThis.js\";\nexport const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const WebSocket = globalThis.WebSocket || globalThis.MozWebSocket;\nexport const usingBrowserWebSocket = true;\nexport const defaultBinaryType = \"arraybuffer\";\n","import { Transport } from \"../transport.js\";\nimport { encode } from \"../contrib/parseqs.js\";\nimport { yeast } from \"../contrib/yeast.js\";\nimport { pick } from \"../util.js\";\nimport { defaultBinaryType, nextTick, usingBrowserWebSocket, WebSocket, } from \"./websocket-constructor.js\";\nimport { encodePacket } from \"engine.io-parser\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class WS extends Transport {\n    /**\n     * WebSocket transport constructor.\n     *\n     * @param {Object} opts - connection options\n     * @protected\n     */\n    constructor(opts) {\n        super(opts);\n        this.supportsBinary = !opts.forceBase64;\n    }\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        if (!this.check()) {\n            // let probe timeout\n            return;\n        }\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws =\n                usingBrowserWebSocket && !isReactNative\n                    ? protocols\n                        ? new WebSocket(uri, protocols)\n                        : new WebSocket(uri)\n                    : new WebSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType || defaultBinaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // always create a new object (GH-437)\n                const opts = {};\n                if (!usingBrowserWebSocket) {\n                    if (packet.options) {\n                        opts.compress = packet.options.compress;\n                    }\n                    if (this.opts.perMessageDeflate) {\n                        const len = \n                        // @ts-ignore\n                        \"string\" === typeof data ? Buffer.byteLength(data) : data.length;\n                        if (len < this.opts.perMessageDeflate.threshold) {\n                            opts.compress = false;\n                        }\n                    }\n                }\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    if (usingBrowserWebSocket) {\n                        // TypeError is thrown when passing the second argument on Safari\n                        this.ws.send(data);\n                    }\n                    else {\n                        this.ws.send(data, opts);\n                    }\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        let query = this.query || {};\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        let port = \"\";\n        // avoid port if default for schema\n        if (this.opts.port &&\n            ((\"wss\" === schema && Number(this.opts.port) !== 443) ||\n                (\"ws\" === schema && Number(this.opts.port) !== 80))) {\n            port = \":\" + this.opts.port;\n        }\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = yeast();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        const encodedQuery = encode(query);\n        const ipv6 = this.opts.hostname.indexOf(\":\") !== -1;\n        return (schema +\n            \"://\" +\n            (ipv6 ? \"[\" + this.opts.hostname + \"]\" : this.opts.hostname) +\n            port +\n            this.opts.path +\n            (encodedQuery.length ? \"?\" + encodedQuery : \"\"));\n    }\n    /**\n     * Feature detection for WebSocket.\n     *\n     * @return {Boolean} whether this transport is available.\n     * @private\n     */\n    check() {\n        return !!WebSocket;\n    }\n}\n","import { Polling } from \"./polling.js\";\nimport { WS } from \"./websocket.js\";\nexport const transports = {\n    websocket: WS,\n    polling: Polling,\n};\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nexport class Socket extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts = {}) {\n        super();\n        this.writeBuffer = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            uri = parse(uri);\n            opts.hostname = uri.host;\n            opts.secure = uri.protocol === \"https\" || uri.protocol === \"wss\";\n            opts.port = uri.port;\n            if (uri.query)\n                opts.query = uri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = opts.transports || [\"polling\", \"websocket\"];\n        this.writeBuffer = [];\n        this.prevBufferLen = 0;\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: true,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        // set on handshake\n        this.id = null;\n        this.upgrades = null;\n        this.pingInterval = null;\n        this.pingTimeout = null;\n        // set on heartbeat\n        this.pingTimeoutTimer = null;\n        if (typeof addEventListener === \"function\") {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this.beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this.beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this.offlineEventListener = () => {\n                    this.onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                addEventListener(\"offline\", this.offlineEventListener, false);\n            }\n        }\n        this.open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts.transportOptions[name], this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        });\n        return new transports[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    open() {\n        let transport;\n        if (this.opts.rememberUpgrade &&\n            Socket.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1) {\n            transport = \"websocket\";\n        }\n        else if (0 === this.transports.length) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        else {\n            transport = this.transports[0];\n        }\n        this.readyState = \"opening\";\n        // Retry with the next transport if the transport is disabled (jsonp: false)\n        try {\n            transport = this.createTransport(transport);\n        }\n        catch (e) {\n            this.transports.shift();\n            this.open();\n            return;\n        }\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this.onDrain.bind(this))\n            .on(\"packet\", this.onPacket.bind(this))\n            .on(\"error\", this.onError.bind(this))\n            .on(\"close\", (reason) => this.onClose(\"transport close\", reason));\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        Socket.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    Socket.priorWebsocketSuccess = \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        transport.open();\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        Socket.priorWebsocketSuccess = \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n        // we check for `readyState` in case an `open`\n        // listener already closed the socket\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            let i = 0;\n            const l = this.upgrades.length;\n            for (; i < l; i++) {\n                this.probe(this.upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this.resetPingTimeout();\n                    this.sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this.onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this.upgrades = this.filterUpgrades(data.upgrades);\n        this.pingInterval = data.pingInterval;\n        this.pingTimeout = data.pingTimeout;\n        this.maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this.resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    resetPingTimeout() {\n        this.clearTimeoutFn(this.pingTimeoutTimer);\n        this.pingTimeoutTimer = this.setTimeoutFn(() => {\n            this.onClose(\"ping timeout\");\n        }, this.pingInterval + this.pingTimeout);\n        if (this.opts.autoUnref) {\n            this.pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    onDrain() {\n        this.writeBuffer.splice(0, this.prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this.prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this.getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this.prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    getWritablePackets() {\n        const shouldCheckPayloadSize = this.maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this.maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this.sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    send(msg, options, fn) {\n        this.sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this.onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    onError(err) {\n        Socket.priorWebsocketSuccess = false;\n        this.emitReserved(\"error\", err);\n        this.onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this.pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (typeof removeEventListener === \"function\") {\n                removeEventListener(\"beforeunload\", this.beforeunloadEventListener, false);\n                removeEventListener(\"offline\", this.offlineEventListener, false);\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this.prevBufferLen = 0;\n        }\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        let i = 0;\n        const j = upgrades.length;\n        for (; i < j; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\nSocket.protocol = protocol;\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return typeof payload === \"object\";\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || typeof payload === \"object\";\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"string\" || typeof payload[0] === \"number\"));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = this.io.engine &&\n            this.io.engine.transport &&\n            this.io.engine.transport.writable;\n        const discardPacket = this.flags.volatile && (!isTransportWritable || !this.connected);\n        if (discardPacket) {\n        }\n        else if (this.connected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        this.acks[id] = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, [null, ...args]);\n        };\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        // the timeout flag is optional\n        const withErr = this.flags.timeout !== undefined || this._opts.ackTimeout !== undefined;\n        return new Promise((resolve, reject) => {\n            args.push((arg1, arg2) => {\n                if (withErr) {\n                    return arg1 ? reject(arg1) : resolve(arg2);\n                }\n                else {\n                    return resolve(arg1);\n                }\n            });\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n                // the packet has already been acknowledged\n                return;\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowlegement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (\"function\" === typeof ack) {\n            ack.apply(this, packet.data);\n            delete this.acks[packet.id];\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this.emitReserved(\"connect\");\n        this._drainQueue(true);\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        // emit `error`\n        const errorSub = on(socket, \"error\", (err) => {\n            self.cleanup();\n            self._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                self.maybeReconnectOnOpen();\n            }\n        });\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            if (timeout === 0) {\n                openSubDestroy(); // prevents a race condition with the 'open' event\n            }\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                socket.close();\n                // @ts-ignore\n                socket.emit(\"error\", new Error(\"timeout\"));\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(function subDestroy() {\n                clearTimeout(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n        if (this.engine)\n            this.engine.close();\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called upon engine close.\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        this.cleanup();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(function subDestroy() {\n                clearTimeout(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\n","import {io} from 'socket.io-client'\r\n\r\nconst SocketService = {\r\n  init: ({API_KEY,HOST_SERVER,CURRENT,ENV,API_VERSION}) => {\r\n    let socket={}\r\n    const accessToken=localStorage.getItem('accessToken')\r\n    try{\r\n      const extraHeaders={\r\n        'Accept':'application/json',\r\n        'Content-Type':'application/json',\r\n        'Access-Control-Allow-Origin':'*',\r\n        'Access-Key':API_KEY,//API_KEY,\r\n        //'socket':'\"{privateClient:\"true\",id:\"My-custom-id\"}\"',\r\n        'Access-Control-Allow-Methods':'POST, GET, OPTIONS, PUT, DELETE, HEAD,PATCH',\r\n        'Access-Control-Allow-Headers':'X-PINGOTHER, Origin, X-Requested-With, Content-Type, Accept',\r\n        'Access-Control-Max-Age':'1728000',\r\n      }\r\n      if(accessToken) extraHeaders['Authorization']='Bearer '+accessToken\r\n\r\n      socket.storage = io(HOST_SERVER?.STORAGE,{\r\n        extraHeaders\r\n      });\r\n\r\n      //if(!socket?.storage?.connected) socket?.storage?.disconnect()\r\n      socket?.storage?.on('connect',()=>{\r\n        if(ENV==='dev') console.log('Swyger Storage Client JS is connected with Swyger Server!!!')\r\n\r\n      })\r\n      if(!socket?.storage) socket?.storage?.disconnect()\r\n      socket?.storage?.on(\"disconnect\", (reason) => {\r\n        if(ENV==='dev') console.log('The device is disconnected from Storage server!')\r\n\r\n        //socket?.storage?.disconnect()\r\n        /*if (reason === \"io server disconnect\") {\r\n          // the disconnection was initiated by the server, you need to reconnect manually\r\n          io.connect();\r\n        }*/\r\n        // else the socket will automatically try to reconnect\r\n      });\r\n\r\n\r\n      return socket;\r\n    }catch (e) {\r\n\r\n    }\r\n\r\n  },\r\n};\r\nexport default SocketService\r\n","function e(e){this.message=e}e.prototype=new Error,e.prototype.name=\"InvalidCharacterError\";var r=\"undefined\"!=typeof window&&window.atob&&window.atob.bind(window)||function(r){var t=String(r).replace(/=+$/,\"\");if(t.length%4==1)throw new e(\"'atob' failed: The string to be decoded is not correctly encoded.\");for(var n,o,a=0,i=0,c=\"\";o=t.charAt(i++);~o&&(n=a%4?64*n+o:o,a++%4)?c+=String.fromCharCode(255&n>>(-2*a&6)):0)o=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(o);return c};function t(e){var t=e.replace(/-/g,\"+\").replace(/_/g,\"/\");switch(t.length%4){case 0:break;case 2:t+=\"==\";break;case 3:t+=\"=\";break;default:throw\"Illegal base64url string!\"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,r){var t=r.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t=\"0\"+t),\"%\"+t})))}(t)}catch(e){return r(t)}}function n(e){this.message=e}function o(e,r){if(\"string\"!=typeof e)throw new n(\"Invalid token specified\");var o=!0===(r=r||{}).header?0:1;try{return JSON.parse(t(e.split(\".\")[o]))}catch(e){throw new n(\"Invalid token specified: \"+e.message)}}n.prototype=new Error,n.prototype.name=\"InvalidTokenError\";export default o;export{n as InvalidTokenError};\n//# sourceMappingURL=jwt-decode.esm.js.map\n","'use strict';\n\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n","'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(Symbol.toStringTag in val) && !(Symbol.iterator in val);\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[Symbol.iterator];\n\n  const iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    if (reducer(descriptor, name, obj) !== false) {\n      reducedDescriptors[name] = descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  value = +value;\n  return Number.isFinite(value) ? value : defaultValue;\n}\n\nconst ALPHA = 'abcdefghijklmnopqrstuvwxyz'\n\nconst DIGIT = '0123456789';\n\nconst ALPHABET = {\n  DIGIT,\n  ALPHA,\n  ALPHA_DIGIT: ALPHA + ALPHA.toUpperCase() + DIGIT\n}\n\nconst generateString = (size = 16, alphabet = ALPHABET.ALPHA_DIGIT) => {\n  let str = '';\n  const {length} = alphabet;\n  while (size--) {\n    str += alphabet[Math.random() * length|0]\n  }\n\n  return str;\n}\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[Symbol.toStringTag] === 'FormData' && thing[Symbol.iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  ALPHABET,\n  generateString,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable\n};\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  response && (this.response = response);\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.response && this.response.status ? this.response.status : null\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  AxiosError.call(axiosError, error.message, code, config, request, response);\n\n  axiosError.cause = error;\n\n  axiosError.name = error.name;\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n","// eslint-disable-next-line strict\nexport default null;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n","'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?object} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {Boolean} `true` if the interceptor was removed, `false` otherwise\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n","'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n","'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n","'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n","'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n","import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst isStandardBrowserEnv = (() => {\n  let product;\n  if (typeof navigator !== 'undefined' && (\n    (product = navigator.product) === 'ReactNative' ||\n    product === 'NativeScript' ||\n    product === 'NS')\n  ) {\n    return false;\n  }\n\n  return typeof window !== 'undefined' && typeof document !== 'undefined';\n})();\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\n const isStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  isStandardBrowserEnv,\n  isStandardBrowserWebWorkerEnv,\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), Object.assign({\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    }\n  }, options));\n}\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\nconst DEFAULT_CONTENT_TYPE = {\n  'Content-Type': undefined\n};\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      if (!hasJSONContentType) {\n        return data;\n      }\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*'\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nexport default defaults;\n","'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\nutils.freezeMethods(AxiosHeaders.prototype);\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n","'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n","'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n","'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n","'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n","'use strict';\n\nimport utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.isStandardBrowserEnv ?\n\n// Standard browser envs support document.cookie\n  (function standardBrowserEnv() {\n    return {\n      write: function write(name, value, expires, path, domain, secure) {\n        const cookie = [];\n        cookie.push(name + '=' + encodeURIComponent(value));\n\n        if (utils.isNumber(expires)) {\n          cookie.push('expires=' + new Date(expires).toGMTString());\n        }\n\n        if (utils.isString(path)) {\n          cookie.push('path=' + path);\n        }\n\n        if (utils.isString(domain)) {\n          cookie.push('domain=' + domain);\n        }\n\n        if (secure === true) {\n          cookie.push('secure');\n        }\n\n        document.cookie = cookie.join('; ');\n      },\n\n      read: function read(name) {\n        const match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n        return (match ? decodeURIComponent(match[3]) : null);\n      },\n\n      remove: function remove(name) {\n        this.write(name, '', Date.now() - 86400000);\n      }\n    };\n  })() :\n\n// Non standard browser env (web workers, react-native) lack needed support.\n  (function nonStandardBrowserEnv() {\n    return {\n      write: function write() {},\n      read: function read() { return null; },\n      remove: function remove() {}\n    };\n  })();\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n","'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL) {\n  if (baseURL && !isAbsoluteURL(requestedURL)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n","'use strict';\n\nimport utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.isStandardBrowserEnv ?\n\n// Standard browser envs have full support of the APIs needed to test\n// whether the request URL is of the same origin as current location.\n  (function standardBrowserEnv() {\n    const msie = /(msie|trident)/i.test(navigator.userAgent);\n    const urlParsingNode = document.createElement('a');\n    let originURL;\n\n    /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n    function resolveURL(url) {\n      let href = url;\n\n      if (msie) {\n        // IE needs attribute set twice to normalize properties\n        urlParsingNode.setAttribute('href', href);\n        href = urlParsingNode.href;\n      }\n\n      urlParsingNode.setAttribute('href', href);\n\n      // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n      return {\n        href: urlParsingNode.href,\n        protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n        host: urlParsingNode.host,\n        search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n        hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n        hostname: urlParsingNode.hostname,\n        port: urlParsingNode.port,\n        pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n          urlParsingNode.pathname :\n          '/' + urlParsingNode.pathname\n      };\n    }\n\n    originURL = resolveURL(window.location.href);\n\n    /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n    return function isURLSameOrigin(requestURL) {\n      const parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n      return (parsed.protocol === originURL.protocol &&\n          parsed.host === originURL.host);\n    };\n  })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n  (function nonStandardBrowserEnv() {\n    return function isURLSameOrigin() {\n      return true;\n    };\n  })();\n","'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n","'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n","'use strict';\n\nimport utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport cookies from './../helpers/cookies.js';\nimport buildURL from './../helpers/buildURL.js';\nimport buildFullPath from '../core/buildFullPath.js';\nimport isURLSameOrigin from './../helpers/isURLSameOrigin.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport speedometer from '../helpers/speedometer.js';\n\nfunction progressEventReducer(listener, isDownloadStream) {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e\n    };\n\n    data[isDownloadStream ? 'download' : 'upload'] = true;\n\n    listener(data);\n  };\n}\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    let requestData = config.data;\n    const requestHeaders = AxiosHeaders.from(config.headers).normalize();\n    const responseType = config.responseType;\n    let onCanceled;\n    function done() {\n      if (config.cancelToken) {\n        config.cancelToken.unsubscribe(onCanceled);\n      }\n\n      if (config.signal) {\n        config.signal.removeEventListener('abort', onCanceled);\n      }\n    }\n\n    if (utils.isFormData(requestData)) {\n      if (platform.isStandardBrowserEnv || platform.isStandardBrowserWebWorkerEnv) {\n        requestHeaders.setContentType(false); // Let the browser set it\n      } else {\n        requestHeaders.setContentType('multipart/form-data;', false); // mobile/desktop app frameworks\n      }\n    }\n\n    let request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      const username = config.auth.username || '';\n      const password = config.auth.password ? unescape(encodeURIComponent(config.auth.password)) : '';\n      requestHeaders.set('Authorization', 'Basic ' + btoa(username + ':' + password));\n    }\n\n    const fullPath = buildFullPath(config.baseURL, config.url);\n\n    request.open(config.method.toUpperCase(), buildURL(fullPath, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = config.timeout ? 'timeout of ' + config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = config.transitional || transitionalDefaults;\n      if (config.timeoutErrorMessage) {\n        timeoutErrorMessage = config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (platform.isStandardBrowserEnv) {\n      // Add xsrf header\n      const xsrfValue = (config.withCredentials || isURLSameOrigin(fullPath))\n        && config.xsrfCookieName && cookies.read(config.xsrfCookieName);\n\n      if (xsrfValue) {\n        requestHeaders.set(config.xsrfHeaderName, xsrfValue);\n      }\n    }\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(config.withCredentials)) {\n      request.withCredentials = !!config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = config.responseType;\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', progressEventReducer(config.onDownloadProgress, true));\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', progressEventReducer(config.onUploadProgress));\n    }\n\n    if (config.cancelToken || config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      config.cancelToken && config.cancelToken.subscribe(onCanceled);\n      if (config.signal) {\n        config.signal.aborted ? onCanceled() : config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(fullPath);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n","import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter\n}\n\nutils.forEach(knownAdapters, (fn, value) => {\n  if(fn) {\n    try {\n      Object.defineProperty(fn, 'name', {value});\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', {value});\n  }\n});\n\nexport default {\n  getAdapter: (adapters) => {\n    adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n    const {length} = adapters;\n    let nameOrAdapter;\n    let adapter;\n\n    for (let i = 0; i < length; i++) {\n      nameOrAdapter = adapters[i];\n      if((adapter = utils.isString(nameOrAdapter) ? knownAdapters[nameOrAdapter.toLowerCase()] : nameOrAdapter)) {\n        break;\n      }\n    }\n\n    if (!adapter) {\n      if (adapter === false) {\n        throw new AxiosError(\n          `Adapter ${nameOrAdapter} is not supported by the environment`,\n          'ERR_NOT_SUPPORT'\n        );\n      }\n\n      throw new Error(\n        utils.hasOwnProp(knownAdapters, nameOrAdapter) ?\n          `Adapter '${nameOrAdapter}' is not available in the build` :\n          `Unknown adapter '${nameOrAdapter}'`\n      );\n    }\n\n    if (!utils.isFunction(adapter)) {\n      throw new TypeError('adapter is not a function');\n    }\n\n    return adapter;\n  },\n  adapters: knownAdapters\n}\n","'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? thing.toJSON() : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b) => mergeDeepProperties(headersToObject(a), headersToObject(b), true)\n  };\n\n  utils.forEach(Object.keys(Object.assign({}, config1, config2)), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n","export const VERSION = \"1.4.0\";","'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n","'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig;\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    let contextHeaders;\n\n    // Flatten headers\n    contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    contextHeaders && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift.apply(chain, requestInterceptorChain);\n      chain.push.apply(chain, responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    i = 0;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n","'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n","const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n","'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n","import axios from \"axios\";\r\nconst AxiosService={\r\n  init:({API_KEY})=>{\r\n    return async (method='post',path='/',data={},args={})=>{\r\n      const accessToken=localStorage.getItem('accessToken')\r\n      let headers={\r\n        'Accept':'application/json',\r\n        'Content-Type':'application/json', // 'Content-Type': 'multipart/form-data' for files\r\n        'Access-Control-Allow-Origin':'*',\r\n        'Access-Key':API_KEY,\r\n        'Access-Control-Allow-Methods':'POST, GET, OPTIONS, PUT, DELETE, HEAD,PATCH',\r\n        'Access-Control-Allow-Headers':'X-PINGOTHER, Origin, X-Requested-With, Content-Type, Accept',\r\n        'Access-Control-Max-Age':'1728000',\r\n      }\r\n      if(accessToken) headers['Authorization']='Bearer '+accessToken\r\n      const url=path\r\n\r\n      if(typeof data?.get=='function' && data?.get('file')){\r\n        //https://stackoverflow.com/questions/43013858/how-to-post-a-file-from-a-form-with-axios\r\n        headers['Content-Type']='multipart/form-data'\r\n      }\r\n      if(args?.headers){\r\n        headers=Object.assign(\r\n            ...headers,\r\n            ...args.headers\r\n        )\r\n        delete args.headers\r\n      }\r\n      const config=Object.assign(\r\n          {\r\n            mode:'cors',\r\n            method,\r\n            url,\r\n            data,\r\n            headers,\r\n          },\r\n          args\r\n      )\r\n\r\n      let resp={}\r\n      try {\r\n        const result  =await axios(config)\r\n        resp.data=result?.data?.data || result?.data\r\n        if(result?.error)\r\n          resp.error=result.error\r\n        if(!resp.data) resp.data={}\r\n      }catch (e) {\r\n        resp.error=e.response?.data?.error || e.response?.error\r\n        if(!resp.error) resp.error={}\r\n      }\r\n\r\n      return resp\r\n\r\n    }\r\n  }\r\n}\r\nexport default AxiosService\r\n\r\n\r\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","(function(undefined) {\n  var root = this;\n\n  // Weird IE shit, objects do not have hasOwn, but the prototype does...\n  var hasOwnProp = Object.prototype.hasOwnProperty;\n\n  var reverseDupArray = function (array) {\n    var result = new Array(array.length);\n    var index  = array.length;\n    var arrayMaxIndex = index - 1;\n\n    while (index--) {\n      result[arrayMaxIndex - index] = array[index];\n    }\n\n    return result;\n  };\n\n  var Dottie = function() {\n    var args = Array.prototype.slice.call(arguments);\n\n    if (args.length == 2) {\n      return Dottie.find.apply(this, args);\n    }\n    return Dottie.transform.apply(this, args);\n  };\n\n  // Legacy syntax, changed syntax to have get/set be similar in arg order\n  Dottie.find = function(path, object) {\n    return Dottie.get(object, path);\n  };\n\n  // Dottie memoization flag\n  Dottie.memoizePath = true;\n  var memoized = {};\n\n  // Traverse object according to path, return value if found - Return undefined if destination is unreachable\n  Dottie.get = function(object, path, defaultVal) {\n    if ((object === undefined) || (object === null) || (path === undefined) || (path === null)) {\n        return defaultVal;\n    }\n\n    var names;\n\n    if (typeof path === \"string\") {\n      if (Dottie.memoizePath) {\n        if (memoized[path]) {\n          names = memoized[path].slice(0);\n        } else {\n          names = path.split('.').reverse();\n          memoized[path] = names.slice(0);\n        }\n      } else {\n        names = path.split('.').reverse();\n      }\n    } else if (Array.isArray(path)) {\n      names = reverseDupArray(path);\n    }\n\n    while (names.length && (object = object[names.pop()]) !== undefined && object !== null);\n\n    // Handle cases where accessing a childprop of a null value\n    if (object === null && names.length) object = undefined;\n\n    return (object === undefined ? defaultVal : object);\n  };\n\n  Dottie.exists = function(object, path) {\n    return Dottie.get(object, path) !== undefined;\n  };\n\n  // Set nested value\n  Dottie.set = function(object, path, value, options) {\n    var pieces = Array.isArray(path) ? path : path.split('.'), current = object, piece, length = pieces.length;\n\n    if (typeof current !== 'object') {\n        throw new Error('Parent is not an object.');\n    }\n\n    for (var index = 0; index < length; index++) {\n      piece = pieces[index];\n\n      // Create namespace (object) where none exists.\n      // If `force === true`, bruteforce the path without throwing errors.\n      if (\n        !hasOwnProp.call(current, piece)\n        || current[piece] === undefined\n        || ((typeof current[piece] !== 'object' || current[piece] === null) && options && options.force === true)) {\n        current[piece] = {};\n      }\n\n      if (index == (length - 1)) {\n        // Set final value\n        current[piece] = value;\n      } else {\n        // We do not overwrite existing path pieces by default\n        if (typeof current[piece] !== 'object' || current[piece] === null) {\n          throw new Error('Target key \"' + piece + '\" is not suitable for a nested value. (It is in use as non-object. Set `force` to `true` to override.)');\n        }\n\n        // Traverse next in path\n        current = current[piece];\n      }\n    }\n\n    // Is there any case when this is relevant? It's also the last line in the above for-loop\n    current[piece] = value;\n  };\n\n  // Set default nested value\n  Dottie['default'] = function(object, path, value) {\n    if (Dottie.get(object, path) === undefined) {\n      Dottie.set(object, path, value);\n    }\n  };\n\n  // Transform unnested object with .-seperated keys into a nested object.\n  Dottie.transform = function Dottie$transformfunction(object, options) {\n    if (Array.isArray(object)) {\n      return object.map(function(o) {\n        return Dottie.transform(o, options);\n      });\n    }\n\n    options = options || {};\n    options.delimiter = options.delimiter || '.';\n\n    var pieces\n      , piecesLength\n      , piece\n      , current\n      , transformed = {}\n      , key\n      , keys = Object.keys(object)\n      , length = keys.length\n      , i;\n\n    for (i = 0; i < length; i++) {\n      key = keys[i];\n\n      if (key.indexOf(options.delimiter) !== -1) {\n        pieces = key.split(options.delimiter);\n        piecesLength = pieces.length;\n        current = transformed;\n\n        for (var index = 0; index < piecesLength; index++) {\n          piece = pieces[index];\n          if (index != (piecesLength - 1) && !current.hasOwnProperty(piece)) {\n            current[piece] = {};\n          }\n\n          if (index == (piecesLength - 1)) {\n            current[piece] = object[key];\n          }\n\n          current = current[piece];\n          if (current === null) {\n            break;\n          }\n        }\n      } else {\n        transformed[key] = object[key];\n      }\n    }\n\n    return transformed;\n  };\n\n  Dottie.flatten = function(object, seperator) {\n    if (typeof seperator === \"undefined\") seperator = '.';\n    var flattened = {}\n      , current\n      , nested;\n\n    for (var key in object) {\n      if (hasOwnProp.call(object, key)) {\n        current = object[key];\n        if (Object.prototype.toString.call(current) === \"[object Object]\") {\n          nested = Dottie.flatten(current, seperator);\n\n          for (var _key in nested) {\n            flattened[key+seperator+_key] = nested[_key];\n          }\n        } else {\n          flattened[key] = current;\n        }\n      }\n    }\n\n    return flattened;\n  };\n\n  Dottie.paths = function(object, prefixes) {\n    var paths = [];\n    var value;\n    var key;\n\n    prefixes = prefixes || [];\n\n    if (typeof object === 'object') {\n      for (key in object) {\n        value = object[key];\n\n        if (typeof value === 'object' && value !== null) {\n          paths = paths.concat(Dottie.paths(value, prefixes.concat([key])));\n        } else {\n          paths.push(prefixes.concat(key).join('.'));\n        }\n      }\n    } else {\n      throw new Error('Paths was called with non-object argument.');\n    }\n\n    return paths;\n  };\n\n  if (typeof module !== 'undefined' && module.exports) {\n    exports = module.exports = Dottie;\n  } else {\n    root['Dottie'] = Dottie;\n    root['Dot'] = Dottie; //BC\n\n    if (typeof define === \"function\") {\n      define([], function () { return Dottie; });\n    }\n  }\n})();\n","function runCallback(callback, data) {\n    try {\n        callback(data);\n    }\n    catch (err) {\n        console.error('Error in subscription callback', err);\n    }\n}\nconst _subscriptions = Symbol('subscriptions');\nconst _oneTimeEvents = Symbol('oneTimeEvents');\nexport class SimpleEventEmitter {\n    constructor() {\n        this[_subscriptions] = [];\n        this[_oneTimeEvents] = new Map();\n    }\n    on(event, callback) {\n        if (this[_oneTimeEvents].has(event)) {\n            return runCallback(callback, this[_oneTimeEvents].get(event));\n        }\n        this[_subscriptions].push({ event, callback, once: false });\n        return this;\n    }\n    off(event, callback) {\n        this[_subscriptions] = this[_subscriptions].filter(s => s.event !== event || (callback && s.callback !== callback));\n        return this;\n    }\n    once(event, callback) {\n        return new Promise(resolve => {\n            const ourCallback = (data) => {\n                resolve(data);\n                callback?.(data);\n            };\n            if (this[_oneTimeEvents].has(event)) {\n                runCallback(ourCallback, this[_oneTimeEvents].get(event));\n            }\n            else {\n                this[_subscriptions].push({ event, callback: ourCallback, once: true });\n            }\n        });\n    }\n    emit(event, data) {\n        if (this[_oneTimeEvents].has(event)) {\n            throw new Error(`Event \"${event}\" was supposed to be emitted only once`);\n        }\n        for (let i = 0; i < this[_subscriptions].length; i++) {\n            const s = this[_subscriptions][i];\n            if (s.event !== event) {\n                continue;\n            }\n            runCallback(s.callback, data);\n            if (s.once) {\n                this[_subscriptions].splice(i, 1);\n                i--;\n            }\n        }\n        return this;\n    }\n    emitOnce(event, data) {\n        if (this[_oneTimeEvents].has(event)) {\n            throw new Error(`Event \"${event}\" was supposed to be emitted only once`);\n        }\n        this.emit(event, data);\n        this[_oneTimeEvents].set(event, data); // Mark event as being emitted once for future subscribers\n        this.off(event); // Remove all listeners for this event, they won't fire again\n        return this;\n    }\n    pipe(event, eventEmitter) {\n        this.on(event, (data) => {\n            eventEmitter.emit(event, data);\n        });\n    }\n    pipeOnce(event, eventEmitter) {\n        this.once(event, (data) => {\n            eventEmitter.emitOnce(event, data);\n        });\n    }\n}\n//# sourceMappingURL=simple-event-emitter.js.map","function getPathKeys(path) {\n    path = path.replace(/\\[/g, '/[').replace(/^\\/+/, '').replace(/\\/+$/, ''); // Replace [ with /[, remove leading slashes, remove trailing slashes\n    if (path.length === 0) {\n        return [];\n    }\n    const keys = path.split('/');\n    return keys.map(key => {\n        return key.startsWith('[') ? parseInt(key.slice(1, -1)) : key;\n    });\n}\nexport class PathInfo {\n    static get(path) {\n        return new PathInfo(path);\n    }\n    static getChildPath(path, childKey) {\n        // return getChildPath(path, childKey);\n        return PathInfo.get(path).child(childKey).path;\n    }\n    static getPathKeys(path) {\n        return getPathKeys(path);\n    }\n    constructor(path) {\n        if (typeof path === 'string') {\n            this.keys = getPathKeys(path);\n        }\n        else if (path instanceof Array) {\n            this.keys = path;\n        }\n        this.path = this.keys.reduce((path, key, i) => i === 0 ? `${key}` : typeof key === 'string' ? `${path}/${key}` : `${path}[${key}]`, '');\n    }\n    get key() {\n        return this.keys.length === 0 ? null : this.keys.slice(-1)[0];\n    }\n    get parent() {\n        if (this.keys.length == 0) {\n            return null;\n        }\n        const parentKeys = this.keys.slice(0, -1);\n        return new PathInfo(parentKeys);\n    }\n    get parentPath() {\n        return this.keys.length === 0 ? null : this.parent.path;\n    }\n    child(childKey) {\n        if (typeof childKey === 'string') {\n            if (childKey.length === 0) {\n                throw new Error(`child key for path \"${this.path}\" cannot be empty`);\n            }\n            // Allow expansion of a child path (eg \"user/name\") into equivalent `child('user').child('name')`\n            const keys = getPathKeys(childKey);\n            keys.forEach(key => {\n                // Check AceBase key rules here so they will be enforced regardless of storage target.\n                // This prevents specific keys to be allowed in one environment (eg browser), but then\n                // refused upon syncing to a binary AceBase db. Fixes https://github.com/appy-one/acebase/issues/172\n                if (typeof key !== 'string') {\n                    return;\n                }\n                if (/[\\x00-\\x08\\x0b\\x0c\\x0e-\\x1f/[\\]\\\\]/.test(key)) {\n                    throw new Error(`Invalid child key \"${key}\" for path \"${this.path}\". Keys cannot contain control characters or any of the following characters: \\\\ / [ ]`);\n                }\n                if (key.length > 128) {\n                    throw new Error(`child key \"${key}\" for path \"${this.path}\" is too long. Max key length is 128`);\n                }\n                if (key.length === 0) {\n                    throw new Error(`child key for path \"${this.path}\" cannot be empty`);\n                }\n            });\n            childKey = keys;\n        }\n        return new PathInfo(this.keys.concat(childKey));\n    }\n    childPath(childKey) {\n        return this.child(childKey).path;\n    }\n    get pathKeys() {\n        return this.keys;\n    }\n    /**\n     * If varPath contains variables or wildcards, it will return them with the values found in fullPath\n     * @param {string} varPath path containing variables such as * and $name\n     * @param {string} fullPath real path to a node\n     * @returns {{ [index: number]: string|number, [variable: string]: string|number }} returns an array-like object with all variable values. All named variables are also set on the array by their name (eg vars.uid and vars.$uid)\n     * @example\n     * PathInfo.extractVariables('users/$uid/posts/$postid', 'users/ewout/posts/post1/title') === {\n     *  0: 'ewout',\n     *  1: 'post1',\n     *  uid: 'ewout', // or $uid\n     *  postid: 'post1' // or $postid\n     * };\n     *\n     * PathInfo.extractVariables('users/*\\/posts/*\\/$property', 'users/ewout/posts/post1/title') === {\n     *  0: 'ewout',\n     *  1: 'post1',\n     *  2: 'title',\n     *  property: 'title' // or $property\n     * };\n     *\n     * PathInfo.extractVariables('users/$user/friends[*]/$friend', 'users/dora/friends[4]/diego') === {\n     *  0: 'dora',\n     *  1: 4,\n     *  2: 'diego',\n     *  user: 'dora', // or $user\n     *  friend: 'diego' // or $friend\n     * };\n    */\n    static extractVariables(varPath, fullPath) {\n        if (!varPath.includes('*') && !varPath.includes('$')) {\n            return [];\n        }\n        // if (!this.equals(fullPath)) {\n        //     throw new Error(`path does not match with the path of this PathInfo instance: info.equals(path) === false!`)\n        // }\n        const keys = getPathKeys(varPath);\n        const pathKeys = getPathKeys(fullPath);\n        let count = 0;\n        const variables = {\n            get length() { return count; },\n        };\n        keys.forEach((key, index) => {\n            const pathKey = pathKeys[index];\n            if (key === '*') {\n                variables[count++] = pathKey;\n            }\n            else if (typeof key === 'string' && key[0] === '$') {\n                variables[count++] = pathKey;\n                // Set the $variable property\n                variables[key] = pathKey;\n                // Set friendly property name (without $)\n                const varName = key.slice(1);\n                if (typeof variables[varName] === 'undefined') {\n                    variables[varName] = pathKey;\n                }\n            }\n        });\n        return variables;\n    }\n    /**\n     * If varPath contains variables or wildcards, it will return a path with the variables replaced by the keys found in fullPath.\n     * @example\n     * PathInfo.fillVariables('users/$uid/posts/$postid', 'users/ewout/posts/post1/title') === 'users/ewout/posts/post1'\n     */\n    static fillVariables(varPath, fullPath) {\n        if (varPath.indexOf('*') < 0 && varPath.indexOf('$') < 0) {\n            return varPath;\n        }\n        const keys = getPathKeys(varPath);\n        const pathKeys = getPathKeys(fullPath);\n        const merged = keys.map((key, index) => {\n            if (key === pathKeys[index] || index >= pathKeys.length) {\n                return key;\n            }\n            else if (typeof key === 'string' && (key === '*' || key[0] === '$')) {\n                return pathKeys[index];\n            }\n            else {\n                throw new Error(`Path \"${fullPath}\" cannot be used to fill variables of path \"${varPath}\" because they do not match`);\n            }\n        });\n        let mergedPath = '';\n        merged.forEach(key => {\n            if (typeof key === 'number') {\n                mergedPath += `[${key}]`;\n            }\n            else {\n                if (mergedPath.length > 0) {\n                    mergedPath += '/';\n                }\n                mergedPath += key;\n            }\n        });\n        return mergedPath;\n    }\n    /**\n     * Replaces all variables in a path with the values in the vars argument\n     * @param varPath path containing variables\n     * @param vars variables object such as one gotten from PathInfo.extractVariables\n     */\n    static fillVariables2(varPath, vars) {\n        if (typeof vars !== 'object' || Object.keys(vars).length === 0) {\n            return varPath; // Nothing to fill\n        }\n        const pathKeys = getPathKeys(varPath);\n        let n = 0;\n        const targetPath = pathKeys.reduce((path, key) => {\n            if (typeof key === 'string' && (key === '*' || key.startsWith('$'))) {\n                return PathInfo.getChildPath(path, vars[n++]);\n            }\n            else {\n                return PathInfo.getChildPath(path, key);\n            }\n        }, '');\n        return targetPath;\n    }\n    /**\n     * Checks if a given path matches this path, eg \"posts/*\\/title\" matches \"posts/12344/title\" and \"users/123/name\" matches \"users/$uid/name\"\n     */\n    equals(otherPath) {\n        const other = otherPath instanceof PathInfo ? otherPath : new PathInfo(otherPath);\n        if (this.path === other.path) {\n            return true;\n        } // they are identical\n        if (this.keys.length !== other.keys.length) {\n            return false;\n        }\n        return this.keys.every((key, index) => {\n            const otherKey = other.keys[index];\n            return otherKey === key\n                || (typeof otherKey === 'string' && (otherKey === '*' || otherKey[0] === '$'))\n                || (typeof key === 'string' && (key === '*' || key[0] === '$'));\n        });\n    }\n    /**\n     * Checks if a given path is an ancestor, eg \"posts\" is an ancestor of \"posts/12344/title\"\n     */\n    isAncestorOf(descendantPath) {\n        const descendant = descendantPath instanceof PathInfo ? descendantPath : new PathInfo(descendantPath);\n        if (descendant.path === '' || this.path === descendant.path) {\n            return false;\n        }\n        if (this.path === '') {\n            return true;\n        }\n        if (this.keys.length >= descendant.keys.length) {\n            return false;\n        }\n        return this.keys.every((key, index) => {\n            const otherKey = descendant.keys[index];\n            return otherKey === key\n                || (typeof otherKey === 'string' && (otherKey === '*' || otherKey[0] === '$'))\n                || (typeof key === 'string' && (key === '*' || key[0] === '$'));\n        });\n    }\n    /**\n     * Checks if a given path is a descendant, eg \"posts/1234/title\" is a descendant of \"posts\"\n     */\n    isDescendantOf(ancestorPath) {\n        const ancestor = ancestorPath instanceof PathInfo ? ancestorPath : new PathInfo(ancestorPath);\n        if (this.path === '' || this.path === ancestor.path) {\n            return false;\n        }\n        if (ancestorPath === '') {\n            return true;\n        }\n        if (ancestor.keys.length >= this.keys.length) {\n            return false;\n        }\n        return ancestor.keys.every((key, index) => {\n            const otherKey = this.keys[index];\n            return otherKey === key\n                || (typeof otherKey === 'string' && (otherKey === '*' || otherKey[0] === '$'))\n                || (typeof key === 'string' && (key === '*' || key[0] === '$'));\n        });\n    }\n    /**\n     * Checks if the other path is on the same trail as this path. Paths on the same trail if they share a\n     * common ancestor. Eg: \"posts\" is on the trail of \"posts/1234/title\" and vice versa.\n     */\n    isOnTrailOf(otherPath) {\n        const other = otherPath instanceof PathInfo ? otherPath : new PathInfo(otherPath);\n        if (this.path.length === 0 || other.path.length === 0) {\n            return true;\n        }\n        if (this.path === other.path) {\n            return true;\n        }\n        return this.pathKeys.every((key, index) => {\n            if (index >= other.keys.length) {\n                return true;\n            }\n            const otherKey = other.keys[index];\n            return otherKey === key\n                || (typeof otherKey === 'string' && (otherKey === '*' || otherKey[0] === '$'))\n                || (typeof key === 'string' && (key === '*' || key[0] === '$'));\n        });\n    }\n    /**\n     * Checks if a given path is a direct child, eg \"posts/1234/title\" is a child of \"posts/1234\"\n     */\n    isChildOf(otherPath) {\n        const other = otherPath instanceof PathInfo ? otherPath : new PathInfo(otherPath);\n        if (this.path === '') {\n            return false;\n        } // If our path is the root, it's nobody's child...\n        return this.parent.equals(other);\n    }\n    /**\n     * Checks if a given path is its parent, eg \"posts/1234\" is the parent of \"posts/1234/title\"\n     */\n    isParentOf(otherPath) {\n        const other = otherPath instanceof PathInfo ? otherPath : new PathInfo(otherPath);\n        if (other.path === '') {\n            return false;\n        } // If the other path is the root, this path cannot be its parent\n        return this.equals(other.parent);\n    }\n}\n//# sourceMappingURL=path-info.js.map","import { PathInfo } from './path-info.js';\nfunction getChild(snapshot, path, previous = false) {\n    if (!snapshot.exists()) {\n        return null;\n    }\n    let child = previous ? snapshot.previous() : snapshot.val();\n    if (typeof path === 'number') {\n        return child[path];\n    }\n    PathInfo.getPathKeys(path).every(key => {\n        child = child[key];\n        return typeof child !== 'undefined';\n    });\n    return child || null;\n}\nfunction getChildren(snapshot) {\n    if (!snapshot.exists()) {\n        return [];\n    }\n    const value = snapshot.val();\n    if (value instanceof Array) {\n        return new Array(value.length).map((v, i) => i);\n    }\n    if (typeof value === 'object') {\n        return Object.keys(value);\n    }\n    return [];\n}\nexport class DataSnapshot {\n    /**\n     * Indicates whether the node exists in the database\n     */\n    exists() { return false; }\n    /**\n     * Creates a new DataSnapshot instance\n     */\n    constructor(ref, value, isRemoved = false, prevValue, context) {\n        this.ref = ref;\n        this.val = () => { return value; };\n        this.previous = () => { return prevValue; };\n        this.exists = () => {\n            if (isRemoved) {\n                return false;\n            }\n            return value !== null && typeof value !== 'undefined';\n        };\n        this.context = () => { return context || {}; };\n    }\n    /**\n     * Creates a `DataSnapshot` instance\n     * @internal (for internal use)\n     */\n    static for(ref, value) {\n        return new DataSnapshot(ref, value);\n    }\n    child(path) {\n        // Create new snapshot for child data\n        const val = getChild(this, path, false);\n        const prev = getChild(this, path, true);\n        return new DataSnapshot(this.ref.child(path), val, false, prev);\n    }\n    /**\n     * Checks if the snapshot's value has a child with the given key or path\n     * @param path child key or path\n     */\n    hasChild(path) {\n        return getChild(this, path) !== null;\n    }\n    /**\n     * Indicates whether the the snapshot's value has any child nodes\n     */\n    hasChildren() {\n        return getChildren(this).length > 0;\n    }\n    /**\n     * The number of child nodes in this snapshot\n     */\n    numChildren() {\n        return getChildren(this).length;\n    }\n    /**\n     * Runs a callback function for each child node in this snapshot until the callback returns false\n     * @param callback function that is called with a snapshot of each child node in this snapshot.\n     * Must return a boolean value that indicates whether to continue iterating or not.\n     */\n    forEach(callback) {\n        const value = this.val();\n        const prev = this.previous();\n        return getChildren(this).every((key) => {\n            const snap = new DataSnapshot(this.ref.child(key), value[key], false, prev[key]);\n            return callback(snap);\n        });\n    }\n    /**\n     * The key of the node's path\n     */\n    get key() { return this.ref.key; }\n}\nexport class MutationsDataSnapshot extends DataSnapshot {\n    constructor(ref, mutations, context) {\n        super(ref, mutations, false, undefined, context);\n        /**\n         * Don't use this to get previous values of mutated nodes.\n         * Use `.previous` properties on the individual child snapshots instead.\n         * @throws Throws an error if you do use it.\n         */\n        this.previous = () => { throw new Error('Iterate values to get previous values for each mutation'); };\n        this.val = (warn = true) => {\n            if (warn) {\n                console.warn('Unless you know what you are doing, it is best not to use the value of a mutations snapshot directly. Use child methods and forEach to iterate the mutations instead');\n            }\n            return mutations;\n        };\n    }\n    /**\n     * Runs a callback function for each mutation in this snapshot until the callback returns false\n     * @param callback function that is called with a snapshot of each mutation in this snapshot. Must return a boolean value that indicates whether to continue iterating or not.\n     * @returns Returns whether every child was interated\n     */\n    forEach(callback) {\n        const mutations = this.val(false);\n        return mutations.every(mutation => {\n            const ref = mutation.target.reduce((ref, key) => ref.child(key), this.ref);\n            const snap = new DataSnapshot(ref, mutation.val, false, mutation.prev);\n            return callback(snap);\n        });\n    }\n    child(index) {\n        if (typeof index !== 'number') {\n            throw new Error('child index must be a number');\n        }\n        const mutation = this.val(false)[index];\n        const ref = mutation.target.reduce((ref, key) => ref.child(key), this.ref);\n        return new DataSnapshot(ref, mutation.val, false, mutation.prev);\n    }\n}\n//# sourceMappingURL=data-snapshot.js.map","export class EventSubscription {\n    /**\n     * @param stop function that stops the subscription from receiving future events\n     */\n    constructor(stop) {\n        this.stop = stop;\n        this._internal = {\n            state: 'init',\n            activatePromises: [],\n        };\n    }\n    /**\n     * Notifies when subscription is activated or canceled\n     * @param callback optional callback to run each time activation state changes\n     * @returns returns a promise that resolves once activated, or rejects when it is denied (and no callback was supplied)\n     */\n    activated(callback) {\n        if (callback) {\n            this._internal.activatePromises.push({ callback });\n            if (this._internal.state === 'active') {\n                callback(true);\n            }\n            else if (this._internal.state === 'canceled') {\n                callback(false, this._internal.cancelReason);\n            }\n        }\n        // Changed behaviour: now also returns a Promise when the callback is used.\n        // This allows for 1 activated call to both handle: first activation result,\n        // and any future events using the callback\n        return new Promise((resolve, reject) => {\n            if (this._internal.state === 'active') {\n                return resolve();\n            }\n            else if (this._internal.state === 'canceled' && !callback) {\n                return reject(new Error(this._internal.cancelReason));\n            }\n            // eslint-disable-next-line @typescript-eslint/no-empty-function\n            const noop = () => { };\n            this._internal.activatePromises.push({\n                resolve,\n                reject: callback ? noop : reject, // Don't reject when callback is used: let callback handle this (prevents UnhandledPromiseRejection if only callback is used)\n            });\n        });\n    }\n    /** (for internal use) */\n    _setActivationState(activated, cancelReason) {\n        this._internal.cancelReason = cancelReason;\n        this._internal.state = activated ? 'active' : 'canceled';\n        while (this._internal.activatePromises.length > 0) {\n            const p = this._internal.activatePromises.shift();\n            if (activated) {\n                p.callback && p.callback(true);\n                p.resolve && p.resolve();\n            }\n            else {\n                p.callback && p.callback(false, cancelReason);\n                p.reject && p.reject(cancelReason);\n            }\n        }\n    }\n}\nexport class EventPublisher {\n    /**\n     *\n     * @param publish function that publishes a new value to subscribers, return if there are any active subscribers\n     * @param start function that notifies subscribers their subscription is activated\n     * @param cancel function that notifies subscribers their subscription has been canceled, removes all subscriptions\n     */\n    constructor(publish, start, cancel) {\n        this.publish = publish;\n        this.start = start;\n        this.cancel = cancel;\n    }\n}\nexport class EventStream {\n    constructor(eventPublisherCallback) {\n        const subscribers = [];\n        let noMoreSubscribersCallback;\n        let activationState; // TODO: refactor to string only: STATE_INIT, STATE_STOPPED, STATE_ACTIVATED, STATE_CANCELED\n        const STATE_STOPPED = 'stopped (no more subscribers)';\n        this.subscribe = (callback, activationCallback) => {\n            if (typeof callback !== 'function') {\n                throw new TypeError('callback must be a function');\n            }\n            else if (activationState === STATE_STOPPED) {\n                throw new Error('stream can\\'t be used anymore because all subscribers were stopped');\n            }\n            const sub = {\n                callback,\n                activationCallback: function (activated, cancelReason) {\n                    activationCallback?.(activated, cancelReason);\n                    this.subscription._setActivationState(activated, cancelReason);\n                },\n                subscription: new EventSubscription(function stop() {\n                    subscribers.splice(subscribers.indexOf(this), 1);\n                    return checkActiveSubscribers();\n                }),\n            };\n            subscribers.push(sub);\n            if (typeof activationState !== 'undefined') {\n                if (activationState === true) {\n                    activationCallback?.(true);\n                    sub.subscription._setActivationState(true);\n                }\n                else if (typeof activationState === 'string') {\n                    activationCallback?.(false, activationState);\n                    sub.subscription._setActivationState(false, activationState);\n                }\n            }\n            return sub.subscription;\n        };\n        const checkActiveSubscribers = () => {\n            let ret;\n            if (subscribers.length === 0) {\n                ret = noMoreSubscribersCallback?.();\n                activationState = STATE_STOPPED;\n            }\n            return Promise.resolve(ret);\n        };\n        this.unsubscribe = (callback) => {\n            const remove = callback\n                ? subscribers.filter(sub => sub.callback === callback)\n                : subscribers;\n            remove.forEach(sub => {\n                const i = subscribers.indexOf(sub);\n                subscribers.splice(i, 1);\n            });\n            checkActiveSubscribers();\n        };\n        this.stop = () => {\n            // Stop (remove) all subscriptions\n            subscribers.splice(0);\n            checkActiveSubscribers();\n        };\n        /**\n         * For publishing side: adds a value that will trigger callbacks to all subscribers\n         * @param val\n         * @returns returns whether there are subscribers left\n         */\n        const publish = (val) => {\n            subscribers.forEach(sub => {\n                try {\n                    sub.callback(val);\n                }\n                catch (err) {\n                    console.error(`Error running subscriber callback: ${err.message}`);\n                }\n            });\n            if (subscribers.length === 0) {\n                checkActiveSubscribers();\n            }\n            return subscribers.length > 0;\n        };\n        /**\n         * For publishing side: let subscribers know their subscription is activated. Should be called only once\n         */\n        const start = (allSubscriptionsStoppedCallback) => {\n            activationState = true;\n            noMoreSubscribersCallback = allSubscriptionsStoppedCallback;\n            subscribers.forEach(sub => {\n                sub.activationCallback?.(true);\n            });\n        };\n        /**\n         * For publishing side: let subscribers know their subscription has been canceled. Should be called only once\n         */\n        const cancel = (reason) => {\n            activationState = reason;\n            subscribers.forEach(sub => {\n                sub.activationCallback?.(false, reason || new Error('unknown reason'));\n            });\n            subscribers.splice(0); // Clear all\n        };\n        const publisher = new EventPublisher(publish, start, cancel);\n        eventPublisherCallback(publisher);\n    }\n}\n//# sourceMappingURL=subscription.js.map","export default function pad(num, size) {\n    const s = '000000000' + num;\n    return s.substr(s.length - size);\n}\n//# sourceMappingURL=pad.js.map","import pad from '../pad.js';\nconst env = typeof window === 'object' ? window : self, globalCount = Object.keys(env).length, mimeTypesLength = navigator.mimeTypes?.length ?? 0, clientId = pad((mimeTypesLength\n    + navigator.userAgent.length).toString(36)\n    + globalCount.toString(36), 4);\nexport default function fingerprint() {\n    return clientId;\n}\n//# sourceMappingURL=browser.js.map","/**\n * cuid.js\n * Collision-resistant UID generator for browsers and node.\n * Sequential for fast db lookups and recency sorting.\n * Safe for element IDs and server-side lookups.\n *\n * Extracted from CLCTR\n *\n * Copyright (c) Eric Elliott 2012\n * MIT License\n *\n * time biasing added by Ewout Stortenbeker for AceBase\n */\nimport fingerprint from './fingerprint/index.js';\nimport pad from './pad.js';\nlet c = 0;\nconst blockSize = 4, base = 36, discreteValues = Math.pow(base, blockSize);\nfunction randomBlock() {\n    return pad((Math.random() * discreteValues << 0).toString(base), blockSize);\n}\nfunction safeCounter() {\n    c = c < discreteValues ? c : 0;\n    c++; // this is not subliminal\n    return c - 1;\n}\nexport default function cuid(timebias = 0) {\n    // Starting with a lowercase letter makes\n    // it HTML element ID friendly.\n    const letter = 'c', // hard-coded allows for sequential access\n    // timestamp\n    // warning: this exposes the exact date and time\n    // that the uid was created.\n    // NOTES Ewout:\n    // - added timebias\n    // - at '2059/05/25 19:38:27.456', timestamp will become 1 character larger!\n    timestamp = (new Date().getTime() + timebias).toString(base), \n    // Prevent same-machine collisions.\n    counter = pad(safeCounter().toString(base), blockSize), \n    // A few chars to generate distinct ids for different\n    // clients (so different computers are far less\n    // likely to generate the same id)\n    print = fingerprint(), \n    // Grab some more chars from Math.random()\n    random = randomBlock() + randomBlock();\n    return letter + timestamp + counter + print + random;\n}\n// Not using slugs, removed code\n//# sourceMappingURL=index.js.map","import cuid from './cuid/index.js';\n// const uuid62 = require('uuid62');\nlet timeBias = 0;\nexport class ID {\n    /**\n     * (for internal use)\n     * bias in milliseconds to adjust generated cuid timestamps with\n     */\n    static set timeBias(bias) {\n        if (typeof bias !== 'number') {\n            return;\n        }\n        timeBias = bias;\n    }\n    static generate() {\n        // Could also use https://www.npmjs.com/package/pushid for Firebase style 20 char id's\n        return cuid(timeBias).slice(1); // Cuts off the always leading 'c'\n        // return uuid62.v1();\n    }\n}\n//# sourceMappingURL=id.js.map","export class PathReference {\n    /**\n     * Creates a reference to a path that can be stored in the database. Use this to create cross-references to other data in your database\n     * @param path\n     */\n    constructor(path) {\n        this.path = path;\n    }\n}\n//# sourceMappingURL=path-reference.js.map","export default {\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    nextTick(fn) {\n        setTimeout(fn, 0);\n    },\n};\n//# sourceMappingURL=browser.js.map","/**\n * Sparse/partial array converted to a serializable object. Use `Object.keys(sparseArray)` and `Object.values(sparseArray)` to iterate its indice and/or values\n */\nexport class PartialArray {\n    constructor(sparseArray) {\n        if (sparseArray instanceof Array) {\n            for (let i = 0; i < sparseArray.length; i++) {\n                if (typeof sparseArray[i] !== 'undefined') {\n                    this[i] = sparseArray[i];\n                }\n            }\n        }\n        else if (sparseArray) {\n            Object.assign(this, sparseArray);\n        }\n    }\n}\n//# sourceMappingURL=partial-array.js.map","import { PathReference } from './path-reference.js';\nimport process from './process/index.js';\nimport { PartialArray } from './partial-array.js';\nexport function numberToBytes(number) {\n    const bytes = new Uint8Array(8);\n    const view = new DataView(bytes.buffer);\n    view.setFloat64(0, number);\n    return new Array(...bytes);\n}\nexport function bytesToNumber(bytes) {\n    const length = Array.isArray(bytes) ? bytes.length : bytes.byteLength;\n    if (length !== 8) {\n        throw new TypeError('must be 8 bytes');\n    }\n    const bin = new Uint8Array(bytes);\n    const view = new DataView(bin.buffer);\n    const nr = view.getFloat64(0);\n    return nr;\n}\nconst big = {\n    zero: BigInt(0),\n    one: BigInt(1),\n    two: BigInt(2),\n    eight: BigInt(8),\n    ff: BigInt(0xff),\n};\nexport function bigintToBytes(number) {\n    if (typeof number !== 'bigint') {\n        throw new Error('number must be a bigint');\n    }\n    const bytes = [];\n    const negative = number < big.zero;\n    do {\n        const byte = Number(number & big.ff); // NOTE: bits are inverted on negative numbers\n        bytes.push(byte);\n        number = number >> big.eight;\n    } while (number !== (negative ? -big.one : big.zero));\n    bytes.reverse(); // little-endian\n    if (negative ? bytes[0] < 128 : bytes[0] >= 128) {\n        bytes.unshift(negative ? 255 : 0); // extra sign byte needed\n    }\n    return bytes;\n}\nexport function bytesToBigint(bytes) {\n    const negative = bytes[0] >= 128;\n    let number = big.zero;\n    for (let b of bytes) {\n        if (negative) {\n            b = ~b & 0xff;\n        } // Invert the bits\n        number = (number << big.eight) + BigInt(b);\n    }\n    if (negative) {\n        number = -(number + big.one);\n    }\n    return number;\n}\n/**\n * Converts a string to a utf-8 encoded Uint8Array\n */\nexport function encodeString(str) {\n    if (typeof TextEncoder !== 'undefined') {\n        // Modern browsers, Node.js v11.0.0+ (or v8.3.0+ with util.TextEncoder)\n        const encoder = new TextEncoder();\n        return encoder.encode(str);\n    }\n    else if (typeof Buffer === 'function') {\n        // Node.js\n        const buf = Buffer.from(str, 'utf-8');\n        return new Uint8Array(buf.buffer, buf.byteOffset, buf.byteLength);\n    }\n    else {\n        // Older browsers. Manually encode\n        const arr = [];\n        for (let i = 0; i < str.length; i++) {\n            let code = str.charCodeAt(i);\n            if (code > 128) {\n                // Attempt simple UTF-8 conversion. See https://en.wikipedia.org/wiki/UTF-8\n                if ((code & 0xd800) === 0xd800) {\n                    // code starts with 1101 10...: this is a 2-part utf-16 char code\n                    const nextCode = str.charCodeAt(i + 1);\n                    if ((nextCode & 0xdc00) !== 0xdc00) {\n                        // next code must start with 1101 11...\n                        throw new Error('follow-up utf-16 character does not start with 0xDC00');\n                    }\n                    i++;\n                    const p1 = code & 0x3ff; // Only use last 10 bits\n                    const p2 = nextCode & 0x3ff;\n                    // Create code point from these 2: (see https://en.wikipedia.org/wiki/UTF-16)\n                    code = 0x10000 | (p1 << 10) | p2;\n                }\n                if (code < 2048) {\n                    // Use 2 bytes for 11 bit value, first byte starts with 110xxxxx (0xc0), 2nd byte with 10xxxxxx (0x80)\n                    const b1 = 0xc0 | ((code >> 6) & 0x1f); // 0xc0 = 11000000, 0x1f = 11111\n                    const b2 = 0x80 | (code & 0x3f); // 0x80 = 10000000, 0x3f = 111111\n                    arr.push(b1, b2);\n                }\n                else if (code < 65536) {\n                    // Use 3 bytes for 16-bit value, bits per byte: 4, 6, 6\n                    const b1 = 0xe0 | ((code >> 12) & 0xf); // 0xe0 = 11100000, 0xf = 1111\n                    const b2 = 0x80 | ((code >> 6) & 0x3f); // 0x80 = 10000000, 0x3f = 111111\n                    const b3 = 0x80 | (code & 0x3f);\n                    arr.push(b1, b2, b3);\n                }\n                else if (code < 2097152) {\n                    // Use 4 bytes for 21-bit value, bits per byte: 3, 6, 6, 6\n                    const b1 = 0xf0 | ((code >> 18) & 0x7); // 0xf0 = 11110000, 0x7 = 111\n                    const b2 = 0x80 | ((code >> 12) & 0x3f); // 0x80 = 10000000, 0x3f = 111111\n                    const b3 = 0x80 | ((code >> 6) & 0x3f); // 0x80 = 10000000, 0x3f = 111111\n                    const b4 = 0x80 | (code & 0x3f);\n                    arr.push(b1, b2, b3, b4);\n                }\n                else {\n                    throw new Error(`Cannot convert character ${str.charAt(i)} (code ${code}) to utf-8`);\n                }\n            }\n            else {\n                arr.push(code < 128 ? code : 63); // 63 = ?\n            }\n        }\n        return new Uint8Array(arr);\n    }\n}\n/**\n * Converts a utf-8 encoded buffer to string\n */\nexport function decodeString(buffer) {\n    if (typeof TextDecoder !== 'undefined') {\n        // Modern browsers, Node.js v11.0.0+ (or v8.3.0+ with util.TextDecoder)\n        const decoder = new TextDecoder();\n        if (buffer instanceof Uint8Array) {\n            return decoder.decode(buffer);\n        }\n        const buf = Uint8Array.from(buffer);\n        return decoder.decode(buf);\n    }\n    else if (typeof Buffer === 'function') {\n        // Node.js (v10 and below)\n        if (buffer instanceof Array) {\n            buffer = Uint8Array.from(buffer); // convert to typed array\n        }\n        if (!(buffer instanceof Buffer) && 'buffer' in buffer && buffer.buffer instanceof ArrayBuffer) {\n            const typedArray = buffer;\n            buffer = Buffer.from(typedArray.buffer, typedArray.byteOffset, typedArray.byteLength); // Convert typed array to node.js Buffer\n        }\n        if (!(buffer instanceof Buffer)) {\n            throw new Error('Unsupported buffer argument');\n        }\n        return buffer.toString('utf-8');\n    }\n    else {\n        // Older browsers. Manually decode!\n        if (!(buffer instanceof Uint8Array) && 'buffer' in buffer && buffer['buffer'] instanceof ArrayBuffer) {\n            // Convert TypedArray to Uint8Array\n            const typedArray = buffer;\n            buffer = new Uint8Array(typedArray.buffer, typedArray.byteOffset, typedArray.byteLength);\n        }\n        if (buffer instanceof Buffer || buffer instanceof Array || buffer instanceof Uint8Array) {\n            let str = '';\n            for (let i = 0; i < buffer.length; i++) {\n                let code = buffer[i];\n                if (code > 128) {\n                    // Decode Unicode character\n                    if ((code & 0xf0) === 0xf0) {\n                        // 4 byte char\n                        const b1 = code, b2 = buffer[i + 1], b3 = buffer[i + 2], b4 = buffer[i + 3];\n                        code = ((b1 & 0x7) << 18) | ((b2 & 0x3f) << 12) | ((b3 & 0x3f) << 6) | (b4 & 0x3f);\n                        i += 3;\n                    }\n                    else if ((code & 0xe0) === 0xe0) {\n                        // 3 byte char\n                        const b1 = code, b2 = buffer[i + 1], b3 = buffer[i + 2];\n                        code = ((b1 & 0xf) << 12) | ((b2 & 0x3f) << 6) | (b3 & 0x3f);\n                        i += 2;\n                    }\n                    else if ((code & 0xc0) === 0xc0) {\n                        // 2 byte char\n                        const b1 = code, b2 = buffer[i + 1];\n                        code = ((b1 & 0x1f) << 6) | (b2 & 0x3f);\n                        i++;\n                    }\n                    else {\n                        throw new Error('invalid utf-8 data');\n                    }\n                }\n                if (code >= 65536) {\n                    // Split into 2-part utf-16 char codes\n                    code ^= 0x10000;\n                    const p1 = 0xd800 | (code >> 10);\n                    const p2 = 0xdc00 | (code & 0x3ff);\n                    str += String.fromCharCode(p1);\n                    str += String.fromCharCode(p2);\n                }\n                else {\n                    str += String.fromCharCode(code);\n                }\n            }\n            return str;\n        }\n        else {\n            throw new Error('Unsupported buffer argument');\n        }\n    }\n}\nexport function concatTypedArrays(a, b) {\n    const c = new a.constructor(a.length + b.length);\n    c.set(a);\n    c.set(b, a.length);\n    return c;\n}\nexport function cloneObject(original, stack) {\n    if (original?.constructor?.name === 'DataSnapshot') {\n        throw new TypeError(`Object to clone is a DataSnapshot (path \"${original.ref.path}\")`);\n    }\n    const checkAndFixTypedArray = (obj) => {\n        if (obj !== null && typeof obj === 'object'\n            && typeof obj.constructor === 'function' && typeof obj.constructor.name === 'string'\n            && ['Buffer', 'Uint8Array', 'Int8Array', 'Uint16Array', 'Int16Array', 'Uint32Array', 'Int32Array', 'BigUint64Array', 'BigInt64Array'].includes(obj.constructor.name)) {\n            // FIX for typed array being converted to objects with numeric properties:\n            // Convert Buffer or TypedArray to ArrayBuffer\n            obj = obj.buffer.slice(obj.byteOffset, obj.byteOffset + obj.byteLength);\n        }\n        return obj;\n    };\n    original = checkAndFixTypedArray(original);\n    if (typeof original !== 'object' || original === null || original instanceof Date || original instanceof ArrayBuffer || original instanceof PathReference || original instanceof RegExp) {\n        return original;\n    }\n    const cloneValue = (val) => {\n        if (stack.indexOf(val) >= 0) {\n            throw new ReferenceError('object contains a circular reference');\n        }\n        val = checkAndFixTypedArray(val);\n        if (val === null || val instanceof Date || val instanceof ArrayBuffer || val instanceof PathReference || val instanceof RegExp) { // || val instanceof ID\n            return val;\n        }\n        else if (typeof val === 'object') {\n            stack.push(val);\n            val = cloneObject(val, stack);\n            stack.pop();\n            return val;\n        }\n        else {\n            return val; // Anything other can just be copied\n        }\n    };\n    if (typeof stack === 'undefined') {\n        stack = [original];\n    }\n    const clone = original instanceof Array ? [] : original instanceof PartialArray ? new PartialArray() : {};\n    Object.keys(original).forEach(key => {\n        const val = original[key];\n        if (typeof val === 'function') {\n            return; // skip functions\n        }\n        clone[key] = cloneValue(val);\n    });\n    return clone;\n}\nconst isTypedArray = (val) => typeof val === 'object' && ['ArrayBuffer', 'Buffer', 'Uint8Array', 'Uint16Array', 'Uint32Array', 'Int8Array', 'Int16Array', 'Int32Array'].includes(val.constructor.name);\n// CONSIDER: updating isTypedArray to: const isTypedArray = val => typeof val === 'object' && 'buffer' in val && 'byteOffset' in val && 'byteLength' in val;\nexport function valuesAreEqual(val1, val2) {\n    if (val1 === val2) {\n        return true;\n    }\n    if (typeof val1 !== typeof val2) {\n        return false;\n    }\n    if (typeof val1 === 'object' || typeof val2 === 'object') {\n        if (val1 === null || val2 === null) {\n            return false;\n        }\n        if (val1 instanceof PathReference || val2 instanceof PathReference) {\n            return val1 instanceof PathReference && val2 instanceof PathReference && val1.path === val2.path;\n        }\n        if (val1 instanceof Date || val2 instanceof Date) {\n            return val1 instanceof Date && val2 instanceof Date && val1.getTime() === val2.getTime();\n        }\n        if (val1 instanceof Array || val2 instanceof Array) {\n            return val1 instanceof Array && val2 instanceof Array && val1.length === val2.length && val1.every((item, i) => valuesAreEqual(val1[i], val2[i]));\n        }\n        if (isTypedArray(val1) || isTypedArray(val2)) {\n            if (!isTypedArray(val1) || !isTypedArray(val2) || val1.byteLength === val2.byteLength) {\n                return false;\n            }\n            const typed1 = val1 instanceof ArrayBuffer ? new Uint8Array(val1) : new Uint8Array(val1.buffer, val1.byteOffset, val1.byteLength), typed2 = val2 instanceof ArrayBuffer ? new Uint8Array(val2) : new Uint8Array(val2.buffer, val2.byteOffset, val2.byteLength);\n            return typed1.every((val, i) => typed2[i] === val);\n        }\n        const keys1 = Object.keys(val1), keys2 = Object.keys(val2);\n        return keys1.length === keys2.length && keys1.every(key => keys2.includes(key)) && keys1.every(key => valuesAreEqual(val1[key], val2[key]));\n    }\n    return false;\n}\nexport class ObjectDifferences {\n    constructor(added, removed, changed) {\n        this.added = added;\n        this.removed = removed;\n        this.changed = changed;\n    }\n    forChild(key) {\n        if (this.added.includes(key)) {\n            return 'added';\n        }\n        if (this.removed.includes(key)) {\n            return 'removed';\n        }\n        const changed = this.changed.find(ch => ch.key === key);\n        return changed ? changed.change : 'identical';\n    }\n}\nexport function compareValues(oldVal, newVal, sortedResults = false) {\n    const voids = [undefined, null];\n    if (oldVal === newVal) {\n        return 'identical';\n    }\n    else if (voids.indexOf(oldVal) >= 0 && voids.indexOf(newVal) < 0) {\n        return 'added';\n    }\n    else if (voids.indexOf(oldVal) < 0 && voids.indexOf(newVal) >= 0) {\n        return 'removed';\n    }\n    else if (typeof oldVal !== typeof newVal) {\n        return 'changed';\n    }\n    else if (isTypedArray(oldVal) || isTypedArray(newVal)) {\n        // One or both values are typed arrays.\n        if (!isTypedArray(oldVal) || !isTypedArray(newVal)) {\n            return 'changed';\n        }\n        // Both are typed. Compare lengths and byte content of typed arrays\n        const typed1 = oldVal instanceof Uint8Array ? oldVal : oldVal instanceof ArrayBuffer ? new Uint8Array(oldVal) : new Uint8Array(oldVal.buffer, oldVal.byteOffset, oldVal.byteLength);\n        const typed2 = newVal instanceof Uint8Array ? newVal : newVal instanceof ArrayBuffer ? new Uint8Array(newVal) : new Uint8Array(newVal.buffer, newVal.byteOffset, newVal.byteLength);\n        return typed1.byteLength === typed2.byteLength && typed1.every((val, i) => typed2[i] === val) ? 'identical' : 'changed';\n    }\n    else if (oldVal instanceof Date || newVal instanceof Date) {\n        return oldVal instanceof Date && newVal instanceof Date && oldVal.getTime() === newVal.getTime() ? 'identical' : 'changed';\n    }\n    else if (oldVal instanceof PathReference || newVal instanceof PathReference) {\n        return oldVal instanceof PathReference && newVal instanceof PathReference && oldVal.path === newVal.path ? 'identical' : 'changed';\n    }\n    else if (typeof oldVal === 'object') {\n        // Do key-by-key comparison of objects\n        const isArray = oldVal instanceof Array;\n        const getKeys = (obj) => {\n            let keys = Object.keys(obj).filter(key => !voids.includes(obj[key]));\n            if (isArray) {\n                keys = keys.map((v) => parseInt(v));\n            }\n            return keys;\n        };\n        const oldKeys = getKeys(oldVal);\n        const newKeys = getKeys(newVal);\n        const removedKeys = oldKeys.filter(key => !newKeys.includes(key));\n        const addedKeys = newKeys.filter(key => !oldKeys.includes(key));\n        const changedKeys = newKeys.reduce((changed, key) => {\n            if (oldKeys.includes(key)) {\n                const val1 = oldVal[key];\n                const val2 = newVal[key];\n                const c = compareValues(val1, val2);\n                if (c !== 'identical') {\n                    changed.push({ key, change: c });\n                }\n            }\n            return changed;\n        }, []);\n        if (addedKeys.length === 0 && removedKeys.length === 0 && changedKeys.length === 0) {\n            return 'identical';\n        }\n        else {\n            return new ObjectDifferences(addedKeys, removedKeys, sortedResults ? changedKeys.sort((a, b) => a.key < b.key ? -1 : 1) : changedKeys);\n        }\n    }\n    return 'changed';\n}\nexport function getMutations(oldVal, newVal, sortedResults = false) {\n    const process = (target, compareResult, prev, val) => {\n        switch (compareResult) {\n            case 'identical': return [];\n            case 'changed': return [{ target, prev, val }];\n            case 'added': return [{ target, prev: null, val }];\n            case 'removed': return [{ target, prev, val: null }];\n            default: {\n                let changes = [];\n                compareResult.added.forEach(key => changes.push({ target: target.concat(key), prev: null, val: val[key] }));\n                compareResult.removed.forEach(key => changes.push({ target: target.concat(key), prev: prev[key], val: null }));\n                compareResult.changed.forEach(item => {\n                    const childChanges = process(target.concat(item.key), item.change, prev[item.key], val[item.key]);\n                    changes = changes.concat(childChanges);\n                });\n                return changes;\n            }\n        }\n    };\n    const compareResult = compareValues(oldVal, newVal, sortedResults);\n    return process([], compareResult, oldVal, newVal);\n}\nexport function getChildValues(childKey, oldValue, newValue) {\n    oldValue = oldValue === null ? null : oldValue[childKey];\n    if (typeof oldValue === 'undefined') {\n        oldValue = null;\n    }\n    newValue = newValue === null ? null : newValue[childKey];\n    if (typeof newValue === 'undefined') {\n        newValue = null;\n    }\n    return { oldValue, newValue };\n}\nexport function defer(fn) {\n    process.nextTick(fn);\n}\nexport function getGlobalObject() {\n    if (typeof globalThis !== 'undefined') {\n        return globalThis;\n    }\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n    if (typeof self !== 'undefined') {\n        return self;\n    }\n    return (function () { return this; }()) ?? Function('return this')();\n}\n//# sourceMappingURL=utils.js.map","import { getGlobalObject } from './utils.js';\nlet _shimRequested = false;\nlet _observable;\n(async () => {\n    // Try pre-loading rxjs Observable\n    // Test availability in global scope first\n    const global = getGlobalObject();\n    if (typeof global.Observable !== 'undefined') {\n        _observable = global.Observable;\n        return;\n    }\n    // Try importing it from dependencies\n    try {\n        const { Observable } = await import('rxjs');\n        _observable = Observable;\n    }\n    catch {\n        // rxjs Observable not available, setObservable must be used if usage of SimpleObservable is not desired\n        _observable = SimpleObservable;\n    }\n})();\nexport function getObservable() {\n    if (_observable === SimpleObservable && !_shimRequested) {\n        console.warn('Using AceBase\\'s simple Observable implementation because rxjs is not available. ' +\n            'Add it to your project with \"npm install rxjs\", add it to AceBase using db.setObservable(Observable), ' +\n            'or call db.setObservable(\"shim\") to suppress this warning');\n    }\n    if (_observable) {\n        return _observable;\n    }\n    throw new Error('RxJS Observable could not be loaded. ');\n}\nexport function setObservable(Observable) {\n    if (Observable === 'shim') {\n        _observable = SimpleObservable;\n        _shimRequested = true;\n    }\n    else {\n        _observable = Observable;\n    }\n}\n/**\n * rxjs is an optional dependency that only needs installing when any of AceBase's observe methods are used.\n * If for some reason rxjs is not available (eg in test suite), we can provide a shim. This class is used when\n * `db.setObservable(\"shim\")` is called\n */\nexport class SimpleObservable {\n    constructor(create) {\n        this._active = false;\n        this._subscribers = [];\n        this._create = create;\n    }\n    subscribe(subscriber) {\n        if (!this._active) {\n            const next = (value) => {\n                // emit value to all subscribers\n                this._subscribers.forEach(s => {\n                    try {\n                        s(value);\n                    }\n                    catch (err) {\n                        console.error('Error in subscriber callback:', err);\n                    }\n                });\n            };\n            const observer = { next };\n            this._cleanup = this._create(observer);\n            this._active = true;\n        }\n        this._subscribers.push(subscriber);\n        const unsubscribe = () => {\n            this._subscribers.splice(this._subscribers.indexOf(subscriber), 1);\n            if (this._subscribers.length === 0) {\n                this._active = false;\n                this._cleanup();\n            }\n        };\n        const subscription = {\n            unsubscribe,\n        };\n        return subscription;\n    }\n}\n//# sourceMappingURL=optional-observable.js.map","import { cloneObject, getMutations, valuesAreEqual } from './utils.js';\nimport { DataReference } from './data-reference.js';\nimport { DataSnapshot, MutationsDataSnapshot } from './data-snapshot.js';\nimport { PathReference } from './path-reference.js';\nimport { ID } from './id.js';\nimport { getObservable } from './optional-observable.js';\nimport process from './process/index.js';\nimport { PathInfo } from './path-info.js';\nimport { SimpleEventEmitter } from './simple-event-emitter.js';\nclass RelativeNodeTarget extends Array {\n    static areEqual(t1, t2) {\n        return t1.length === t2.length && t1.every((key, i) => t2[i] === key);\n    }\n    static isAncestor(ancestor, other) {\n        return ancestor.length < other.length && ancestor.every((key, i) => other[i] === key);\n    }\n    static isDescendant(descendant, other) {\n        return descendant.length > other.length && other.every((key, i) => descendant[i] === key);\n    }\n}\nconst isProxy = Symbol('isProxy');\nexport class LiveDataProxy {\n    /**\n     * Creates a live data proxy for the given reference. The data of the reference's path will be loaded, and kept in-sync\n     * with live data by listening for 'mutations' events. Any changes made to the value by the client will be synced back\n     * to the database.\n     * @param ref DataReference to create proxy for.\n     * @param options proxy initialization options\n     * be written to the database.\n     */\n    static async create(ref, options) {\n        ref = new DataReference(ref.db, ref.path); // Use copy to prevent context pollution on original reference\n        let cache, loaded = false;\n        let latestCursor = options?.cursor;\n        let proxy;\n        const proxyId = ID.generate(); //ref.push().key;\n        // let onMutationCallback: ProxyObserveMutationsCallback;\n        // let onErrorCallback: ProxyObserveErrorCallback = err => {\n        //     console.error(err.message, err.details);\n        // };\n        const clientSubscriptions = [];\n        const clientEventEmitter = new SimpleEventEmitter();\n        clientEventEmitter.on('cursor', (cursor) => latestCursor = cursor);\n        clientEventEmitter.on('error', (err) => {\n            console.error(err.message, err.details);\n        });\n        const applyChange = (keys, newValue) => {\n            // Make changes to cache\n            if (keys.length === 0) {\n                cache = newValue;\n                return true;\n            }\n            const allowCreation = false; //cache === null; // If the proxy'd target did not exist upon load, we must allow it to be created now.\n            if (allowCreation) {\n                cache = typeof keys[0] === 'number' ? [] : {};\n            }\n            let target = cache;\n            const trailKeys = keys.slice();\n            while (trailKeys.length > 1) {\n                const key = trailKeys.shift();\n                if (!(key in target)) {\n                    if (allowCreation) {\n                        target[key] = typeof key === 'number' ? [] : {};\n                    }\n                    else {\n                        // Have we missed an event, or are local pending mutations creating this conflict?\n                        return false; // Do not proceed\n                    }\n                }\n                target = target[key];\n            }\n            const prop = trailKeys.shift();\n            if (newValue === null) {\n                // Remove it\n                target instanceof Array ? target.splice(prop, 1) : delete target[prop];\n            }\n            else {\n                // Set or update it\n                target[prop] = newValue;\n            }\n            return true;\n        };\n        // Subscribe to mutations events on the target path\n        const syncFallback = async () => {\n            if (!loaded) {\n                return;\n            }\n            await reload();\n        };\n        const subscription = ref.on('mutations', { syncFallback }).subscribe(async (snap) => {\n            if (!loaded) {\n                return;\n            }\n            const context = snap.context();\n            const isRemote = context.acebase_proxy?.id !== proxyId;\n            if (!isRemote) {\n                return; // Update was done through this proxy, no need to update cache or trigger local value subscriptions\n            }\n            const mutations = snap.val(false);\n            const proceed = mutations.every(mutation => {\n                if (!applyChange(mutation.target, mutation.val)) {\n                    return false;\n                }\n                // if (onMutationCallback) {\n                const changeRef = mutation.target.reduce((ref, key) => ref.child(key), ref);\n                const changeSnap = new DataSnapshot(changeRef, mutation.val, false, mutation.prev, snap.context());\n                // onMutationCallback(changeSnap, isRemote); // onMutationCallback uses try/catch for client callback\n                clientEventEmitter.emit('mutation', { snapshot: changeSnap, isRemote });\n                // }\n                return true;\n            });\n            if (proceed) {\n                clientEventEmitter.emit('cursor', context.acebase_cursor); // // NOTE: cursor is only present in mutations done remotely. For our own updates, server cursors are returned by ref.set and ref.update\n                localMutationsEmitter.emit('mutations', { origin: 'remote', snap });\n            }\n            else {\n                console.warn(`Cached value of live data proxy on \"${ref.path}\" appears outdated, will be reloaded`);\n                await reload();\n            }\n        });\n        // Setup updating functionality: enqueue all updates, process them at next tick in the order they were issued\n        let processPromise = Promise.resolve();\n        const mutationQueue = [];\n        const transactions = [];\n        const pushLocalMutations = async () => {\n            // Sync all local mutations that are not in a transaction\n            const mutations = [];\n            for (let i = 0, m = mutationQueue[0]; i < mutationQueue.length; i++, m = mutationQueue[i]) {\n                if (!transactions.find(t => RelativeNodeTarget.areEqual(t.target, m.target) || RelativeNodeTarget.isAncestor(t.target, m.target))) {\n                    mutationQueue.splice(i, 1);\n                    i--;\n                    mutations.push(m);\n                }\n            }\n            if (mutations.length === 0) {\n                return;\n            }\n            // Add current (new) values to mutations\n            mutations.forEach(mutation => {\n                mutation.value = cloneObject(getTargetValue(cache, mutation.target));\n            });\n            // Run local onMutation & onChange callbacks in the next tick\n            process.nextTick(() => {\n                // Run onMutation callback for each changed node\n                const context = { acebase_proxy: { id: proxyId, source: 'update' } };\n                // if (onMutationCallback) {\n                mutations.forEach(mutation => {\n                    const mutationRef = mutation.target.reduce((ref, key) => ref.child(key), ref);\n                    const mutationSnap = new DataSnapshot(mutationRef, mutation.value, false, mutation.previous, context);\n                    // onMutationCallback(mutationSnap, false);\n                    clientEventEmitter.emit('mutation', { snapshot: mutationSnap, isRemote: false });\n                });\n                // }\n                // Notify local subscribers\n                const snap = new MutationsDataSnapshot(ref, mutations.map(m => ({ target: m.target, val: m.value, prev: m.previous })), context);\n                localMutationsEmitter.emit('mutations', { origin: 'local', snap });\n            });\n            // Update database async\n            // const batchId = ID.generate();\n            processPromise = mutations\n                .reduce((mutations, m, i, arr) => {\n                // Only keep top path mutations to prevent unneccessary child path updates\n                if (!arr.some(other => RelativeNodeTarget.isAncestor(other.target, m.target))) {\n                    mutations.push(m);\n                }\n                return mutations;\n            }, [])\n                .reduce((updates, m) => {\n                // Prepare db updates\n                const target = m.target;\n                if (target.length === 0) {\n                    // Overwrite this proxy's root value\n                    updates.push({ ref, target, value: cache, type: 'set', previous: m.previous });\n                }\n                else {\n                    const parentTarget = target.slice(0, -1);\n                    const key = target.slice(-1)[0];\n                    const parentRef = parentTarget.reduce((ref, key) => ref.child(key), ref);\n                    const parentUpdate = updates.find(update => update.ref.path === parentRef.path);\n                    const cacheValue = getTargetValue(cache, target); // m.value?\n                    const prevValue = m.previous;\n                    if (parentUpdate) {\n                        parentUpdate.value[key] = cacheValue;\n                        parentUpdate.previous[key] = prevValue;\n                    }\n                    else {\n                        updates.push({ ref: parentRef, target: parentTarget, value: { [key]: cacheValue }, type: 'update', previous: { [key]: prevValue } });\n                    }\n                }\n                return updates;\n            }, [])\n                .reduce(async (promise, update /*, i, updates */) => {\n                // Execute db update\n                // i === 0 && console.log(`Proxy: processing ${updates.length} db updates to paths:`, updates.map(update => update.ref.path));\n                const context = {\n                    acebase_proxy: {\n                        id: proxyId,\n                        source: update.type,\n                        // update_id: ID.generate(),\n                        // batch_id: batchId,\n                        // batch_updates: updates.length\n                    },\n                };\n                await promise;\n                await update.ref\n                    .context(context)[update.type](update.value) // .set or .update\n                    .catch(err => {\n                    clientEventEmitter.emit('error', { source: 'update', message: `Error processing update of \"/${ref.path}\"`, details: err });\n                    // console.warn(`Proxy could not update DB, should rollback (${update.type}) the proxy value of \"${update.ref.path}\" to: `, update.previous);\n                    const context = { acebase_proxy: { id: proxyId, source: 'update-rollback' } };\n                    const mutations = [];\n                    if (update.type === 'set') {\n                        setTargetValue(cache, update.target, update.previous);\n                        const mutationSnap = new DataSnapshot(update.ref, update.previous, false, update.value, context);\n                        clientEventEmitter.emit('mutation', { snapshot: mutationSnap, isRemote: false });\n                        mutations.push({ target: update.target, val: update.previous, prev: update.value });\n                    }\n                    else {\n                        // update\n                        Object.keys(update.previous).forEach(key => {\n                            setTargetValue(cache, update.target.concat(key), update.previous[key]);\n                            const mutationSnap = new DataSnapshot(update.ref.child(key), update.previous[key], false, update.value[key], context);\n                            clientEventEmitter.emit('mutation', { snapshot: mutationSnap, isRemote: false });\n                            mutations.push({ target: update.target.concat(key), val: update.previous[key], prev: update.value[key] });\n                        });\n                    }\n                    // Run onMutation callback for each node being rolled back\n                    mutations.forEach(m => {\n                        const mutationRef = m.target.reduce((ref, key) => ref.child(key), ref);\n                        const mutationSnap = new DataSnapshot(mutationRef, m.val, false, m.prev, context);\n                        clientEventEmitter.emit('mutation', { snapshot: mutationSnap, isRemote: false });\n                    });\n                    // Notify local subscribers:\n                    const snap = new MutationsDataSnapshot(update.ref, mutations, context);\n                    localMutationsEmitter.emit('mutations', { origin: 'local', snap });\n                });\n                if (update.ref.cursor) {\n                    // Should also be available in context.acebase_cursor now\n                    clientEventEmitter.emit('cursor', update.ref.cursor);\n                }\n            }, processPromise);\n            await processPromise;\n        };\n        let syncInProgress = false;\n        const syncPromises = [];\n        const syncCompleted = () => {\n            let resolve;\n            const promise = new Promise(rs => resolve = rs);\n            syncPromises.push({ resolve });\n            return promise;\n        };\n        let processQueueTimeout = null;\n        const scheduleSync = () => {\n            if (!processQueueTimeout) {\n                processQueueTimeout = setTimeout(async () => {\n                    syncInProgress = true;\n                    processQueueTimeout = null;\n                    await pushLocalMutations();\n                    syncInProgress = false;\n                    syncPromises.splice(0).forEach(p => p.resolve());\n                }, 0);\n            }\n        };\n        const flagOverwritten = (target) => {\n            if (!mutationQueue.find(m => RelativeNodeTarget.areEqual(m.target, target))) {\n                mutationQueue.push({ target, previous: cloneObject(getTargetValue(cache, target)) });\n            }\n            // schedule database updates\n            scheduleSync();\n        };\n        const localMutationsEmitter = new SimpleEventEmitter();\n        const addOnChangeHandler = (target, callback) => {\n            const isObject = (val) => val !== null && typeof val === 'object';\n            const mutationsHandler = async (details) => {\n                const { snap, origin } = details;\n                const context = snap.context();\n                const causedByOurProxy = context.acebase_proxy?.id === proxyId;\n                if (details.origin === 'remote' && causedByOurProxy) {\n                    // Any local changes already triggered subscription callbacks\n                    console.error('DEV ISSUE: mutationsHandler was called from remote event originating from our own proxy');\n                    return;\n                }\n                const mutations = snap.val(false).filter(mutation => {\n                    // Keep mutations impacting the subscribed target: mutations on target, or descendant or ancestor of target\n                    return mutation.target.slice(0, target.length).every((key, i) => target[i] === key);\n                });\n                if (mutations.length === 0) {\n                    return;\n                }\n                let newValue, previousValue;\n                // If there is a mutation on the target itself, or parent/ancestor path, there can only be one. We can take a shortcut\n                const singleMutation = mutations.find(m => m.target.length <= target.length);\n                if (singleMutation) {\n                    const trailKeys = target.slice(singleMutation.target.length);\n                    newValue = trailKeys.reduce((val, key) => !isObject(val) || !(key in val) ? null : val[key], singleMutation.val);\n                    previousValue = trailKeys.reduce((val, key) => !isObject(val) || !(key in val) ? null : val[key], singleMutation.prev);\n                }\n                else {\n                    // All mutations are on children/descendants of our target\n                    // Construct new & previous values by combining cache and snapshot\n                    const currentValue = getTargetValue(cache, target);\n                    newValue = cloneObject(currentValue);\n                    previousValue = cloneObject(newValue);\n                    mutations.forEach(mutation => {\n                        // mutation.target is relative to proxy root\n                        const trailKeys = mutation.target.slice(target.length);\n                        for (let i = 0, val = newValue, prev = previousValue; i < trailKeys.length; i++) { // arr = PathInfo.getPathKeys(mutationPath).slice(PathInfo.getPathKeys(targetRef.path).length)\n                            const last = i + 1 === trailKeys.length, key = trailKeys[i];\n                            if (last) {\n                                val[key] = mutation.val;\n                                if (val[key] === null) {\n                                    delete val[key];\n                                }\n                                prev[key] = mutation.prev;\n                                if (prev[key] === null) {\n                                    delete prev[key];\n                                }\n                            }\n                            else {\n                                val = val[key] = key in val ? val[key] : {};\n                                prev = prev[key] = key in prev ? prev[key] : {};\n                            }\n                        }\n                    });\n                }\n                process.nextTick(() => {\n                    // Run callback with read-only (frozen) values in next tick\n                    let keepSubscription = true;\n                    try {\n                        keepSubscription = false !== callback(Object.freeze(newValue), Object.freeze(previousValue), !causedByOurProxy, context);\n                    }\n                    catch (err) {\n                        clientEventEmitter.emit('error', { source: origin === 'remote' ? 'remote_update' : 'local_update', message: 'Error running subscription callback', details: err });\n                    }\n                    if (keepSubscription === false) {\n                        stop();\n                    }\n                });\n            };\n            localMutationsEmitter.on('mutations', mutationsHandler);\n            const stop = () => {\n                localMutationsEmitter.off('mutations', mutationsHandler);\n                clientSubscriptions.splice(clientSubscriptions.findIndex(cs => cs.stop === stop), 1);\n            };\n            clientSubscriptions.push({ target, stop });\n            return { stop };\n        };\n        const handleFlag = (flag, target, args) => {\n            if (flag === 'write') {\n                return flagOverwritten(target);\n            }\n            else if (flag === 'onChange') {\n                return addOnChangeHandler(target, args.callback);\n            }\n            else if (flag === 'subscribe' || flag === 'observe') {\n                const subscribe = (subscriber) => {\n                    const currentValue = getTargetValue(cache, target);\n                    subscriber.next(currentValue);\n                    const subscription = addOnChangeHandler(target, (value /*, previous, isRemote, context */) => {\n                        subscriber.next(value);\n                    });\n                    return function unsubscribe() {\n                        subscription.stop();\n                    };\n                };\n                if (flag === 'subscribe') {\n                    return subscribe;\n                }\n                // Try to load Observable\n                const Observable = getObservable();\n                return new Observable(subscribe);\n            }\n            else if (flag === 'transaction') {\n                const hasConflictingTransaction = transactions.some(t => RelativeNodeTarget.areEqual(target, t.target) || RelativeNodeTarget.isAncestor(target, t.target) || RelativeNodeTarget.isDescendant(target, t.target));\n                if (hasConflictingTransaction) {\n                    // TODO: Wait for this transaction to finish, then try again\n                    return Promise.reject(new Error('Cannot start transaction because it conflicts with another transaction'));\n                }\n                return new Promise(async (resolve) => {\n                    // If there are pending mutations on target (or deeper), wait until they have been synchronized\n                    const hasPendingMutations = mutationQueue.some(m => RelativeNodeTarget.areEqual(target, m.target) || RelativeNodeTarget.isAncestor(target, m.target));\n                    if (hasPendingMutations) {\n                        if (!syncInProgress) {\n                            scheduleSync();\n                        }\n                        await syncCompleted();\n                    }\n                    const tx = { target, status: 'started', transaction: null };\n                    transactions.push(tx);\n                    tx.transaction = {\n                        get status() { return tx.status; },\n                        get completed() { return tx.status !== 'started'; },\n                        get mutations() {\n                            return mutationQueue.filter(m => RelativeNodeTarget.areEqual(tx.target, m.target) || RelativeNodeTarget.isAncestor(tx.target, m.target));\n                        },\n                        get hasMutations() {\n                            return this.mutations.length > 0;\n                        },\n                        async commit() {\n                            if (this.completed) {\n                                throw new Error(`Transaction has completed already (status '${tx.status}')`);\n                            }\n                            tx.status = 'finished';\n                            transactions.splice(transactions.indexOf(tx), 1);\n                            if (syncInProgress) {\n                                // Currently syncing without our mutations\n                                await syncCompleted();\n                            }\n                            scheduleSync();\n                            await syncCompleted();\n                        },\n                        rollback() {\n                            // Remove mutations from queue\n                            if (this.completed) {\n                                throw new Error(`Transaction has completed already (status '${tx.status}')`);\n                            }\n                            tx.status = 'canceled';\n                            const mutations = [];\n                            for (let i = 0; i < mutationQueue.length; i++) {\n                                const m = mutationQueue[i];\n                                if (RelativeNodeTarget.areEqual(tx.target, m.target) || RelativeNodeTarget.isAncestor(tx.target, m.target)) {\n                                    mutationQueue.splice(i, 1);\n                                    i--;\n                                    mutations.push(m);\n                                }\n                            }\n                            // Replay mutations in reverse order\n                            mutations.reverse()\n                                .forEach(m => {\n                                if (m.target.length === 0) {\n                                    cache = m.previous;\n                                }\n                                else {\n                                    setTargetValue(cache, m.target, m.previous);\n                                }\n                            });\n                            // Remove transaction\n                            transactions.splice(transactions.indexOf(tx), 1);\n                        },\n                    };\n                    resolve(tx.transaction);\n                });\n            }\n        };\n        const snap = await ref.get({ cache_mode: 'allow', cache_cursor: options?.cursor });\n        // const gotOfflineStartValue = snap.context().acebase_origin === 'cache';\n        // if (gotOfflineStartValue) {\n        //     console.warn(`Started data proxy with cached value of \"${ref.path}\", check if its value is reloaded on next connection!`);\n        // }\n        if (snap.context().acebase_origin !== 'cache') {\n            clientEventEmitter.emit('cursor', ref.cursor ?? null); // latestCursor = snap.context().acebase_cursor ?? null;\n        }\n        loaded = true;\n        cache = snap.val();\n        if (cache === null && typeof options?.defaultValue !== 'undefined') {\n            cache = options.defaultValue;\n            const context = {\n                acebase_proxy: {\n                    id: proxyId,\n                    source: 'default',\n                    // update_id: ID.generate()\n                },\n            };\n            await ref.context(context).set(cache);\n        }\n        proxy = createProxy({ root: { ref, get cache() { return cache; } }, target: [], id: proxyId, flag: handleFlag });\n        const assertProxyAvailable = () => {\n            if (proxy === null) {\n                throw new Error('Proxy was destroyed');\n            }\n        };\n        const reload = async () => {\n            // Manually reloads current value when cache is out of sync, which should only\n            // be able to happen if an AceBaseClient is used without cache database,\n            // and the connection to the server was lost for a while. In all other cases,\n            // there should be no need to call this method.\n            assertProxyAvailable();\n            mutationQueue.splice(0); // Remove pending mutations. Will be empty in production, but might not be while debugging, leading to weird behaviour.\n            const snap = await ref.get({ allow_cache: false });\n            const oldVal = cache, newVal = snap.val();\n            cache = newVal;\n            // Compare old and new values\n            const mutations = getMutations(oldVal, newVal);\n            if (mutations.length === 0) {\n                return; // Nothing changed\n            }\n            // Run onMutation callback for each changed node\n            const context = snap.context(); // context might contain acebase_cursor if server support that\n            context.acebase_proxy = { id: proxyId, source: 'reload' };\n            // if (onMutationCallback) {\n            mutations.forEach(m => {\n                const targetRef = getTargetRef(ref, m.target);\n                const newSnap = new DataSnapshot(targetRef, m.val, m.val === null, m.prev, context);\n                clientEventEmitter.emit('mutation', { snapshot: newSnap, isRemote: true });\n            });\n            // }\n            // Notify local subscribers\n            const mutationsSnap = new MutationsDataSnapshot(ref, mutations, context);\n            localMutationsEmitter.emit('mutations', { origin: 'local', snap: mutationsSnap });\n        };\n        return {\n            async destroy() {\n                await processPromise;\n                const promises = [\n                    subscription.stop(),\n                    ...clientSubscriptions.map(cs => cs.stop()),\n                ];\n                await Promise.all(promises);\n                ['cursor', 'mutation', 'error'].forEach(event => clientEventEmitter.off(event));\n                cache = null; // Remove cache\n                proxy = null;\n            },\n            stop() {\n                this.destroy();\n            },\n            get value() {\n                assertProxyAvailable();\n                return proxy;\n            },\n            get hasValue() {\n                assertProxyAvailable();\n                return cache !== null;\n            },\n            set value(val) {\n                // Overwrite the value of the proxied path itself!\n                assertProxyAvailable();\n                if (val !== null && typeof val === 'object' && val[isProxy]) {\n                    // Assigning one proxied value to another\n                    val = val.valueOf();\n                }\n                flagOverwritten([]);\n                cache = val;\n            },\n            get ref() {\n                return ref;\n            },\n            get cursor() {\n                return latestCursor;\n            },\n            reload,\n            onMutation(callback) {\n                // Fires callback each time anything changes\n                assertProxyAvailable();\n                clientEventEmitter.off('mutation'); // Mimic legacy behaviour that overwrites handler\n                clientEventEmitter.on('mutation', ({ snapshot, isRemote }) => {\n                    try {\n                        callback(snapshot, isRemote);\n                    }\n                    catch (err) {\n                        clientEventEmitter.emit('error', { source: 'mutation_callback', message: 'Error in dataproxy onMutation callback', details: err });\n                    }\n                });\n            },\n            onError(callback) {\n                // Fires callback each time anything goes wrong\n                assertProxyAvailable();\n                clientEventEmitter.off('error'); // Mimic legacy behaviour that overwrites handler\n                clientEventEmitter.on('error', (err) => {\n                    try {\n                        callback(err);\n                    }\n                    catch (err) {\n                        console.error(`Error in dataproxy onError callback: ${err.message}`);\n                    }\n                });\n            },\n            on(event, callback) {\n                clientEventEmitter.on(event, callback);\n            },\n            off(event, callback) {\n                clientEventEmitter.off(event, callback);\n            },\n        };\n    }\n}\nfunction getTargetValue(obj, target) {\n    let val = obj;\n    for (const key of target) {\n        val = typeof val === 'object' && val !== null && key in val ? val[key] : null;\n    }\n    return val;\n}\nfunction setTargetValue(obj, target, value) {\n    if (target.length === 0) {\n        throw new Error('Cannot update root target, caller must do that itself!');\n    }\n    const targetObject = target.slice(0, -1).reduce((obj, key) => obj[key], obj);\n    const prop = target.slice(-1)[0];\n    if (value === null || typeof value === 'undefined') {\n        // Remove it\n        targetObject instanceof Array ? targetObject.splice(prop, 1) : delete targetObject[prop];\n    }\n    else {\n        // Set or update it\n        targetObject[prop] = value;\n    }\n}\nfunction getTargetRef(ref, target) {\n    // Create new DataReference to prevent context reuse\n    const path = PathInfo.get(ref.path).childPath(target);\n    return new DataReference(ref.db, path);\n}\nfunction createProxy(context) {\n    const targetRef = getTargetRef(context.root.ref, context.target);\n    const childProxies = [];\n    const handler = {\n        get(target, prop, receiver) {\n            target = getTargetValue(context.root.cache, context.target);\n            if (typeof prop === 'symbol') {\n                if (prop.toString() === Symbol.iterator.toString()) {\n                    // Use .values for @@iterator symbol\n                    prop = 'values';\n                }\n                else if (prop.toString() === isProxy.toString()) {\n                    return true;\n                }\n                else {\n                    return Reflect.get(target, prop, receiver);\n                }\n            }\n            if (prop === 'valueOf') {\n                return function valueOf() { return target; };\n            }\n            if (target === null || typeof target !== 'object') {\n                throw new Error(`Cannot read property \"${prop}\" of ${target}. Value of path \"/${targetRef.path}\" is not an object (anymore)`);\n            }\n            if (target instanceof Array && typeof prop === 'string' && /^[0-9]+$/.test(prop)) {\n                // Proxy type definitions say prop can be a number, but this is never the case.\n                prop = parseInt(prop);\n            }\n            const value = target[prop];\n            if (value === null) {\n                // Removed property. Should never happen, but if it does:\n                delete target[prop];\n                return; // undefined\n            }\n            // Check if we have a child proxy for this property already.\n            // If so, and the properties' typeof value did not change, return that\n            const childProxy = childProxies.find(proxy => proxy.prop === prop);\n            if (childProxy) {\n                if (childProxy.typeof === typeof value) {\n                    return childProxy.value;\n                }\n                childProxies.splice(childProxies.indexOf(childProxy), 1);\n            }\n            const proxifyChildValue = (prop) => {\n                const value = target[prop]; //\n                const childProxy = childProxies.find(child => child.prop === prop);\n                if (childProxy) {\n                    if (childProxy.typeof === typeof value) {\n                        return childProxy.value;\n                    }\n                    childProxies.splice(childProxies.indexOf(childProxy), 1);\n                }\n                if (typeof value !== 'object') {\n                    // Can't proxify non-object values\n                    return value;\n                }\n                const newChildProxy = createProxy({ root: context.root, target: context.target.concat(prop), id: context.id, flag: context.flag });\n                childProxies.push({ typeof: typeof value, prop, value: newChildProxy });\n                return newChildProxy;\n            };\n            const unproxyValue = (value) => {\n                return value !== null && typeof value === 'object' && value[isProxy]\n                    ? value.getTarget()\n                    : value;\n            };\n            // If the property contains a simple value, return it.\n            if (['string', 'number', 'boolean'].includes(typeof value)\n                || value instanceof Date\n                || value instanceof PathReference\n                || value instanceof ArrayBuffer\n                || (typeof value === 'object' && 'buffer' in value) // Typed Arrays\n            ) {\n                return value;\n            }\n            const isArray = target instanceof Array;\n            if (prop === 'toString') {\n                return function toString() {\n                    return `[LiveDataProxy for \"${targetRef.path}\"]`;\n                };\n            }\n            if (typeof value === 'undefined') {\n                if (prop === 'push') {\n                    // Push item to an object collection\n                    return function push(item) {\n                        const childRef = targetRef.push();\n                        context.flag('write', context.target.concat(childRef.key)); //, { previous: null }\n                        target[childRef.key] = item;\n                        return childRef.key;\n                    };\n                }\n                if (prop === 'getTarget') {\n                    // Get unproxied readonly (but still live) version of data.\n                    return function (warn = true) {\n                        warn && console.warn('Use getTarget with caution - any changes will not be synchronized!');\n                        return target;\n                    };\n                }\n                if (prop === 'getRef') {\n                    // Gets the DataReference to this data target\n                    return function getRef() {\n                        const ref = getTargetRef(context.root.ref, context.target);\n                        return ref;\n                    };\n                }\n                if (prop === 'forEach') {\n                    return function forEach(callback) {\n                        const keys = Object.keys(target);\n                        // Fix: callback with unproxied value\n                        let stop = false;\n                        for (let i = 0; !stop && i < keys.length; i++) {\n                            const key = keys[i];\n                            const value = proxifyChildValue(key); //, target[key]\n                            stop = callback(value, key, i) === false;\n                        }\n                    };\n                }\n                if (['values', 'entries', 'keys'].includes(prop)) {\n                    return function* generator() {\n                        const keys = Object.keys(target);\n                        for (const key of keys) {\n                            if (prop === 'keys') {\n                                yield key;\n                            }\n                            else {\n                                const value = proxifyChildValue(key); //, target[key]\n                                if (prop === 'entries') {\n                                    yield [key, value];\n                                }\n                                else {\n                                    yield value;\n                                }\n                            }\n                        }\n                    };\n                }\n                if (prop === 'toArray') {\n                    return function toArray(sortFn) {\n                        const arr = Object.keys(target).map(key => proxifyChildValue(key)); //, target[key]\n                        if (sortFn) {\n                            arr.sort(sortFn);\n                        }\n                        return arr;\n                    };\n                }\n                if (prop === 'onChanged') {\n                    // Starts monitoring the value\n                    return function onChanged(callback) {\n                        return context.flag('onChange', context.target, { callback });\n                    };\n                }\n                if (prop === 'subscribe') {\n                    // Gets subscriber function to use with Observables, or custom handling\n                    return function subscribe() {\n                        return context.flag('subscribe', context.target);\n                    };\n                }\n                if (prop === 'getObservable') {\n                    // Creates an observable for monitoring the value\n                    return function getObservable() {\n                        return context.flag('observe', context.target);\n                    };\n                }\n                if (prop === 'getOrderedCollection') {\n                    return function getOrderedCollection(orderProperty, orderIncrement) {\n                        return new OrderedCollectionProxy(this, orderProperty, orderIncrement);\n                    };\n                }\n                if (prop === 'startTransaction') {\n                    return function startTransaction() {\n                        return context.flag('transaction', context.target);\n                    };\n                }\n                if (prop === 'remove' && !isArray) {\n                    // Removes target from object collection\n                    return function remove() {\n                        if (context.target.length === 0) {\n                            throw new Error('Can\\'t remove proxy root value');\n                        }\n                        const parent = getTargetValue(context.root.cache, context.target.slice(0, -1));\n                        const key = context.target.slice(-1)[0];\n                        context.flag('write', context.target);\n                        delete parent[key];\n                    };\n                }\n                return; // undefined\n            }\n            else if (typeof value === 'function') {\n                if (isArray) {\n                    // Handle array methods\n                    const writeArray = (action) => {\n                        context.flag('write', context.target);\n                        return action();\n                    };\n                    const cleanArrayValues = (values) => values.map((value) => {\n                        value = unproxyValue(value);\n                        removeVoidProperties(value);\n                        return value;\n                    });\n                    // Methods that directly change the array:\n                    if (prop === 'push') {\n                        return function push(...items) {\n                            items = cleanArrayValues(items);\n                            return writeArray(() => target.push(...items)); // push the items to the cache array\n                        };\n                    }\n                    if (prop === 'pop') {\n                        return function pop() {\n                            return writeArray(() => target.pop());\n                        };\n                    }\n                    if (prop === 'splice') {\n                        return function splice(start, deleteCount, ...items) {\n                            items = cleanArrayValues(items);\n                            return writeArray(() => target.splice(start, deleteCount, ...items));\n                        };\n                    }\n                    if (prop === 'shift') {\n                        return function shift() {\n                            return writeArray(() => target.shift());\n                        };\n                    }\n                    if (prop === 'unshift') {\n                        return function unshift(...items) {\n                            items = cleanArrayValues(items);\n                            return writeArray(() => target.unshift(...items));\n                        };\n                    }\n                    if (prop === 'sort') {\n                        return function sort(compareFn) {\n                            return writeArray(() => target.sort(compareFn));\n                        };\n                    }\n                    if (prop === 'reverse') {\n                        return function reverse() {\n                            return writeArray(() => target.reverse());\n                        };\n                    }\n                    // Methods that do not change the array themselves, but\n                    // have callbacks that might, or return child values:\n                    if (['indexOf', 'lastIndexOf'].includes(prop)) {\n                        return function indexOf(item, start) {\n                            if (item !== null && typeof item === 'object' && item[isProxy]) {\n                                // Use unproxied value, or array.indexOf will return -1 (fixes issue #1)\n                                item = item.getTarget(false);\n                            }\n                            return target[prop](item, start);\n                        };\n                    }\n                    if (['forEach', 'every', 'some', 'filter', 'map'].includes(prop)) {\n                        return function iterate(callback) {\n                            return target[prop]((value, i) => {\n                                return callback(proxifyChildValue(i), i, proxy); //, value\n                            });\n                        };\n                    }\n                    if (['reduce', 'reduceRight'].includes(prop)) {\n                        return function reduce(callback, initialValue) {\n                            return target[prop]((prev, value, i) => {\n                                return callback(prev, proxifyChildValue(i), i, proxy); //, value\n                            }, initialValue);\n                        };\n                    }\n                    if (['find', 'findIndex'].includes(prop)) {\n                        return function find(callback) {\n                            let value = target[prop]((value, i) => {\n                                return callback(proxifyChildValue(i), i, proxy); // , value\n                            });\n                            if (prop === 'find' && value) {\n                                const index = target.indexOf(value);\n                                value = proxifyChildValue(index); //, value\n                            }\n                            return value;\n                        };\n                    }\n                    if (['values', 'entries', 'keys'].includes(prop)) {\n                        return function* generator() {\n                            for (let i = 0; i < target.length; i++) {\n                                if (prop === 'keys') {\n                                    yield i;\n                                }\n                                else {\n                                    const value = proxifyChildValue(i); //, target[i]\n                                    if (prop === 'entries') {\n                                        yield [i, value];\n                                    }\n                                    else {\n                                        yield value;\n                                    }\n                                }\n                            }\n                        };\n                    }\n                }\n                // Other function (or not an array), should not alter its value\n                // return function fn(...args) {\n                //     return target[prop](...args);\n                // }\n                return value;\n            }\n            // Proxify any other value\n            return proxifyChildValue(prop); //, value\n        },\n        set(target, prop, value, receiver) {\n            // Eg: chats.chat1.title = 'New chat title';\n            // target === chats.chat1, prop === 'title'\n            target = getTargetValue(context.root.cache, context.target);\n            if (typeof prop === 'symbol') {\n                return Reflect.set(target, prop, value, receiver);\n            }\n            if (target === null || typeof target !== 'object') {\n                throw new Error(`Cannot set property \"${prop}\" of ${target}. Value of path \"/${targetRef.path}\" is not an object`);\n            }\n            if (target instanceof Array && typeof prop === 'string') {\n                if (!/^[0-9]+$/.test(prop)) {\n                    throw new Error(`Cannot set property \"${prop}\" on array value of path \"/${targetRef.path}\"`);\n                }\n                prop = parseInt(prop);\n            }\n            if (value !== null) {\n                if (typeof value === 'object') {\n                    if (value[isProxy]) {\n                        // Assigning one proxied value to another\n                        value = value.valueOf();\n                    }\n                    // else if (Object.isFrozen(value)) {\n                    //     // Create a copy to unfreeze it\n                    //     value = cloneObject(value);\n                    // }\n                    value = cloneObject(value); // Fix #10, always clone objects so changes made through the proxy won't change the original object (and vice versa)\n                }\n                if (valuesAreEqual(value, target[prop])) { //if (compareValues(value, target[prop]) === 'identical') { // (typeof value !== 'object' && target[prop] === value) {\n                    // not changing the actual value, ignore\n                    return true;\n                }\n            }\n            if (context.target.some(key => typeof key === 'number')) {\n                // Updating an object property inside an array. Flag the first array in target to be written.\n                // Eg: when chat.members === [{ name: 'Ewout', id: 'someid' }]\n                // --> chat.members[0].name = 'Ewout' --> Rewrite members array instead of chat/members[0]/name\n                context.flag('write', context.target.slice(0, context.target.findIndex(key => typeof key === 'number')));\n            }\n            else if (target instanceof Array) {\n                // Flag the entire array to be overwritten\n                context.flag('write', context.target);\n            }\n            else {\n                // Flag child property\n                context.flag('write', context.target.concat(prop));\n            }\n            // Set cached value:\n            if (value === null) {\n                delete target[prop];\n            }\n            else {\n                removeVoidProperties(value);\n                target[prop] = value;\n            }\n            return true;\n        },\n        deleteProperty(target, prop) {\n            target = getTargetValue(context.root.cache, context.target);\n            if (target === null) {\n                throw new Error(`Cannot delete property ${prop.toString()} of null`);\n            }\n            if (typeof prop === 'symbol') {\n                return Reflect.deleteProperty(target, prop);\n            }\n            if (!(prop in target)) {\n                return true; // Nothing to delete\n            }\n            context.flag('write', context.target.concat(prop));\n            delete target[prop];\n            return true;\n        },\n        ownKeys(target) {\n            target = getTargetValue(context.root.cache, context.target);\n            return Reflect.ownKeys(target);\n        },\n        has(target, prop) {\n            target = getTargetValue(context.root.cache, context.target);\n            return Reflect.has(target, prop);\n        },\n        getOwnPropertyDescriptor(target, prop) {\n            target = getTargetValue(context.root.cache, context.target);\n            const descriptor = Reflect.getOwnPropertyDescriptor(target, prop);\n            if (descriptor) {\n                descriptor.configurable = true; // prevent \"TypeError: 'getOwnPropertyDescriptor' on proxy: trap reported non-configurability for property '...' which is either non-existant or configurable in the proxy target\"\n            }\n            return descriptor;\n        },\n        getPrototypeOf(target) {\n            target = getTargetValue(context.root.cache, context.target);\n            return Reflect.getPrototypeOf(target);\n        },\n    };\n    const proxy = new Proxy({}, handler);\n    return proxy;\n}\nfunction removeVoidProperties(obj) {\n    if (typeof obj !== 'object') {\n        return;\n    }\n    Object.keys(obj).forEach(key => {\n        const val = obj[key];\n        if (val === null || typeof val === 'undefined') {\n            delete obj[key];\n        }\n        else if (typeof val === 'object') {\n            removeVoidProperties(val);\n        }\n    });\n}\n/**\n * Convenience function to access ILiveDataProxyValue methods on a proxied value\n * @param proxiedValue The proxied value to get access to\n * @returns Returns the same object typecasted to an ILiveDataProxyValue\n * @example\n * // IChatMessages is an ObjectCollection<IChatMessage>\n * let observable: Observable<IChatMessages>;\n *\n * // Allows you to do this:\n * observable = proxyAccess<IChatMessages>(chat.messages).getObservable();\n *\n * // Instead of:\n * observable = (chat.messages.msg1 as any as ILiveDataProxyValue<IChatMessages>).getObservable();\n *\n * // Both do the exact same, but the first is less obscure\n */\nexport function proxyAccess(proxiedValue) {\n    if (typeof proxiedValue !== 'object' || !proxiedValue[isProxy]) {\n        throw new Error('Given value is not proxied. Make sure you are referencing the value through the live data proxy.');\n    }\n    return proxiedValue;\n}\n/**\n * Provides functionality to work with ordered collections through a live data proxy. Eliminates\n * the need for arrays to handle ordered data by adding a 'sort' properties to child objects in a\n * collection, and provides functionality to sort and reorder items with a minimal amount of database\n * updates.\n */\nexport class OrderedCollectionProxy {\n    constructor(collection, orderProperty = 'order', orderIncrement = 10) {\n        this.collection = collection;\n        this.orderProperty = orderProperty;\n        this.orderIncrement = orderIncrement;\n        if (typeof collection !== 'object' || !collection[isProxy]) {\n            throw new Error('Collection is not proxied');\n        }\n        if (collection.valueOf() instanceof Array) {\n            throw new Error('Collection is an array, not an object collection');\n        }\n        if (!Object.keys(collection).every(key => typeof collection[key] === 'object')) {\n            throw new Error('Collection has non-object children');\n        }\n        // Check if the collection has order properties. If not, assign them now\n        const ok = Object.keys(collection).every(key => typeof collection[key][orderProperty] === 'number');\n        if (!ok) {\n            // Assign order properties now. Database will be updated automatically\n            const keys = Object.keys(collection);\n            for (let i = 0; i < keys.length; i++) {\n                const item = collection[keys[i]];\n                item[orderProperty] = i * orderIncrement; // 0, 10, 20, 30 etc\n            }\n        }\n    }\n    /**\n     * Gets an observable for the target object collection. Same as calling `collection.getObservable()`\n     * @returns\n     */\n    getObservable() {\n        return proxyAccess(this.collection).getObservable();\n    }\n    /**\n     * Gets an observable that emits a new ordered array representation of the object collection each time\n     * the unlaying data is changed. Same as calling `getArray()` in a `getObservable().subscribe` callback\n     * @returns\n     */\n    getArrayObservable() {\n        const Observable = getObservable();\n        return new Observable((subscriber => {\n            const subscription = this.getObservable().subscribe(( /*value*/) => {\n                const newArray = this.getArray();\n                subscriber.next(newArray);\n            });\n            return function unsubscribe() {\n                subscription.unsubscribe();\n            };\n        }));\n    }\n    /**\n     * Gets an ordered array representation of the items in your object collection. The items in the array\n     * are proxied values, changes will be in sync with the database. Note that the array itself\n     * is not mutable: adding or removing items to it will NOT update the collection in the\n     * the database and vice versa. Use `add`, `delete`, `sort` and `move` methods to make changes\n     * that impact the collection's sorting order\n     * @returns order array\n     */\n    getArray() {\n        const arr = proxyAccess(this.collection).toArray((a, b) => a[this.orderProperty] - b[this.orderProperty]);\n        // arr.push = (...items: T[]) => {\n        //     items.forEach(item => this.add(item));\n        //     return arr.length;\n        // };\n        return arr;\n    }\n    /**\n     * Adds or moves an item to/within the object collection and takes care of the proper sorting order.\n     * @param item Item to add or move\n     * @param index Optional target index in the sorted representation, appends if not specified.\n     * @param from If the item is being moved\n     * @returns\n     */\n    add(item, index, from) {\n        const arr = this.getArray();\n        let minOrder = Number.POSITIVE_INFINITY, maxOrder = Number.NEGATIVE_INFINITY;\n        for (let i = 0; i < arr.length; i++) {\n            const order = arr[i][this.orderProperty];\n            minOrder = Math.min(order, minOrder);\n            maxOrder = Math.max(order, maxOrder);\n        }\n        let fromKey;\n        if (typeof from === 'number') {\n            // Moving existing item\n            fromKey = Object.keys(this.collection).find(key => this.collection[key] === item);\n            if (!fromKey) {\n                throw new Error('item not found in collection');\n            }\n            if (from === index) {\n                return { key: fromKey, index };\n            }\n            if (Math.abs(from - index) === 1) {\n                // Position being swapped, swap their order property values\n                const otherItem = arr[index];\n                const otherOrder = otherItem[this.orderProperty];\n                otherItem[this.orderProperty] = item[this.orderProperty];\n                item[this.orderProperty] = otherOrder;\n                return { key: fromKey, index };\n            }\n            else {\n                // Remove from array, code below will add again\n                arr.splice(from, 1);\n            }\n        }\n        if (typeof index !== 'number' || index >= arr.length) {\n            // append at the end\n            index = arr.length;\n            item[this.orderProperty] = (arr.length == 0 ? 0 : maxOrder + this.orderIncrement);\n        }\n        else if (index === 0) {\n            // insert before all others\n            item[this.orderProperty] = (arr.length == 0 ? 0 : minOrder - this.orderIncrement);\n        }\n        else {\n            // insert between 2 others\n            const orders = arr.map(item => item[this.orderProperty]);\n            const gap = orders[index] - orders[index - 1];\n            if (gap > 1) {\n                item[this.orderProperty] = (orders[index] - Math.floor(gap / 2));\n            }\n            else {\n                // TODO: Can this gap be enlarged by moving one of both orders?\n                // For now, change all other orders\n                arr.splice(index, 0, item);\n                for (let i = 0; i < arr.length; i++) {\n                    arr[i][this.orderProperty] = (i * this.orderIncrement);\n                }\n            }\n        }\n        const key = typeof fromKey === 'string'\n            ? fromKey // Moved item, don't add it\n            : proxyAccess(this.collection).push(item);\n        return { key, index };\n    }\n    /**\n     * Deletes an item from the object collection using the their index in the sorted array representation\n     * @param index\n     * @returns the key of the collection's child that was deleted\n     */\n    delete(index) {\n        const arr = this.getArray();\n        const item = arr[index];\n        if (!item) {\n            throw new Error(`Item at index ${index} not found`);\n        }\n        const key = Object.keys(this.collection).find(key => this.collection[key] === item);\n        if (!key) {\n            throw new Error('Cannot find target object to delete');\n        }\n        this.collection[key] = null; // Deletes it from db\n        return { key, index };\n    }\n    /**\n     * Moves an item in the object collection by reordering it\n     * @param fromIndex Current index in the array (the ordered representation of the object collection)\n     * @param toIndex Target index in the array\n     * @returns\n     */\n    move(fromIndex, toIndex) {\n        const arr = this.getArray();\n        return this.add(arr[fromIndex], toIndex, fromIndex);\n    }\n    /**\n     * Reorders the object collection using given sort function. Allows quick reordering of the collection which is persisted in the database\n     * @param sortFn\n     */\n    sort(sortFn) {\n        const arr = this.getArray();\n        arr.sort(sortFn);\n        for (let i = 0; i < arr.length; i++) {\n            arr[i][this.orderProperty] = i * this.orderIncrement;\n        }\n    }\n}\n//# sourceMappingURL=data-proxy.js.map","import { DataSnapshot, MutationsDataSnapshot } from './data-snapshot.js';\nimport { EventStream } from './subscription.js';\nimport { ID } from './id.js';\nimport { PathInfo } from './path-info.js';\nimport { LiveDataProxy } from './data-proxy.js';\nimport { getObservable } from './optional-observable.js';\nexport class DataRetrievalOptions {\n    /**\n     * Options for data retrieval, allows selective loading of object properties\n     */\n    constructor(options) {\n        if (!options) {\n            options = {};\n        }\n        if (typeof options.include !== 'undefined' && !(options.include instanceof Array)) {\n            throw new TypeError('options.include must be an array');\n        }\n        if (typeof options.exclude !== 'undefined' && !(options.exclude instanceof Array)) {\n            throw new TypeError('options.exclude must be an array');\n        }\n        if (typeof options.child_objects !== 'undefined' && typeof options.child_objects !== 'boolean') {\n            throw new TypeError('options.child_objects must be a boolean');\n        }\n        if (typeof options.cache_mode === 'string' && !['allow', 'bypass', 'force'].includes(options.cache_mode)) {\n            throw new TypeError('invalid value for options.cache_mode');\n        }\n        this.include = options.include || undefined;\n        this.exclude = options.exclude || undefined;\n        this.child_objects = typeof options.child_objects === 'boolean' ? options.child_objects : undefined;\n        this.cache_mode = typeof options.cache_mode === 'string'\n            ? options.cache_mode\n            : typeof options.allow_cache === 'boolean'\n                ? options.allow_cache ? 'allow' : 'bypass'\n                : 'allow';\n        this.cache_cursor = typeof options.cache_cursor === 'string' ? options.cache_cursor : undefined;\n    }\n}\nexport class QueryDataRetrievalOptions extends DataRetrievalOptions {\n    /**\n     * @param options Options for data retrieval, allows selective loading of object properties\n     */\n    constructor(options) {\n        super(options);\n        if (!['undefined', 'boolean'].includes(typeof options.snapshots)) {\n            throw new TypeError('options.snapshots must be a boolean');\n        }\n        this.snapshots = typeof options.snapshots === 'boolean' ? options.snapshots : true;\n    }\n}\nconst _private = Symbol('private');\nexport class DataReference {\n    /**\n     * Creates a reference to a node\n     */\n    constructor(db, path, vars) {\n        this.db = db;\n        if (!path) {\n            path = '';\n        }\n        path = path.replace(/^\\/|\\/$/g, ''); // Trim slashes\n        const pathInfo = PathInfo.get(path);\n        const key = pathInfo.key;\n        const callbacks = [];\n        this[_private] = {\n            get path() { return path; },\n            get key() { return key; },\n            get callbacks() { return callbacks; },\n            vars: vars || {},\n            context: {},\n            pushed: false,\n            cursor: null,\n        };\n    }\n    context(context, merge = false) {\n        const currentContext = this[_private].context;\n        if (typeof context === 'object') {\n            const newContext = context ? merge ? currentContext || {} : context : {};\n            if (context) {\n                // Merge new with current context\n                Object.keys(context).forEach(key => {\n                    newContext[key] = context[key];\n                });\n            }\n            this[_private].context = newContext;\n            return this;\n        }\n        else if (typeof context === 'undefined') {\n            console.warn('Use snap.context() instead of snap.ref.context() to get updating context in event callbacks');\n            return currentContext;\n        }\n        else {\n            throw new Error('Invalid context argument');\n        }\n    }\n    /**\n     * Contains the last received cursor for this referenced path (if the connected database has transaction logging enabled).\n     * If you want to be notified if this value changes, add a handler with `ref.onCursor(callback)`\n     */\n    get cursor() {\n        return this[_private].cursor;\n    }\n    set cursor(value) {\n        this[_private].cursor = value;\n        this.onCursor?.(value);\n    }\n    /**\n    * The path this instance was created with\n    */\n    get path() { return this[_private].path; }\n    /**\n     * The key or index of this node\n     */\n    get key() {\n        const key = this[_private].key;\n        return typeof key === 'number' ? `[${key}]` : key;\n    }\n    /**\n     * If the \"key\" is a number, it is an index!\n     */\n    get index() {\n        const key = this[_private].key;\n        if (typeof key !== 'number') {\n            throw new Error(`\"${key}\" is not a number`);\n        }\n        return key;\n    }\n    /**\n     * Returns a new reference to this node's parent\n     */\n    get parent() {\n        const currentPath = PathInfo.fillVariables2(this.path, this.vars);\n        const info = PathInfo.get(currentPath);\n        if (info.parentPath === null) {\n            return null;\n        }\n        return new DataReference(this.db, info.parentPath).context(this[_private].context);\n    }\n    /**\n     * Contains values of the variables/wildcards used in a subscription path if this reference was\n     * created by an event (\"value\", \"child_added\" etc), or in a type mapping path when serializing / instantiating typed objects\n     */\n    get vars() {\n        return this[_private].vars;\n    }\n    /**\n     * Returns a new reference to a child node\n     * @param childPath Child key, index or path\n     * @returns reference to the child\n     */\n    child(childPath) {\n        childPath = typeof childPath === 'number' ? childPath : childPath.replace(/^\\/|\\/$/g, '');\n        const currentPath = PathInfo.fillVariables2(this.path, this.vars);\n        const targetPath = PathInfo.getChildPath(currentPath, childPath);\n        return new DataReference(this.db, targetPath).context(this[_private].context); //  `${this.path}/${childPath}`\n    }\n    /**\n     * Sets or overwrites the stored value\n     * @param value value to store in database\n     * @param onComplete optional completion callback to use instead of returning promise\n     * @returns promise that resolves with this reference when completed\n     */\n    async set(value, onComplete) {\n        try {\n            if (this.isWildcardPath) {\n                throw new Error(`Cannot set the value of wildcard path \"/${this.path}\"`);\n            }\n            if (this.parent === null) {\n                throw new Error('Cannot set the root object. Use update, or set individual child properties');\n            }\n            if (typeof value === 'undefined') {\n                throw new TypeError(`Cannot store undefined value in \"/${this.path}\"`);\n            }\n            if (!this.db.isReady) {\n                await this.db.ready();\n            }\n            value = this.db.types.serialize(this.path, value);\n            const { cursor } = await this.db.api.set(this.path, value, { context: this[_private].context });\n            this.cursor = cursor;\n            if (typeof onComplete === 'function') {\n                try {\n                    onComplete(null, this);\n                }\n                catch (err) {\n                    console.error('Error in onComplete callback:', err);\n                }\n            }\n        }\n        catch (err) {\n            if (typeof onComplete === 'function') {\n                try {\n                    onComplete(err, this);\n                }\n                catch (err) {\n                    console.error('Error in onComplete callback:', err);\n                }\n            }\n            else {\n                // throw again\n                throw err;\n            }\n        }\n        return this;\n    }\n    /**\n     * Updates properties of the referenced node\n     * @param updates containing the properties to update\n     * @param onComplete optional completion callback to use instead of returning promise\n     * @return returns promise that resolves with this reference once completed\n     */\n    async update(updates, onComplete) {\n        try {\n            if (this.isWildcardPath) {\n                throw new Error(`Cannot update the value of wildcard path \"/${this.path}\"`);\n            }\n            if (!this.db.isReady) {\n                await this.db.ready();\n            }\n            if (typeof updates !== 'object' || updates instanceof Array || updates instanceof ArrayBuffer || updates instanceof Date) {\n                await this.set(updates);\n            }\n            else if (Object.keys(updates).length === 0) {\n                console.warn(`update called on path \"/${this.path}\", but there is nothing to update`);\n            }\n            else {\n                updates = this.db.types.serialize(this.path, updates);\n                const { cursor } = await this.db.api.update(this.path, updates, { context: this[_private].context });\n                this.cursor = cursor;\n            }\n            if (typeof onComplete === 'function') {\n                try {\n                    onComplete(null, this);\n                }\n                catch (err) {\n                    console.error('Error in onComplete callback:', err);\n                }\n            }\n        }\n        catch (err) {\n            if (typeof onComplete === 'function') {\n                try {\n                    onComplete(err, this);\n                }\n                catch (err) {\n                    console.error('Error in onComplete callback:', err);\n                }\n            }\n            else {\n                // throw again\n                throw err;\n            }\n        }\n        return this;\n    }\n    /**\n     * Sets the value a node using a transaction: it runs your callback function with the current value, uses its return value as the new value to store.\n     * The transaction is canceled if your callback returns undefined, or throws an error. If your callback returns null, the target node will be removed.\n     * @param callback - callback function that performs the transaction on the node's current value. It must return the new value to store (or promise with new value), undefined to cancel the transaction, or null to remove the node.\n     * @returns returns a promise that resolves with the DataReference once the transaction has been processed\n     */\n    async transaction(callback) {\n        if (this.isWildcardPath) {\n            throw new Error(`Cannot start a transaction on wildcard path \"/${this.path}\"`);\n        }\n        if (!this.db.isReady) {\n            await this.db.ready();\n        }\n        let throwError;\n        const cb = (currentValue) => {\n            currentValue = this.db.types.deserialize(this.path, currentValue);\n            const snap = new DataSnapshot(this, currentValue);\n            let newValue;\n            try {\n                newValue = callback(snap);\n            }\n            catch (err) {\n                // callback code threw an error\n                throwError = err; // Remember error\n                return; // cancel transaction by returning undefined\n            }\n            if (newValue instanceof Promise) {\n                return newValue\n                    .then((val) => {\n                    return this.db.types.serialize(this.path, val);\n                })\n                    .catch(err => {\n                    throwError = err; // Remember error\n                    return; // cancel transaction by returning undefined\n                });\n            }\n            else {\n                return this.db.types.serialize(this.path, newValue);\n            }\n        };\n        const { cursor } = await this.db.api.transaction(this.path, cb, { context: this[_private].context });\n        this.cursor = cursor;\n        if (throwError) {\n            // Rethrow error from callback code\n            throw throwError;\n        }\n        return this;\n    }\n    on(event, callback, cancelCallback) {\n        if (this.path === '' && ['value', 'child_changed'].includes(event)) {\n            // Removed 'notify_value' and 'notify_child_changed' events from the list, they do not require additional data loading anymore.\n            console.warn('WARNING: Listening for value and child_changed events on the root node is a bad practice. These events require loading of all data (value event), or potentially lots of data (child_changed event) each time they are fired');\n        }\n        let eventPublisher = null;\n        const eventStream = new EventStream(publisher => { eventPublisher = publisher; });\n        // Map OUR callback to original callback, so .off can remove the right callback(s)\n        const cb = {\n            event,\n            stream: eventStream,\n            userCallback: typeof callback === 'function' && callback,\n            ourCallback: (err, path, newValue, oldValue, eventContext) => {\n                if (err) {\n                    // TODO: Investigate if this ever happens?\n                    this.db.debug.error(`Error getting data for event ${event} on path \"${path}\"`, err);\n                    return;\n                }\n                const ref = this.db.ref(path);\n                ref[_private].vars = PathInfo.extractVariables(this.path, path);\n                let callbackObject;\n                if (event.startsWith('notify_')) {\n                    // No data event, callback with reference\n                    callbackObject = ref.context(eventContext || {});\n                }\n                else {\n                    const values = {\n                        previous: this.db.types.deserialize(path, oldValue),\n                        current: this.db.types.deserialize(path, newValue),\n                    };\n                    if (event === 'child_removed') {\n                        callbackObject = new DataSnapshot(ref, values.previous, true, values.previous, eventContext);\n                    }\n                    else if (event === 'mutations') {\n                        callbackObject = new MutationsDataSnapshot(ref, values.current, eventContext);\n                    }\n                    else {\n                        const isRemoved = event === 'mutated' && values.current === null;\n                        callbackObject = new DataSnapshot(ref, values.current, isRemoved, values.previous, eventContext);\n                    }\n                }\n                eventPublisher.publish(callbackObject);\n                if (eventContext?.acebase_cursor) {\n                    this.cursor = eventContext.acebase_cursor;\n                }\n            },\n        };\n        this[_private].callbacks.push(cb);\n        const subscribe = () => {\n            // (NEW) Add callback to event stream\n            // ref.on('value', callback) is now exactly the same as ref.on('value').subscribe(callback)\n            if (typeof callback === 'function') {\n                eventStream.subscribe(callback, (activated, cancelReason) => {\n                    if (!activated) {\n                        cancelCallback && cancelCallback(cancelReason);\n                    }\n                });\n            }\n            const advancedOptions = typeof callback === 'object'\n                ? callback\n                : { newOnly: !callback }; // newOnly: if callback is not 'truthy', could change this to (typeof callback !== 'function' && callback !== true) but that would break client code that uses a truthy argument.\n            if (typeof advancedOptions.newOnly !== 'boolean') {\n                advancedOptions.newOnly = false;\n            }\n            if (this.isWildcardPath) {\n                advancedOptions.newOnly = true;\n            }\n            const cancelSubscription = (err) => {\n                // Access denied?\n                // Cancel subscription\n                const callbacks = this[_private].callbacks;\n                callbacks.splice(callbacks.indexOf(cb), 1);\n                this.db.api.unsubscribe(this.path, event, cb.ourCallback);\n                // Call cancelCallbacks\n                this.db.debug.error(`Subscription \"${event}\" on path \"/${this.path}\" canceled because of an error: ${err.message}`);\n                eventPublisher.cancel(err.message);\n            };\n            const authorized = this.db.api.subscribe(this.path, event, cb.ourCallback, { newOnly: advancedOptions.newOnly, cancelCallback: cancelSubscription, syncFallback: advancedOptions.syncFallback });\n            const allSubscriptionsStoppedCallback = () => {\n                const callbacks = this[_private].callbacks;\n                callbacks.splice(callbacks.indexOf(cb), 1);\n                return this.db.api.unsubscribe(this.path, event, cb.ourCallback);\n            };\n            if (authorized instanceof Promise) {\n                // Web API now returns a promise that resolves if the request is allowed\n                // and rejects when access is denied by the set security rules\n                authorized.then(() => {\n                    // Access granted\n                    eventPublisher.start(allSubscriptionsStoppedCallback);\n                }).catch(cancelSubscription);\n            }\n            else {\n                // Local API, always authorized\n                eventPublisher.start(allSubscriptionsStoppedCallback);\n            }\n            if (!advancedOptions.newOnly) {\n                // If callback param is supplied (either a callback function or true or something else truthy),\n                // it will fire events for current values right now.\n                // Otherwise, it expects the .subscribe methode to be used, which will then\n                // only be called for future events\n                if (event === 'value') {\n                    this.get(snap => {\n                        eventPublisher.publish(snap);\n                    });\n                }\n                else if (event === 'child_added') {\n                    this.get(snap => {\n                        const val = snap.val();\n                        if (val === null || typeof val !== 'object') {\n                            return;\n                        }\n                        Object.keys(val).forEach(key => {\n                            const childSnap = new DataSnapshot(this.child(key), val[key]);\n                            eventPublisher.publish(childSnap);\n                        });\n                    });\n                }\n                else if (event === 'notify_child_added') {\n                    // Use the reflect API to get current children.\n                    // NOTE: This does not work with AceBaseServer <= v0.9.7, only when signed in as admin\n                    const step = 100, limit = step;\n                    let skip = 0;\n                    const more = async () => {\n                        const children = await this.db.api.reflect(this.path, 'children', { limit, skip });\n                        children.list.forEach(child => {\n                            const childRef = this.child(child.key);\n                            eventPublisher.publish(childRef);\n                            // typeof callback === 'function' && callback(childRef);\n                        });\n                        if (children.more) {\n                            skip += step;\n                            more();\n                        }\n                    };\n                    more();\n                }\n            }\n        };\n        if (this.db.isReady) {\n            subscribe();\n        }\n        else {\n            this.db.ready(subscribe);\n        }\n        return eventStream;\n    }\n    off(event, callback) {\n        const subscriptions = this[_private].callbacks;\n        const stopSubs = subscriptions.filter(sub => (!event || sub.event === event) && (!callback || sub.userCallback === callback));\n        if (stopSubs.length === 0) {\n            this.db.debug.warn(`Can't find event subscriptions to stop (path: \"${this.path}\", event: ${event || '(any)'}, callback: ${callback})`);\n        }\n        stopSubs.forEach(sub => {\n            sub.stream.stop();\n        });\n        return this;\n    }\n    get(optionsOrCallback, callback) {\n        if (!this.db.isReady) {\n            const promise = this.db.ready().then(() => this.get(optionsOrCallback, callback));\n            return typeof optionsOrCallback !== 'function' && typeof callback !== 'function' ? promise : undefined; // only return promise if no callback is used\n        }\n        callback =\n            typeof optionsOrCallback === 'function'\n                ? optionsOrCallback\n                : typeof callback === 'function'\n                    ? callback\n                    : undefined;\n        if (this.isWildcardPath) {\n            const error = new Error(`Cannot get value of wildcard path \"/${this.path}\". Use .query() instead`);\n            if (typeof callback === 'function') {\n                throw error;\n            }\n            return Promise.reject(error);\n        }\n        const options = new DataRetrievalOptions(typeof optionsOrCallback === 'object' ? optionsOrCallback : { cache_mode: 'allow' });\n        const promise = this.db.api.get(this.path, options).then(result => {\n            const isNewApiResult = ('context' in result && 'value' in result);\n            if (!isNewApiResult) {\n                // acebase-core version package was updated but acebase or acebase-client package was not? Warn, but don't throw an error.\n                console.warn('AceBase api.get method returned an old response value. Update your acebase or acebase-client package');\n                result = { value: result, context: {} };\n            }\n            const value = this.db.types.deserialize(this.path, result.value);\n            const snapshot = new DataSnapshot(this, value, undefined, undefined, result.context);\n            if (result.context?.acebase_cursor) {\n                this.cursor = result.context.acebase_cursor;\n            }\n            return snapshot;\n        });\n        if (callback) {\n            promise.then(callback).catch(err => {\n                console.error('Uncaught error:', err);\n            });\n            return;\n        }\n        else {\n            return promise;\n        }\n    }\n    /**\n     * Waits for an event to occur\n     * @param event Name of the event, eg \"value\", \"child_added\", \"child_changed\", \"child_removed\"\n     * @param options data retrieval options, to include or exclude specific child keys\n     * @returns returns promise that resolves with a snapshot of the data\n     */\n    once(event, options) {\n        if (event === 'value' && !this.isWildcardPath) {\n            // Shortcut, do not start listening for future events\n            return this.get(options);\n        }\n        return new Promise((resolve) => {\n            const callback = (snap) => {\n                this.off(event, callback); // unsubscribe directly\n                resolve(snap);\n            };\n            this.on(event, callback);\n        });\n    }\n    /**\n     * @param value optional value to store into the database right away\n     * @param onComplete optional callback function to run once value has been stored\n     * @returns returns promise that resolves with the reference after the passed value has been stored\n     */\n    push(value, onComplete) {\n        if (this.isWildcardPath) {\n            const error = new Error(`Cannot push to wildcard path \"/${this.path}\"`);\n            if (typeof value === 'undefined' || typeof onComplete === 'function') {\n                throw error;\n            }\n            return Promise.reject(error);\n        }\n        const id = ID.generate();\n        const ref = this.child(id);\n        ref[_private].pushed = true;\n        if (typeof value !== 'undefined') {\n            return ref.set(value, onComplete).then(() => ref);\n        }\n        else {\n            return ref;\n        }\n    }\n    /**\n     * Removes this node and all children\n     */\n    async remove() {\n        if (this.isWildcardPath) {\n            throw new Error(`Cannot remove wildcard path \"/${this.path}\". Use query().remove instead`);\n        }\n        if (this.parent === null) {\n            throw new Error('Cannot remove the root node');\n        }\n        return this.set(null);\n    }\n    /**\n     * Quickly checks if this reference has a value in the database, without returning its data\n     * @returns returns a promise that resolves with a boolean value\n     */\n    async exists() {\n        if (this.isWildcardPath) {\n            throw new Error(`Cannot check wildcard path \"/${this.path}\" existence`);\n        }\n        if (!this.db.isReady) {\n            await this.db.ready();\n        }\n        return this.db.api.exists(this.path);\n    }\n    get isWildcardPath() {\n        return this.path.indexOf('*') >= 0 || this.path.indexOf('$') >= 0;\n    }\n    /**\n     * Creates a query object for current node\n     */\n    query() {\n        return new DataReferenceQuery(this);\n    }\n    /**\n     * Gets the number of children this node has, uses reflection\n     */\n    async count() {\n        const info = await this.reflect('info', { child_count: true });\n        return info.children.count;\n    }\n    async reflect(type, args) {\n        if (this.isWildcardPath) {\n            throw new Error(`Cannot reflect on wildcard path \"/${this.path}\"`);\n        }\n        if (!this.db.isReady) {\n            await this.db.ready();\n        }\n        return this.db.api.reflect(this.path, type, args);\n    }\n    async export(write, options = { format: 'json', type_safe: true }) {\n        if (this.isWildcardPath) {\n            throw new Error(`Cannot export wildcard path \"/${this.path}\"`);\n        }\n        if (!this.db.isReady) {\n            await this.db.ready();\n        }\n        const writeFn = typeof write === 'function' ? write : write.write.bind(write);\n        return this.db.api.export(this.path, writeFn, options);\n    }\n    /**\n     * Imports the value of this node and all children\n     * @param read Function that reads data from your stream\n     * @param options Only supported format currently is json\n     * @returns returns a promise that resolves once all data is imported\n     */\n    async import(read, options = { format: 'json', suppress_events: false }) {\n        if (this.isWildcardPath) {\n            throw new Error(`Cannot import to wildcard path \"/${this.path}\"`);\n        }\n        if (!this.db.isReady) {\n            await this.db.ready();\n        }\n        return this.db.api.import(this.path, read, options);\n    }\n    proxy(options) {\n        const isOptionsArg = typeof options === 'object' && (typeof options.cursor !== 'undefined' || typeof options.defaultValue !== 'undefined');\n        if (typeof options !== 'undefined' && !isOptionsArg) {\n            this.db.debug.warn('Warning: live data proxy is being initialized with a deprecated method signature. Use ref.proxy(options) instead of ref.proxy(defaultValue)');\n            options = { defaultValue: options };\n        }\n        return LiveDataProxy.create(this, options);\n    }\n    /**\n      * @param options optional initial data retrieval options.\n      * Not recommended to use yet - given includes/excludes are not applied to received mutations,\n      * or sync actions when using an AceBaseClient with cache db.\n      */\n    observe(options) {\n        // options should not be used yet - we can't prevent/filter mutation events on excluded paths atm\n        if (options) {\n            throw new Error('observe does not support data retrieval options yet');\n        }\n        if (this.isWildcardPath) {\n            throw new Error(`Cannot observe wildcard path \"/${this.path}\"`);\n        }\n        const Observable = getObservable();\n        return new Observable((observer => {\n            let cache, resolved = false;\n            let promise = this.get(options).then(snap => {\n                resolved = true;\n                cache = snap.val();\n                observer.next(cache);\n            });\n            const updateCache = (snap) => {\n                if (!resolved) {\n                    promise = promise.then(() => updateCache(snap));\n                    return;\n                }\n                const mutatedPath = snap.ref.path;\n                if (mutatedPath === this.path) {\n                    cache = snap.val();\n                    return observer.next(cache);\n                }\n                const trailKeys = PathInfo.getPathKeys(mutatedPath).slice(PathInfo.getPathKeys(this.path).length);\n                let target = cache;\n                while (trailKeys.length > 1) {\n                    const key = trailKeys.shift();\n                    if (!(key in target)) {\n                        // Happens if initial loaded data did not include / excluded this data,\n                        // or we missed out on an event\n                        target[key] = typeof trailKeys[0] === 'number' ? [] : {};\n                    }\n                    target = target[key];\n                }\n                const prop = trailKeys.shift();\n                const newValue = snap.val();\n                if (newValue === null) {\n                    // Remove it\n                    target instanceof Array && typeof prop === 'number' ? target.splice(prop, 1) : delete target[prop];\n                }\n                else {\n                    // Set or update it\n                    target[prop] = newValue;\n                }\n                observer.next(cache);\n            };\n            this.on('mutated', updateCache); // TODO: Refactor to 'mutations' event instead\n            // Return unsubscribe function\n            return () => {\n                this.off('mutated', updateCache);\n            };\n        }));\n    }\n    async forEach(callbackOrOptions, callback) {\n        let options;\n        if (typeof callbackOrOptions === 'function') {\n            callback = callbackOrOptions;\n        }\n        else {\n            options = callbackOrOptions;\n        }\n        if (typeof callback !== 'function') {\n            throw new TypeError('No callback function given');\n        }\n        // Get all children through reflection. This could be tweaked further using paging\n        const info = await this.reflect('children', { limit: 0, skip: 0 }); // Gets ALL child keys\n        const summary = {\n            canceled: false,\n            total: info.list.length,\n            processed: 0,\n        };\n        // Iterate through all children until callback returns false\n        for (let i = 0; i < info.list.length; i++) {\n            const key = info.list[i].key;\n            // Get child data\n            const snapshot = await this.child(key).get(options);\n            summary.processed++;\n            if (!snapshot.exists()) {\n                // Was removed in the meantime, skip\n                continue;\n            }\n            // Run callback\n            const result = await callback(snapshot);\n            if (result === false) {\n                summary.canceled = true;\n                break; // Stop looping\n            }\n        }\n        return summary;\n    }\n    async getMutations(cursorOrDate) {\n        const cursor = typeof cursorOrDate === 'string' ? cursorOrDate : undefined;\n        const timestamp = cursorOrDate === null || typeof cursorOrDate === 'undefined' ? 0 : cursorOrDate instanceof Date ? cursorOrDate.getTime() : undefined;\n        return this.db.api.getMutations({ path: this.path, cursor, timestamp });\n    }\n    async getChanges(cursorOrDate) {\n        const cursor = typeof cursorOrDate === 'string' ? cursorOrDate : undefined;\n        const timestamp = cursorOrDate === null || typeof cursorOrDate === 'undefined' ? 0 : cursorOrDate instanceof Date ? cursorOrDate.getTime() : undefined;\n        return this.db.api.getChanges({ path: this.path, cursor, timestamp });\n    }\n}\nexport class DataReferenceQuery {\n    /**\n     * Creates a query on a reference\n     */\n    constructor(ref) {\n        this.ref = ref;\n        this[_private] = {\n            filters: [],\n            skip: 0,\n            take: 0,\n            order: [],\n            events: {},\n        };\n    }\n    /**\n     * Applies a filter to the children of the refence being queried.\n     * If there is an index on the property key being queried, it will be used\n     * to speed up the query\n     * @param key property to test value of\n     * @param op operator to use\n     * @param compare value to compare with\n     */\n    filter(key, op, compare) {\n        if ((op === 'in' || op === '!in') && (!(compare instanceof Array) || compare.length === 0)) {\n            throw new Error(`${op} filter for ${key} must supply an Array compare argument containing at least 1 value`);\n        }\n        if ((op === 'between' || op === '!between') && (!(compare instanceof Array) || compare.length !== 2)) {\n            throw new Error(`${op} filter for ${key} must supply an Array compare argument containing 2 values`);\n        }\n        if ((op === 'matches' || op === '!matches') && !(compare instanceof RegExp)) {\n            throw new Error(`${op} filter for ${key} must supply a RegExp compare argument`);\n        }\n        // DISABLED 2019/10/23 because it is not fully implemented only works locally\n        // if (op === \"custom\" && typeof compare !== \"function\") {\n        //     throw `${op} filter for ${key} must supply a Function compare argument`;\n        // }\n        // DISABLED 2022/08/15, implemented by query.ts in acebase\n        // if ((op === 'contains' || op === '!contains') && ((typeof compare === 'object' && !(compare instanceof Array) && !(compare instanceof Date)) || (compare instanceof Array && compare.length === 0))) {\n        //     throw new Error(`${op} filter for ${key} must supply a simple value or (non-zero length) array compare argument`);\n        // }\n        this[_private].filters.push({ key, op, compare });\n        return this;\n    }\n    /**\n     * @deprecated use `.filter` instead\n     */\n    where(key, op, compare) {\n        return this.filter(key, op, compare);\n    }\n    /**\n     * Limits the number of query results\n     */\n    take(n) {\n        this[_private].take = n;\n        return this;\n    }\n    /**\n     * Skips the first n query results\n     */\n    skip(n) {\n        this[_private].skip = n;\n        return this;\n    }\n    sort(key, ascending = true) {\n        if (!['string', 'number'].includes(typeof key)) {\n            throw 'key must be a string or number';\n        }\n        this[_private].order.push({ key, ascending });\n        return this;\n    }\n    /**\n     * @deprecated use `.sort` instead\n     */\n    order(key, ascending = true) {\n        return this.sort(key, ascending);\n    }\n    get(optionsOrCallback, callback) {\n        if (!this.ref.db.isReady) {\n            const promise = this.ref.db.ready().then(() => this.get(optionsOrCallback, callback));\n            return typeof optionsOrCallback !== 'function' && typeof callback !== 'function' ? promise : undefined; // only return promise if no callback is used\n        }\n        callback =\n            typeof optionsOrCallback === 'function'\n                ? optionsOrCallback\n                : typeof callback === 'function'\n                    ? callback\n                    : undefined;\n        const options = new QueryDataRetrievalOptions(typeof optionsOrCallback === 'object' ? optionsOrCallback : { snapshots: true, cache_mode: 'allow' });\n        options.allow_cache = options.cache_mode !== 'bypass'; // Backward compatibility when using older acebase-client\n        options.eventHandler = ev => {\n            // TODO: implement context for query events\n            if (!this[_private].events[ev.name]) {\n                return false;\n            }\n            const listeners = this[_private].events[ev.name];\n            if (typeof listeners !== 'object' || listeners.length === 0) {\n                return false;\n            }\n            if (['add', 'change', 'remove'].includes(ev.name)) {\n                const eventData = {\n                    name: ev.name,\n                    ref: new DataReference(this.ref.db, ev.path),\n                };\n                if (options.snapshots && ev.name !== 'remove') {\n                    const val = db.types.deserialize(ev.path, ev.value);\n                    eventData.snapshot = new DataSnapshot(eventData.ref, val, false);\n                }\n                ev = eventData;\n            }\n            listeners.forEach(callback => {\n                try {\n                    callback(ev);\n                }\n                catch (err) {\n                    this.ref.db.debug.error(`Error executing \"${ev.name}\" event handler of realtime query on path \"${this.ref.path}\": ${err?.stack ?? err?.message ?? err}`);\n                }\n            });\n        };\n        // Check if there are event listeners set for realtime changes\n        options.monitor = { add: false, change: false, remove: false };\n        if (this[_private].events) {\n            if (this[_private].events['add'] && this[_private].events['add'].length > 0) {\n                options.monitor.add = true;\n            }\n            if (this[_private].events['change'] && this[_private].events['change'].length > 0) {\n                options.monitor.change = true;\n            }\n            if (this[_private].events['remove'] && this[_private].events['remove'].length > 0) {\n                options.monitor.remove = true;\n            }\n        }\n        // Stop realtime results if they are still enabled on a previous .get on this instance\n        this.stop();\n        // NOTE: returning promise here, regardless of callback argument. Good argument to refactor method to async/await soon\n        const db = this.ref.db;\n        return db.api.query(this.ref.path, this[_private], options)\n            .catch(err => {\n            throw new Error(err);\n        })\n            .then(res => {\n            const { stop } = res;\n            let { results, context } = res;\n            this.stop = async () => {\n                await stop();\n            };\n            if (!('results' in res && 'context' in res)) {\n                console.warn('Query results missing context. Update your acebase and/or acebase-client packages');\n                results = res, context = {};\n            }\n            if (options.snapshots) {\n                const snaps = results.map(result => {\n                    const val = db.types.deserialize(result.path, result.val);\n                    return new DataSnapshot(db.ref(result.path), val, false, undefined, context);\n                });\n                return DataSnapshotsArray.from(snaps);\n            }\n            else {\n                const refs = results.map(path => db.ref(path));\n                return DataReferencesArray.from(refs);\n            }\n        })\n            .then(results => {\n            callback && callback(results);\n            return results;\n        });\n    }\n    /**\n     * Stops a realtime query, no more notifications will be received.\n     */\n    async stop() {\n        // Overridden by .get\n    }\n    /**\n     * Executes the query and returns references. Short for `.get({ snapshots: false })`\n     * @param callback callback to use instead of returning a promise\n     * @returns returns an Promise that resolves with an array of DataReferences, or void when using a callback\n     * @deprecated Use `find` instead\n     */\n    getRefs(callback) {\n        return this.get({ snapshots: false }, callback);\n    }\n    /**\n     * Executes the query and returns an array of references. Short for `.get({ snapshots: false })`\n     */\n    find() {\n        return this.get({ snapshots: false });\n    }\n    /**\n     * Executes the query and returns the number of results\n     */\n    async count() {\n        const refs = await this.find();\n        return refs.length;\n    }\n    /**\n     * Executes the query and returns if there are any results\n     */\n    async exists() {\n        const originalTake = this[_private].take;\n        const p = this.take(1).find();\n        this.take(originalTake);\n        const refs = await p;\n        return refs.length !== 0;\n    }\n    /**\n     * Executes the query, removes all matches from the database\n     * @returns returns a Promise that resolves once all matches have been removed\n     */\n    async remove(callback) {\n        const refs = await this.find();\n        // Perform updates on each distinct parent collection (only 1 parent if this is not a wildcard path)\n        const parentUpdates = refs.reduce((parents, ref) => {\n            const parent = parents[ref.parent.path];\n            if (!parent) {\n                parents[ref.parent.path] = [ref];\n            }\n            else {\n                parent.push(ref);\n            }\n            return parents;\n        }, {});\n        const db = this.ref.db;\n        const promises = Object.keys(parentUpdates).map(async (parentPath) => {\n            const updates = refs.reduce((updates, ref) => {\n                updates[ref.key] = null;\n                return updates;\n            }, {});\n            const ref = db.ref(parentPath);\n            try {\n                await ref.update(updates);\n                return { ref, success: true };\n            }\n            catch (error) {\n                return { ref, success: false, error };\n            }\n        });\n        const results = await Promise.all(promises);\n        callback && callback(results);\n        return results;\n    }\n    on(event, callback) {\n        if (!this[_private].events[event]) {\n            this[_private].events[event] = [];\n        }\n        this[_private].events[event].push(callback);\n        return this;\n    }\n    /**\n     * Unsubscribes from (a) previously added event(s)\n     * @param event Name of the event\n     * @param callback callback function to remove\n     * @returns returns reference to this query\n     */\n    off(event, callback) {\n        if (typeof event === 'undefined') {\n            this[_private].events = {};\n            return this;\n        }\n        if (!this[_private].events[event]) {\n            return this;\n        }\n        if (typeof callback === 'undefined') {\n            delete this[_private].events[event];\n            return this;\n        }\n        const index = this[_private].events[event].indexOf(callback);\n        if (!~index) {\n            return this;\n        }\n        this[_private].events[event].splice(index, 1);\n        return this;\n    }\n    async forEach(callbackOrOptions, callback) {\n        let options;\n        if (typeof callbackOrOptions === 'function') {\n            callback = callbackOrOptions;\n        }\n        else {\n            options = callbackOrOptions;\n        }\n        if (typeof callback !== 'function') {\n            throw new TypeError('No callback function given');\n        }\n        // Get all query results. This could be tweaked further using paging\n        const refs = await this.find();\n        const summary = {\n            canceled: false,\n            total: refs.length,\n            processed: 0,\n        };\n        // Iterate through all children until callback returns false\n        for (let i = 0; i < refs.length; i++) {\n            const ref = refs[i];\n            // Get child data\n            const snapshot = await ref.get(options);\n            summary.processed++;\n            if (!snapshot.exists()) {\n                // Was removed in the meantime, skip\n                continue;\n            }\n            // Run callback\n            const result = await callback(snapshot);\n            if (result === false) {\n                summary.canceled = true;\n                break; // Stop looping\n            }\n        }\n        return summary;\n    }\n}\nexport class DataSnapshotsArray extends Array {\n    static from(snaps) {\n        const arr = new DataSnapshotsArray(snaps.length);\n        snaps.forEach((snap, i) => arr[i] = snap);\n        return arr;\n    }\n    getValues() {\n        return this.map(snap => snap.val());\n    }\n}\nexport class DataReferencesArray extends Array {\n    static from(refs) {\n        const arr = new DataReferencesArray(refs.length);\n        refs.forEach((ref, i) => arr[i] = ref);\n        return arr;\n    }\n    getPaths() {\n        return this.map(ref => ref.path);\n    }\n}\n//# sourceMappingURL=data-reference.js.map","import { cloneObject } from './utils.js';\nimport { PathInfo } from './path-info.js';\nimport { DataReference } from './data-reference.js';\nimport { DataSnapshot } from './data-snapshot.js';\n/**\n * (for internal use) - gets the mapping set for a specific path\n */\nfunction get(mappings, path) {\n    // path points to the mapped (object container) location\n    path = path.replace(/^\\/|\\/$/g, ''); // trim slashes\n    const keys = PathInfo.getPathKeys(path);\n    const mappedPath = Object.keys(mappings).find(mpath => {\n        const mkeys = PathInfo.getPathKeys(mpath);\n        if (mkeys.length !== keys.length) {\n            return false; // Can't be a match\n        }\n        return mkeys.every((mkey, index) => {\n            if (mkey === '*' || (typeof mkey === 'string' && mkey[0] === '$')) {\n                return true; // wildcard\n            }\n            return mkey === keys[index];\n        });\n    });\n    const mapping = mappings[mappedPath];\n    return mapping;\n}\n/**\n * (for internal use) - gets the mapping set for a specific path's parent\n */\nfunction map(mappings, path) {\n    // path points to the object location, its parent should have the mapping\n    const targetPath = PathInfo.get(path).parentPath;\n    if (targetPath === null) {\n        return;\n    }\n    return get(mappings, targetPath);\n}\n/**\n * (for internal use) - gets all mappings set for a specific path and all subnodes\n * @returns returns array of all matched mappings in path\n */\nfunction mapDeep(mappings, entryPath) {\n    // returns mapping for this node, and all mappings for nested nodes\n    // entryPath: \"users/ewout\"\n    // mappingPath: \"users\"\n    // mappingPath: \"users/*/posts\"\n    entryPath = entryPath.replace(/^\\/|\\/$/g, ''); // trim slashes\n    // Start with current path's parent node\n    const pathInfo = PathInfo.get(entryPath);\n    const startPath = pathInfo.parentPath;\n    const keys = startPath ? PathInfo.getPathKeys(startPath) : [];\n    // Every path that starts with startPath, is a match\n    // TODO: refactor to return Object.keys(mappings),filter(...)\n    const matches = Object.keys(mappings).reduce((m, mpath) => {\n        //const mkeys = mpath.length > 0 ? mpath.split(\"/\") : [];\n        const mkeys = PathInfo.getPathKeys(mpath);\n        if (mkeys.length < keys.length) {\n            return m; // Can't be a match\n        }\n        let isMatch = true;\n        if (keys.length === 0 && startPath !== null) {\n            // Only match first node's children if mapping pattern is \"*\" or \"$variable\"\n            isMatch = mkeys.length === 1 && (mkeys[0] === '*' || (typeof mkeys[0] === 'string' && mkeys[0][0] === '$'));\n        }\n        else {\n            mkeys.every((mkey, index) => {\n                if (index >= keys.length) {\n                    return false; // stop .every loop\n                }\n                else if ((mkey === '*' || (typeof mkey === 'string' && mkey[0] === '$')) || mkey === keys[index]) {\n                    return true; // continue .every loop\n                }\n                else {\n                    isMatch = false;\n                    return false; // stop .every loop\n                }\n            });\n        }\n        if (isMatch) {\n            const mapping = mappings[mpath];\n            m.push({ path: mpath, type: mapping });\n        }\n        return m;\n    }, []);\n    return matches;\n}\n/**\n * (for internal use) - serializes or deserializes an object using type mappings\n * @returns returns the (de)serialized value\n */\nfunction process(db, mappings, path, obj, action) {\n    if (obj === null || typeof obj !== 'object') {\n        return obj;\n    }\n    const keys = PathInfo.getPathKeys(path); // path.length > 0 ? path.split(\"/\") : [];\n    const m = mapDeep(mappings, path);\n    const changes = [];\n    m.sort((a, b) => PathInfo.getPathKeys(a.path).length > PathInfo.getPathKeys(b.path).length ? -1 : 1); // Deepest paths first\n    m.forEach(mapping => {\n        const mkeys = PathInfo.getPathKeys(mapping.path); //mapping.path.length > 0 ? mapping.path.split(\"/\") : [];\n        mkeys.push('*');\n        const mTrailKeys = mkeys.slice(keys.length);\n        if (mTrailKeys.length === 0) {\n            const vars = PathInfo.extractVariables(mapping.path, path);\n            const ref = new DataReference(db, path, vars);\n            if (action === 'serialize') {\n                // serialize this object\n                obj = mapping.type.serialize(obj, ref);\n            }\n            else if (action === 'deserialize') {\n                // deserialize this object\n                const snap = new DataSnapshot(ref, obj);\n                obj = mapping.type.deserialize(snap);\n            }\n            return;\n        }\n        // Find all nested objects at this trail path\n        const process = (parentPath, parent, keys) => {\n            if (obj === null || typeof obj !== 'object') {\n                return obj;\n            }\n            const key = keys[0];\n            let children = [];\n            if (key === '*' || (typeof key === 'string' && key[0] === '$')) {\n                // Include all children\n                if (parent instanceof Array) {\n                    children = parent.map((val, index) => ({ key: index, val }));\n                }\n                else {\n                    children = Object.keys(parent).map(k => ({ key: k, val: parent[k] }));\n                }\n            }\n            else {\n                // Get the 1 child\n                const child = parent[key];\n                if (typeof child === 'object') {\n                    children.push({ key, val: child });\n                }\n            }\n            children.forEach(child => {\n                const childPath = PathInfo.getChildPath(parentPath, child.key);\n                const vars = PathInfo.extractVariables(mapping.path, childPath);\n                const ref = new DataReference(db, childPath, vars);\n                if (keys.length === 1) {\n                    // TODO: this alters the existing object, we must build our own copy!\n                    if (action === 'serialize') {\n                        // serialize this object\n                        changes.push({ parent, key: child.key, original: parent[child.key] });\n                        parent[child.key] = mapping.type.serialize(child.val, ref);\n                    }\n                    else if (action === 'deserialize') {\n                        // deserialize this object\n                        const snap = new DataSnapshot(ref, child.val);\n                        parent[child.key] = mapping.type.deserialize(snap);\n                    }\n                }\n                else {\n                    // Dig deeper\n                    process(childPath, child.val, keys.slice(1));\n                }\n            });\n        };\n        process(path, obj, mTrailKeys);\n    });\n    if (action === 'serialize') {\n        // Clone this serialized object so any types that remained\n        // will become plain objects without functions, and we can restore\n        // the original object's values if any mappings were processed.\n        // This will also prevent circular references\n        obj = cloneObject(obj);\n        if (changes.length > 0) {\n            // Restore the changes made to the original object\n            changes.forEach(change => {\n                change.parent[change.key] = change.original;\n            });\n        }\n    }\n    return obj;\n}\nconst _mappings = Symbol('mappings');\nexport class TypeMappings {\n    constructor(db) {\n        this.db = db;\n        this[_mappings] = {};\n    }\n    /** (for internal use) */\n    get mappings() { return this[_mappings]; }\n    /** (for internal use) */\n    map(path) {\n        return map(this[_mappings], path);\n    }\n    /**\n     * Maps objects that are stored in a specific path to a class, so they can automatically be\n     * serialized when stored to, and deserialized (instantiated) when loaded from the database.\n     * @param path path to an object container, eg \"users\" or \"users/*\\/posts\"\n     * @param type class to bind all child objects of path to\n     * Best practice is to implement 2 methods for instantiation and serializing of your objects:\n     * 1) `static create(snap: DataSnapshot)` and 2) `serialize(ref: DataReference)`. See example\n     * @param options (optional) You can specify the functions to use to\n     * serialize and/or instantiate your class. If you do not specificy a creator (constructor) method,\n     * AceBase will call `YourClass.create(snapshot)` method if it exists, or create an instance of\n     * YourClass with `new YourClass(snapshot)`.\n     * If you do not specifiy a serializer method, AceBase will call `YourClass.prototype.serialize(ref)`\n     * if it exists, or tries storing your object's fields unaltered. NOTE: `this` in your creator\n     * function will point to `YourClass`, and `this` in your serializer function will point to the\n     * `instance` of `YourClass`.\n     * @example\n     * class User {\n     *    static create(snap: DataSnapshot): User {\n     *        // Deserialize (instantiate) User from plain database object\n     *        let user = new User();\n     *        Object.assign(user, snap.val()); // Copy all properties to user\n     *        user.id = snap.ref.key; // Add the key as id\n     *        return user;\n     *    }\n     *    serialize(ref: DataReference) {\n     *        // Serialize user for database storage\n     *        return {\n     *            name: this.name\n     *            email: this.email\n     *        };\n     *    }\n     * }\n     * db.types.bind('users', User); // Automatically uses serialize and static create methods\n     */\n    bind(path, type, options = {}) {\n        // Maps objects that are stored in a specific path to a constructor method,\n        // so they are automatically deserialized\n        if (typeof path !== 'string') {\n            throw new TypeError('path must be a string');\n        }\n        if (typeof type !== 'function') {\n            throw new TypeError('constructor must be a function');\n        }\n        if (typeof options.serializer === 'undefined') {\n            // if (typeof type.prototype.serialize === 'function') {\n            //     // Use .serialize instance method\n            //     options.serializer = type.prototype.serialize;\n            // }\n            // Use object's serialize method upon serialization (if available)\n        }\n        else if (typeof options.serializer === 'string') {\n            if (typeof type.prototype[options.serializer] === 'function') {\n                options.serializer = type.prototype[options.serializer];\n            }\n            else {\n                throw new TypeError(`${type.name}.prototype.${options.serializer} is not a function, cannot use it as serializer`);\n            }\n        }\n        else if (typeof options.serializer !== 'function') {\n            throw new TypeError(`serializer for class ${type.name} must be a function, or the name of a prototype method`);\n        }\n        if (typeof options.creator === 'undefined') {\n            if (typeof type.create === 'function') {\n                // Use static .create as creator method\n                options.creator = type.create;\n            }\n        }\n        else if (typeof options.creator === 'string') {\n            if (typeof type[options.creator] === 'function') {\n                options.creator = type[options.creator];\n            }\n            else {\n                throw new TypeError(`${type.name}.${options.creator} is not a function, cannot use it as creator`);\n            }\n        }\n        else if (typeof options.creator !== 'function') {\n            throw new TypeError(`creator for class ${type.name} must be a function, or the name of a static method`);\n        }\n        path = path.replace(/^\\/|\\/$/g, ''); // trim slashes\n        this[_mappings][path] = {\n            db: this.db,\n            type,\n            creator: options.creator,\n            serializer: options.serializer,\n            deserialize(snap) {\n                // run constructor method\n                let obj;\n                if (this.creator) {\n                    obj = this.creator.call(this.type, snap);\n                }\n                else {\n                    obj = new this.type(snap);\n                }\n                return obj;\n            },\n            serialize(obj, ref) {\n                if (this.serializer) {\n                    obj = this.serializer.call(obj, ref, obj);\n                }\n                else if (obj && typeof obj.serialize === 'function') {\n                    obj = obj.serialize(ref, obj);\n                }\n                return obj;\n            },\n        };\n    }\n    /**\n     * @internal (for internal use)\n     * Serializes any child in given object that has a type mapping\n     * @param path | path to the object's location\n     * @param obj object to serialize\n     */\n    serialize(path, obj) {\n        return process(this.db, this[_mappings], path, obj, 'serialize');\n    }\n    /**\n     * @internal (for internal use)\n     * Deserialzes any child in given object that has a type mapping\n     * @param path path to the object's location\n     * @param obj object to deserialize\n     */\n    deserialize(path, obj) {\n        return process(this.db, this[_mappings], path, obj, 'deserialize');\n    }\n}\n//# sourceMappingURL=type-mappings.js.map","import process from './process/index.js';\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst noop = () => { };\nexport class DebugLogger {\n    constructor(level = 'log', prefix = '') {\n        this.level = level;\n        this.prefix = prefix;\n        this.setLevel(level);\n    }\n    setLevel(level) {\n        const prefix = this.prefix ? this.prefix + ' %s' : '';\n        this.verbose = ['verbose'].includes(level) ? prefix ? console.log.bind(console, prefix) : console.log.bind(console) : noop;\n        this.log = ['verbose', 'log'].includes(level) ? prefix ? console.log.bind(console, prefix) : console.log.bind(console) : noop;\n        this.warn = ['verbose', 'log', 'warn'].includes(level) ? prefix ? console.warn.bind(console, prefix) : console.warn.bind(console) : noop;\n        this.error = ['verbose', 'log', 'warn', 'error'].includes(level) ? prefix ? console.error.bind(console, prefix) : console.error.bind(console) : noop;\n        this.write = (text) => {\n            const isRunKit = typeof process !== 'undefined' && process.env && typeof process.env.RUNKIT_ENDPOINT_PATH === 'string';\n            if (text && isRunKit) {\n                text.split('\\n').forEach(line => console.log(line)); // Logs each line separately\n            }\n            else {\n                console.log(text);\n            }\n        };\n    }\n}\n//# sourceMappingURL=debug.js.map","import process from './process/index.js';\n// See from https://en.wikipedia.org/wiki/ANSI_escape_code\nconst FontCode = {\n    bold: 1,\n    dim: 2,\n    italic: 3,\n    underline: 4,\n    inverse: 7,\n    hidden: 8,\n    strikethrough: 94,\n};\nconst ColorCode = {\n    black: 30,\n    red: 31,\n    green: 32,\n    yellow: 33,\n    blue: 34,\n    magenta: 35,\n    cyan: 36,\n    white: 37,\n    grey: 90,\n    // Bright colors:\n    brightRed: 91,\n    // TODO, other bright colors\n};\nconst BgColorCode = {\n    bgBlack: 40,\n    bgRed: 41,\n    bgGreen: 42,\n    bgYellow: 43,\n    bgBlue: 44,\n    bgMagenta: 45,\n    bgCyan: 46,\n    bgWhite: 47,\n    bgGrey: 100,\n    bgBrightRed: 101,\n    // TODO, other bright colors\n};\nconst ResetCode = {\n    all: 0,\n    color: 39,\n    background: 49,\n    bold: 22,\n    dim: 22,\n    italic: 23,\n    underline: 24,\n    inverse: 27,\n    hidden: 28,\n    strikethrough: 29,\n};\nexport var ColorStyle;\n(function (ColorStyle) {\n    ColorStyle[\"reset\"] = \"reset\";\n    ColorStyle[\"bold\"] = \"bold\";\n    ColorStyle[\"dim\"] = \"dim\";\n    ColorStyle[\"italic\"] = \"italic\";\n    ColorStyle[\"underline\"] = \"underline\";\n    ColorStyle[\"inverse\"] = \"inverse\";\n    ColorStyle[\"hidden\"] = \"hidden\";\n    ColorStyle[\"strikethrough\"] = \"strikethrough\";\n    ColorStyle[\"black\"] = \"black\";\n    ColorStyle[\"red\"] = \"red\";\n    ColorStyle[\"green\"] = \"green\";\n    ColorStyle[\"yellow\"] = \"yellow\";\n    ColorStyle[\"blue\"] = \"blue\";\n    ColorStyle[\"magenta\"] = \"magenta\";\n    ColorStyle[\"cyan\"] = \"cyan\";\n    ColorStyle[\"grey\"] = \"grey\";\n    ColorStyle[\"bgBlack\"] = \"bgBlack\";\n    ColorStyle[\"bgRed\"] = \"bgRed\";\n    ColorStyle[\"bgGreen\"] = \"bgGreen\";\n    ColorStyle[\"bgYellow\"] = \"bgYellow\";\n    ColorStyle[\"bgBlue\"] = \"bgBlue\";\n    ColorStyle[\"bgMagenta\"] = \"bgMagenta\";\n    ColorStyle[\"bgCyan\"] = \"bgCyan\";\n    ColorStyle[\"bgWhite\"] = \"bgWhite\";\n    ColorStyle[\"bgGrey\"] = \"bgGrey\";\n})(ColorStyle || (ColorStyle = {}));\nexport function ColorsSupported() {\n    // Checks for basic color support\n    if (typeof process === 'undefined' || !process.stdout || !process.env || !process.platform || process.platform === 'browser') {\n        return false;\n    }\n    if (process.platform === 'win32') {\n        return true;\n    }\n    const env = process.env;\n    if (env.COLORTERM) {\n        return true;\n    }\n    if (env.TERM === 'dumb') {\n        return false;\n    }\n    if (env.CI || env.TEAMCITY_VERSION) {\n        return !!env.TRAVIS;\n    }\n    if (['iTerm.app', 'HyperTerm', 'Hyper', 'MacTerm', 'Apple_Terminal', 'vscode'].includes(env.TERM_PROGRAM)) {\n        return true;\n    }\n    if (/^xterm-256|^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(env.TERM)) {\n        return true;\n    }\n    return false;\n}\nlet _enabled = ColorsSupported();\nexport function SetColorsEnabled(enabled) {\n    _enabled = ColorsSupported() && enabled;\n}\nexport function Colorize(str, style) {\n    if (!_enabled) {\n        return str;\n    }\n    const openCodes = [], closeCodes = [];\n    const addStyle = (style) => {\n        if (style === ColorStyle.reset) {\n            openCodes.push(ResetCode.all);\n        }\n        else if (style in FontCode) {\n            openCodes.push(FontCode[style]);\n            closeCodes.push(ResetCode[style]);\n        }\n        else if (style in ColorCode) {\n            openCodes.push(ColorCode[style]);\n            closeCodes.push(ResetCode.color);\n        }\n        else if (style in BgColorCode) {\n            openCodes.push(BgColorCode[style]);\n            closeCodes.push(ResetCode.background);\n        }\n    };\n    if (style instanceof Array) {\n        style.forEach(addStyle);\n    }\n    else {\n        addStyle(style);\n    }\n    // const open = '\\u001b[' + openCodes.join(';') + 'm';\n    // const close = '\\u001b[' + closeCodes.join(';') + 'm';\n    const open = openCodes.map(code => '\\u001b[' + code + 'm').join('');\n    const close = closeCodes.map(code => '\\u001b[' + code + 'm').join('');\n    // return open + str + close;\n    return str.split('\\n').map(line => open + line + close).join('\\n');\n}\nString.prototype.colorize = function (style) {\n    return Colorize(this, style);\n};\n//# sourceMappingURL=simple-colors.js.map","/**\n   ________________________________________________________________________________\n\n      ___          ______\n     / _ \\         | ___ \\\n    / /_\\ \\ ___ ___| |_/ / __ _ ___  ___\n    |  _  |/ __/ _ \\ ___ \\/ _` / __|/ _ \\\n    | | | | (_|  __/ |_/ / (_| \\__ \\  __/\n    \\_| |_/\\___\\___\\____/ \\__,_|___/\\___|\n                        realtime database\n\n   Copyright 2018-2022 by Ewout Stortenbeker (me@appy.one)\n   Published under MIT license\n\n   See docs at https://github.com/appy-one/acebase\n   ________________________________________________________________________________\n\n*/\nimport { SimpleEventEmitter } from './simple-event-emitter.js';\nimport { DataReference, DataReferenceQuery } from './data-reference.js';\nimport { TypeMappings } from './type-mappings.js';\nimport { setObservable } from './optional-observable.js';\nimport { DebugLogger } from './debug.js';\nimport { ColorStyle, SetColorsEnabled } from './simple-colors.js';\nexport class AceBaseBaseSettings {\n    constructor(options) {\n        /**\n         * What level to use for console logging.\n         * @default 'log'\n         */\n        this.logLevel = 'log';\n        /**\n         * Whether to use colors in the console logs output\n         * @default true\n         */\n        this.logColors = true;\n        /**\n         * @internal (for internal use)\n         */\n        this.info = 'realtime database';\n        /**\n         * You can turn this on if you are a sponsor. See https://github.com/appy-one/acebase/discussions/100 for more info\n         */\n        this.sponsor = false;\n        if (typeof options !== 'object') {\n            options = {};\n        }\n        if (typeof options.logLevel === 'string') {\n            this.logLevel = options.logLevel;\n        }\n        if (typeof options.logColors === 'boolean') {\n            this.logColors = options.logColors;\n        }\n        if (typeof options.info === 'string') {\n            this.info = options.info;\n        }\n        if (typeof options.sponsor === 'boolean') {\n            this.sponsor = options.sponsor;\n        }\n    }\n}\nexport class AceBaseBase extends SimpleEventEmitter {\n    /**\n     * @param dbname Name of the database to open or create\n     */\n    constructor(dbname, options = {}) {\n        super();\n        this._ready = false;\n        options = new AceBaseBaseSettings(options);\n        this.name = dbname;\n        // Setup console logging\n        this.debug = new DebugLogger(options.logLevel, `[${dbname}]`);\n        // Enable/disable logging with colors\n        SetColorsEnabled(options.logColors);\n        // ASCI art: http://patorjk.com/software/taag/#p=display&f=Doom&t=AceBase\n        const logoStyle = [ColorStyle.magenta, ColorStyle.bold];\n        const logo = '     ___          ______                ' + '\\n' +\n            '    / _ \\\\         | ___ \\\\               ' + '\\n' +\n            '   / /_\\\\ \\\\ ___ ___| |_/ / __ _ ___  ___ ' + '\\n' +\n            '   |  _  |/ __/ _ \\\\ ___ \\\\/ _` / __|/ _ \\\\' + '\\n' +\n            '   | | | | (_|  __/ |_/ / (_| \\\\__ \\\\  __/' + '\\n' +\n            '   \\\\_| |_/\\\\___\\\\___\\\\____/ \\\\__,_|___/\\\\___|';\n        const info = (options.info ? ''.padStart(40 - options.info.length, ' ') + options.info + '\\n' : '');\n        if (!options.sponsor) {\n            // if you are a sponsor, you can switch off the \"AceBase banner ad\"\n            this.debug.write(logo.colorize(logoStyle));\n            info && this.debug.write(info.colorize(ColorStyle.magenta));\n        }\n        // Setup type mapping functionality\n        this.types = new TypeMappings(this);\n        this.once('ready', () => {\n            // console.log(`database \"${dbname}\" (${this.constructor.name}) is ready to use`);\n            this._ready = true;\n        });\n    }\n    /**\n     * Waits for the database to be ready before running your callback.\n     * @param callback (optional) callback function that is called when the database is ready to be used. You can also use the returned promise.\n     * @returns returns a promise that resolves when ready\n     */\n    async ready(callback) {\n        if (!this._ready) {\n            // Wait for ready event\n            await new Promise(resolve => this.on('ready', resolve));\n        }\n        callback?.();\n    }\n    get isReady() {\n        return this._ready;\n    }\n    /**\n     * Allow specific observable implementation to be used\n     * @param ObservableImpl Implementation to use\n     */\n    setObservable(ObservableImpl) {\n        setObservable(ObservableImpl);\n    }\n    /**\n     * Creates a reference to a node\n     * @param path\n     * @returns reference to the requested node\n     */\n    ref(path) {\n        return new DataReference(this, path);\n    }\n    /**\n     * Get a reference to the root database node\n     * @returns reference to root node\n     */\n    get root() {\n        return this.ref('');\n    }\n    /**\n     * Creates a query on the requested node\n     * @param path\n     * @returns query for the requested node\n     */\n    query(path) {\n        const ref = new DataReference(this, path);\n        return new DataReferenceQuery(ref);\n    }\n    get indexes() {\n        return {\n            /**\n             * Gets all indexes\n             */\n            get: () => {\n                return this.api.getIndexes();\n            },\n            /**\n             * Creates an index on \"key\" for all child nodes at \"path\". If the index already exists, nothing happens.\n             * Example: creating an index on all \"name\" keys of child objects of path \"system/users\",\n             * will index \"system/users/user1/name\", \"system/users/user2/name\" etc.\n             * You can also use wildcard paths to enable indexing and quering of fragmented data.\n             * Example: path \"users/*\\/posts\", key \"title\": will index all \"title\" keys in all posts of all users.\n             * @param path path to the container node\n             * @param key name of the key to index every container child node\n             * @param options any additional options\n             */\n            create: (path, key, options) => {\n                return this.api.createIndex(path, key, options);\n            },\n            /**\n             * Deletes an existing index from the database\n             */\n            delete: async (filePath) => {\n                return this.api.deleteIndex(filePath);\n            },\n        };\n    }\n    get schema() {\n        return {\n            get: (path) => {\n                return this.api.getSchema(path);\n            },\n            set: (path, schema, warnOnly = false) => {\n                return this.api.setSchema(path, schema, warnOnly);\n            },\n            all: () => {\n                return this.api.getSchemas();\n            },\n            check: (path, value, isUpdate) => {\n                return this.api.validateSchema(path, value, isUpdate);\n            },\n        };\n    }\n}\n//# sourceMappingURL=acebase-base.js.map","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { SimpleEventEmitter } from './simple-event-emitter.js';\nclass NotImplementedError extends Error {\n    constructor(name) { super(`${name} is not implemented`); }\n}\n/**\n * Refactor to type/interface once acebase and acebase-client have been ported to TS\n */\nexport class Api extends SimpleEventEmitter {\n    constructor() {\n        super();\n    }\n    /**\n     * Provides statistics\n     * @param options\n     */\n    stats(options) { throw new NotImplementedError('stats'); }\n    /**\n     * @param path\n     * @param event event to subscribe to (\"value\", \"child_added\" etc)\n     * @param callback callback function\n     */\n    subscribe(path, event, callback, settings) { throw new NotImplementedError('subscribe'); }\n    unsubscribe(path, event, callback) { throw new NotImplementedError('unsubscribe'); }\n    update(path, updates, options) { throw new NotImplementedError('update'); }\n    set(path, value, options) { throw new NotImplementedError('set'); }\n    get(path, options) { throw new NotImplementedError('get'); }\n    transaction(path, callback, options) { throw new NotImplementedError('transaction'); }\n    exists(path) { throw new NotImplementedError('exists'); }\n    query(path, query, options) { throw new NotImplementedError('query'); }\n    reflect(path, type, args) { throw new NotImplementedError('reflect'); }\n    export(path, write, options) { throw new NotImplementedError('export'); }\n    import(path, read, options) { throw new NotImplementedError('import'); }\n    /** Creates an index on key for all child nodes at path */\n    createIndex(path, key, options) { throw new NotImplementedError('createIndex'); }\n    getIndexes() { throw new NotImplementedError('getIndexes'); }\n    deleteIndex(filePath) { throw new NotImplementedError('deleteIndex'); }\n    setSchema(path, schema, warnOnly) { throw new NotImplementedError('setSchema'); }\n    getSchema(path) { throw new NotImplementedError('getSchema'); }\n    getSchemas() { throw new NotImplementedError('getSchemas'); }\n    validateSchema(path, value, isUpdate) { throw new NotImplementedError('validateSchema'); }\n    getMutations(filter) { throw new NotImplementedError('getMutations'); }\n    getChanges(filter) { throw new NotImplementedError('getChanges'); }\n}\n//# sourceMappingURL=api.js.map","function c(input, length, result) {\n    const b = [0, 0, 0, 0, 0];\n    for (let i = 0; i < length; i += 4) {\n        let n = ((input[i] * 256 + input[i + 1]) * 256 + input[i + 2]) * 256 + input[i + 3];\n        if (!n) {\n            result.push('z');\n        }\n        else {\n            for (let j = 0; j < 5; b[j++] = n % 85 + 33, n = Math.floor(n / 85)) { }\n            result.push(String.fromCharCode(b[4], b[3], b[2], b[1], b[0]));\n        }\n    }\n}\nfunction encode(arr) {\n    // summary: encodes input data in ascii85 string\n    // input: ArrayLike\n    const input = arr, result = [], remainder = input.length % 4, length = input.length - remainder;\n    c(input, length, result);\n    if (remainder) {\n        const t = new Uint8Array(4);\n        t.set(input.slice(length), 0);\n        c(t, 4, result);\n        let x = result.pop();\n        if (x == 'z') {\n            x = '!!!!!';\n        }\n        result.push(x.substr(0, remainder + 1));\n    }\n    let ret = result.join(''); // String\n    ret = '<~' + ret + '~>';\n    return ret;\n}\nexport const ascii85 = {\n    encode: function (arr) {\n        if (arr instanceof ArrayBuffer) {\n            arr = new Uint8Array(arr, 0, arr.byteLength);\n        }\n        return encode(arr);\n    },\n    decode: function (input) {\n        // summary: decodes the input string back to an ArrayBuffer\n        // input: String: the input string to decode\n        if (!input.startsWith('<~') || !input.endsWith('~>')) {\n            throw new Error('Invalid input string');\n        }\n        input = input.substr(2, input.length - 4);\n        const n = input.length, r = [], b = [0, 0, 0, 0, 0];\n        let t, x, y, d;\n        for (let i = 0; i < n; ++i) {\n            if (input.charAt(i) == 'z') {\n                r.push(0, 0, 0, 0);\n                continue;\n            }\n            for (let j = 0; j < 5; ++j) {\n                b[j] = input.charCodeAt(i + j) - 33;\n            }\n            d = n - i;\n            if (d < 5) {\n                for (let j = d; j < 4; b[++j] = 0) { }\n                b[d] = 85;\n            }\n            t = (((b[0] * 85 + b[1]) * 85 + b[2]) * 85 + b[3]) * 85 + b[4];\n            x = t & 255;\n            t >>>= 8;\n            y = t & 255;\n            t >>>= 8;\n            r.push(t >>> 8, t & 255, y, x);\n            for (let j = d; j < 5; ++j, r.pop()) { }\n            i += 4;\n        }\n        const data = new Uint8Array(r);\n        return data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\n    },\n};\n//# sourceMappingURL=ascii85.js.map","import { PathReference } from './path-reference.js';\nimport { cloneObject } from './utils.js';\nimport { ascii85 } from './ascii85.js';\nimport { PathInfo } from './path-info.js';\nimport { PartialArray } from './partial-array.js';\n/*\n    There are now 2 different serialization methods for transporting values.\n\n    v1:\n    The original version (v1) created an object with \"map\" and \"val\" properties.\n    The \"map\" property was made optional in v1.14.1 so they won't be present for values needing no serializing\n\n    v2:\n    The new version replaces serialized values inline by objects containing \".type\" and \".val\" properties.\n    This serializing method was introduced by `export` and `import` methods because they use streaming and\n    are unable to prepare type mappings up-front. This format is smaller in transmission (in many cases),\n    and easier to read and process.\n\n    original: { \"date\": (some date) }\n    v1 serialized: { \"map\": { \"date\": \"date\" }, \"val\": { date: \"2022-04-22T07:49:23Z\" } }\n    v2 serialized: { \"date\": { \".type\": \"date\", \".val\": \"2022-04-22T07:49:23Z\" } }\n\n    original: (some date)\n    v1 serialized: { \"map\": \"date\", \"val\": \"2022-04-22T07:49:23Z\" }\n    v2 serialized: { \".type\": \"date\", \".val\": \"2022-04-22T07:49:23Z\" }\n    comment: top level value that need serializing is wrapped in an object with \".type\" and \".val\". v1 is smaller in this case\n\n    original: 'some string'\n    v1 serialized: { \"map\": {}, \"val\": \"some string\" }\n    v2 serialized: \"some string\"\n    comment: primitive types such as strings don't need serializing and are returned as is in v2\n\n    original: { \"date\": (some date), \"text\": \"Some string\" }\n    v1 serialized: { \"map\": { \"date\": \"date\" }, \"val\": { date: \"2022-04-22T07:49:23Z\", \"text\": \"Some string\" } }\n    v2 serialized: { \"date\": { \".type\": \"date\", \".val\": \"2022-04-22T07:49:23Z\" }, \"text\": \"Some string\" }\n*/\n/**\n * Original deserialization method using global `map` and `val` properties\n * @param data\n * @returns\n */\nexport const deserialize = (data) => {\n    if (data.map === null || typeof data.map === 'undefined') {\n        if (typeof data.val === 'undefined') {\n            throw new Error('serialized value must have a val property');\n        }\n        return data.val;\n    }\n    const deserializeValue = (type, val) => {\n        if (type === 'date') {\n            // Date was serialized as a string (UTC)\n            return new Date(val);\n        }\n        else if (type === 'binary') {\n            // ascii85 encoded binary data\n            return ascii85.decode(val);\n        }\n        else if (type === 'reference') {\n            return new PathReference(val);\n        }\n        else if (type === 'regexp') {\n            return new RegExp(val.pattern, val.flags);\n        }\n        else if (type === 'array') {\n            return new PartialArray(val);\n        }\n        else if (type === 'bigint') {\n            return BigInt(val);\n        }\n        return val;\n    };\n    if (typeof data.map === 'string') {\n        // Single value\n        return deserializeValue(data.map, data.val);\n    }\n    Object.keys(data.map).forEach(path => {\n        const type = data.map[path];\n        const keys = PathInfo.getPathKeys(path);\n        let parent = data;\n        let key = 'val';\n        let val = data.val;\n        keys.forEach(k => {\n            key = k;\n            parent = val;\n            val = val[key]; // If an error occurs here, there's something wrong with the calling code...\n        });\n        parent[key] = deserializeValue(type, val);\n    });\n    return data.val;\n};\n/**\n * Function to detect the used serialization method with for the given object\n * @param data\n * @returns\n */\nexport const detectSerializeVersion = (data) => {\n    if (typeof data !== 'object' || data === null) {\n        // This can only be v2, which allows primitive types to bypass serializing\n        return 2;\n    }\n    if ('map' in data && 'val' in data) {\n        return 1;\n    }\n    else if ('val' in data) {\n        // If it's v1, 'val' will be the only key in the object because serialize2 adds \".version\": 2 to the object to prevent confusion.\n        if (Object.keys(data).length > 1) {\n            return 2;\n        }\n        return 1;\n    }\n    return 2;\n};\n/**\n * Original serialization method using global `map` and `val` properties\n * @param data\n * @returns\n */\nexport const serialize = (obj) => {\n    // Recursively find dates and binary data\n    if (obj === null || typeof obj !== 'object' || obj instanceof Date || obj instanceof ArrayBuffer || obj instanceof PathReference || obj instanceof RegExp) {\n        // Single value\n        const ser = serialize({ value: obj });\n        return {\n            map: ser.map?.value,\n            val: ser.val.value,\n        };\n    }\n    obj = cloneObject(obj); // Make sure we don't alter the original object\n    const process = (obj, mappings, prefix) => {\n        if (obj instanceof PartialArray) {\n            mappings[prefix] = 'array';\n        }\n        Object.keys(obj).forEach(key => {\n            const val = obj[key];\n            const path = prefix.length === 0 ? key : `${prefix}/${key}`;\n            if (typeof val === 'bigint') {\n                obj[key] = val.toString();\n                mappings[path] = 'bigint';\n            }\n            else if (val instanceof Date) {\n                // serialize date to UTC string\n                obj[key] = val.toISOString();\n                mappings[path] = 'date';\n            }\n            else if (val instanceof ArrayBuffer) {\n                // Serialize binary data with ascii85\n                obj[key] = ascii85.encode(val); //ascii85.encode(Buffer.from(val)).toString();\n                mappings[path] = 'binary';\n            }\n            else if (val instanceof PathReference) {\n                obj[key] = val.path;\n                mappings[path] = 'reference';\n            }\n            else if (val instanceof RegExp) {\n                // Queries using the 'matches' filter with a regular expression can now also be used on remote db's\n                obj[key] = { pattern: val.source, flags: val.flags };\n                mappings[path] = 'regexp';\n            }\n            else if (typeof val === 'object' && val !== null) {\n                process(val, mappings, path);\n            }\n        });\n    };\n    const mappings = {};\n    process(obj, mappings, '');\n    const serialized = { val: obj };\n    if (Object.keys(mappings).length > 0) {\n        serialized.map = mappings;\n    }\n    return serialized;\n};\n/**\n * New serialization method using inline `.type` and `.val` properties\n * @param obj\n * @returns\n */\nexport const serialize2 = (obj) => {\n    // Recursively find data that needs serializing\n    const getSerializedValue = (val) => {\n        if (typeof val === 'bigint') {\n            // serialize bigint to string\n            return {\n                '.type': 'bigint',\n                '.val': val.toString(),\n            };\n        }\n        else if (val instanceof Date) {\n            // serialize date to UTC string\n            return {\n                '.type': 'date',\n                '.val': val.toISOString(),\n            };\n        }\n        else if (val instanceof ArrayBuffer) {\n            // Serialize binary data with ascii85\n            return {\n                '.type': 'binary',\n                '.val': ascii85.encode(val),\n            };\n        }\n        else if (val instanceof PathReference) {\n            return {\n                '.type': 'reference',\n                '.val': val.path,\n            };\n        }\n        else if (val instanceof RegExp) {\n            // Queries using the 'matches' filter with a regular expression can now also be used on remote db's\n            return {\n                '.type': 'regexp',\n                '.val': `/${val.source}/${val.flags}`, // new: shorter\n                // '.val': {\n                //     pattern: val.source,\n                //     flags: val.flags\n                // }\n            };\n        }\n        else if (typeof val === 'object' && val !== null) {\n            if (val instanceof Array) {\n                const copy = [];\n                for (let i = 0; i < val.length; i++) {\n                    copy[i] = getSerializedValue(val[i]);\n                }\n                return copy;\n            }\n            else {\n                const copy = {}; //val instanceof Array ? [] : {} as SerializedValueV2;\n                if (val instanceof PartialArray) {\n                    // Mark the object as partial (\"sparse\") array\n                    copy['.type'] = 'array';\n                }\n                for (const prop in val) {\n                    copy[prop] = getSerializedValue(val[prop]);\n                }\n                return copy;\n            }\n        }\n        else {\n            // Primitive value. Don't serialize\n            return val;\n        }\n    };\n    const serialized = getSerializedValue(obj);\n    if (serialized !== null && typeof serialized === 'object' && 'val' in serialized && Object.keys(serialized).length === 1) {\n        // acebase-core v1.14.1 made the 'map' property optional.\n        // This v2 serialized object might be confused with a v1 without mappings, because it only has a \"val\" property\n        // To prevent this, mark the serialized object with version 2\n        serialized['.version'] = 2;\n    }\n    return serialized;\n};\n/**\n * New deserialization method using inline `.type` and `.val` properties\n * @param obj\n * @returns\n */\nexport const deserialize2 = (data) => {\n    if (typeof data !== 'object' || data === null) {\n        // primitive value, not serialized\n        return data;\n    }\n    if (typeof data['.type'] === 'undefined') {\n        // No type given: this is a plain object or array\n        if (data instanceof Array) {\n            // Plain array, deserialize items into a copy\n            const copy = [];\n            const arr = data;\n            for (let i = 0; i < arr.length; i++) {\n                copy.push(deserialize2(arr[i]));\n            }\n            return copy;\n        }\n        else {\n            // Plain object, deserialize properties into a copy\n            const copy = {};\n            const obj = data;\n            for (const prop in obj) {\n                copy[prop] = deserialize2(obj[prop]);\n            }\n            return copy;\n        }\n    }\n    else if (typeof data['.type'] === 'string') {\n        const dataType = data['.type'].toLowerCase();\n        if (dataType === 'bigint') {\n            const val = data['.val'];\n            return BigInt(val);\n        }\n        else if (dataType === 'array') {\n            // partial (\"sparse\") array, deserialize children into a copy\n            const arr = data;\n            const copy = {};\n            for (const index in arr) {\n                copy[index] = deserialize2(arr[index]);\n            }\n            delete copy['.type'];\n            return new PartialArray(copy);\n        }\n        else if (dataType === 'date') {\n            // Date was serialized as a string (UTC)\n            const val = data['.val'];\n            return new Date(val);\n        }\n        else if (dataType === 'binary') {\n            // ascii85 encoded binary data\n            const val = data['.val'];\n            return ascii85.decode(val);\n        }\n        else if (dataType === 'reference') {\n            const val = data['.val'];\n            return new PathReference(val);\n        }\n        else if (dataType === 'regexp') {\n            const val = data['.val'];\n            if (typeof val === 'string') {\n                // serialized as '/(pattern)/flags'\n                const match = /^\\/(.*)\\/([a-z]+)$/.exec(val);\n                return new RegExp(match[1], match[2]);\n            }\n            // serialized as object with pattern & flags properties\n            return new RegExp(val.pattern, val.flags);\n        }\n    }\n    throw new Error(`Unknown data type \"${data['.type']}\" in serialized value`);\n};\n//# sourceMappingURL=transport.js.map","import { cloneObject } from './utils.js';\nconst calculateExpiryTime = (expirySeconds) => expirySeconds > 0 ? Date.now() + (expirySeconds * 1000) : Infinity;\n/**\n * Simple cache implementation that retains immutable values in memory for a limited time.\n * Immutability is enforced by cloning the stored and retrieved values. To change a cached value, it will have to be `set` again with the new value.\n */\nexport class SimpleCache {\n    get size() { return this.cache.size; }\n    constructor(options) {\n        this.enabled = true;\n        if (typeof options === 'number') {\n            // Old signature: only expirySeconds given\n            options = { expirySeconds: options };\n        }\n        options.cloneValues = options.cloneValues !== false;\n        if (typeof options.expirySeconds !== 'number' && typeof options.maxEntries !== 'number') {\n            throw new Error('Either expirySeconds or maxEntries must be specified');\n        }\n        this.options = options;\n        this.cache = new Map();\n        // Cleanup every minute\n        const interval = setInterval(() => { this.cleanUp(); }, 60 * 1000);\n        interval.unref?.();\n    }\n    has(key) {\n        if (!this.enabled) {\n            return false;\n        }\n        return this.cache.has(key);\n    }\n    get(key) {\n        if (!this.enabled) {\n            return null;\n        }\n        const entry = this.cache.get(key);\n        if (!entry) {\n            return null;\n        } // if (!entry || entry.expires <= Date.now()) { return null; }\n        entry.expires = calculateExpiryTime(this.options.expirySeconds);\n        entry.accessed = Date.now();\n        return this.options.cloneValues ? cloneObject(entry.value) : entry.value;\n    }\n    set(key, value) {\n        if (this.options.maxEntries > 0 && this.cache.size >= this.options.maxEntries && !this.cache.has(key)) {\n            // console.warn(`* cache limit ${this.options.maxEntries} reached: ${this.cache.size}`);\n            // Remove an expired item or the one that was accessed longest ago\n            let oldest = null;\n            const now = Date.now();\n            for (const [key, entry] of this.cache.entries()) {\n                if (entry.expires <= now) {\n                    // Found an expired item. Remove it now and stop\n                    this.cache.delete(key);\n                    oldest = null;\n                    break;\n                }\n                if (!oldest || entry.accessed < oldest.accessed) {\n                    oldest = { key, accessed: entry.accessed };\n                }\n            }\n            if (oldest !== null) {\n                this.cache.delete(oldest.key);\n            }\n        }\n        this.cache.set(key, { value: this.options.cloneValues ? cloneObject(value) : value, added: Date.now(), accessed: Date.now(), expires: calculateExpiryTime(this.options.expirySeconds) });\n    }\n    remove(key) {\n        this.cache.delete(key);\n    }\n    cleanUp() {\n        const now = Date.now();\n        this.cache.forEach((entry, key) => {\n            if (entry.expires <= now) {\n                this.cache.delete(key);\n            }\n        });\n    }\n}\n//# sourceMappingURL=simple-cache.js.map","// parses a typestring, creates checker functions\nfunction parse(definition) {\n    // tokenize\n    let pos = 0;\n    function consumeSpaces() {\n        let c;\n        while (c = definition[pos], [' ', '\\r', '\\n', '\\t'].includes(c)) {\n            pos++;\n        }\n    }\n    function consumeCharacter(c) {\n        if (definition[pos] !== c) {\n            throw new Error(`Unexpected character at position ${pos}. Expected: '${c}', found '${definition[pos]}'`);\n        }\n        pos++;\n    }\n    function readProperty() {\n        consumeSpaces();\n        const prop = { name: '', optional: false, wildcard: false };\n        let c;\n        while (c = definition[pos], c === '_' || c === '$' || (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') || (prop.name.length > 0 && c >= '0' && c <= '9') || (prop.name.length === 0 && c === '*')) {\n            prop.name += c;\n            pos++;\n        }\n        if (prop.name.length === 0) {\n            throw new Error(`Property name expected at position ${pos}, found: ${definition.slice(pos, pos + 10)}..`);\n        }\n        if (definition[pos] === '?') {\n            prop.optional = true;\n            pos++;\n        }\n        if (prop.name === '*' || prop.name[0] === '$') {\n            prop.optional = true;\n            prop.wildcard = true;\n        }\n        consumeSpaces();\n        consumeCharacter(':');\n        return prop;\n    }\n    function readType() {\n        consumeSpaces();\n        let type = { typeOf: 'any' }, c;\n        // try reading simple type first: (string,number,boolean,Date etc)\n        let name = '';\n        while (c = definition[pos], (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {\n            name += c;\n            pos++;\n        }\n        if (name.length === 0) {\n            if (definition[pos] === '*') {\n                // any value\n                consumeCharacter('*');\n                type.typeOf = 'any';\n            }\n            else if (['\\'', '\"', '`'].includes(definition[pos])) {\n                // Read string value\n                type.typeOf = 'string';\n                type.value = '';\n                const quote = definition[pos];\n                consumeCharacter(quote);\n                while (c = definition[pos], c && c !== quote) {\n                    type.value += c;\n                    pos++;\n                }\n                consumeCharacter(quote);\n            }\n            else if (definition[pos] >= '0' && definition[pos] <= '9') {\n                // read numeric value\n                type.typeOf = 'number';\n                let nr = '';\n                while (c = definition[pos], c === '.' || c === 'n' || (c >= '0' && c <= '9')) {\n                    nr += c;\n                    pos++;\n                }\n                if (nr.endsWith('n')) {\n                    type.value = BigInt(nr);\n                }\n                else if (nr.includes('.')) {\n                    type.value = parseFloat(nr);\n                }\n                else {\n                    type.value = parseInt(nr);\n                }\n            }\n            else if (definition[pos] === '{') {\n                // Read object (interface) definition\n                consumeCharacter('{');\n                type.typeOf = 'object';\n                type.instanceOf = Object;\n                // Read children:\n                type.children = [];\n                while (true) {\n                    const prop = readProperty();\n                    const types = readTypes();\n                    type.children.push({ name: prop.name, optional: prop.optional, wildcard: prop.wildcard, types });\n                    consumeSpaces();\n                    if (definition[pos] === ';' || definition[pos] === ',') {\n                        consumeCharacter(definition[pos]);\n                        consumeSpaces();\n                    }\n                    if (definition[pos] === '}') {\n                        break;\n                    }\n                }\n                consumeCharacter('}');\n            }\n            else if (definition[pos] === '/') {\n                // Read regular expression definition\n                consumeCharacter('/');\n                let pattern = '', flags = '';\n                while (c = definition[pos], c !== '/' || pattern.endsWith('\\\\')) {\n                    pattern += c;\n                    pos++;\n                }\n                consumeCharacter('/');\n                while (c = definition[pos], ['g', 'i', 'm', 's', 'u', 'y', 'd'].includes(c)) {\n                    flags += c;\n                    pos++;\n                }\n                type.typeOf = 'string';\n                type.matches = new RegExp(pattern, flags);\n            }\n            else {\n                throw new Error(`Expected a type definition at position ${pos}, found character '${definition[pos]}'`);\n            }\n        }\n        else if (['string', 'number', 'boolean', 'bigint', 'undefined', 'String', 'Number', 'Boolean', 'BigInt'].includes(name)) {\n            type.typeOf = name.toLowerCase();\n        }\n        else if (name === 'Object' || name === 'object') {\n            type.typeOf = 'object';\n            type.instanceOf = Object;\n        }\n        else if (name === 'Date') {\n            type.typeOf = 'object';\n            type.instanceOf = Date;\n        }\n        else if (name === 'Binary' || name === 'binary') {\n            type.typeOf = 'object';\n            type.instanceOf = ArrayBuffer;\n        }\n        else if (name === 'any') {\n            type.typeOf = 'any';\n        }\n        else if (name === 'null') {\n            // This is ignored, null values are not stored in the db (null indicates deletion)\n            type.typeOf = 'object';\n            type.value = null;\n        }\n        else if (name === 'Array') {\n            // Read generic Array defintion\n            consumeCharacter('<');\n            type.typeOf = 'object';\n            type.instanceOf = Array; //name;\n            type.genericTypes = readTypes();\n            consumeCharacter('>');\n        }\n        else if (['true', 'false'].includes(name)) {\n            type.typeOf = 'boolean';\n            type.value = name === 'true';\n        }\n        else {\n            throw new Error(`Unknown type at position ${pos}: \"${type}\"`);\n        }\n        // Check if it's an Array of given type (eg: string[] or string[][])\n        // Also converts to generics, string[] becomes Array<string>, string[][] becomes Array<Array<string>>\n        consumeSpaces();\n        while (definition[pos] === '[') {\n            consumeCharacter('[');\n            consumeCharacter(']');\n            type = { typeOf: 'object', instanceOf: Array, genericTypes: [type] };\n        }\n        return type;\n    }\n    function readTypes() {\n        consumeSpaces();\n        const types = [readType()];\n        while (definition[pos] === '|') {\n            consumeCharacter('|');\n            types.push(readType());\n            consumeSpaces();\n        }\n        return types;\n    }\n    return readType();\n}\nfunction checkObject(path, properties, obj, partial) {\n    // Are there any properties that should not be in there?\n    const invalidProperties = properties.find(prop => prop.name === '*' || prop.name[0] === '$') // Only if no wildcard properties are allowed\n        ? []\n        : Object.keys(obj).filter(key => ![null, undefined].includes(obj[key]) // Ignore null or undefined values\n            && !properties.find(prop => prop.name === key));\n    if (invalidProperties.length > 0) {\n        return { ok: false, reason: `Object at path \"${path}\" cannot have propert${invalidProperties.length === 1 ? 'y' : 'ies'} ${invalidProperties.map(p => `\"${p}\"`).join(', ')}` };\n    }\n    // Loop through properties that should be present\n    function checkProperty(property) {\n        const hasValue = ![null, undefined].includes(obj[property.name]);\n        if (!property.optional && (partial ? obj[property.name] === null : !hasValue)) {\n            return { ok: false, reason: `Property at path \"${path}/${property.name}\" is not optional` };\n        }\n        if (hasValue && property.types.length === 1) {\n            return checkType(`${path}/${property.name}`, property.types[0], obj[property.name], false);\n        }\n        if (hasValue && !property.types.some(type => checkType(`${path}/${property.name}`, type, obj[property.name], false).ok)) {\n            return { ok: false, reason: `Property at path \"${path}/${property.name}\" does not match any of ${property.types.length} allowed types` };\n        }\n        return { ok: true };\n    }\n    const namedProperties = properties.filter(prop => !prop.wildcard);\n    const failedProperty = namedProperties.find(prop => !checkProperty(prop).ok);\n    if (failedProperty) {\n        const reason = checkProperty(failedProperty).reason;\n        return { ok: false, reason };\n    }\n    const wildcardProperty = properties.find(prop => prop.wildcard);\n    if (!wildcardProperty) {\n        return { ok: true };\n    }\n    const wildcardChildKeys = Object.keys(obj).filter(key => !namedProperties.find(prop => prop.name === key));\n    let result = { ok: true };\n    for (let i = 0; i < wildcardChildKeys.length && result.ok; i++) {\n        const childKey = wildcardChildKeys[i];\n        result = checkProperty({ name: childKey, types: wildcardProperty.types, optional: true, wildcard: true });\n    }\n    return result;\n}\nfunction checkType(path, type, value, partial, trailKeys) {\n    const ok = { ok: true };\n    if (type.typeOf === 'any') {\n        return ok;\n    }\n    if (trailKeys instanceof Array && trailKeys.length > 0) {\n        // The value to check resides in a descendant path of given type definition.\n        // Recursivly check child type definitions to find a match\n        if (type.typeOf !== 'object') {\n            return { ok: false, reason: `path \"${path}\" must be typeof ${type.typeOf}` }; // given value resides in a child path, but parent is not allowed be an object.\n        }\n        if (!type.children) {\n            return ok;\n        }\n        const childKey = trailKeys[0];\n        let property = type.children.find(prop => prop.name === childKey);\n        if (!property) {\n            property = type.children.find(prop => prop.name === '*' || prop.name[0] === '$');\n        }\n        if (!property) {\n            return { ok: false, reason: `Object at path \"${path}\" cannot have property \"${childKey}\"` };\n        }\n        if (property.optional && value === null && trailKeys.length === 1) {\n            return ok;\n        }\n        let result;\n        property.types.some(type => {\n            const childPath = typeof childKey === 'number' ? `${path}[${childKey}]` : `${path}/${childKey}`;\n            result = checkType(childPath, type, value, partial, trailKeys.slice(1));\n            return result.ok;\n        });\n        return result;\n    }\n    if (value === null) {\n        return ok;\n    }\n    if (type.instanceOf === Object && (typeof value !== 'object' || value instanceof Array || value instanceof Date)) {\n        return { ok: false, reason: `path \"${path}\" must be an object collection` };\n    }\n    if (type.instanceOf && (typeof value !== 'object' || value.constructor !== type.instanceOf)) { // !(value instanceof type.instanceOf) // value.constructor.name !== type.instanceOf\n        return { ok: false, reason: `path \"${path}\" must be an instance of ${type.instanceOf.name}` };\n    }\n    if ('value' in type && value !== type.value) {\n        return { ok: false, reason: `path \"${path}\" must be value: ${type.value}` };\n    }\n    if (typeof value !== type.typeOf) {\n        return { ok: false, reason: `path \"${path}\" must be typeof ${type.typeOf}` };\n    }\n    if (type.instanceOf === Array && type.genericTypes && !value.every(v => type.genericTypes.some(t => checkType(path, t, v, false).ok))) {\n        return { ok: false, reason: `every array value of path \"${path}\" must match one of the specified types` };\n    }\n    if (type.typeOf === 'object' && type.children) {\n        return checkObject(path, type.children, value, partial);\n    }\n    if (type.matches && !type.matches.test(value)) {\n        return { ok: false, reason: `path \"${path}\" must match regular expression /${type.matches.source}/${type.matches.flags}` };\n    }\n    return ok;\n}\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction getConstructorType(val) {\n    switch (val) {\n        case String: return 'string';\n        case Number: return 'number';\n        case Boolean: return 'boolean';\n        case Date: return 'Date';\n        case BigInt: return 'bigint';\n        case Array: throw new Error('Schema error: Array cannot be used without a type. Use string[] or Array<string> instead');\n        default: throw new Error(`Schema error: unknown type used: ${val.name}`);\n    }\n}\nexport class SchemaDefinition {\n    constructor(definition, handling = { warnOnly: false }) {\n        this.handling = handling;\n        this.source = definition;\n        if (typeof definition === 'object') {\n            // Turn object into typescript definitions\n            // eg:\n            // const example = {\n            //     name: String,\n            //     born: Date,\n            //     instrument: \"'guitar'|'piano'\",\n            //     \"address?\": {\n            //         street: String\n            //     }\n            // };\n            // Resulting ts: \"{name:string,born:Date,instrument:'guitar'|'piano',address?:{street:string}}\"\n            const toTS = (obj) => {\n                return '{' + Object.keys(obj)\n                    .map(key => {\n                    let val = obj[key];\n                    if (val === undefined) {\n                        val = 'undefined';\n                    }\n                    else if (val instanceof RegExp) {\n                        val = `/${val.source}/${val.flags}`;\n                    }\n                    else if (typeof val === 'object') {\n                        val = toTS(val);\n                    }\n                    else if (typeof val === 'function') {\n                        val = getConstructorType(val);\n                    }\n                    else if (!['string', 'number', 'boolean', 'bigint'].includes(typeof val)) {\n                        throw new Error(`Type definition for key \"${key}\" must be a string, number, boolean, bigint, object, regular expression, or one of these classes: String, Number, Boolean, Date, BigInt`);\n                    }\n                    return `${key}:${val}`;\n                })\n                    .join(',') + '}';\n            };\n            this.text = toTS(definition);\n        }\n        else if (typeof definition === 'string') {\n            this.text = definition;\n        }\n        else {\n            throw new Error('Type definiton must be a string or an object');\n        }\n        this.type = parse(this.text);\n    }\n    check(path, value, partial, trailKeys) {\n        const result = checkType(path, this.type, value, partial, trailKeys);\n        if (!result.ok && this.handling.warnOnly) {\n            // Only issue a warning, allows schema definitions to be added to a production db to monitor if they are accurate before enforcing them.\n            result.warning = `${partial ? 'Partial schema' : 'Schema'} check on path \"${path}\"${trailKeys ? ` for child \"${trailKeys.join('/')}\"` : ''} failed: ${result.reason}`;\n            result.ok = true;\n            this.handling.warnCallback(result.warning);\n        }\n        return result;\n    }\n}\n//# sourceMappingURL=schema.js.map","export class NotSupported {\n    constructor(context = 'browser') { throw new Error(`This feature is not supported in ${context} context`); }\n}\n//# sourceMappingURL=not-supported.js.map","import { NotSupported } from '../../not-supported.js';\n/**\n * Not supported in browser context\n */\nexport class AceBaseStorageSettings extends NotSupported {\n}\n/**\n * Not supported in browser context\n */\nexport class AceBaseStorage extends NotSupported {\n}\n//# sourceMappingURL=browser.js.map","import { NotSupported } from '../../not-supported.js';\n/**\n * Not supported in browser context\n */\nexport class SQLiteStorageSettings extends NotSupported {\n}\n/**\n * Not supported in browser context\n */\nexport class SQLiteStorage extends NotSupported {\n}\n//# sourceMappingURL=browser.js.map","import { NotSupported } from '../../not-supported.js';\n/**\n * Not supported in browser context\n */\nexport class MSSQLStorageSettings extends NotSupported {\n}\n/**\n * Not supported in browser context\n */\nexport class MSSQLStorage extends NotSupported {\n}\n//# sourceMappingURL=browser.js.map","import { PathReference } from 'acebase-core';\nconst nodeValueTypes = {\n    // Native types:\n    OBJECT: 1,\n    ARRAY: 2,\n    NUMBER: 3,\n    BOOLEAN: 4,\n    STRING: 5,\n    BIGINT: 7,\n    // Custom types:\n    DATETIME: 6,\n    BINARY: 8,\n    REFERENCE: 9, // Absolute or relative path to other node\n    // Future:\n    // DOCUMENT: 10,     // JSON/XML documents that are contained entirely within the stored node\n};\nexport const VALUE_TYPES = nodeValueTypes;\nexport function getValueTypeName(valueType) {\n    switch (valueType) {\n        case VALUE_TYPES.ARRAY: return 'array';\n        case VALUE_TYPES.BINARY: return 'binary';\n        case VALUE_TYPES.BOOLEAN: return 'boolean';\n        case VALUE_TYPES.DATETIME: return 'date';\n        case VALUE_TYPES.NUMBER: return 'number';\n        case VALUE_TYPES.OBJECT: return 'object';\n        case VALUE_TYPES.REFERENCE: return 'reference';\n        case VALUE_TYPES.STRING: return 'string';\n        case VALUE_TYPES.BIGINT: return 'bigint';\n        // case VALUE_TYPES.DOCUMENT: return 'document';\n        default: 'unknown';\n    }\n}\nexport function getNodeValueType(value) {\n    if (value instanceof Array) {\n        return VALUE_TYPES.ARRAY;\n    }\n    else if (value instanceof PathReference) {\n        return VALUE_TYPES.REFERENCE;\n    }\n    else if (value instanceof ArrayBuffer) {\n        return VALUE_TYPES.BINARY;\n    }\n    // TODO else if (value instanceof DataDocument) { return VALUE_TYPES.DOCUMENT; }\n    else if (typeof value === 'string') {\n        return VALUE_TYPES.STRING;\n    }\n    else if (typeof value === 'object') {\n        return VALUE_TYPES.OBJECT;\n    }\n    else if (typeof value === 'bigint') {\n        return VALUE_TYPES.BIGINT;\n    }\n    throw new Error(`Invalid value for standalone node: ${value}`);\n}\nexport function getValueType(value) {\n    if (value instanceof Array) {\n        return VALUE_TYPES.ARRAY;\n    }\n    else if (value instanceof PathReference) {\n        return VALUE_TYPES.REFERENCE;\n    }\n    else if (value instanceof ArrayBuffer) {\n        return VALUE_TYPES.BINARY;\n    }\n    else if (value instanceof Date) {\n        return VALUE_TYPES.DATETIME;\n    }\n    // TODO else if (value instanceof DataDocument) { return VALUE_TYPES.DOCUMENT; }\n    else if (typeof value === 'string') {\n        return VALUE_TYPES.STRING;\n    }\n    else if (typeof value === 'object') {\n        return VALUE_TYPES.OBJECT;\n    }\n    else if (typeof value === 'number') {\n        return VALUE_TYPES.NUMBER;\n    }\n    else if (typeof value === 'boolean') {\n        return VALUE_TYPES.BOOLEAN;\n    }\n    else if (typeof value === 'bigint') {\n        return VALUE_TYPES.BIGINT;\n    }\n    throw new Error(`Unknown value type: ${value}`);\n}\n//# sourceMappingURL=node-value-types.js.map","import { getValueTypeName } from './node-value-types.js';\nimport { PathInfo } from 'acebase-core';\nexport class NodeInfo {\n    constructor(info) {\n        this.path = info.path;\n        this.type = info.type;\n        this.index = info.index;\n        this.key = info.key;\n        this.exists = info.exists;\n        this.address = info.address;\n        this.value = info.value;\n        this.childCount = info.childCount;\n        if (typeof this.path === 'string' && (typeof this.key === 'undefined' && typeof this.index === 'undefined')) {\n            const pathInfo = PathInfo.get(this.path);\n            if (typeof pathInfo.key === 'number') {\n                this.index = pathInfo.key;\n            }\n            else {\n                this.key = pathInfo.key;\n            }\n        }\n        if (typeof this.exists === 'undefined') {\n            this.exists = true;\n        }\n    }\n    get valueType() {\n        return this.type;\n    }\n    get valueTypeName() {\n        return getValueTypeName(this.valueType);\n    }\n    toString() {\n        if (!this.exists) {\n            return `\"${this.path}\" doesn't exist`;\n        }\n        if (this.address) {\n            return `\"${this.path}\" is ${this.valueTypeName} stored at ${this.address.toString()}`;\n        }\n        else {\n            return `\"${this.path}\" is ${this.valueTypeName} with value ${this.value}`;\n        }\n    }\n}\n//# sourceMappingURL=node-info.js.map","/**\n* Replacement for console.assert, throws an error if condition is not met.\n* @param condition 'truthy' condition\n* @param error\n*/\nexport function assert(condition, error) {\n    if (!condition) {\n        throw new Error(`Assertion failed: ${error ?? 'check your code'}`);\n    }\n}\n//# sourceMappingURL=assert.js.map","import { PathInfo, ID } from 'acebase-core';\nimport { assert } from './assert.js';\nconst DEBUG_MODE = false;\nconst DEFAULT_LOCK_TIMEOUT = 120; // in seconds\nexport const LOCK_STATE = {\n    PENDING: 'pending',\n    LOCKED: 'locked',\n    EXPIRED: 'expired',\n    DONE: 'done',\n};\nexport class NodeLocker {\n    /**\n     * Provides locking mechanism for nodes, ensures no simultanious read and writes happen to overlapping paths\n     */\n    constructor(debug, lockTimeout = DEFAULT_LOCK_TIMEOUT) {\n        this._locks = [];\n        this._lastTid = 0;\n        this.debug = debug;\n        this.timeout = lockTimeout * 1000;\n    }\n    setTimeout(timeout) {\n        this.timeout = timeout * 1000;\n    }\n    createTid() {\n        return DEBUG_MODE ? ++this._lastTid : ID.generate();\n    }\n    _allowLock(path, tid, forWriting) {\n        /**\n         * Disabled path locking because of the following issue:\n         *\n         * Process 1 requests WRITE lock on \"/users/ewout\", is GRANTED\n         * Process 2 requests READ lock on \"\", is DENIED (process 1 writing to a descendant)\n         * Process 3 requests WRITE lock on \"/posts/post1\", is GRANTED\n         * Process 1 requests READ lock on \"/\" because of bound events, is DENIED (3 is writing to a descendant)\n         * Process 3 requests READ lock on \"/\" because of bound events, is DENIED (1 is writing to a descendant)\n         *\n         * --> DEADLOCK!\n         *\n         * Now simply makes sure one transaction has write access at the same time,\n         * might change again in the future...\n         */\n        const conflict = this._locks\n            .find(otherLock => {\n            return (otherLock.tid !== tid\n                && otherLock.state === LOCK_STATE.LOCKED\n                && (forWriting || otherLock.forWriting));\n        });\n        return { allow: !conflict, conflict };\n    }\n    quit() {\n        return new Promise(resolve => {\n            if (this._locks.length === 0) {\n                return resolve();\n            }\n            this._quit = resolve;\n        });\n    }\n    /**\n     * Safely reject a pending lock, catching any unhandled promise rejections (that should not happen in the first place, obviously)\n     * @param lock\n     */\n    _rejectLock(lock, err) {\n        this._locks.splice(this._locks.indexOf(lock), 1); // Remove from queue\n        clearTimeout(lock.timeout);\n        try {\n            lock.reject(err);\n        }\n        catch (err) {\n            console.error(`Unhandled promise rejection:`, err);\n        }\n    }\n    _processLockQueue() {\n        if (this._quit) {\n            // Reject all pending locks\n            const quitError = new Error('Quitting');\n            this._locks\n                .filter(lock => lock.state === LOCK_STATE.PENDING)\n                .forEach(lock => this._rejectLock(lock, quitError));\n            // Resolve quit promise if queue is empty:\n            if (this._locks.length === 0) {\n                this._quit();\n            }\n        }\n        const pending = this._locks\n            .filter(lock => lock.state === LOCK_STATE.PENDING)\n            .sort((a, b) => {\n            // // Writes get higher priority so all reads get the most recent data\n            // if (a.forWriting === b.forWriting) {\n            //     if (a.requested < b.requested) { return -1; }\n            //     else { return 1; }\n            // }\n            // else if (a.forWriting) { return -1; }\n            if (a.priority && !b.priority) {\n                return -1;\n            }\n            else if (!a.priority && b.priority) {\n                return 1;\n            }\n            return a.requested - b.requested;\n        });\n        pending.forEach(lock => {\n            const check = this._allowLock(lock.path, lock.tid, lock.forWriting);\n            lock.waitingFor = check.conflict || null;\n            if (check.allow) {\n                this.lock(lock)\n                    .then(lock.resolve)\n                    .catch(err => this._rejectLock(lock, err));\n            }\n        });\n    }\n    async lock(path, tid, forWriting = true, comment = '', options = { withPriority: false, noTimeout: false }) {\n        let lock, proceed;\n        if (path instanceof NodeLock) {\n            lock = path;\n            //lock.comment = `(retry: ${lock.comment})`;\n            proceed = true;\n        }\n        else if (this._locks.findIndex((l => l.tid === tid && l.state === LOCK_STATE.EXPIRED)) >= 0) {\n            throw new Error(`lock on tid ${tid} has expired, not allowed to continue`);\n        }\n        else if (this._quit && !options.withPriority) {\n            throw new Error(`Quitting`);\n        }\n        else {\n            DEBUG_MODE && console.error(`${forWriting ? 'write' : 'read'} lock requested on \"${path}\" by tid ${tid} (${comment})`);\n            // // Test the requested lock path\n            // let duplicateKeys = getPathKeys(path)\n            //     .reduce((r, key) => {\n            //         let i = r.findIndex(c => c.key === key);\n            //         if (i >= 0) { r[i].count++; }\n            //         else { r.push({ key, count: 1 }) }\n            //         return r;\n            //     }, [])\n            //     .filter(c => c.count > 1)\n            //     .map(c => c.key);\n            // if (duplicateKeys.length > 0) {\n            //     console.log(`ALERT: Duplicate keys found in path \"/${path}\"`.colorize([ColorStyle.dim, ColorStyle.bgRed]);\n            // }\n            lock = new NodeLock(this, path, tid, forWriting, options.withPriority === true);\n            lock.comment = comment;\n            this._locks.push(lock);\n            const check = this._allowLock(path, tid, forWriting);\n            lock.waitingFor = check.conflict || null;\n            proceed = check.allow;\n        }\n        if (proceed) {\n            DEBUG_MODE && console.error(`${lock.forWriting ? 'write' : 'read'} lock ALLOWED on \"${lock.path}\" by tid ${lock.tid} (${lock.comment})`);\n            lock.state = LOCK_STATE.LOCKED;\n            if (typeof lock.granted === 'number') {\n                //debug.warn(`lock :: ALLOWING ${lock.forWriting ? \"write\" : \"read\" } lock on path \"/${lock.path}\" by tid ${lock.tid}; ${lock.comment}`);\n            }\n            else {\n                lock.granted = Date.now();\n                if (options.noTimeout !== true) {\n                    lock.expires = Date.now() + this.timeout;\n                    //debug.warn(`lock :: GRANTED ${lock.forWriting ? \"write\" : \"read\" } lock on path \"/${lock.path}\" by tid ${lock.tid}; ${lock.comment}`);\n                    let timeoutCount = 0;\n                    const timeoutHandler = () => {\n                        // Autorelease timeouts must only fire when there is something wrong in the\n                        // executing (AceBase) code, eg an unhandled promise rejection causing a lock not\n                        // to be released. To guard against programming errors, we will issue 3 warning\n                        // messages before releasing the lock.\n                        if (lock.state !== LOCK_STATE.LOCKED) {\n                            return;\n                        }\n                        timeoutCount++;\n                        if (timeoutCount <= 3) {\n                            // Warn first.\n                            this.debug.warn(`${lock.forWriting ? 'write' : 'read'} lock on path \"/${lock.path}\" by tid ${lock.tid} (${lock.comment}) is taking a long time to complete [${timeoutCount}]`);\n                            lock.timeout = setTimeout(timeoutHandler, this.timeout / 4);\n                            return;\n                        }\n                        this.debug.error(`lock :: ${lock.forWriting ? 'write' : 'read'} lock on path \"/${lock.path}\" by tid ${lock.tid} (${lock.comment}) took too long`);\n                        lock.state = LOCK_STATE.EXPIRED;\n                        // let allTransactionLocks = _locks.filter(l => l.tid === lock.tid).sort((a,b) => a.requested < b.requested ? -1 : 1);\n                        // let transactionsDebug = allTransactionLocks.map(l => `${l.state} ${l.forWriting ? \"WRITE\" : \"read\"} ${l.comment}`).join(\"\\n\");\n                        // debug.error(transactionsDebug);\n                        this._processLockQueue();\n                    };\n                    lock.timeout = setTimeout(timeoutHandler, this.timeout / 4);\n                }\n            }\n            return lock;\n        }\n        else {\n            // Keep pending until clashing lock(s) is/are removed\n            //debug.warn(`lock :: QUEUED ${lock.forWriting ? \"write\" : \"read\" } lock on path \"/${lock.path}\" by tid ${lock.tid}; ${lock.comment}`);\n            assert(lock.state === LOCK_STATE.PENDING);\n            return new Promise((resolve, reject) => {\n                lock.resolve = resolve;\n                lock.reject = reject;\n            });\n        }\n    }\n    unlock(lockOrId, comment, processQueue = true) {\n        let lock, i;\n        if (lockOrId instanceof NodeLock) {\n            lock = lockOrId;\n            i = this._locks.indexOf(lock);\n        }\n        else {\n            const id = lockOrId;\n            i = this._locks.findIndex(l => l.id === id);\n            lock = this._locks[i];\n        }\n        if (i < 0) {\n            const msg = `lock on \"/${lock.path}\" for tid ${lock.tid} wasn't found; ${comment}`;\n            // debug.error(`unlock :: ${msg}`);\n            throw new Error(msg);\n        }\n        lock.state = LOCK_STATE.DONE;\n        clearTimeout(lock.timeout);\n        this._locks.splice(i, 1);\n        DEBUG_MODE && console.error(`${lock.forWriting ? 'write' : 'read'} lock RELEASED on \"${lock.path}\" by tid ${lock.tid}`);\n        //debug.warn(`unlock :: RELEASED ${lock.forWriting ? \"write\" : \"read\" } lock on \"/${lock.path}\" for tid ${lock.tid}; ${lock.comment}; ${comment}`);\n        processQueue && this._processLockQueue();\n        return lock;\n    }\n    list() {\n        return this._locks || [];\n    }\n    isAllowed(path, tid, forWriting) {\n        return this._allowLock(path, tid, forWriting).allow;\n    }\n}\nlet lastid = 0;\nexport class NodeLock {\n    static get LOCK_STATE() { return LOCK_STATE; }\n    /**\n     * Constructor for a record lock\n     * @param {NodeLocker} locker\n     * @param {string} path\n     * @param {string} tid\n     * @param {boolean} forWriting\n     * @param {boolean} priority\n     */\n    constructor(locker, path, tid, forWriting, priority = false) {\n        this.locker = locker;\n        this.path = path;\n        this.tid = tid;\n        this.forWriting = forWriting;\n        this.priority = priority;\n        this.state = LOCK_STATE.PENDING;\n        this.requested = Date.now();\n        this.comment = '';\n        this.waitingFor = null;\n        this.id = ++lastid;\n        this.history = [];\n    }\n    async release(comment) {\n        //return this.storage.unlock(this.path, this.tid, comment);\n        this.history.push({ action: 'release', path: this.path, forWriting: this.forWriting, comment });\n        return this.locker.unlock(this, comment || this.comment);\n    }\n    async moveToParent() {\n        const parentPath = PathInfo.get(this.path).parentPath; //getPathInfo(this.path).parent;\n        const allowed = this.locker.isAllowed(parentPath, this.tid, this.forWriting); //_allowLock(parentPath, this.tid, this.forWriting);\n        if (allowed) {\n            DEBUG_MODE && console.error(`moveToParent ALLOWED for ${this.forWriting ? 'write' : 'read'} lock on \"${this.path}\" by tid ${this.tid} (${this.comment})`);\n            this.history.push({ path: this.path, forWriting: this.forWriting, action: 'moving to parent' });\n            this.waitingFor = null;\n            this.path = parentPath;\n            // this.comment = `moved to parent: ${this.comment}`;\n            return this;\n        }\n        else {\n            // Unlock without processing the queue\n            DEBUG_MODE && console.error(`moveToParent QUEUED for ${this.forWriting ? 'write' : 'read'} lock on \"${this.path}\" by tid ${this.tid} (${this.comment})`);\n            this.locker.unlock(this, `moveLockToParent: ${this.comment}`, false);\n            // Lock parent node with priority to jump the queue\n            const newLock = await this.locker.lock(parentPath, this.tid, this.forWriting, this.comment, { withPriority: true });\n            DEBUG_MODE && console.error(`QUEUED moveToParent ALLOWED for ${this.forWriting ? 'write' : 'read'} lock on \"${this.path}\" by tid ${this.tid} (${this.comment})`);\n            newLock.history = this.history;\n            newLock.history.push({ path: this.path, forWriting: this.forWriting, action: 'moving to parent through queue (priority)' });\n            return newLock;\n        }\n    }\n}\n//# sourceMappingURL=node-lock.js.map","export class NodeNotFoundError extends Error {\n}\nexport class NodeRevisionError extends Error {\n}\n//# sourceMappingURL=node-errors.js.map","import { ID, SimpleEventEmitter } from 'acebase-core';\nimport { NodeLocker, LOCK_STATE } from '../node-lock.js';\nexport class AceBaseIPCPeerExitingError extends Error {\n    constructor(message) { super(`Exiting: ${message}`); }\n}\n/**\n * Base class for Inter Process Communication, enables vertical scaling: using more CPU's on the same machine to share workload.\n * These processes will have to communicate with eachother because they are reading and writing to the same database file\n */\nexport class AceBaseIPCPeer extends SimpleEventEmitter {\n    get isMaster() { return this.masterPeerId === this.id; }\n    constructor(storage, id, dbname = storage.name) {\n        super();\n        this.storage = storage;\n        this.id = id;\n        this.dbname = dbname;\n        this.ipcType = 'ipc';\n        this.ourSubscriptions = [];\n        this.remoteSubscriptions = [];\n        this.peers = [];\n        this._exiting = false;\n        this._locks = [];\n        this._requests = new Map();\n        this._eventsEnabled = true;\n        this._nodeLocker = new NodeLocker(storage.debug, storage.settings.lockTimeout);\n        // Setup db event listeners\n        storage.on('subscribe', (subscription) => {\n            // Subscription was added to db\n            storage.debug.verbose(`database subscription being added on peer ${this.id}`);\n            const remoteSubscription = this.remoteSubscriptions.find(sub => sub.callback === subscription.callback);\n            if (remoteSubscription) {\n                // Send ack\n                // return sendMessage({ type: 'subscribe_ack', from: tabId, to: remoteSubscription.for, data: { path: subscription.path, event: subscription.event } });\n                return;\n            }\n            const othersAlreadyNotifying = this.ourSubscriptions.some(sub => sub.event === subscription.event && sub.path === subscription.path);\n            // Add subscription\n            this.ourSubscriptions.push(subscription);\n            if (othersAlreadyNotifying) {\n                // Same subscription as other previously added. Others already know we want to be notified\n                return;\n            }\n            // Request other tabs to keep us updated of this event\n            const message = { type: 'subscribe', from: this.id, data: { path: subscription.path, event: subscription.event } };\n            this.sendMessage(message);\n        });\n        storage.on('unsubscribe', (subscription) => {\n            // Subscription was removed from db\n            const remoteSubscription = this.remoteSubscriptions.find(sub => sub.callback === subscription.callback);\n            if (remoteSubscription) {\n                // Remove\n                this.remoteSubscriptions.splice(this.remoteSubscriptions.indexOf(remoteSubscription), 1);\n                // Send ack\n                // return sendMessage({ type: 'unsubscribe_ack', from: tabId, to: remoteSubscription.for, data: { path: subscription.path, event: subscription.event } });\n                return;\n            }\n            this.ourSubscriptions\n                .filter(sub => sub.path === subscription.path && (!subscription.event || sub.event === subscription.event) && (!subscription.callback || sub.callback === subscription.callback))\n                .forEach(sub => {\n                // Remove from our subscriptions\n                this.ourSubscriptions.splice(this.ourSubscriptions.indexOf(sub), 1);\n                // Request other tabs to stop notifying\n                const message = { type: 'unsubscribe', from: this.id, data: { path: sub.path, event: sub.event } };\n                this.sendMessage(message);\n            });\n        });\n    }\n    /**\n     * Requests the peer to shut down. Resolves once its locks are cleared and 'exit' event has been emitted.\n     * Has to be overridden by the IPC implementation to perform custom shutdown tasks\n     * @param code optional exit code (eg one provided by SIGINT event)\n     */\n    async exit(code = 0) {\n        if (this._exiting) {\n            // Already exiting...\n            return this.once('exit');\n        }\n        this._exiting = true;\n        this.storage.debug.warn(`Received ${this.isMaster ? 'master' : 'worker ' + this.id} process exit request`);\n        if (this._locks.length > 0) {\n            this.storage.debug.warn(`Waiting for ${this.isMaster ? 'master' : 'worker'} ${this.id} locks to clear`);\n            await this.once('locks-cleared');\n        }\n        // Send \"bye\"\n        this.sayGoodbye(this.id);\n        this.storage.debug.warn(`${this.isMaster ? 'Master' : 'Worker ' + this.id} will now exit`);\n        this.emitOnce('exit', code);\n    }\n    sayGoodbye(forPeerId) {\n        // Send \"bye\" message on their behalf\n        const bye = { type: 'bye', from: forPeerId, data: undefined };\n        this.sendMessage(bye);\n    }\n    addPeer(id, sendReply = true) {\n        if (this._exiting) {\n            return;\n        }\n        const peer = this.peers.find(w => w.id === id);\n        if (!peer) {\n            this.peers.push({ id, lastSeen: Date.now() });\n        }\n        if (sendReply) {\n            // Send hello back to sender\n            const helloMessage = { type: 'hello', from: this.id, to: id, data: undefined };\n            this.sendMessage(helloMessage);\n            // Send our active subscriptions through\n            this.ourSubscriptions.forEach(sub => {\n                // Request to keep us updated\n                const message = { type: 'subscribe', from: this.id, to: id, data: { path: sub.path, event: sub.event } };\n                this.sendMessage(message);\n            });\n        }\n    }\n    removePeer(id, ignoreUnknown = false) {\n        if (this._exiting) {\n            return;\n        }\n        const peer = this.peers.find(peer => peer.id === id);\n        if (!peer) {\n            if (!ignoreUnknown) {\n                throw new Error(`We are supposed to know this peer!`);\n            }\n            return;\n        }\n        this.peers.splice(this.peers.indexOf(peer), 1);\n        // Remove their subscriptions\n        const subscriptions = this.remoteSubscriptions.filter(sub => sub.for === id);\n        subscriptions.forEach(sub => {\n            // Remove & stop their subscription\n            this.remoteSubscriptions.splice(this.remoteSubscriptions.indexOf(sub), 1);\n            this.storage.subscriptions.remove(sub.path, sub.event, sub.callback);\n        });\n    }\n    addRemoteSubscription(peerId, details) {\n        if (this._exiting) {\n            return;\n        }\n        // this.storage.debug.log(`remote subscription being added`);\n        if (this.remoteSubscriptions.some(sub => sub.for === peerId && sub.event === details.event && sub.path === details.path)) {\n            // We're already serving this event for the other peer. Ignore\n            return;\n        }\n        // Add remote subscription\n        const subscribeCallback = (err, path, val, previous, context) => {\n            // db triggered an event, send notification to remote subscriber\n            const eventMessage = {\n                type: 'event',\n                from: this.id,\n                to: peerId,\n                path: details.path,\n                event: details.event,\n                data: {\n                    path,\n                    val,\n                    previous,\n                    context,\n                },\n            };\n            this.sendMessage(eventMessage);\n        };\n        this.remoteSubscriptions.push({ for: peerId, event: details.event, path: details.path, callback: subscribeCallback });\n        this.storage.subscriptions.add(details.path, details.event, subscribeCallback);\n    }\n    cancelRemoteSubscription(peerId, details) {\n        // Other tab requests to remove previously subscribed event\n        const sub = this.remoteSubscriptions.find(sub => sub.for === peerId && sub.event === details.event && sub.path === details.event);\n        if (!sub) {\n            // We don't know this subscription so we weren't notifying in the first place. Ignore\n            return;\n        }\n        // Stop subscription\n        this.storage.subscriptions.remove(details.path, details.event, sub.callback);\n    }\n    async handleMessage(message) {\n        switch (message.type) {\n            case 'hello': return this.addPeer(message.from, message.to !== this.id);\n            case 'bye': return this.removePeer(message.from, true);\n            case 'subscribe': return this.addRemoteSubscription(message.from, message.data);\n            case 'unsubscribe': return this.cancelRemoteSubscription(message.from, message.data);\n            case 'event': {\n                if (!this._eventsEnabled) {\n                    // IPC event handling is disabled for this client. Ignore message.\n                    break;\n                }\n                const eventMessage = message;\n                const context = eventMessage.data.context || {};\n                context.acebase_ipc = { type: this.ipcType, origin: eventMessage.from }; // Add IPC details\n                // Other peer raised an event we are monitoring\n                const subscriptions = this.ourSubscriptions.filter(sub => sub.event === eventMessage.event && sub.path === eventMessage.path);\n                subscriptions.forEach(sub => {\n                    sub.callback(null, eventMessage.data.path, eventMessage.data.val, eventMessage.data.previous, context);\n                });\n                break;\n            }\n            case 'lock-request': {\n                // Lock request sent by worker to master\n                if (!this.isMaster) {\n                    throw new Error(`Workers are not supposed to receive lock requests!`);\n                }\n                const request = message;\n                const result = { type: 'lock-result', id: request.id, from: this.id, to: request.from, ok: true, data: undefined };\n                try {\n                    const lock = await this.lock(request.data);\n                    result.data = {\n                        id: lock.id,\n                        path: lock.path,\n                        tid: lock.tid,\n                        write: lock.forWriting,\n                        expires: lock.expires,\n                        comment: lock.comment,\n                    };\n                }\n                catch (err) {\n                    result.ok = false;\n                    result.reason = err.stack || err.message || err;\n                }\n                return this.sendMessage(result);\n            }\n            case 'lock-result': {\n                // Lock result sent from master to worker\n                if (this.isMaster) {\n                    throw new Error(`Masters are not supposed to receive results for lock requests!`);\n                }\n                const result = message;\n                const request = this._requests.get(result.id);\n                if (typeof request !== 'object') {\n                    throw new Error(`The request must be known to us!`);\n                }\n                if (result.ok) {\n                    request.resolve(result.data);\n                }\n                else {\n                    request.reject(new Error(result.reason));\n                }\n                return;\n            }\n            case 'unlock-request': {\n                // lock release request sent from worker to master\n                if (!this.isMaster) {\n                    throw new Error(`Workers are not supposed to receive unlock requests!`);\n                }\n                const request = message;\n                const result = { type: 'unlock-result', id: request.id, from: this.id, to: request.from, ok: true, data: { id: request.data.id } };\n                try {\n                    const lockInfo = this._locks.find(l => l.lock?.id === request.data.id); // this._locks.get(request.data.id);\n                    await lockInfo.lock.release(); //this.unlock(request.data.id);\n                }\n                catch (err) {\n                    result.ok = false;\n                    result.reason = err.stack || err.message || err;\n                }\n                return this.sendMessage(result);\n            }\n            case 'unlock-result': {\n                // lock release result sent from master to worker\n                if (this.isMaster) {\n                    throw new Error(`Masters are not supposed to receive results for unlock requests!`);\n                }\n                const result = message;\n                const request = this._requests.get(result.id);\n                if (typeof request !== 'object') {\n                    throw new Error(`The request must be known to us!`);\n                }\n                if (result.ok) {\n                    request.resolve(result.data);\n                }\n                else {\n                    request.reject(new Error(result.reason));\n                }\n                return;\n            }\n            case 'move-lock-request': {\n                // move lock request sent from worker to master\n                if (!this.isMaster) {\n                    throw new Error(`Workers are not supposed to receive move lock requests!`);\n                }\n                const request = message;\n                const result = { type: 'lock-result', id: request.id, from: this.id, to: request.from, ok: true, data: undefined };\n                try {\n                    let movedLock;\n                    // const lock = this._locks.get(request.data.id);\n                    const lockRequest = this._locks.find(r => r.lock?.id === request.data.id);\n                    if (request.data.move_to === 'parent') {\n                        movedLock = await lockRequest.lock.moveToParent();\n                    }\n                    else {\n                        throw new Error(`Unknown lock move_to \"${request.data.move_to}\"`);\n                    }\n                    // this._locks.delete(request.data.id);\n                    // this._locks.set(movedLock.id, movedLock);\n                    lockRequest.lock = movedLock;\n                    result.data = {\n                        id: movedLock.id,\n                        path: movedLock.path,\n                        tid: movedLock.tid,\n                        write: movedLock.forWriting,\n                        expires: movedLock.expires,\n                        comment: movedLock.comment,\n                    };\n                }\n                catch (err) {\n                    result.ok = false;\n                    result.reason = err.stack || err.message || err;\n                }\n                return this.sendMessage(result);\n            }\n            case 'notification': {\n                // Custom notification received - raise event\n                return this.emit('notification', message);\n            }\n            case 'request': {\n                // Custom message received - raise event\n                return this.emit('request', message);\n            }\n            case 'result': {\n                // Result of custom request received - raise event\n                const result = message;\n                const request = this._requests.get(result.id);\n                if (typeof request !== 'object') {\n                    throw new Error(`Result of unknown request received`);\n                }\n                if (result.ok) {\n                    request.resolve(result.data);\n                }\n                else {\n                    request.reject(new Error(result.reason));\n                }\n            }\n        }\n    }\n    /**\n     * Acquires a lock. If this peer is a worker, it will request the lock from the master\n     * @param details\n     */\n    async lock(details) {\n        if (this._exiting) {\n            // Peer is exiting. Do we have an existing lock with requested tid? If not, deny request.\n            const tidApproved = this._locks.find(l => l.tid === details.tid && l.granted);\n            if (!tidApproved) {\n                // We have no previously granted locks for this transaction. Deny.\n                throw new AceBaseIPCPeerExitingError('new transaction lock denied because the IPC peer is exiting');\n            }\n        }\n        const removeLock = (lockDetails) => {\n            this._locks.splice(this._locks.indexOf(lockDetails), 1);\n            if (this._locks.length === 0) {\n                // this.storage.debug.log(`No more locks in worker ${this.id}`);\n                this.emit('locks-cleared');\n            }\n        };\n        if (this.isMaster) {\n            // Master\n            const lockInfo = { tid: details.tid, granted: false, request: details, lock: null };\n            this._locks.push(lockInfo);\n            const lock = await this._nodeLocker.lock(details.path, details.tid, details.write, details.comment);\n            lockInfo.tid = lock.tid;\n            lockInfo.granted = true;\n            const createIPCLock = (lock) => {\n                return {\n                    get id() { return lock.id; },\n                    get tid() { return lock.tid; },\n                    get path() { return lock.path; },\n                    get forWriting() { return lock.forWriting; },\n                    get expires() { return lock.expires; },\n                    get comment() { return lock.comment; },\n                    get state() { return lock.state; },\n                    release: async () => {\n                        await lock.release();\n                        removeLock(lockInfo);\n                    },\n                    moveToParent: async () => {\n                        const parentLock = await lock.moveToParent();\n                        lockInfo.lock = createIPCLock(parentLock);\n                        return lockInfo.lock;\n                    },\n                };\n            };\n            lockInfo.lock = createIPCLock(lock);\n            return lockInfo.lock;\n        }\n        else {\n            // Worker\n            const lockInfo = { tid: details.tid, granted: false, request: details, lock: null };\n            this._locks.push(lockInfo);\n            const createIPCLock = (result) => {\n                lockInfo.granted = true;\n                lockInfo.tid = result.tid;\n                lockInfo.lock = {\n                    id: result.id,\n                    tid: result.tid,\n                    path: result.path,\n                    forWriting: result.write,\n                    state: LOCK_STATE.LOCKED,\n                    expires: result.expires,\n                    comment: result.comment,\n                    release: async () => {\n                        const req = { type: 'unlock-request', id: ID.generate(), from: this.id, to: this.masterPeerId, data: { id: lockInfo.lock.id } };\n                        await this.request(req);\n                        lockInfo.lock.state = LOCK_STATE.DONE;\n                        this.storage.debug.verbose(`Worker ${this.id} released lock ${lockInfo.lock.id} (tid ${lockInfo.lock.tid}, ${lockInfo.lock.comment}, \"/${lockInfo.lock.path}\", ${lockInfo.lock.forWriting ? 'write' : 'read'})`);\n                        removeLock(lockInfo);\n                    },\n                    moveToParent: async () => {\n                        const req = { type: 'move-lock-request', id: ID.generate(), from: this.id, to: this.masterPeerId, data: { id: lockInfo.lock.id, move_to: 'parent' } };\n                        let result;\n                        try {\n                            result = await this.request(req);\n                        }\n                        catch (err) {\n                            // We didn't get new lock?!\n                            lockInfo.lock.state = LOCK_STATE.DONE;\n                            removeLock(lockInfo);\n                            throw err;\n                        }\n                        lockInfo.lock = createIPCLock(result);\n                        return lockInfo.lock;\n                    },\n                };\n                // this.storage.debug.log(`Worker ${this.id} received lock ${lock.id} (tid ${lock.tid}, ${lock.comment}, \"/${lock.path}\", ${lock.forWriting ? 'write' : 'read'})`);\n                return lockInfo.lock;\n            };\n            const req = { type: 'lock-request', id: ID.generate(), from: this.id, to: this.masterPeerId, data: details };\n            let result, err;\n            try {\n                result = await this.request(req);\n            }\n            catch (e) {\n                err = e;\n                result = null;\n            }\n            if (err) {\n                removeLock(lockInfo);\n                throw err;\n            }\n            return createIPCLock(result);\n        }\n    }\n    async request(req) {\n        // Send request, return result promise\n        let resolve, reject;\n        const promise = new Promise((rs, rj) => {\n            resolve = (result) => {\n                this._requests.delete(req.id);\n                rs(result);\n            };\n            reject = (err) => {\n                this._requests.delete(req.id);\n                rj(err);\n            };\n        });\n        this._requests.set(req.id, { resolve, reject, request: req });\n        this.sendMessage(req);\n        return promise;\n    }\n    /**\n     * Sends a custom request to the IPC master\n     * @param request\n     * @returns\n     */\n    sendRequest(request) {\n        const req = { type: 'request', from: this.id, to: this.masterPeerId, id: ID.generate(), data: request };\n        return this.request(req)\n            .catch(err => {\n            this.storage.debug.error(err);\n            throw err;\n        });\n    }\n    replyRequest(requestMessage, result) {\n        const reply = { type: 'result', id: requestMessage.id, ok: true, from: this.id, to: requestMessage.from, data: result };\n        this.sendMessage(reply);\n    }\n    /**\n     * Sends a custom notification to all IPC peers\n     * @param notification\n     * @returns\n     */\n    sendNotification(notification) {\n        const msg = { type: 'notification', from: this.id, data: notification };\n        this.sendMessage(msg);\n    }\n    /**\n     * If ipc event handling is currently enabled\n     */\n    get eventsEnabled() { return this._eventsEnabled; }\n    /**\n     * Enables or disables ipc event handling. When disabled, incoming event messages will be ignored.\n     */\n    set eventsEnabled(enabled) {\n        this.storage.debug.log(`ipc events ${enabled ? 'enabled' : 'disabled'}`);\n        this._eventsEnabled = enabled;\n    }\n}\n//# sourceMappingURL=ipc.js.map","import { ID, Transport } from 'acebase-core';\nimport { AceBaseIPCPeer } from './ipc.js';\nimport { NotSupported } from '../not-supported.js';\n/**\n * Browser tabs IPC. Database changes and events will be synchronized automatically.\n * Locking of resources will be done by the election of a single locking master:\n * the one with the lowest id.\n */\nexport class IPCPeer extends AceBaseIPCPeer {\n    constructor(storage) {\n        super(storage, ID.generate());\n        this.masterPeerId = this.id; // We don't know who the master is yet...\n        this.ipcType = 'browser.bcc';\n        // Setup process exit handler\n        // Monitor onbeforeunload event to say goodbye when the window is closed\n        window.addEventListener('beforeunload', () => {\n            this.exit();\n        });\n        // Create BroadcastChannel to allow multi-tab communication\n        // This allows other tabs to make changes to the database, notifying us of those changes.\n        if (typeof window.BroadcastChannel !== 'undefined') {\n            this.channel = new BroadcastChannel(`acebase:${storage.name}`);\n        }\n        else {\n            // Use localStorage as polyfill for Safari & iOS WebKit\n            const listeners = [null]; // first callback reserved for onmessage handler\n            const notImplemented = () => { throw new Error('Not implemented'); };\n            this.channel = {\n                name: `acebase:${storage.name}`,\n                postMessage: (message) => {\n                    const messageId = ID.generate(), key = `acebase:${storage.name}:${this.id}:${messageId}`, payload = JSON.stringify(Transport.serialize(message));\n                    // Store message, triggers 'storage' event in other tabs\n                    localStorage.setItem(key, payload);\n                    // Remove after 10ms\n                    setTimeout(() => localStorage.removeItem(key), 10);\n                },\n                set onmessage(handler) { listeners[0] = handler; },\n                set onmessageerror(handler) { notImplemented(); },\n                close() { notImplemented(); },\n                addEventListener(event, callback) {\n                    if (event !== 'message') {\n                        notImplemented();\n                    }\n                    listeners.push(callback);\n                },\n                removeEventListener(event, callback) {\n                    const i = listeners.indexOf(callback);\n                    i >= 1 && listeners.splice(i, 1);\n                },\n                dispatchEvent(event) {\n                    listeners.forEach(callback => {\n                        try {\n                            callback && callback(event);\n                        }\n                        catch (err) {\n                            console.error(err);\n                        }\n                    });\n                    return true;\n                },\n            };\n            // Listen for storage events to intercept possible messages\n            window.addEventListener('storage', event => {\n                const [acebase, dbname, peerId, messageId] = event.key.split(':');\n                if (acebase !== 'acebase' || dbname !== storage.name || peerId === this.id || event.newValue === null) {\n                    return;\n                }\n                const message = Transport.deserialize(JSON.parse(event.newValue));\n                this.channel.dispatchEvent({ data: message });\n            });\n        }\n        // Monitor incoming messages\n        this.channel.addEventListener('message', async (event) => {\n            const message = event.data;\n            if (message.to && message.to !== this.id) {\n                // Message is for somebody else. Ignore\n                return;\n            }\n            storage.debug.verbose(`[BroadcastChannel] received: `, message);\n            if (message.type === 'hello' && message.from < this.masterPeerId) {\n                // This peer was created before other peer we thought was the master\n                this.masterPeerId = message.from;\n                storage.debug.log(`[BroadcastChannel] Tab ${this.masterPeerId} is the master.`);\n            }\n            else if (message.type === 'bye' && message.from === this.masterPeerId) {\n                // The master tab is leaving\n                storage.debug.log(`[BroadcastChannel] Master tab ${this.masterPeerId} is leaving`);\n                // Elect new master\n                const allPeerIds = this.peers.map(peer => peer.id).concat(this.id).filter(id => id !== this.masterPeerId); // All peers, including us, excluding the leaving master peer\n                this.masterPeerId = allPeerIds.sort()[0];\n                storage.debug.log(`[BroadcastChannel] ${this.masterPeerId === this.id ? 'We are' : `tab ${this.masterPeerId} is`} the new master. Requesting ${this._locks.length} locks (${this._locks.filter(r => !r.granted).length} pending)`);\n                // Let the new master take over any locks and lock requests.\n                const requests = this._locks.splice(0); // Copy and clear current lock requests before granted locks are requested again.\n                // Request previously granted locks again\n                await Promise.all(requests.filter(req => req.granted).map(async (req) => {\n                    // Prevent race conditions: if the existing lock is released or moved to parent before it was\n                    // moved to the new master peer, we'll resolve their promises after releasing/moving the new lock\n                    let released, movedToParent;\n                    req.lock.release = () => { return new Promise(resolve => released = resolve); };\n                    req.lock.moveToParent = () => { return new Promise(resolve => movedToParent = resolve); };\n                    // Request lock again:\n                    const lock = await this.lock({ path: req.lock.path, write: req.lock.forWriting, tid: req.lock.tid, comment: req.lock.comment });\n                    if (movedToParent) {\n                        const newLock = await lock.moveToParent();\n                        movedToParent(newLock);\n                    }\n                    if (released) {\n                        await lock.release();\n                        released();\n                    }\n                }));\n                // Now request pending locks again\n                await Promise.all(requests.filter(req => !req.granted).map(async (req) => {\n                    await this.lock(req.request);\n                }));\n            }\n            return this.handleMessage(message);\n        });\n        // // Schedule periodic \"pulse\" to let others know we're still around\n        // setInterval(() => {\n        //     sendMessage(<IPulseMessage>{ from: tabId, type: 'pulse' });\n        // }, 30000);\n        // Send hello to other peers\n        const helloMsg = { type: 'hello', from: this.id, data: undefined };\n        this.sendMessage(helloMsg);\n    }\n    sendMessage(message) {\n        this.storage.debug.verbose(`[BroadcastChannel] sending: `, message);\n        this.channel.postMessage(message);\n    }\n}\n/**\n * Not supported in browser context\n */\nexport { NotSupported as RemoteIPCPeer, NotSupported as IPCSocketPeer, NotSupported as NetIPCServer, };\n//# sourceMappingURL=browser.js.map","export class pfs {\n    static get hasFileSystem() { return false; }\n    static get fs() { return null; }\n}\n//# sourceMappingURL=browser.js.map","import { NotSupported } from '../not-supported.js';\n/**\n * Not supported in browser context\n */\nexport class DataIndex extends NotSupported {\n}\n/**\n * Not supported in browser context\n */\nexport class FullTextIndex extends NotSupported {\n}\n/**\n * Not supported in browser context\n */\nexport class GeoIndex extends NotSupported {\n}\n/**\n * Not supported in browser context\n */\nexport class ArrayIndex extends NotSupported {\n}\n//# sourceMappingURL=browser.js.map","import { ColorStyle } from 'acebase-core';\nimport { DataIndex, ArrayIndex, FullTextIndex, GeoIndex } from '../data-index/index.js';\nimport { pfs } from '../promise-fs/index.js';\n/**\n* Creates an index on specified path and key(s)\n* @param path location of objects to be indexed. Eg: \"users\" to index all children of the \"users\" node; or \"chats/*\\/members\" to index all members of all chats\n* @param key for now - one key to index. Once our B+tree implementation supports nested trees, we can allow multiple fields\n*/\nexport async function createIndex(context, path, key, options) {\n    if (!context.storage.indexes.supported) {\n        throw new Error('Indexes are not supported in current environment because it requires Node.js fs');\n    }\n    // path = path.replace(/\\/\\*$/, \"\"); // Remove optional trailing \"/*\"\n    const { ipc, debug, indexes, storage } = context;\n    const rebuild = options && options.rebuild === true;\n    const indexType = (options && options.type) || 'normal';\n    let includeKeys = (options && options.include) || [];\n    if (typeof includeKeys === 'string') {\n        includeKeys = [includeKeys];\n    }\n    const existingIndex = indexes.find(index => index.path === path && index.key === key && index.type === indexType\n        && index.includeKeys.length === includeKeys.length\n        && index.includeKeys.every((key, index) => includeKeys[index] === key));\n    if (existingIndex && options.config) {\n        // Additional index config params are not saved to index files, apply them to the in-memory index now\n        existingIndex.config = options.config;\n    }\n    if (existingIndex && rebuild !== true) {\n        debug.log(`Index on \"/${path}/*/${key}\" already exists`.colorize(ColorStyle.inverse));\n        return existingIndex;\n    }\n    if (!ipc.isMaster) {\n        // Pass create request to master\n        const result = await ipc.sendRequest({ type: 'index.create', path, key, options });\n        if (result.ok) {\n            return storage.indexes.add(result.fileName);\n        }\n        throw new Error(result.reason);\n    }\n    await pfs.mkdir(`${storage.settings.path}/${storage.name}.acebase`).catch(err => {\n        if (err.code !== 'EEXIST') {\n            throw err;\n        }\n    });\n    const index = existingIndex || (() => {\n        const { include, caseSensitive, textLocale, textLocaleKey } = options;\n        const indexOptions = { include, caseSensitive, textLocale, textLocaleKey };\n        switch (indexType) {\n            case 'array': return new ArrayIndex(storage, path, key, { ...indexOptions });\n            case 'fulltext': return new FullTextIndex(storage, path, key, { ...indexOptions, config: options.config });\n            case 'geo': return new GeoIndex(storage, path, key, { ...indexOptions });\n            default: return new DataIndex(storage, path, key, { ...indexOptions });\n        }\n    })();\n    if (!existingIndex) {\n        indexes.push(index);\n    }\n    try {\n        await index.build();\n    }\n    catch (err) {\n        context.debug.error(`Index build on \"/${path}/*/${key}\" failed: ${err.message} (code: ${err.code})`.colorize(ColorStyle.red));\n        if (!existingIndex) {\n            // Only remove index if we added it. Build may have failed because someone tried creating the index more than once, or rebuilding it while it was building...\n            indexes.splice(indexes.indexOf(index), 1);\n        }\n        throw err;\n    }\n    ipc.sendNotification({ type: 'index.created', fileName: index.fileName, path, key, options });\n    return index;\n}\n//# sourceMappingURL=create-index.js.map","import { Utils, DebugLogger, PathInfo, ID, PathReference, ascii85, SimpleEventEmitter, SchemaDefinition } from 'acebase-core';\nimport { VALUE_TYPES } from '../node-value-types.js';\nimport { NodeRevisionError } from '../node-errors.js';\nimport { NodeInfo } from '../node-info.js';\nimport { IPCPeer, RemoteIPCPeer, IPCSocketPeer, NetIPCServer } from '../ipc/index.js';\nimport { pfs } from '../promise-fs/index.js';\n// const { IPCTransactionManager } = require('./node-transaction');\nimport { DataIndex } from '../data-index/index.js'; // Indexing might not be available: the browser dist bundle doesn't include it because fs is not available: browserify --i ./src/data-index.js\nimport { createIndex } from './indexes.js';\nimport { assert } from '../assert.js';\nconst { compareValues, getChildValues, encodeString, defer } = Utils;\nconst DEBUG_MODE = false;\nconst SUPPORTED_EVENTS = ['value', 'child_added', 'child_changed', 'child_removed', 'mutated', 'mutations'];\n// Add 'notify_*' event types for each event to enable data-less notifications, so data retrieval becomes optional\nSUPPORTED_EVENTS.push(...SUPPORTED_EVENTS.map(event => `notify_${event}`));\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst NOOP = () => { };\nexport class SchemaValidationError extends Error {\n    constructor(reason) {\n        super(`Schema validation failed: ${reason}`);\n        this.reason = reason;\n    }\n}\n/**\n * Storage Settings\n */\nexport class StorageSettings {\n    constructor(settings = {}) {\n        /**\n         * in bytes, max amount of child data to store within a parent record before moving to a dedicated record. Default is 50\n         * @default 50\n         */\n        this.maxInlineValueSize = 50;\n        /**\n         * Instead of throwing errors on undefined values, remove the properties automatically. Default is false\n         * @default false\n         */\n        this.removeVoidProperties = false;\n        /**\n         * Target path to store database files in, default is `'.'`\n         * @default '.'\n         */\n        this.path = '.';\n        /**\n         * timeout setting for read and write locks in seconds. Operations taking longer than this will be aborted. Default is 120 seconds.\n         * @default 120\n         */\n        this.lockTimeout = 120;\n        /**\n         * optional type of storage class - used by `AceBaseStorage` to create different specific db files (data, transaction, auth etc)\n         * @see AceBaseStorageSettings see `AceBaseStorageSettings.type` for more info\n         */\n        this.type = 'data';\n        /**\n         * Whether the database should be opened in readonly mode\n         * @default false\n         */\n        this.readOnly = false;\n        if (typeof settings.maxInlineValueSize === 'number') {\n            this.maxInlineValueSize = settings.maxInlineValueSize;\n        }\n        if (typeof settings.removeVoidProperties === 'boolean') {\n            this.removeVoidProperties = settings.removeVoidProperties;\n        }\n        if (typeof settings.path === 'string') {\n            this.path = settings.path;\n        }\n        if (this.path.endsWith('/')) {\n            this.path = this.path.slice(0, -1);\n        }\n        if (typeof settings.lockTimeout === 'number') {\n            this.lockTimeout = settings.lockTimeout;\n        }\n        if (typeof settings.type === 'string') {\n            this.type = settings.type;\n        }\n        if (typeof settings.readOnly === 'boolean') {\n            this.readOnly = settings.readOnly;\n        }\n        if (['object', 'string'].includes(typeof settings.ipc)) {\n            this.ipc = settings.ipc;\n        }\n    }\n}\nexport class Storage extends SimpleEventEmitter {\n    createTid() {\n        return DEBUG_MODE ? ++this._lastTid : ID.generate();\n    }\n    /**\n     * Base class for database storage, must be extended by back-end specific methods.\n     * Currently implemented back-ends are AceBaseStorage, SQLiteStorage, MSSQLStorage, CustomStorage\n     * @param name name of the database\n     * @param settings instance of AceBaseStorageSettings or SQLiteStorageSettings\n     */\n    constructor(name, settings, env) {\n        super();\n        this.name = name;\n        this.settings = settings;\n        // private _validation = new Map<string, { validate?: (previous: any, value: any) => boolean, schema?: SchemaDefinition }>;\n        this._schemas = [];\n        this._indexes = [];\n        this._annoucedIndexes = new Map();\n        this.indexes = {\n            /**\n             * Tests if (the default storage implementation of) indexes are supported in the environment.\n             * They are currently only supported when running in Node.js because they use the fs filesystem.\n             * TODO: Implement storage specific indexes (eg in SQLite, MySQL, MSSQL, in-memory)\n             */\n            get supported() {\n                return pfs?.hasFileSystem;\n            },\n            create: (path, key, options = {\n                rebuild: false,\n            }) => {\n                const context = { storage: this, debug: this.debug, indexes: this._indexes, ipc: this.ipc };\n                return createIndex(context, path, key, options);\n            },\n            /**\n             * Returns indexes at a path, or a specific index on a key in that path\n             */\n            get: (path, key = null) => {\n                if (path.includes('$')) {\n                    // Replace $variables in path with * wildcards\n                    const pathKeys = PathInfo.getPathKeys(path).map(key => typeof key === 'string' && key.startsWith('$') ? '*' : key);\n                    path = (new PathInfo(pathKeys)).path;\n                }\n                return this._indexes.filter(index => index.path === path &&\n                    (key === null || key === index.key));\n            },\n            /**\n             * Returns all indexes on a target path, optionally includes indexes on child and parent paths\n             */\n            getAll: (targetPath, options = { parentPaths: true, childPaths: true }) => {\n                const pathKeys = PathInfo.getPathKeys(targetPath);\n                return this._indexes.filter(index => {\n                    const indexKeys = PathInfo.getPathKeys(index.path + '/*');\n                    // check if index is on a parent node of given path:\n                    if (options.parentPaths && indexKeys.every((key, i) => { return key === '*' || pathKeys[i] === key; }) && [index.key].concat(...index.includeKeys).includes(pathKeys[indexKeys.length])) {\n                        // eg: path = 'restaurants/1/location/lat', index is on 'restaurants(/*)', key 'location'\n                        return true;\n                    }\n                    else if (indexKeys.length < pathKeys.length) {\n                        // the index is on a higher path, and did not match above parent paths check\n                        return false;\n                    }\n                    else if (!options.childPaths && indexKeys.length !== pathKeys.length) {\n                        // no checking for indexes on child paths and index path has more or less keys than path\n                        // eg: path = 'restaurants/1', index is on child path 'restaurants/*/reviews(/*)', key 'rating'\n                        return false;\n                    }\n                    // check if all path's keys match the index path\n                    // eg: path = 'restaurants/1', index is on 'restaurants(/*)', key 'name'\n                    // or: path = 'restaurants/1', index is on 'restaurants/*/reviews(/*)', key 'rating' (and options.childPaths === true)\n                    return pathKeys.every((key, i) => {\n                        return [key, '*'].includes(indexKeys[i]); //key === indexKeys[i] || indexKeys[i] === '*';\n                    });\n                });\n            },\n            /**\n             * Returns all indexes\n             */\n            list: () => {\n                return this._indexes.slice();\n            },\n            /**\n             * Discovers and populates all created indexes\n             */\n            load: async () => {\n                this._indexes.splice(0);\n                if (!pfs.hasFileSystem) {\n                    // If pfs (fs) is not available, don't try using it\n                    return;\n                }\n                let files = [];\n                try {\n                    files = (await pfs.readdir(`${this.settings.path}/${this.name}.acebase`));\n                }\n                catch (err) {\n                    if (err.code !== 'ENOENT') {\n                        // If the directory is not found, there are no file indexes. (probably not supported by used storage class)\n                        // Only complain if error is something else\n                        this.debug.error(err);\n                    }\n                }\n                const promises = [];\n                files.forEach(fileName => {\n                    if (!fileName.endsWith('.idx')) {\n                        return;\n                    }\n                    const needsStoragePrefix = this.settings.type !== 'data'; // auth indexes need to start with \"[auth]-\" and have to be ignored by other storage types\n                    const hasStoragePrefix = /^\\[[a-z]+\\]-/.test(fileName);\n                    if ((!needsStoragePrefix && !hasStoragePrefix) || needsStoragePrefix && fileName.startsWith(`[${this.settings.type}]-`)) {\n                        const p = this.indexes.add(fileName);\n                        promises.push(p);\n                    }\n                });\n                await Promise.all(promises);\n            },\n            add: async (fileName) => {\n                const existingIndex = this._indexes.find(index => index.fileName === fileName);\n                if (existingIndex) {\n                    return existingIndex;\n                }\n                else if (this._annoucedIndexes.has(fileName)) {\n                    // Index is already in the process of being added, wait until it becomes availabe\n                    const index = await this._annoucedIndexes.get(fileName);\n                    return index;\n                }\n                try {\n                    // Announce the index to prevent race condition in between reading and receiving the IPC index.created notification\n                    const indexPromise = DataIndex.readFromFile(this, fileName);\n                    this._annoucedIndexes.set(fileName, indexPromise);\n                    const index = await indexPromise;\n                    this._indexes.push(index);\n                    this._annoucedIndexes.delete(fileName);\n                    return index;\n                }\n                catch (err) {\n                    this.debug.error(err);\n                    return null;\n                }\n            },\n            /**\n             * Deletes an index from the database\n             */\n            delete: async (fileName) => {\n                const index = await this.indexes.remove(fileName);\n                await index.delete();\n                this.ipc.sendNotification({ type: 'index.deleted', fileName: index.fileName, path: index.path, keys: index.key });\n            },\n            /**\n             * Removes an index from the list. Does not delete the actual file, `delete` does that!\n             * @returns returns the removed index\n             */\n            remove: async (fileName) => {\n                const index = this._indexes.find(index => index.fileName === fileName);\n                if (!index) {\n                    throw new Error(`Index ${fileName} not found`);\n                }\n                this._indexes.splice(this._indexes.indexOf(index), 1);\n                return index;\n            },\n            close: async () => {\n                // Close all indexes\n                const promises = this.indexes.list().map(index => index.close().catch(err => this.debug.error(err)));\n                await Promise.all(promises);\n            },\n        };\n        this._eventSubscriptions = {};\n        this.subscriptions = {\n            /**\n             * Adds a subscription to a node\n             * @param path Path to the node to add subscription to\n             * @param type Type of the subscription\n             * @param callback Subscription callback function\n             */\n            add: (path, type, callback) => {\n                if (SUPPORTED_EVENTS.indexOf(type) < 0) {\n                    throw new TypeError(`Invalid event type \"${type}\"`);\n                }\n                let pathSubs = this._eventSubscriptions[path];\n                if (!pathSubs) {\n                    pathSubs = this._eventSubscriptions[path] = [];\n                }\n                // if (pathSubs.findIndex(ps => ps.type === type && ps.callback === callback)) {\n                //     storage.debug.warn(`Identical subscription of type ${type} on path \"${path}\" being added`);\n                // }\n                pathSubs.push({ created: Date.now(), type, callback });\n                this.emit('subscribe', { path, event: type, callback }); // Enables IPC peers to be notified\n            },\n            /**\n             * Removes 1 or more subscriptions from a node\n             * @param path Path to the node to remove the subscription from\n             * @param type Type of subscription(s) to remove (optional: if omitted all types will be removed)\n             * @param callback Callback to remove (optional: if omitted all of the same type will be removed)\n             */\n            remove: (path, type, callback) => {\n                const pathSubs = this._eventSubscriptions[path];\n                if (!pathSubs) {\n                    return;\n                }\n                const next = () => pathSubs.findIndex(ps => (type ? ps.type === type : true) && (callback ? ps.callback === callback : true));\n                let i;\n                while ((i = next()) >= 0) {\n                    pathSubs.splice(i, 1);\n                }\n                this.emit('unsubscribe', { path, event: type, callback }); // Enables IPC peers to be notified\n            },\n            /**\n             * Checks if there are any subscribers at given path that need the node's previous value when a change is triggered\n             * @param path\n             */\n            hasValueSubscribersForPath(path) {\n                const valueNeeded = this.getValueSubscribersForPath(path);\n                return !!valueNeeded;\n            },\n            /**\n             * Gets all subscribers at given path that need the node's previous value when a change is triggered\n             * @param path\n             */\n            getValueSubscribersForPath: (path) => {\n                // Subscribers that MUST have the entire previous value of a node before updating:\n                //  - \"value\" events on the path itself, and any ancestor path\n                //  - \"child_added\", \"child_removed\" events on the parent path\n                //  - \"child_changed\" events on the parent path and its ancestors\n                //  - ALL events on child/descendant paths\n                const pathInfo = new PathInfo(path);\n                const valueSubscribers = [];\n                Object.keys(this._eventSubscriptions).forEach(subscriptionPath => {\n                    if (pathInfo.equals(subscriptionPath) || pathInfo.isDescendantOf(subscriptionPath)) {\n                        // path being updated === subscriptionPath, or a child/descendant path of it\n                        // eg path === \"posts/123/title\"\n                        // and subscriptionPath is \"posts/123/title\", \"posts/$postId/title\", \"posts/123\", \"posts/*\", \"posts\" etc\n                        const pathSubs = this._eventSubscriptions[subscriptionPath];\n                        const eventPath = PathInfo.fillVariables(subscriptionPath, path);\n                        pathSubs\n                            .filter(sub => !sub.type.startsWith('notify_')) // notify events don't need additional value loading\n                            .forEach(sub => {\n                            let dataPath = null;\n                            if (sub.type === 'value') { // [\"value\", \"notify_value\"].includes(sub.type)\n                                dataPath = eventPath;\n                            }\n                            else if (['mutated', 'mutations'].includes(sub.type) && pathInfo.isDescendantOf(eventPath)) { //[\"mutated\", \"notify_mutated\"].includes(sub.type)\n                                dataPath = path; // Only needed data is the properties being updated in the targeted path\n                            }\n                            else if (sub.type === 'child_changed' && path !== eventPath) { // [\"child_changed\", \"notify_child_changed\"].includes(sub.type)\n                                const childKey = PathInfo.getPathKeys(path.slice(eventPath.length).replace(/^\\//, ''))[0];\n                                dataPath = PathInfo.getChildPath(eventPath, childKey);\n                            }\n                            else if (['child_added', 'child_removed'].includes(sub.type) && pathInfo.isChildOf(eventPath)) { //[\"child_added\", \"child_removed\", \"notify_child_added\", \"notify_child_removed\"]\n                                const childKey = PathInfo.getPathKeys(path.slice(eventPath.length).replace(/^\\//, ''))[0];\n                                dataPath = PathInfo.getChildPath(eventPath, childKey);\n                            }\n                            if (dataPath !== null && !valueSubscribers.some(s => s.type === sub.type && s.eventPath === eventPath)) {\n                                valueSubscribers.push({ type: sub.type, eventPath, dataPath, subscriptionPath });\n                            }\n                        });\n                    }\n                });\n                return valueSubscribers;\n            },\n            /**\n             * Gets all subscribers at given path that could possibly be invoked after a node is updated\n             */\n            getAllSubscribersForPath: (path) => {\n                const pathInfo = PathInfo.get(path);\n                const subscribers = [];\n                Object.keys(this._eventSubscriptions).forEach(subscriptionPath => {\n                    // if (pathInfo.equals(subscriptionPath) //path === subscriptionPath\n                    //     || pathInfo.isDescendantOf(subscriptionPath)\n                    //     || pathInfo.isAncestorOf(subscriptionPath)\n                    // ) {\n                    if (pathInfo.isOnTrailOf(subscriptionPath)) {\n                        const pathSubs = this._eventSubscriptions[subscriptionPath];\n                        const eventPath = PathInfo.fillVariables(subscriptionPath, path);\n                        pathSubs.forEach(sub => {\n                            let dataPath = null;\n                            if (sub.type === 'value' || sub.type === 'notify_value') {\n                                dataPath = eventPath;\n                            }\n                            else if (['child_changed', 'notify_child_changed'].includes(sub.type)) {\n                                const childKey = path === eventPath || pathInfo.isAncestorOf(eventPath)\n                                    ? '*'\n                                    : PathInfo.getPathKeys(path.slice(eventPath.length).replace(/^\\//, ''))[0];\n                                dataPath = PathInfo.getChildPath(eventPath, childKey);\n                            }\n                            else if (['mutated', 'mutations', 'notify_mutated', 'notify_mutations'].includes(sub.type)) {\n                                dataPath = path;\n                            }\n                            else if (['child_added', 'child_removed', 'notify_child_added', 'notify_child_removed'].includes(sub.type)\n                                && (pathInfo.isChildOf(eventPath)\n                                    || path === eventPath\n                                    || pathInfo.isAncestorOf(eventPath))) {\n                                const childKey = path === eventPath || pathInfo.isAncestorOf(eventPath)\n                                    ? '*'\n                                    : PathInfo.getPathKeys(path.slice(eventPath.length).replace(/^\\//, ''))[0];\n                                dataPath = PathInfo.getChildPath(eventPath, childKey); //NodePath(subscriptionPath).childPath(childKey);\n                            }\n                            if (dataPath !== null && !subscribers.some(s => s.type === sub.type && s.eventPath === eventPath && s.subscriptionPath === subscriptionPath)) { // && subscribers.findIndex(s => s.type === sub.type && s.dataPath === dataPath) < 0\n                                subscribers.push({ type: sub.type, eventPath, dataPath, subscriptionPath });\n                            }\n                        });\n                    }\n                });\n                return subscribers;\n            },\n            /**\n             * Triggers subscription events to run on relevant nodes\n             * @param event Event type: \"value\", \"child_added\", \"child_changed\", \"child_removed\"\n             * @param path Path to the node the subscription is on\n             * @param dataPath path to the node the value is stored\n             * @param oldValue old value\n             * @param newValue new value\n             * @param context context used by the client that updated this data\n             */\n            trigger: (event, path, dataPath, oldValue, newValue, context) => {\n                //console.warn(`Event \"${event}\" triggered on node \"/${path}\" with data of \"/${dataPath}\": `, newValue);\n                const pathSubscriptions = this._eventSubscriptions[path] || [];\n                pathSubscriptions.filter(sub => sub.type === event)\n                    .forEach(sub => {\n                    sub.callback(null, dataPath, newValue, oldValue, context);\n                    // if (event.startsWith('notify_')) {\n                    //     // Notify only event, run callback without data\n                    //     sub.callback(null, dataPath);\n                    // }\n                    // else {\n                    //     // Run callback with data\n                    //     sub.callback(null, dataPath, newValue, oldValue);\n                    // }\n                });\n            },\n        };\n        this.debug = new DebugLogger(env.logLevel, `[${name}${typeof settings.type === 'string' && settings.type !== 'data' ? `:${settings.type}` : ''}]`); // `├ ${name} ┤` // `[🧱${name}]`\n        // Setup IPC to allow vertical scaling (multiple threads sharing locks and data)\n        const ipcName = name + (typeof settings.type === 'string' ? `_${settings.type}` : '');\n        if (settings.ipc === 'socket' || settings.ipc instanceof NetIPCServer) {\n            const ipcSettings = { ipcName, server: settings.ipc instanceof NetIPCServer ? settings.ipc : null };\n            this.ipc = new IPCSocketPeer(this, ipcSettings);\n        }\n        else if (settings.ipc) {\n            if (typeof settings.ipc.port !== 'number') {\n                throw new Error('IPC port number must be a number');\n            }\n            if (!['master', 'worker'].includes(settings.ipc.role)) {\n                throw new Error(`IPC client role must be either \"master\" or \"worker\", not \"${settings.ipc.role}\"`);\n            }\n            const ipcSettings = Object.assign({ dbname: ipcName }, settings.ipc);\n            this.ipc = new RemoteIPCPeer(this, ipcSettings);\n        }\n        else {\n            this.ipc = new IPCPeer(this, ipcName);\n        }\n        this.ipc.once('exit', (code) => {\n            // We can perform any custom cleanup here:\n            // - storage-acebase should close the db file\n            // - storage-mssql / sqlite should close connection\n            // - indexes should close their files\n            if (this.indexes.supported) {\n                this.indexes.close();\n            }\n        });\n        this.nodeLocker = {\n            lock: (path, tid, write, comment) => {\n                return this.ipc.lock({ path, tid, write, comment });\n            },\n        };\n        // this.transactionManager = new IPCTransactionManager(this.ipc);\n        this._lastTid = 0;\n    } // end of constructor\n    async close() {\n        // Close the database by calling exit on the ipc channel, which will emit an 'exit' event when the database can be safely closed.\n        await this.ipc.exit();\n    }\n    get path() {\n        return `${this.settings.path}/${this.name}.acebase`;\n    }\n    /**\n     * Checks if a value can be stored in a parent object, or if it should\n     * move to a dedicated record. Uses settings.maxInlineValueSize\n     * @param value\n     */\n    valueFitsInline(value) {\n        if (typeof value === 'number' || typeof value === 'boolean' || value instanceof Date) {\n            return true;\n        }\n        else if (typeof value === 'string') {\n            if (value.length > this.settings.maxInlineValueSize) {\n                return false;\n            }\n            // if the string has unicode chars, its byte size will be bigger than value.length\n            const encoded = encodeString(value);\n            return encoded.length < this.settings.maxInlineValueSize;\n        }\n        else if (value instanceof PathReference) {\n            if (value.path.length > this.settings.maxInlineValueSize) {\n                return false;\n            }\n            // if the path has unicode chars, its byte size will be bigger than value.path.length\n            const encoded = encodeString(value.path);\n            return encoded.length < this.settings.maxInlineValueSize;\n        }\n        else if (value instanceof ArrayBuffer) {\n            return value.byteLength < this.settings.maxInlineValueSize;\n        }\n        else if (value instanceof Array) {\n            return value.length === 0;\n        }\n        else if (typeof value === 'object') {\n            return Object.keys(value).length === 0;\n        }\n        else {\n            throw new TypeError('What else is there?');\n        }\n    }\n    /**\n     * Creates or updates a node in its own record. DOES NOT CHECK if path exists in parent node, or if parent paths exist! Calling code needs to do this\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    _writeNode(path, value, options) {\n        throw new Error('This method must be implemented by subclass');\n    }\n    getUpdateImpact(path, suppressEvents) {\n        let topEventPath = path;\n        let hasValueSubscribers = false;\n        // Get all subscriptions that should execute on the data (includes events on child nodes as well)\n        const eventSubscriptions = suppressEvents ? [] : this.subscriptions.getAllSubscribersForPath(path);\n        // Get all subscriptions for data on this or ancestor nodes, determines what data to load before processing\n        const valueSubscribers = suppressEvents ? [] : this.subscriptions.getValueSubscribersForPath(path);\n        if (valueSubscribers.length > 0) {\n            hasValueSubscribers = true;\n            const eventPaths = valueSubscribers\n                .map(sub => { return { path: sub.dataPath, keys: PathInfo.getPathKeys(sub.dataPath) }; })\n                .sort((a, b) => {\n                if (a.keys.length < b.keys.length) {\n                    return -1;\n                }\n                else if (a.keys.length > b.keys.length) {\n                    return 1;\n                }\n                return 0;\n            });\n            const first = eventPaths[0];\n            topEventPath = first.path;\n            if (valueSubscribers.filter(sub => sub.dataPath === topEventPath).every(sub => sub.type === 'mutated' || sub.type.startsWith('notify_'))) {\n                // Prevent loading of all data on path, so it'll only load changing properties\n                hasValueSubscribers = false;\n            }\n            topEventPath = PathInfo.fillVariables(topEventPath, path); // fill in any wildcards in the subscription path\n        }\n        const indexes = this.indexes.getAll(path, { childPaths: true, parentPaths: true })\n            .map(index => ({ index, keys: PathInfo.getPathKeys(index.path) }))\n            .sort((a, b) => {\n            if (a.keys.length < b.keys.length) {\n                return -1;\n            }\n            else if (a.keys.length > b.keys.length) {\n                return 1;\n            }\n            return 0;\n        })\n            .map(obj => obj.index);\n        const keysFilter = [];\n        if (indexes.length > 0) {\n            indexes.sort((a, b) => {\n                if (typeof a._pathKeys === 'undefined') {\n                    a._pathKeys = PathInfo.getPathKeys(a.path);\n                }\n                if (typeof b._pathKeys === 'undefined') {\n                    b._pathKeys = PathInfo.getPathKeys(b.path);\n                }\n                if (a._pathKeys.length < b._pathKeys.length) {\n                    return -1;\n                }\n                else if (a._pathKeys.length > b._pathKeys.length) {\n                    return 1;\n                }\n                return 0;\n            });\n            const topIndex = indexes[0];\n            const topIndexPath = topIndex.path === path ? path : PathInfo.fillVariables(`${topIndex.path}/*`, path);\n            if (topIndexPath.length < topEventPath.length) {\n                // index is on a higher path than any value subscriber.\n                // eg:\n                //      path = 'restaurants/1/rating'\n                //      topEventPath = 'restaurants/1/rating' (because of 'value' event on 'restaurants/*/rating')\n                //      topIndexPath = 'restaurants/1' (because of index on 'restaurants(/*)', key 'name', included key 'rating')\n                // set topEventPath to topIndexPath, but include only:\n                // - indexed keys on that path,\n                // - any additional child keys for all value event subscriptions in that path (they can never be different though?)\n                topEventPath = topIndexPath;\n                indexes.filter(index => index.path === topIndex.path).forEach(index => {\n                    const keys = [index.key].concat(index.includeKeys);\n                    keys.forEach(key => !keysFilter.includes(key) && keysFilter.push(key));\n                });\n            }\n        }\n        return { topEventPath, eventSubscriptions, valueSubscribers, hasValueSubscribers, indexes, keysFilter };\n    }\n    /**\n     * Wrapper for _writeNode, handles triggering change events, index updating.\n     * @returns Returns a promise that resolves with an object that contains storage specific details,\n     * plus the applied mutations if transaction logging is enabled\n     */\n    async _writeNodeWithTracking(path, value, options = {\n        merge: false,\n        waitForIndexUpdates: true,\n        suppress_events: false,\n        context: null,\n        impact: null,\n    }) {\n        options = options || {};\n        if (!options.tid && !options.transaction) {\n            throw new Error('_writeNodeWithTracking MUST be executed with a tid OR transaction!');\n        }\n        options.merge = options.merge === true;\n        // Does the value meet schema requirements?\n        const validation = this.validateSchema(path, value, { updates: options.merge });\n        if (!validation.ok) {\n            throw new SchemaValidationError(validation.reason);\n        }\n        const tid = options.tid;\n        const transaction = options.transaction;\n        // Is anyone interested in the values changing on this path?\n        let topEventData = null;\n        const updateImpact = options.impact ? options.impact : this.getUpdateImpact(path, options.suppress_events);\n        const { topEventPath, eventSubscriptions, hasValueSubscribers, indexes } = updateImpact;\n        let { keysFilter } = updateImpact;\n        const writeNode = () => {\n            if (typeof options._customWriteFunction === 'function') {\n                return options._customWriteFunction();\n            }\n            if (topEventData) {\n                // Pass loaded data to _writeNode, speeds up recursive calls\n                // This prevents reloading and/or overwriting of unchanged child nodes\n                const pathKeys = PathInfo.getPathKeys(path);\n                const eventPathKeys = PathInfo.getPathKeys(topEventPath);\n                const trailKeys = pathKeys.slice(eventPathKeys.length);\n                let currentValue = topEventData;\n                while (trailKeys.length > 0 && currentValue !== null) {\n                    const childKey = trailKeys.shift();\n                    currentValue = typeof currentValue === 'object' && childKey in currentValue ? currentValue[childKey] : null;\n                }\n                options.currentValue = currentValue;\n            }\n            return this._writeNode(path, value, options);\n        };\n        const transactionLoggingEnabled = this.settings.transactions && this.settings.transactions.log === true;\n        if (eventSubscriptions.length === 0 && indexes.length === 0 && !transactionLoggingEnabled) {\n            // Nobody's interested in value changes. Write node without tracking\n            return writeNode();\n        }\n        if (!hasValueSubscribers && options.merge === true && keysFilter.length === 0) {\n            // only load properties being updated\n            keysFilter = Object.keys(value);\n            if (topEventPath !== path) {\n                const trailPath = path.slice(topEventPath.length);\n                keysFilter = keysFilter.map(key => `${trailPath}/${key}`);\n            }\n        }\n        const eventNodeInfo = await this.getNodeInfo(topEventPath, { transaction, tid });\n        let currentValue = null;\n        if (eventNodeInfo.exists) {\n            const valueOptions = { transaction, tid };\n            if (keysFilter.length > 0) {\n                valueOptions.include = keysFilter;\n            }\n            if (topEventPath === '' && typeof valueOptions.include === 'undefined') {\n                this.debug.warn('WARNING: One or more value event listeners on the root node are causing the entire database value to be read to facilitate change tracking. Using \"value\", \"notify_value\", \"child_changed\" and \"notify_child_changed\" events on the root node are a bad practice because of the significant performance impact. Use \"mutated\" or \"mutations\" events instead');\n            }\n            const node = await this.getNode(topEventPath, valueOptions);\n            currentValue = node.value;\n        }\n        topEventData = currentValue;\n        // Now proceed with node updating\n        const result = (await writeNode()) || {};\n        // Build data for old/new comparison\n        let newTopEventData, modifiedData;\n        if (path === topEventPath) {\n            if (options.merge) {\n                if (topEventData === null) {\n                    newTopEventData = value instanceof Array ? [] : {};\n                }\n                else {\n                    // Create shallow copy of previous object value\n                    newTopEventData = topEventData instanceof Array ? [] : {};\n                    Object.keys(topEventData).forEach(key => {\n                        newTopEventData[key] = topEventData[key];\n                    });\n                }\n            }\n            else {\n                newTopEventData = value;\n            }\n            modifiedData = newTopEventData;\n        }\n        else {\n            // topEventPath is on a higher path, so we have to adjust the value deeper down\n            const trailPath = path.slice(topEventPath.length).replace(/^\\//, '');\n            const trailKeys = PathInfo.getPathKeys(trailPath);\n            // Create shallow copy of the original object (let unchanged properties reference existing objects)\n            if (topEventData === null) {\n                // the node didn't exist prior to the update (or was not loaded)\n                newTopEventData = typeof trailKeys[0] === 'number' ? [] : {};\n            }\n            else {\n                newTopEventData = topEventData instanceof Array ? [] : {};\n                Object.keys(topEventData).forEach(key => {\n                    newTopEventData[key] = topEventData[key];\n                });\n            }\n            modifiedData = newTopEventData;\n            while (trailKeys.length > 0) {\n                const childKey = trailKeys.shift();\n                // Create shallow copy of object at target\n                if (!options.merge && trailKeys.length === 0) {\n                    modifiedData[childKey] = value;\n                }\n                else {\n                    const original = modifiedData[childKey];\n                    const shallowCopy = typeof childKey === 'number' ? [...original] : { ...original };\n                    modifiedData[childKey] = shallowCopy;\n                }\n                modifiedData = modifiedData[childKey];\n            }\n        }\n        if (options.merge) {\n            // Update target value with updates\n            Object.keys(value).forEach(key => {\n                modifiedData[key] = value[key];\n            });\n        }\n        // assert(topEventData !== newTopEventData, 'shallow copy must have been made!');\n        const dataChanges = compareValues(topEventData, newTopEventData);\n        if (dataChanges === 'identical') {\n            result.mutations = [];\n            return result;\n        }\n        // Fix: remove null property values (https://github.com/appy-one/acebase/issues/2)\n        function removeNulls(obj) {\n            if (obj === null || typeof obj !== 'object') {\n                return obj;\n            } // Nothing to do\n            Object.keys(obj).forEach(prop => {\n                const val = obj[prop];\n                if (val === null) {\n                    delete obj[prop];\n                    if (obj instanceof Array) {\n                        obj.length--;\n                    } // Array items can only be removed from the end,\n                }\n                if (typeof val === 'object') {\n                    removeNulls(val);\n                }\n            });\n        }\n        removeNulls(newTopEventData);\n        // Trigger all index updates\n        // TODO: Let indexes subscribe to \"mutations\" event, saves a lot of work because we are preparing\n        // before/after copies of the relevant data here, and then the indexes go check what data changed...\n        const indexUpdates = [];\n        indexes.map(index => ({ index, keys: PathInfo.getPathKeys(index.path) }))\n            .sort((a, b) => {\n            // Deepest paths should fire first, then bubble up the tree\n            if (a.keys.length < b.keys.length) {\n                return 1;\n            }\n            else if (a.keys.length > b.keys.length) {\n                return -1;\n            }\n            return 0;\n        })\n            .forEach(({ index }) => {\n            // Index is either on the top event path, or on a child path\n            // Example situation:\n            // path = \"users/ewout/posts/1\" (a post was added)\n            // topEventPath = \"users/ewout\" (a \"child_changed\" event was on \"users\")\n            // index.path is \"users/*/posts\"\n            // index must be called with data of \"users/ewout/posts/1\"\n            const pathKeys = PathInfo.getPathKeys(topEventPath);\n            const indexPathKeys = PathInfo.getPathKeys(index.path + '/*');\n            const trailKeys = indexPathKeys.slice(pathKeys.length);\n            // let { oldValue, newValue } = updatedData;\n            const oldValue = topEventData;\n            const newValue = newTopEventData;\n            if (trailKeys.length === 0) {\n                assert(pathKeys.length === indexPathKeys.length, 'check logic');\n                // Index is on updated path\n                const p = this.ipc.isMaster\n                    ? index.handleRecordUpdate(topEventPath, oldValue, newValue)\n                    : this.ipc.sendRequest({ type: 'index.update', fileName: index.fileName, path: topEventPath, oldValue, newValue });\n                indexUpdates.push(p);\n                return; // next index\n            }\n            const getAllIndexUpdates = (path, oldValue, newValue) => {\n                if (oldValue === null && newValue === null) {\n                    return [];\n                }\n                const pathKeys = PathInfo.getPathKeys(path);\n                const indexPathKeys = PathInfo.getPathKeys(index.path + '/*');\n                const trailKeys = indexPathKeys.slice(pathKeys.length);\n                if (trailKeys.length === 0) {\n                    assert(pathKeys.length === indexPathKeys.length, 'check logic');\n                    return [{ path, oldValue, newValue }];\n                }\n                let results = [];\n                let trailPath = '';\n                while (trailKeys.length > 0) {\n                    const subKey = trailKeys.shift();\n                    if (typeof subKey === 'string' && (subKey === '*' || subKey.startsWith('$'))) {\n                        // Recursion needed\n                        const allKeys = oldValue === null ? [] : Object.keys(oldValue);\n                        newValue !== null && Object.keys(newValue).forEach(key => {\n                            if (allKeys.indexOf(key) < 0) {\n                                allKeys.push(key);\n                            }\n                        });\n                        allKeys.forEach(key => {\n                            const childPath = PathInfo.getChildPath(trailPath, key);\n                            const childValues = getChildValues(key, oldValue, newValue);\n                            const subTrailPath = PathInfo.getChildPath(path, childPath);\n                            const childResults = getAllIndexUpdates(subTrailPath, childValues.oldValue, childValues.newValue);\n                            results = results.concat(childResults);\n                        });\n                        break;\n                    }\n                    else {\n                        const values = getChildValues(subKey, oldValue, newValue);\n                        oldValue = values.oldValue;\n                        newValue = values.newValue;\n                        if (oldValue === null && newValue === null) {\n                            break;\n                        }\n                        trailPath = PathInfo.getChildPath(trailPath, subKey);\n                    }\n                }\n                return results;\n            };\n            const results = getAllIndexUpdates(topEventPath, oldValue, newValue);\n            results.forEach(result => {\n                const p = this.ipc.isMaster\n                    ? index.handleRecordUpdate(result.path, result.oldValue, result.newValue)\n                    : this.ipc.sendRequest({ type: 'index.update', fileName: index.fileName, path: result.path, oldValue: result.oldValue, newValue: result.newValue });\n                indexUpdates.push(p);\n            });\n        });\n        const callSubscriberWithValues = (sub, oldValue, newValue, variables = []) => {\n            let trigger = true;\n            let type = sub.type;\n            if (type.startsWith('notify_')) {\n                type = type.slice('notify_'.length);\n            }\n            if (type === 'mutated') {\n                return; // Ignore here, requires different logic\n            }\n            else if (type === 'child_changed' && (oldValue === null || newValue === null)) {\n                trigger = false;\n            }\n            else if (type === 'value' || type === 'child_changed') {\n                const changes = compareValues(oldValue, newValue);\n                trigger = changes !== 'identical';\n            }\n            else if (type === 'child_added') {\n                trigger = oldValue === null && newValue !== null;\n            }\n            else if (type === 'child_removed') {\n                trigger = oldValue !== null && newValue === null;\n            }\n            if (!trigger) {\n                return;\n            }\n            const pathKeys = PathInfo.getPathKeys(sub.dataPath);\n            variables.forEach(variable => {\n                // only replaces first occurrence (so multiple *'s will be processed 1 by 1)\n                const index = pathKeys.indexOf(variable.name);\n                assert(index >= 0, `Variable \"${variable.name}\" not found in subscription dataPath \"${sub.dataPath}\"`);\n                pathKeys[index] = variable.value;\n            });\n            const dataPath = pathKeys.reduce((path, key) => PathInfo.getChildPath(path, key), '');\n            this.subscriptions.trigger(sub.type, sub.subscriptionPath, dataPath, oldValue, newValue, options.context);\n        };\n        const prepareMutationEvents = (currentPath, oldValue, newValue, compareResult) => {\n            const batch = [];\n            const result = compareResult || compareValues(oldValue, newValue);\n            if (result === 'identical') {\n                return batch; // no changes on subscribed path\n            }\n            else if (typeof result === 'string') {\n                // We are on a path that has an actual change\n                batch.push({ path: currentPath, oldValue, newValue });\n            }\n            // else if (oldValue instanceof Array || newValue instanceof Array) {\n            //     // Trigger mutated event on the array itself instead of on individual indexes.\n            //     // DO convert both arrays to objects because they are sparse\n            //     const oldObj = {}, newObj = {};\n            //     result.added.forEach(index => {\n            //         oldObj[index] = null;\n            //         newObj[index] = newValue[index];\n            //     });\n            //     result.removed.forEach(index => {\n            //         oldObj[index] = oldValue[index];\n            //         newObj[index] = null;\n            //     });\n            //     result.changed.forEach(index => {\n            //         oldObj[index] = oldValue[index];\n            //         newObj[index] = newValue[index];\n            //     });\n            //     batch.push({ path: currentPath, oldValue: oldObj, newValue: newObj });\n            // }\n            else {\n                // DISABLED array handling here, because if a client is using a cache db this will cause problems\n                // because individual array entries should never be modified.\n                // if (oldValue instanceof Array && newValue instanceof Array) {\n                //     // Make sure any removed events on arrays will be triggered from last to first\n                //     result.removed.sort((a,b) => a < b ? 1 : -1);\n                // }\n                result.changed.forEach(info => {\n                    const childPath = PathInfo.getChildPath(currentPath, info.key);\n                    const childValues = getChildValues(info.key, oldValue, newValue);\n                    const childBatch = prepareMutationEvents(childPath, childValues.oldValue, childValues.newValue, info.change);\n                    batch.push(...childBatch);\n                });\n                result.added.forEach(key => {\n                    const childPath = PathInfo.getChildPath(currentPath, key);\n                    batch.push({ path: childPath, oldValue: null, newValue: newValue[key] });\n                });\n                if (oldValue instanceof Array && newValue instanceof Array) {\n                    result.removed.sort((a, b) => a < b ? 1 : -1);\n                }\n                result.removed.forEach(key => {\n                    const childPath = PathInfo.getChildPath(currentPath, key);\n                    batch.push({ path: childPath, oldValue: oldValue[key], newValue: null });\n                });\n            }\n            return batch;\n        };\n        // Add mutations to result (only if transaction logging is enabled)\n        if (transactionLoggingEnabled && this.settings.type !== 'transaction') {\n            result.mutations = (() => {\n                const trailPath = path.slice(topEventPath.length).replace(/^\\//, '');\n                const trailKeys = PathInfo.getPathKeys(trailPath);\n                let oldValue = topEventData, newValue = newTopEventData;\n                while (trailKeys.length > 0) {\n                    const key = trailKeys.shift();\n                    ({ oldValue, newValue } = getChildValues(key, oldValue, newValue));\n                }\n                const compareResults = compareValues(oldValue, newValue);\n                const batch = prepareMutationEvents(path, oldValue, newValue, compareResults);\n                const mutations = batch.map(m => ({ target: PathInfo.getPathKeys(m.path.slice(path.length)), prev: m.oldValue, val: m.newValue })); // key: PathInfo.get(m.path).key\n                return mutations;\n            })();\n        }\n        const triggerAllEvents = () => {\n            // Notify all event subscriptions, should be executed with a delay\n            // this.debug.verbose(`Triggering events caused by ${options && options.merge ? '(merge) ' : ''}write on \"${path}\":`, value);\n            eventSubscriptions\n                .filter(sub => !['mutated', 'mutations', 'notify_mutated', 'notify_mutations'].includes(sub.type))\n                .map(sub => {\n                const keys = PathInfo.getPathKeys(sub.dataPath);\n                return {\n                    sub,\n                    keys,\n                };\n            })\n                .sort((a, b) => {\n                // Deepest paths should fire first, then bubble up the tree\n                if (a.keys.length < b.keys.length) {\n                    return 1;\n                }\n                else if (a.keys.length > b.keys.length) {\n                    return -1;\n                }\n                return 0;\n            })\n                .forEach(({ sub }) => {\n                const process = (currentPath, oldValue, newValue, variables = []) => {\n                    const trailPath = sub.dataPath.slice(currentPath.length).replace(/^\\//, '');\n                    const trailKeys = PathInfo.getPathKeys(trailPath);\n                    while (trailKeys.length > 0) {\n                        const subKey = trailKeys.shift();\n                        if (typeof subKey === 'string' && (subKey === '*' || subKey[0] === '$')) {\n                            // Fire on all relevant child keys\n                            const allKeys = oldValue === null ? [] : Object.keys(oldValue).map(key => oldValue instanceof Array ? parseInt(key) : key);\n                            newValue !== null && Object.keys(newValue).forEach(key => {\n                                const keyOrIndex = newValue instanceof Array ? parseInt(key) : key;\n                                !allKeys.includes(keyOrIndex) && allKeys.push(key);\n                            });\n                            allKeys.forEach(key => {\n                                const childValues = getChildValues(key, oldValue, newValue);\n                                const vars = variables.concat({ name: subKey, value: key });\n                                if (trailKeys.length === 0) {\n                                    callSubscriberWithValues(sub, childValues.oldValue, childValues.newValue, vars);\n                                }\n                                else {\n                                    process(PathInfo.getChildPath(currentPath, subKey), childValues.oldValue, childValues.newValue, vars);\n                                }\n                            });\n                            return; // We can stop processing\n                        }\n                        else {\n                            currentPath = PathInfo.getChildPath(currentPath, subKey);\n                            const childValues = getChildValues(subKey, oldValue, newValue);\n                            oldValue = childValues.oldValue;\n                            newValue = childValues.newValue;\n                        }\n                    }\n                    callSubscriberWithValues(sub, oldValue, newValue, variables);\n                };\n                if (sub.type.startsWith('notify_') && PathInfo.get(sub.eventPath).isAncestorOf(topEventPath)) {\n                    // Notify event on a higher path than we have loaded data on\n                    // We can trigger the notify event on the subscribed path\n                    // Eg:\n                    // path === 'users/ewout', updates === { name: 'Ewout Stortenbeker' }\n                    // sub.path === 'users' or '', sub.type === 'notify_child_changed'\n                    // => OK to trigger if dataChanges !== 'removed' and 'added'\n                    const isOnParentPath = PathInfo.get(sub.eventPath).isParentOf(topEventPath);\n                    const trigger = (sub.type === 'notify_value')\n                        || (sub.type === 'notify_child_changed' && (!isOnParentPath || !['added', 'removed'].includes(dataChanges)))\n                        || (sub.type === 'notify_child_removed' && dataChanges === 'removed' && isOnParentPath)\n                        || (sub.type === 'notify_child_added' && dataChanges === 'added' && isOnParentPath);\n                    trigger && this.subscriptions.trigger(sub.type, sub.subscriptionPath, sub.dataPath, null, null, options.context);\n                }\n                else {\n                    // Subscription is on current or deeper path\n                    process(topEventPath, topEventData, newTopEventData);\n                }\n            });\n            // The only events we haven't processed now are 'mutated' events.\n            // They require different logic: we'll call them for all nested properties of the updated path, that\n            // actually did change. They do not bubble up like 'child_changed' does.\n            const mutationEvents = eventSubscriptions.filter(sub => ['mutated', 'mutations', 'notify_mutated', 'notify_mutations'].includes(sub.type));\n            mutationEvents.forEach(sub => {\n                // Get the target data this subscription is interested in\n                let currentPath = topEventPath;\n                const trailPath = sub.eventPath.slice(currentPath.length).replace(/^\\//, '');\n                const trailKeys = PathInfo.getPathKeys(trailPath);\n                let oldValue = topEventData, newValue = newTopEventData;\n                while (trailKeys.length > 0) {\n                    const subKey = trailKeys.shift();\n                    currentPath = PathInfo.getChildPath(currentPath, subKey);\n                    const childValues = getChildValues(subKey, oldValue, newValue);\n                    oldValue = childValues.oldValue;\n                    newValue = childValues.newValue;\n                }\n                const batch = prepareMutationEvents(currentPath, oldValue, newValue);\n                if (batch.length === 0) {\n                    return;\n                }\n                const isNotifyEvent = sub.type.startsWith('notify_');\n                if (['mutated', 'notify_mutated'].includes(sub.type)) {\n                    // Send all mutations 1 by 1\n                    batch.forEach((mutation, index) => {\n                        const context = options.context; // const context = cloneObject(options.context);\n                        // context.acebase_mutated_event = { nr: index + 1, total: batch.length }; // Add context info about number of mutations\n                        const prevVal = isNotifyEvent ? null : mutation.oldValue;\n                        const newVal = isNotifyEvent ? null : mutation.newValue;\n                        this.subscriptions.trigger(sub.type, sub.subscriptionPath, mutation.path, prevVal, newVal, context);\n                    });\n                }\n                else if (['mutations', 'notify_mutations'].includes(sub.type)) {\n                    // Send 1 batch with all mutations\n                    // const oldValues = isNotifyEvent ? null : batch.map(m => ({ target: PathInfo.getPathKeys(mutation.path.slice(sub.subscriptionPath.length)), val: m.oldValue })); // batch.reduce((obj, mutation) => (obj[mutation.path.slice(sub.subscriptionPath.length).replace(/^\\//, '') || '.'] = mutation.oldValue, obj), {});\n                    // const newValues = isNotifyEvent ? null : batch.map(m => ({ target: PathInfo.getPathKeys(mutation.path.slice(sub.subscriptionPath.length)), val: m.newValue })) //batch.reduce((obj, mutation) => (obj[mutation.path.slice(sub.subscriptionPath.length).replace(/^\\//, '') || '.'] = mutation.newValue, obj), {});\n                    const values = isNotifyEvent ? null : batch.map(m => ({ target: PathInfo.getPathKeys(m.path.slice(sub.subscriptionPath.length)), prev: m.oldValue, val: m.newValue }));\n                    this.subscriptions.trigger(sub.type, sub.subscriptionPath, sub.subscriptionPath, null, values, options.context);\n                }\n            });\n        };\n        // Wait for all index updates to complete\n        if (options.waitForIndexUpdates === false) {\n            indexUpdates.splice(0); // Remove all index update promises, so we don't wait for them to resolve\n        }\n        await Promise.all(indexUpdates);\n        defer(triggerAllEvents); // Delayed execution\n        return result;\n    }\n    /**\n     * Enumerates all children of a given Node for reflection purposes\n     * @param path\n     * @param options optional options used by implementation for recursive calls\n     * @returns returns a generator object that calls .next for each child until the .next callback returns false\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getChildren(path, options) {\n        throw new Error('This method must be implemented by subclass');\n    }\n    /**\n     * @deprecated Use `getNode` instead\n     * Gets a node's value by delegating to getNode, returning only the value\n     * @param path\n     * @param options optional options that can limit the amount of (sub)data being loaded, and any other implementation specific options for recusrsive calls\n     */\n    async getNodeValue(path, options = {}) {\n        const node = await this.getNode(path, options);\n        return node.value;\n    }\n    /**\n     * Gets a node's value and (if supported) revision\n     * @param path\n     * @param options optional options that can limit the amount of (sub)data being loaded, and any other implementation specific options for recusrsive calls\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getNode(path, options) {\n        throw new Error('This method must be implemented by subclass');\n    }\n    /**\n     * Retrieves info about a node (existence, wherabouts etc)\n     * @param {string} path\n     * @param {object} [options] optional options used by implementation for recursive calls\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getNodeInfo(path, options) {\n        throw new Error('This method must be implemented by subclass');\n    }\n    /**\n     * Creates or overwrites a node. Delegates to updateNode on a parent if\n     * path is not the root.\n     * @param path\n     * @param value\n     * @param options optional options used by implementation for recursive calls\n     * @returns Returns a new cursor if transaction logging is enabled\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    setNode(path, value, options) {\n        throw new Error('This method must be implemented by subclass');\n    }\n    /**\n     * Updates a node by merging an existing node with passed updates object,\n     * or creates it by delegating to updateNode on the parent path.\n     * @param path\n     * @param updates object with key/value pairs\n     * @returns Returns a new cursor if transaction logging is enabled\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    updateNode(path, updates, options) {\n        throw new Error('This method must be implemented by subclass');\n    }\n    /**\n     * Updates a node by getting its value, running a callback function that transforms\n     * the current value and returns the new value to be stored. Assures the read value\n     * does not change while the callback runs, or runs the callback again if it did.\n     * @param path\n     * @param callback function that transforms current value and returns the new value to be stored. Can return a Promise\n     * @param options optional options used by implementation for recursive calls\n     * @returns Returns a new cursor if transaction logging is enabled\n     */\n    async transactNode(path, callback, options = { no_lock: false, suppress_events: false, context: null }) {\n        const useFakeLock = options && options.no_lock === true;\n        const tid = this.createTid();\n        const lock = useFakeLock\n            ? { tid, release: NOOP } // Fake lock, we'll use revision checking & retrying instead\n            : await this.nodeLocker.lock(path, tid, true, 'transactNode');\n        try {\n            let changed = false;\n            const changeCallback = () => { changed = true; };\n            if (useFakeLock) {\n                // Monitor value changes\n                this.subscriptions.add(path, 'notify_value', changeCallback);\n            }\n            const node = await this.getNode(path, { tid });\n            const checkRevision = node.revision;\n            let newValue;\n            try {\n                newValue = callback(node.value);\n                if (newValue instanceof Promise) {\n                    newValue = await newValue.catch(err => {\n                        this.debug.error(`Error in transaction callback: ${err.message}`);\n                    });\n                }\n            }\n            catch (err) {\n                this.debug.error(`Error in transaction callback: ${err.message}`);\n            }\n            if (typeof newValue === 'undefined') {\n                // Callback did not return value. Cancel transaction\n                return;\n            }\n            // asserting revision is only needed when no_lock option was specified\n            if (useFakeLock) {\n                this.subscriptions.remove(path, 'notify_value', changeCallback);\n            }\n            if (changed) {\n                throw new NodeRevisionError('Node changed');\n            }\n            const cursor = await this.setNode(path, newValue, { assert_revision: checkRevision, tid: lock.tid, suppress_events: options.suppress_events, context: options.context });\n            return cursor;\n        }\n        catch (err) {\n            if (err instanceof NodeRevisionError) {\n                // try again\n                console.warn(`node value changed, running again. Error: ${err.message}`);\n                return this.transactNode(path, callback, options);\n            }\n            else {\n                throw err;\n            }\n        }\n        finally {\n            lock.release();\n        }\n    }\n    /**\n     * Checks if a node's value matches the passed criteria\n     * @param path\n     * @param criteria criteria to test\n     * @param options optional options used by implementation for recursive calls\n     * @returns returns a promise that resolves with a boolean indicating if it matched the criteria\n     */\n    async matchNode(path, criteria, options) {\n        const tid = options?.tid ?? ID.generate();\n        const checkNode = async (path, criteria) => {\n            if (criteria.length === 0) {\n                return Promise.resolve(true); // No criteria, so yes... It matches!\n            }\n            const criteriaKeys = criteria.reduce((keys, cr) => {\n                let key = cr.key;\n                if (typeof key === 'string' && key.includes('/')) {\n                    // Descendant key criterium, use child key only (eg 'address' of 'address/city')\n                    key = key.slice(0, key.indexOf('/'));\n                }\n                if (keys.indexOf(key) < 0) {\n                    keys.push(key);\n                }\n                return keys;\n            }, []);\n            const unseenKeys = criteriaKeys.slice();\n            let isMatch = true;\n            const delayedMatchPromises = [];\n            try {\n                await this.getChildren(path, { tid, keyFilter: criteriaKeys }).next(childInfo => {\n                    const keyOrIndex = childInfo.key ?? childInfo.index;\n                    unseenKeys.includes(keyOrIndex) && unseenKeys.splice(unseenKeys.indexOf(childInfo.key), 1);\n                    const keyCriteria = criteria\n                        .filter(cr => cr.key === keyOrIndex)\n                        .map(cr => ({ op: cr.op, compare: cr.compare }));\n                    const keyResult = keyCriteria.length > 0 ? checkChild(childInfo, keyCriteria) : { isMatch: true, promises: [] };\n                    isMatch = keyResult.isMatch;\n                    if (isMatch) {\n                        delayedMatchPromises.push(...keyResult.promises);\n                        const childCriteria = criteria\n                            .filter(cr => typeof cr.key === 'string' && cr.key.startsWith(`${typeof keyOrIndex === 'number' ? `[${keyOrIndex}]` : keyOrIndex}/`))\n                            .map(cr => {\n                            const key = cr.key.slice(cr.key.indexOf('/') + 1);\n                            return { key, op: cr.op, compare: cr.compare };\n                        });\n                        if (childCriteria.length > 0) {\n                            const childPath = PathInfo.getChildPath(path, childInfo.key);\n                            const childPromise = checkNode(childPath, childCriteria)\n                                .then(isMatch => ({ isMatch }));\n                            delayedMatchPromises.push(childPromise);\n                        }\n                    }\n                    if (!isMatch || unseenKeys.length === 0) {\n                        return false; // Stop iterating\n                    }\n                });\n                if (isMatch) {\n                    const results = await Promise.all(delayedMatchPromises);\n                    isMatch = results.every(res => res.isMatch);\n                }\n                if (!isMatch) {\n                    return false;\n                }\n                // Now, also check keys that weren't found in the node. (a criterium may be \"!exists\")\n                isMatch = unseenKeys.every(keyOrIndex => {\n                    const childInfo = new NodeInfo({\n                        ...(typeof keyOrIndex === 'number' && { index: keyOrIndex }),\n                        ...(typeof keyOrIndex === 'string' && { key: keyOrIndex }),\n                        exists: false,\n                    });\n                    const childCriteria = criteria\n                        .filter(cr => typeof cr.key === 'string' && cr.key.startsWith(`${typeof keyOrIndex === 'number' ? `[${keyOrIndex}]` : keyOrIndex}/`))\n                        .map(cr => ({ op: cr.op, compare: cr.compare }));\n                    if (childCriteria.length > 0 && !checkChild(childInfo, childCriteria).isMatch) {\n                        return false;\n                    }\n                    const keyCriteria = criteria\n                        .filter(cr => cr.key === keyOrIndex)\n                        .map(cr => ({ op: cr.op, compare: cr.compare }));\n                    if (keyCriteria.length === 0) {\n                        return true; // There were only child criteria, and they matched (otherwise we wouldn't be here)\n                    }\n                    const result = checkChild(childInfo, keyCriteria);\n                    return result.isMatch;\n                });\n                return isMatch;\n            }\n            catch (err) {\n                this.debug.error(`Error matching on \"${path}\": `, err);\n                throw err;\n            }\n        }; // checkNode\n        /**\n         *\n         * @param child\n         * @param criteria criteria to test\n         */\n        const checkChild = (child, criteria) => {\n            const promises = [];\n            const isMatch = criteria.every(f => {\n                let proceed = true;\n                if (f.op === '!exists' || (f.op === '==' && (typeof f.compare === 'undefined' || f.compare === null))) {\n                    proceed = !child.exists;\n                }\n                else if (f.op === 'exists' || (f.op === '!=' && (typeof f.compare === 'undefined' || f.compare === null))) {\n                    proceed = child.exists;\n                }\n                else if ((f.op === 'contains' || f.op === '!contains') && f.compare instanceof Array && f.compare.length === 0) {\n                    // Added for #135: empty compare array for contains/!contains must match all values\n                    proceed = true;\n                }\n                else if (!child.exists) {\n                    proceed = false;\n                }\n                else {\n                    if (child.address) {\n                        if (child.valueType === VALUE_TYPES.OBJECT && ['has', '!has'].indexOf(f.op) >= 0) {\n                            const op = f.op === 'has' ? 'exists' : '!exists';\n                            const p = checkNode(child.path, [{ key: f.compare, op }])\n                                .then(isMatch => {\n                                return { key: child.key, isMatch };\n                            });\n                            promises.push(p);\n                            proceed = true;\n                        }\n                        else if (child.valueType === VALUE_TYPES.ARRAY && ['contains', '!contains'].indexOf(f.op) >= 0) {\n                            // TODO: refactor to use child stream\n                            const p = this.getNode(child.path, { tid })\n                                .then(({ value: arr }) => {\n                                // const i = arr.indexOf(f.compare);\n                                // return { key: child.key, isMatch: (i >= 0 && f.op === \"contains\") || (i < 0 && f.op === \"!contains\") };\n                                const isMatch = f.op === 'contains'\n                                    // \"contains\"\n                                    ? f.compare instanceof Array\n                                        ? f.compare.every(val => arr.includes(val)) // Match if ALL of the passed values are in the array\n                                        : arr.includes(f.compare)\n                                    // \"!contains\"\n                                    : f.compare instanceof Array\n                                        ? !f.compare.some(val => arr.includes(val)) // DON'T match if ANY of the passed values is in the array\n                                        : !arr.includes(f.compare);\n                                return { key: child.key, isMatch };\n                            });\n                            promises.push(p);\n                            proceed = true;\n                        }\n                        else if (child.valueType === VALUE_TYPES.STRING) {\n                            const p = this.getNode(child.path, { tid })\n                                .then(node => {\n                                return { key: child.key, isMatch: this.test(node.value, f.op, f.compare) };\n                            });\n                            promises.push(p);\n                            proceed = true;\n                        }\n                        else {\n                            proceed = false;\n                        }\n                    }\n                    else if (child.type === VALUE_TYPES.OBJECT && ['has', '!has'].indexOf(f.op) >= 0) {\n                        const has = f.compare in child.value;\n                        proceed = (has && f.op === 'has') || (!has && f.op === '!has');\n                    }\n                    else if (child.type === VALUE_TYPES.ARRAY && ['contains', '!contains'].indexOf(f.op) >= 0) {\n                        const contains = child.value.indexOf(f.compare) >= 0;\n                        proceed = (contains && f.op === 'contains') || (!contains && f.op === '!contains');\n                    }\n                    else {\n                        let ret = this.test(child.value, f.op, f.compare);\n                        if (ret instanceof Promise) {\n                            promises.push(ret);\n                            ret = true;\n                        }\n                        proceed = ret;\n                    }\n                }\n                return proceed;\n            }); // fs.every\n            return { isMatch, promises };\n        }; // checkChild\n        return checkNode(path, criteria);\n    }\n    test(val, op, compare) {\n        if (op === '<') {\n            return val < compare;\n        }\n        if (op === '<=') {\n            return val <= compare;\n        }\n        if (op === '==') {\n            return val === compare;\n        }\n        if (op === '!=') {\n            return val !== compare;\n        }\n        if (op === '>') {\n            return val > compare;\n        }\n        if (op === '>=') {\n            return val >= compare;\n        }\n        if (op === 'in') {\n            return compare.indexOf(val) >= 0;\n        }\n        if (op === '!in') {\n            return compare.indexOf(val) < 0;\n        }\n        if (op === 'like' || op === '!like') {\n            const pattern = '^' + compare.replace(/[-[\\]{}()+.,\\\\^$|#\\s]/g, '\\\\$&').replace(/\\?/g, '.').replace(/\\*/g, '.*?') + '$';\n            const re = new RegExp(pattern, 'i');\n            const isMatch = re.test(val.toString());\n            return op === 'like' ? isMatch : !isMatch;\n        }\n        if (op === 'matches') {\n            return compare.test(val.toString());\n        }\n        if (op === '!matches') {\n            return !compare.test(val.toString());\n        }\n        if (op === 'between') {\n            return val >= compare[0] && val <= compare[1];\n        }\n        if (op === '!between') {\n            return val < compare[0] || val > compare[1];\n        }\n        if (op === 'has' || op === '!has') {\n            const has = typeof val === 'object' && compare in val;\n            return op === 'has' ? has : !has;\n        }\n        if (op === 'contains' || op === '!contains') {\n            // TODO: rename to \"includes\"?\n            const includes = typeof val === 'object' && val instanceof Array && val.includes(compare);\n            return op === 'contains' ? includes : !includes;\n        }\n        return false;\n    }\n    /**\n     * Export a specific path's data to a stream\n     * @param path\n     * @param write function that writes to a stream, or stream object that has a write method that (optionally) returns a promise the export needs to wait for before continuing\n     * @returns returns a promise that resolves once all data is exported\n     */\n    async exportNode(path, writeFn, options = { format: 'json', type_safe: true }) {\n        if (options?.format !== 'json') {\n            throw new Error('Only json output is currently supported');\n        }\n        const write = typeof writeFn !== 'function'\n            ? writeFn.write.bind(writeFn) // Using the \"old\" stream argument. Use its write method for backward compatibility\n            : writeFn;\n        const stringifyValue = (type, val) => {\n            const escape = (str) => str\n                .replace(/\\\\/g, '\\\\\\\\') // forward slashes\n                .replace(/\"/g, '\\\\\"') // quotes\n                .replace(/\\r/g, '\\\\r') // carriage return\n                .replace(/\\n/g, '\\\\n') // line feed\n                .replace(/\\t/g, '\\\\t') // tabs\n                .replace(/[\\u0000-\\u001f]/g, // other control characters\n            // other control characters\n            ch => `\\\\u${ch.charCodeAt(0).toString(16).padStart(4, '0')}`);\n            if (type === VALUE_TYPES.DATETIME) {\n                val = `\"${val.toISOString()}\"`;\n                if (options.type_safe) {\n                    val = `{\".type\":\"date\",\".val\":${val}}`; // Previously: \"Date\"\n                }\n            }\n            else if (type === VALUE_TYPES.STRING) {\n                val = `\"${escape(val)}\"`;\n            }\n            else if (type === VALUE_TYPES.ARRAY) {\n                val = '[]';\n            }\n            else if (type === VALUE_TYPES.OBJECT) {\n                val = '{}';\n            }\n            else if (type === VALUE_TYPES.BINARY) {\n                val = `\"${escape(ascii85.encode(val))}\"`; // TODO: use base64 instead, no escaping needed\n                if (options.type_safe) {\n                    val = `{\".type\":\"binary\",\".val\":${val}}`; // Previously: \"Buffer\"\n                }\n            }\n            else if (type === VALUE_TYPES.REFERENCE) {\n                val = `\"${val.path}\"`;\n                if (options.type_safe) {\n                    val = `{\".type\":\"reference\",\".val\":${val}}`; // Previously: \"PathReference\"\n                }\n            }\n            else if (type === VALUE_TYPES.BIGINT) {\n                // Unfortnately, JSON.parse does not support 0n bigint json notation\n                val = `\"${val}\"`;\n                if (options.type_safe) {\n                    val = `{\".type\":\"bigint\",\".val\":${val}}`;\n                }\n            }\n            return val;\n        };\n        let objStart = '', objEnd = '';\n        const nodeInfo = await this.getNodeInfo(path);\n        if (!nodeInfo.exists) {\n            return write('null');\n        }\n        else if (nodeInfo.type === VALUE_TYPES.OBJECT) {\n            objStart = '{';\n            objEnd = '}';\n        }\n        else if (nodeInfo.type === VALUE_TYPES.ARRAY) {\n            objStart = '[';\n            objEnd = ']';\n        }\n        else {\n            // Node has no children, get and export its value\n            const node = await this.getNode(path);\n            const val = stringifyValue(nodeInfo.type, node.value);\n            return write(val);\n        }\n        if (objStart) {\n            const p = write(objStart);\n            if (p instanceof Promise) {\n                await p;\n            }\n        }\n        let output = '', outputCount = 0;\n        const pending = [];\n        await this.getChildren(path)\n            .next(childInfo => {\n            if (childInfo.address) {\n                // Export child recursively\n                pending.push(childInfo);\n            }\n            else {\n                if (outputCount++ > 0) {\n                    output += ',';\n                }\n                if (typeof childInfo.key === 'string') {\n                    output += `\"${childInfo.key}\":`;\n                }\n                output += stringifyValue(childInfo.type, childInfo.value);\n            }\n        });\n        if (output) {\n            const p = write(output);\n            if (p instanceof Promise) {\n                await p;\n            }\n        }\n        while (pending.length > 0) {\n            const childInfo = pending.shift();\n            let output = outputCount++ > 0 ? ',' : '';\n            const key = typeof childInfo.index === 'number' ? childInfo.index : childInfo.key;\n            if (typeof key === 'string') {\n                output += `\"${key}\":`;\n            }\n            if (output) {\n                const p = write(output);\n                if (p instanceof Promise) {\n                    await p;\n                }\n            }\n            await this.exportNode(PathInfo.getChildPath(path, key), write, options);\n        }\n        if (objEnd) {\n            const p = write(objEnd);\n            if (p instanceof Promise) {\n                await p;\n            }\n        }\n    }\n    /**\n     * Import a specific path's data from a stream\n     * @param path\n     * @param read read function that streams a new chunk of data\n     * @returns returns a promise that resolves once all data is imported\n     */\n    async importNode(path, read, options = { format: 'json', method: 'set' }) {\n        const chunkSize = 256 * 1024; // 256KB\n        const maxQueueBytes = 1024 * 1024; // 1MB\n        const state = {\n            data: '',\n            index: 0,\n            offset: 0,\n            queue: [],\n            queueStartByte: 0,\n            timesFlushed: 0,\n            get processedBytes() {\n                return this.offset + this.index;\n            },\n        };\n        const readNextChunk = async (append = false) => {\n            let data = await read(chunkSize);\n            if (data === null) {\n                if (state.data) {\n                    throw new Error(`Unexpected EOF at index ${state.offset + state.data.length}`);\n                }\n                else {\n                    throw new Error('Unable to read data from stream');\n                }\n            }\n            else if (typeof data === 'object') {\n                data = Utils.decodeString(data);\n            }\n            if (append) {\n                state.data += data;\n            }\n            else {\n                state.offset += state.data.length;\n                state.data = data;\n                state.index = 0;\n            }\n        };\n        const readBytes = async (length) => {\n            let str = '';\n            if (state.index + length >= state.data.length) {\n                str = state.data.slice(state.index);\n                length -= str.length;\n                await readNextChunk();\n            }\n            str += state.data.slice(state.index, state.index + length);\n            state.index += length;\n            return str;\n        };\n        const assertBytes = async (length) => {\n            if (state.index + length > state.data.length) {\n                await readNextChunk(true);\n            }\n            if (state.index + length > state.data.length) {\n                throw new Error('Not enough data available from stream');\n            }\n        };\n        const consumeToken = async (token) => {\n            // const str = state.data.slice(state.index, state.index + token.length);\n            const str = await readBytes(token.length);\n            if (str !== token) {\n                throw new Error(`Unexpected character \"${str[0]}\" at index ${state.offset + state.index}, expected \"${token}\"`);\n            }\n        };\n        const consumeSpaces = async () => {\n            const spaces = [' ', '\\t', '\\r', '\\n'];\n            while (true) {\n                if (state.index >= state.data.length) {\n                    await readNextChunk();\n                }\n                if (spaces.includes(state.data[state.index])) {\n                    state.index++;\n                }\n                else {\n                    break;\n                }\n            }\n        };\n        /**\n         * Reads number of bytes from the stream but does not consume them\n         */\n        const peekBytes = async (length) => {\n            await assertBytes(length);\n            const index = state.index;\n            return state.data.slice(index, index + length);\n        };\n        /**\n         * Tries to detect what type of value to expect, but does not read it\n         * @returns\n         */\n        const peekValueType = async () => {\n            await consumeSpaces();\n            const ch = await peekBytes(1);\n            switch (ch) {\n                case '\"': return 'string';\n                case '{': return 'object';\n                case '[': return 'array';\n                case 'n': return 'null';\n                case 'u': return 'undefined';\n                case 't':\n                case 'f':\n                    return 'boolean';\n                default: {\n                    if (ch === '-' || (ch >= '0' && ch <= '9')) {\n                        return 'number';\n                    }\n                    throw new Error(`Unknown value at index ${state.offset + state.index}`);\n                }\n            }\n        };\n        /**\n         * Reads a string from the stream at current index. Expects current character to be \"\n         */\n        const readString = async () => {\n            await consumeToken('\"');\n            let str = '';\n            let i = state.index;\n            // Read until next (unescaped) quote\n            while (state.data[i] !== '\"' || state.data[i - 1] === '\\\\') {\n                i++;\n                if (i >= state.data.length) {\n                    str += state.data.slice(state.index);\n                    await readNextChunk();\n                    i = 0;\n                }\n            }\n            str += state.data.slice(state.index, i);\n            state.index = i + 1;\n            return unescape(str);\n        };\n        const readBoolean = async () => {\n            if (state.data[state.index] === 't') {\n                await consumeToken('true');\n            }\n            else if (state.data[state.index] === 'f') {\n                await consumeToken('false');\n            }\n            throw new Error(`Expected true or false at index ${state.offset + state.index}`);\n        };\n        const readNumber = async () => {\n            let str = '';\n            let i = state.index;\n            // Read until non-number character is encountered\n            const nrChars = ['-', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '.', 'e', 'b', 'f', 'x', 'o', 'n']; // b: 0b110101, x: 0x3a, o: 0o01, n: 29723n, e: 10e+23, f: ?\n            while (nrChars.includes(state.data[i])) {\n                i++;\n                if (i >= state.data.length) {\n                    str += state.data.slice(state.index);\n                    await readNextChunk();\n                    i = 0;\n                }\n            }\n            str += state.data.slice(state.index, i);\n            state.index = i;\n            const nr = str.endsWith('n') ? BigInt(str.slice(0, -1)) : str.includes('.') ? parseFloat(str) : parseInt(str);\n            return nr;\n        };\n        const readValue = async () => {\n            await consumeSpaces();\n            const type = await peekValueType();\n            const value = await (() => {\n                switch (type) {\n                    case 'string': return readString();\n                    case 'object': return {};\n                    case 'array': return [];\n                    case 'number': return readNumber();\n                    case 'null': return null;\n                    case 'undefined': return undefined;\n                    case 'boolean': return readBoolean();\n                }\n            })();\n            return { type, value };\n        };\n        const unescape = (str) => str.replace(/\\\\n/g, '\\n').replace(/\\\\\"/g, '\"');\n        const getTypeSafeValue = (path, obj) => {\n            const type = obj['.type'];\n            let val = obj['.val'];\n            switch (type) {\n                case 'Date':\n                case 'date': {\n                    val = new Date(val);\n                    break;\n                }\n                case 'Buffer':\n                case 'binary': {\n                    val = unescape(val);\n                    if (val.startsWith('<~')) {\n                        // Ascii85 encoded\n                        val = ascii85.decode(val);\n                    }\n                    else {\n                        // base64 not implemented yet\n                        throw new Error(`Import error: Unexpected encoding for value for value at path \"/${path}\"`);\n                    }\n                    break;\n                }\n                case 'PathReference':\n                case 'reference': {\n                    val = new PathReference(val);\n                    break;\n                }\n                case 'bigint': {\n                    val = BigInt(val);\n                    break;\n                }\n                default:\n                    throw new Error(`Import error: Unsupported type \"${type}\" for value at path \"/${path}\"`);\n            }\n            return val;\n        };\n        const context = { acebase_import_id: ID.generate() };\n        const childOptions = { suppress_events: options.suppress_events, context };\n        /**\n         * Work in progress (not used yet): queue nodes to store to improve performance\n         */\n        const enqueue = async (target, value) => {\n            state.queue.push({ target, value });\n            if (state.processedBytes >= state.queueStartByte + maxQueueBytes) {\n                // Flush queue, group queued (set) items as update operations on their parents\n                const operations = state.queue.reduce((updates, item) => {\n                    // Optimization idea: find all data we know is complete, add that as 1 set if method !== 'merge'\n                    // Example: queue is something like [\n                    //   \"users/user1\": {},\n                    //   \"users/user1/email\": \"user@example.com\"\n                    //   \"users/user1/addresses\": {},\n                    //   \"users/user1/addresses/address1\": {},\n                    //   \"users/user1/addresses/address1/city\": \"Amsterdam\",\n                    //   \"users/user1/addresses/address2\": {}, // We KNOW \"users/user1/addresses/address1\" is not coming back\n                    //   \"users/user1/addresses/address2/city\": \"Berlin\",\n                    //   \"users/user2\": {} // <-- We KNOW \"users/user1\" is not coming back!\n                    //]\n                    if (item.target.path === path) {\n                        // This is the import target. If method is 'set' and this is the first flush, add it as 'set' operation.\n                        // Use 'update' in all other cases\n                        updates.push({ op: options.method === 'set' && state.timesFlushed === 0 ? 'set' : 'update', ...item });\n                    }\n                    else {\n                        // Find parent to merge with\n                        const parent = updates.find(other => other.target.isParentOf(item.target));\n                        if (parent) {\n                            parent.value[item.target.key] = item.value;\n                        }\n                        else {\n                            // Parent not found. If method is 'merge', use 'update', otherwise use or 'set'\n                            updates.push({ op: options.method === 'merge' ? 'update' : 'set', ...item });\n                        }\n                    }\n                    return updates;\n                }, []);\n                // Fresh state\n                state.queueStartByte = state.processedBytes;\n                state.queue = [];\n                state.timesFlushed++;\n                // Execute db updates\n            }\n            if (target.path === path) {\n                // This is the import target. If method === 'set'\n            }\n        };\n        const importObject = async (target) => {\n            await consumeToken('{');\n            await consumeSpaces();\n            const nextChar = await peekBytes(1);\n            if (nextChar === '}') {\n                state.index++;\n                return this.setNode(target.path, {}, childOptions);\n            }\n            let childCount = 0;\n            let obj = {};\n            let flushedBefore = false;\n            const flushObject = async () => {\n                let p;\n                if (!flushedBefore) {\n                    flushedBefore = true;\n                    p = this.setNode(target.path, obj, childOptions);\n                }\n                else if (Object.keys(obj).length > 0) {\n                    p = this.updateNode(target.path, obj, childOptions);\n                }\n                obj = {};\n                if (p) {\n                    await p;\n                }\n            };\n            const promises = [];\n            while (true) {\n                await consumeSpaces();\n                const property = await readString(); // readPropertyName();\n                await consumeSpaces();\n                await consumeToken(':');\n                await consumeSpaces();\n                const { value, type } = await readValue();\n                obj[property] = value;\n                childCount++;\n                if (['object', 'array'].includes(type)) {\n                    // Flush current imported value before proceeding with object/array child\n                    promises.push(flushObject());\n                    if (type === 'object') {\n                        // Import child object/array\n                        await importObject(target.child(property));\n                    }\n                    else {\n                        await importArray(target.child(property));\n                    }\n                }\n                // What comes next? End of object ('}') or new property (',')?\n                await consumeSpaces();\n                const nextChar = await peekBytes(1);\n                if (nextChar === '}') {\n                    // Done importing this object\n                    state.index++;\n                    break;\n                }\n                // Assume comma now\n                await consumeToken(',');\n            }\n            const isTypedValue = childCount === 2 && '.type' in obj && '.val' in obj;\n            if (isTypedValue) {\n                // This is a value that was exported with type safety.\n                // Do not store as object, but convert to original value\n                // Note that this is done regardless of options.type_safe\n                const val = getTypeSafeValue(target.path, obj);\n                return this.setNode(target.path, val, childOptions);\n            }\n            promises.push(flushObject());\n            await Promise.all(promises);\n        };\n        const importArray = async (target) => {\n            await consumeToken('[');\n            await consumeSpaces();\n            const nextChar = await peekBytes(1);\n            if (nextChar === ']') {\n                state.index++;\n                return this.setNode(target.path, [], childOptions);\n            }\n            let flushedBefore = false;\n            let arr = [];\n            let updates = {};\n            const flushArray = async () => {\n                let p;\n                if (!flushedBefore) {\n                    // Store array\n                    flushedBefore = true;\n                    p = this.setNode(target.path, arr, childOptions);\n                    arr = null; // GC\n                }\n                else if (Object.keys(updates).length > 0) {\n                    // Flush updates\n                    p = this.updateNode(target.path, updates, childOptions);\n                    updates = {};\n                }\n                if (p) {\n                    await p;\n                }\n            };\n            const pushChild = (value, index) => {\n                if (flushedBefore) {\n                    updates[index] = value;\n                }\n                else {\n                    arr.push(value);\n                }\n            };\n            const promises = [];\n            let index = 0;\n            while (true) {\n                await consumeSpaces();\n                const { value, type } = await readValue();\n                pushChild(value, index);\n                if (['object', 'array'].includes(type)) {\n                    // Flush current imported value before proceeding with object/array child\n                    promises.push(flushArray()); // No need to await now\n                    if (type === 'object') {\n                        // Import child object/array\n                        await importObject(target.child(index));\n                    }\n                    else {\n                        await importArray(target.child(index));\n                    }\n                }\n                // What comes next? End of array (']') or new property (',')?\n                await consumeSpaces();\n                const nextChar = await peekBytes(1);\n                if (nextChar === ']') {\n                    // Done importing this array\n                    state.index++;\n                    break;\n                }\n                // Assume comma now\n                await consumeToken(',');\n                index++;\n            }\n            promises.push(flushArray());\n            await Promise.all(promises);\n        };\n        const start = async () => {\n            const { value, type } = await readValue();\n            if (['object', 'array'].includes(type)) {\n                // Object or array value, has not been read yet\n                const target = PathInfo.get(path);\n                if (type === 'object') {\n                    await importObject(target);\n                }\n                else {\n                    await importArray(target);\n                }\n            }\n            else {\n                // Simple value\n                await this.setNode(path, value, childOptions);\n            }\n        };\n        return start();\n    }\n    /**\n     * Adds, updates or removes a schema definition to validate node values before they are stored at the specified path\n     * @param path target path to enforce the schema on, can include wildcards. Eg: 'users/*\\/posts/*' or 'users/$uid/posts/$postid'\n     * @param schema schema type definitions. When null value is passed, a previously set schema is removed.\n     */\n    setSchema(path, schema, warnOnly = false) {\n        if (typeof schema === 'undefined') {\n            throw new TypeError('schema argument must be given');\n        }\n        if (schema === null) {\n            // Remove previously set schema on path\n            const i = this._schemas.findIndex(s => s.path === path);\n            i >= 0 && this._schemas.splice(i, 1);\n            return;\n        }\n        // Parse schema, add or update it\n        const definition = new SchemaDefinition(schema, {\n            warnOnly,\n            warnCallback: (message) => this.debug.warn(message),\n        });\n        const item = this._schemas.find(s => s.path === path);\n        if (item) {\n            item.schema = definition;\n        }\n        else {\n            this._schemas.push({ path, schema: definition });\n            this._schemas.sort((a, b) => {\n                const ka = PathInfo.getPathKeys(a.path), kb = PathInfo.getPathKeys(b.path);\n                if (ka.length === kb.length) {\n                    return 0;\n                }\n                return ka.length < kb.length ? -1 : 1;\n            });\n        }\n    }\n    /**\n     * Gets currently active schema definition for the specified path\n     */\n    getSchema(path) {\n        const item = this._schemas.find(item => item.path === path);\n        return item ? { path, schema: item.schema.source, text: item.schema.text } : null;\n    }\n    /**\n     * Gets all currently active schema definitions\n     */\n    getSchemas() {\n        return this._schemas.map(item => ({ path: item.path, schema: item.schema.source, text: item.schema.text }));\n    }\n    /**\n     * Validates the schemas of the node being updated and its children\n     * @param path path being written to\n     * @param value the new value, or updates to current value\n     * @example\n     * // define schema for each tag of each user post:\n     * db.schema.set(\n     *  'users/$uid/posts/$postId/tags/$tagId',\n     *  { name: 'string', 'link_id?': 'number' }\n     * );\n     *\n     * // Insert that will fail:\n     * db.ref('users/352352/posts/572245').set({\n     *  text: 'this is my post',\n     *  tags: { sometag: 'deny this' } // <-- sometag must be typeof object\n     * });\n     *\n     * // Insert that will fail:\n     * db.ref('users/352352/posts/572245').set({\n     *  text: 'this is my post',\n     *  tags: {\n     *      tag1: { name: 'firstpost', link_id: 234 },\n     *      tag2: { name: 'newbie' },\n     *      tag3: { title: 'Not allowed' } // <-- title property not allowed\n     *  }\n     * });\n     *\n     * // Update that fails if post does not exist:\n     * db.ref('users/352352/posts/572245/tags/tag1').update({\n     *  name: 'firstpost'\n     * }); // <-- post is missing property text\n     */\n    validateSchema(path, value, options = { updates: false }) {\n        let result = { ok: true };\n        const pathInfo = PathInfo.get(path);\n        this._schemas.filter(s => pathInfo.isOnTrailOf(s.path)).every(s => {\n            if (pathInfo.isDescendantOf(s.path)) {\n                // Given check path is a descendant of this schema definition's path\n                const ancestorPath = PathInfo.fillVariables(s.path, path);\n                const trailKeys = pathInfo.keys.slice(PathInfo.getPathKeys(s.path).length);\n                result = s.schema.check(ancestorPath, value, options.updates, trailKeys);\n                return result.ok;\n            }\n            // Given check path is on schema definition's path or on a higher path\n            const trailKeys = PathInfo.getPathKeys(s.path).slice(pathInfo.keys.length);\n            if (options.updates === true && trailKeys.length > 0 && !(trailKeys[0] in value)) {\n                // Fixes #217: this update on a higher path does not affect any data at schema's target path\n                return result.ok;\n            }\n            const partial = options.updates === true && trailKeys.length === 0;\n            const check = (path, value, trailKeys) => {\n                if (trailKeys.length === 0) {\n                    // Check this node\n                    return s.schema.check(path, value, partial);\n                }\n                else if (value === null) {\n                    return { ok: true }; // Not at the end of trail, but nothing more to check\n                }\n                const key = trailKeys[0];\n                if (typeof key === 'string' && (key === '*' || key[0] === '$')) {\n                    // Wildcard. Check each key in value recursively\n                    if (value === null || typeof value !== 'object') {\n                        // Can't check children, because there are none. This is\n                        // possible if another rule permits the value at current path\n                        // to be something else than an object.\n                        return { ok: true };\n                    }\n                    let result;\n                    Object.keys(value).every(childKey => {\n                        const childPath = PathInfo.getChildPath(path, childKey);\n                        const childValue = value[childKey];\n                        result = check(childPath, childValue, trailKeys.slice(1));\n                        return result.ok;\n                    });\n                    return result;\n                }\n                else {\n                    const childPath = PathInfo.getChildPath(path, key);\n                    const childValue = value[key];\n                    return check(childPath, childValue, trailKeys.slice(1));\n                }\n            };\n            result = check(path, value, trailKeys);\n            return result.ok;\n        });\n        return result;\n    }\n}\n//# sourceMappingURL=index.js.map","import { PathInfo } from 'acebase-core';\n/**\n * Helper functions to build custom storage classes with\n */\nexport class CustomStorageHelpers {\n    /**\n     * Helper function that returns a SQL where clause for all children of given path\n     * @param path Path to get children of\n     * @param columnName Name of the Path column in your SQL db, default is 'path'\n     * @returns Returns the SQL where clause\n     */\n    static ChildPathsSql(path, columnName = 'path') {\n        const where = path === ''\n            ? `${columnName} <> '' AND ${columnName} NOT LIKE '%/%'`\n            : `(${columnName} LIKE '${path}/%' OR ${columnName} LIKE '${path}[%') AND ${columnName} NOT LIKE '${path}/%/%' AND ${columnName} NOT LIKE '${path}[%]/%' AND ${columnName} NOT LIKE '${path}[%][%'`;\n        return where;\n    }\n    /**\n     * Helper function that returns a regular expression to test if paths are children of the given path\n     * @param path Path to test children of\n     * @returns Returns regular expression to test paths with\n     */\n    static ChildPathsRegex(path) {\n        return new RegExp(`^${path}(?:/[^/[]+|\\\\[[0-9]+\\\\])$`);\n    }\n    /**\n     * Helper function that returns a SQL where clause for all descendants of given path\n     * @param path Path to get descendants of\n     * @param columnName Name of the Path column in your SQL db, default is 'path'\n     * @returns Returns the SQL where clause\n     */\n    static DescendantPathsSql(path, columnName = 'path') {\n        const where = path === ''\n            ? `${columnName} <> ''`\n            : `${columnName} LIKE '${path}/%' OR ${columnName} LIKE '${path}[%'`;\n        return where;\n    }\n    /**\n     * Helper function that returns a regular expression to test if paths are descendants of the given path\n     * @param path Path to test descendants of\n     * @returns Returns regular expression to test paths with\n     */\n    static DescendantPathsRegex(path) {\n        return new RegExp(`^${path}(?:/[^/[]+|\\\\[[0-9]+\\\\])`);\n    }\n    /**\n     * PathInfo helper class. Can be used to extract keys from a given path, get parent paths, check if a path is a child or descendant of other path etc\n     * @example\n     * var pathInfo = CustomStorage.PathInfo.get('my/path/to/data');\n     * pathInfo.key === 'data';\n     * pathInfo.parentPath === 'my/path/to';\n     * pathInfo.pathKeys; // ['my','path','to','data'];\n     * pathInfo.isChildOf('my/path/to') === true;\n     * pathInfo.isDescendantOf('my/path') === true;\n     * pathInfo.isParentOf('my/path/to/data/child') === true;\n     * pathInfo.isAncestorOf('my/path/to/data/child/grandchild') === true;\n     * pathInfo.childPath('child') === 'my/path/to/data/child';\n     * pathInfo.childPath(0) === 'my/path/to/data[0]';\n     */\n    static get PathInfo() {\n        return PathInfo;\n    }\n}\n//# sourceMappingURL=helpers.js.map","export class NodeAddress {\n    constructor(path) {\n        this.path = path;\n    }\n    toString() {\n        return `\"/${this.path}\"`;\n    }\n    /**\n     * Compares this address to another address\n     */\n    equals(address) {\n        return this.path === address.path;\n    }\n}\nexport class RemovedNodeAddress extends NodeAddress {\n    constructor(path) {\n        super(path);\n    }\n    toString() {\n        return `\"/${this.path}\" (removed)`;\n    }\n    /**\n     * Compares this address to another address\n     */\n    equals(address) {\n        return address instanceof RemovedNodeAddress && this.path === address.path;\n    }\n}\n//# sourceMappingURL=node-address.js.map","import { ID, PathReference, PathInfo, ascii85, ColorStyle, Utils } from 'acebase-core';\nconst { compareValues } = Utils;\nimport { NodeInfo } from '../../node-info.js';\nimport { NodeLocker } from '../../node-lock.js';\nimport { VALUE_TYPES } from '../../node-value-types.js';\nimport { NodeNotFoundError, NodeRevisionError } from '../../node-errors.js';\nimport { Storage, StorageSettings } from '../index.js';\nimport { CustomStorageHelpers } from './helpers.js';\nimport { NodeAddress } from '../../node-address.js';\nimport { assert } from '../../assert.js';\nexport { CustomStorageHelpers } from './helpers.js';\n/** Interface for metadata being stored for nodes */\nexport class ICustomStorageNodeMetaData {\n    constructor() {\n        /** cuid (time sortable revision id). Nodes stored in the same operation share this id */\n        this.revision = '';\n        /** Number of revisions, starting with 1. Resets to 1 after deletion and recreation */\n        this.revision_nr = 0;\n        /** Creation date/time in ms since epoch UTC */\n        this.created = 0;\n        /** Last modification date/time in ms since epoch UTC */\n        this.modified = 0;\n        /** Type of the node's value. 1=object, 2=array, 3=number, 4=boolean, 5=string, 6=date, 7=reserved, 8=binary, 9=reference */\n        this.type = 0;\n    }\n}\n/** Interface for metadata combined with a stored value */\nexport class ICustomStorageNode extends ICustomStorageNodeMetaData {\n    constructor() {\n        super();\n        /** only Object, Array, large string and binary values. */\n        this.value = null;\n    }\n}\n/** Enables get/set/remove operations to be wrapped in transactions to improve performance and reliability. */\nexport class CustomStorageTransaction {\n    /**\n     * @param target Which path the transaction is taking place on, and whether it is a read or read/write lock. If your storage backend does not support transactions, is synchronous, or if you are able to lock resources based on path: use storage.nodeLocker to ensure threadsafe transactions\n     */\n    constructor(target) {\n        this.production = false; // dev mode by default\n        this.target = {\n            get originalPath() { return target.path; },\n            path: target.path,\n            get write() { return target.write; },\n        };\n        this.id = ID.generate();\n    }\n    /**\n     * Returns the number of children stored in their own records. This implementation uses `childrenOf` to count, override if storage supports a quicker way.\n     * Eg: For SQL databases, you can implement this with a single query like `SELECT count(*) FROM nodes WHERE ${CustomStorageHelpers.ChildPathsSql(path)}`\n     * @param path\n     * @returns Returns a promise that resolves with the number of children\n     */\n    async getChildCount(path) {\n        let childCount = 0;\n        await this.childrenOf(path, { metadata: false, value: false }, () => { childCount++; return false; });\n        return childCount;\n    }\n    /**\n     * NOT USED YET\n     * Default implementation of getMultiple that executes .get for each given path. Override for custom logic\n     * @param paths\n     * @returns Returns promise with a Map of paths to nodes\n     */\n    async getMultiple(paths) {\n        const map = new Map();\n        await Promise.all(paths.map(path => this.get(path).then(val => map.set(path, val))));\n        return map;\n    }\n    /**\n     * NOT USED YET\n     * Default implementation of setMultiple that executes .set for each given path. Override for custom logic\n     * @param nodes\n     */\n    async setMultiple(nodes) {\n        await Promise.all(nodes.map(({ path, node }) => this.set(path, node)));\n    }\n    /**\n     * Default implementation of removeMultiple that executes .remove for each given path. Override for custom logic\n     * @param paths\n     */\n    async removeMultiple(paths) {\n        await Promise.all(paths.map(path => this.remove(path)));\n    }\n    /**\n     * @returns {Promise<any>}\n     */\n    async commit() { throw new Error(`CustomStorageTransaction.rollback must be overridden by subclass`); }\n    /**\n     * Moves the transaction path to the parent node. If node locking is used, it will request a new lock\n     * Used internally, must not be overridden unless custom locking mechanism is required\n     * @param targetPath\n     */\n    async moveToParentPath(targetPath) {\n        const currentPath = (this._lock && this._lock.path) || this.target.path;\n        if (currentPath === targetPath) {\n            return targetPath; // Already on the right path\n        }\n        const pathInfo = CustomStorageHelpers.PathInfo.get(targetPath);\n        if (pathInfo.isParentOf(currentPath)) {\n            if (this._lock) {\n                this._lock = await this._lock.moveToParent();\n            }\n        }\n        else {\n            throw new Error(`Locking issue. Locked path \"${this._lock.path}\" is not a child/descendant of \"${targetPath}\"`);\n        }\n        this.target.path = targetPath;\n        return targetPath;\n    }\n}\n/**\n * Allows data to be stored in a custom storage backend of your choice! Simply provide a couple of functions\n * to get, set and remove data and you're done.\n */\nexport class CustomStorageSettings extends StorageSettings {\n    constructor(settings) {\n        super(settings);\n        /**\n         * Whether default node locking should be used.\n         * Set to false if your storage backend disallows multiple simultanious write transactions.\n         * Set to true if your storage backend does not support transactions (eg LocalStorage) or allows\n         * multiple simultanious write transactions (eg AceBase binary).\n         * @default true\n         */\n        this.locking = true;\n        if (typeof settings !== 'object') {\n            throw new Error('settings missing');\n        }\n        if (typeof settings.ready !== 'function') {\n            throw new Error(`ready must be a function`);\n        }\n        if (typeof settings.getTransaction !== 'function') {\n            throw new Error(`getTransaction must be a function`);\n        }\n        this.name = settings.name;\n        // this.info = `${this.name || 'CustomStorage'} realtime database`;\n        this.locking = settings.locking !== false;\n        if (this.locking) {\n            this.lockTimeout = typeof settings.lockTimeout === 'number' ? settings.lockTimeout : 120;\n        }\n        this.ready = settings.ready;\n        // Hijack getTransaction to add locking\n        const useLocking = this.locking;\n        const nodeLocker = useLocking ? new NodeLocker(console, this.lockTimeout) : null;\n        this.getTransaction = async ({ path, write }) => {\n            // console.log(`${write ? 'WRITE' : 'READ'} transaction requested for path \"${path}\"`)\n            const transaction = await settings.getTransaction({ path, write });\n            assert(typeof transaction.id === 'string', `transaction id not set`);\n            // console.log(`Got transaction ${transaction.id} for ${write ? 'WRITE' : 'READ'} on path \"${path}\"`);\n            // Hijack rollback and commit\n            const rollback = transaction.rollback;\n            const commit = transaction.commit;\n            transaction.commit = async () => {\n                // console.log(`COMMIT ${transaction.id} for ${write ? 'WRITE' : 'READ'} on path \"${path}\"`);\n                const ret = await commit.call(transaction);\n                // console.log(`COMMIT DONE ${transaction.id} for ${write ? 'WRITE' : 'READ'} on path \"${path}\"`);\n                if (useLocking) {\n                    await transaction._lock.release('commit');\n                }\n                return ret;\n            };\n            transaction.rollback = async (reason) => {\n                // const reasonText = reason instanceof Error ? reason.message : reason.toString();\n                // console.error(`ROLLBACK ${transaction.id} for ${write ? 'WRITE' : 'READ'} on path \"${path}\":`, reason);\n                const ret = await rollback.call(transaction, reason);\n                // console.log(`ROLLBACK DONE ${transaction.id} for ${write ? 'WRITE' : 'READ'} on path \"${path}\"`);\n                if (useLocking) {\n                    await transaction._lock.release('rollback');\n                }\n                return ret;\n            };\n            if (useLocking) {\n                // Lock the path before continuing\n                transaction._lock = await nodeLocker.lock(path, transaction.id, write, `${this.name}::getTransaction`);\n            }\n            return transaction;\n        };\n    }\n}\nexport class CustomStorageNodeAddress {\n    constructor(containerPath) {\n        this.path = containerPath;\n    }\n}\nexport class CustomStorageNodeInfo extends NodeInfo {\n    constructor(info) {\n        super(info);\n        this.revision = info.revision;\n        this.revision_nr = info.revision_nr;\n        this.created = info.created;\n        this.modified = info.modified;\n    }\n}\nexport class CustomStorage extends Storage {\n    constructor(dbname, settings, env) {\n        super(dbname, settings, env);\n        this._customImplementation = settings;\n        this._init();\n    }\n    async _init() {\n        this.debug.log(`Database \"${this.name}\" details:`.colorize(ColorStyle.dim));\n        this.debug.log(`- Type: CustomStorage`.colorize(ColorStyle.dim));\n        this.debug.log(`- Path: ${this.settings.path}`.colorize(ColorStyle.dim));\n        this.debug.log(`- Max inline value size: ${this.settings.maxInlineValueSize}`.colorize(ColorStyle.dim));\n        this.debug.log(`- Autoremove undefined props: ${this.settings.removeVoidProperties}`.colorize(ColorStyle.dim));\n        // Create root node if it's not there yet\n        await this._customImplementation.ready();\n        const transaction = await this._customImplementation.getTransaction({ path: '', write: true });\n        const info = await this.getNodeInfo('', { transaction });\n        if (!info.exists) {\n            await this._writeNode('', {}, { transaction });\n        }\n        await transaction.commit();\n        if (this.indexes.supported) {\n            await this.indexes.load();\n        }\n        this.emit('ready');\n    }\n    throwImplementationError(message) {\n        throw new Error(`CustomStorage \"${this._customImplementation.name}\" ${message}`);\n    }\n    _storeNode(path, node, options) {\n        // serialize the value to store\n        const getTypedChildValue = (val) => {\n            if (val === null) {\n                throw new Error(`Not allowed to store null values. remove the property`);\n            }\n            else if (['string', 'number', 'boolean'].includes(typeof val)) {\n                return val;\n            }\n            else if (val instanceof Date) {\n                return { type: VALUE_TYPES.DATETIME, value: val.getTime() };\n            }\n            else if (val instanceof PathReference) {\n                return { type: VALUE_TYPES.REFERENCE, value: val.path };\n            }\n            else if (val instanceof ArrayBuffer) {\n                return { type: VALUE_TYPES.BINARY, value: ascii85.encode(val) };\n            }\n            else if (typeof val === 'object') {\n                assert(Object.keys(val).length === 0, 'child object stored in parent can only be empty');\n                return val;\n            }\n        };\n        const unprocessed = `Caller should have pre-processed the value by converting it to a string`;\n        if (node.type === VALUE_TYPES.ARRAY && node.value instanceof Array) {\n            // Convert array to object with numeric properties\n            // NOTE: caller should have done this already\n            console.warn(`Unprocessed array. ${unprocessed}`);\n            const obj = {};\n            for (let i = 0; i < node.value.length; i++) {\n                obj[i] = node.value[i];\n            }\n            node.value = obj;\n        }\n        if (node.type === VALUE_TYPES.BINARY && typeof node.value !== 'string') {\n            console.warn(`Unprocessed binary value. ${unprocessed}`);\n            node.value = ascii85.encode(node.value);\n        }\n        if (node.type === VALUE_TYPES.REFERENCE && node.value instanceof PathReference) {\n            console.warn(`Unprocessed path reference. ${unprocessed}`);\n            node.value = node.value.path;\n        }\n        if ([VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(node.type)) {\n            const original = node.value;\n            node.value = {};\n            // If original is an array, it'll automatically be converted to an object now\n            Object.keys(original).forEach(key => {\n                node.value[key] = getTypedChildValue(original[key]);\n            });\n        }\n        return options.transaction.set(path, node);\n    }\n    _processReadNodeValue(node) {\n        const getTypedChildValue = (val) => {\n            // Typed value stored in parent record\n            if (val.type === VALUE_TYPES.BINARY) {\n                // binary stored in a parent record as a string\n                return ascii85.decode(val.value);\n            }\n            else if (val.type === VALUE_TYPES.DATETIME) {\n                // Date value stored as number\n                return new Date(val.value);\n            }\n            else if (val.type === VALUE_TYPES.REFERENCE) {\n                // Path reference stored as string\n                return new PathReference(val.value);\n            }\n            else {\n                throw new Error(`Unhandled child value type ${val.type}`);\n            }\n        };\n        switch (node.type) {\n            case VALUE_TYPES.ARRAY:\n            case VALUE_TYPES.OBJECT: {\n                // check if any value needs to be converted\n                // NOTE: Arrays are stored with numeric properties\n                const obj = node.value;\n                Object.keys(obj).forEach(key => {\n                    const item = obj[key];\n                    if (typeof item === 'object' && 'type' in item) {\n                        obj[key] = getTypedChildValue(item);\n                    }\n                });\n                node.value = obj;\n                break;\n            }\n            case VALUE_TYPES.BINARY: {\n                node.value = ascii85.decode(node.value);\n                break;\n            }\n            case VALUE_TYPES.REFERENCE: {\n                node.value = new PathReference(node.value);\n                break;\n            }\n            case VALUE_TYPES.STRING: {\n                // No action needed\n                // node.value = node.value;\n                break;\n            }\n            default:\n                throw new Error(`Invalid standalone record value type`); // should never happen\n        }\n    }\n    async _readNode(path, options) {\n        // deserialize a stored value (always an object with \"type\", \"value\", \"revision\", \"revision_nr\", \"created\", \"modified\")\n        const node = await options.transaction.get(path);\n        if (node === null) {\n            return null;\n        }\n        if (typeof node !== 'object') {\n            this.throwImplementationError(`transaction.get must return an ICustomStorageNode object. Use JSON.parse if your set function stored it as a string`);\n        }\n        this._processReadNodeValue(node);\n        return node;\n    }\n    _getTypeFromStoredValue(val) {\n        let type;\n        if (typeof val === 'string') {\n            type = VALUE_TYPES.STRING;\n        }\n        else if (typeof val === 'number') {\n            type = VALUE_TYPES.NUMBER;\n        }\n        else if (typeof val === 'boolean') {\n            type = VALUE_TYPES.BOOLEAN;\n        }\n        else if (val instanceof Array) {\n            type = VALUE_TYPES.ARRAY;\n        }\n        else if (typeof val === 'object') {\n            if ('type' in val) {\n                const serialized = val;\n                type = serialized.type;\n                val = serialized.value;\n                if (type === VALUE_TYPES.DATETIME) {\n                    val = new Date(val);\n                }\n                else if (type === VALUE_TYPES.REFERENCE) {\n                    val = new PathReference(val);\n                }\n            }\n            else {\n                type = VALUE_TYPES.OBJECT;\n            }\n        }\n        else {\n            throw new Error(`Unknown value type`);\n        }\n        return { type, value: val };\n    }\n    /**\n     * Creates or updates a node in its own record. DOES NOT CHECK if path exists in parent node, or if parent paths exist! Calling code needs to do this\n     */\n    async _writeNode(path, value, options) {\n        if (!options.merge && this.valueFitsInline(value) && path !== '') {\n            throw new Error(`invalid value to store in its own node`);\n        }\n        else if (path === '' && (typeof value !== 'object' || value instanceof Array)) {\n            throw new Error(`Invalid root node value. Must be an object`);\n        }\n        // Check if the value for this node changed, to prevent recursive calls to\n        // perform unnecessary writes that do not change any data\n        if (typeof options.diff === 'undefined' && typeof options.currentValue !== 'undefined') {\n            const diff = compareValues(options.currentValue, value);\n            if (options.merge && typeof diff === 'object') {\n                diff.removed = diff.removed.filter(key => value[key] === null); // Only keep \"removed\" items that are really being removed by setting to null\n            }\n            options.diff = diff;\n        }\n        if (options.diff === 'identical') {\n            return; // Done!\n        }\n        const transaction = options.transaction;\n        // Get info about current node at path\n        const currentRow = options.currentValue === null\n            ? null // No need to load info if currentValue is null (we already know it doesn't exist)\n            : await this._readNode(path, { transaction });\n        if (options.merge && currentRow) {\n            if (currentRow.type === VALUE_TYPES.ARRAY && !(value instanceof Array) && typeof value === 'object' && Object.keys(value).some(key => isNaN(parseInt(key)))) {\n                throw new Error(`Cannot merge existing array of path \"${path}\" with an object`);\n            }\n            if (value instanceof Array && currentRow.type !== VALUE_TYPES.ARRAY) {\n                throw new Error(`Cannot merge existing object of path \"${path}\" with an array`);\n            }\n        }\n        const revision = options.revision || ID.generate();\n        const mainNode = {\n            type: currentRow && currentRow.type === VALUE_TYPES.ARRAY ? VALUE_TYPES.ARRAY : VALUE_TYPES.OBJECT,\n            value: {},\n        };\n        const childNodeValues = {};\n        if (value instanceof Array) {\n            mainNode.type = VALUE_TYPES.ARRAY;\n            // Convert array to object with numeric properties\n            const obj = {};\n            for (let i = 0; i < value.length; i++) {\n                obj[i] = value[i];\n            }\n            value = obj;\n        }\n        else if (value instanceof PathReference) {\n            mainNode.type = VALUE_TYPES.REFERENCE;\n            mainNode.value = value.path;\n        }\n        else if (value instanceof ArrayBuffer) {\n            mainNode.type = VALUE_TYPES.BINARY;\n            mainNode.value = ascii85.encode(value);\n        }\n        else if (typeof value === 'string') {\n            mainNode.type = VALUE_TYPES.STRING;\n            mainNode.value = value;\n        }\n        const currentIsObjectOrArray = currentRow ? [VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(currentRow.type) : false;\n        const newIsObjectOrArray = [VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(mainNode.type);\n        const children = {\n            current: [],\n            new: [],\n        };\n        let currentObject = null;\n        if (currentIsObjectOrArray) {\n            currentObject = currentRow.value;\n            children.current = Object.keys(currentObject);\n            // if (currentObject instanceof Array) { // ALWAYS FALSE BECAUSE THEY ARE STORED AS OBJECTS WITH NUMERIC PROPERTIES\n            //     // Convert array to object with numeric properties\n            //     const obj = {};\n            //     for (let i = 0; i < value.length; i++) {\n            //         obj[i] = value[i];\n            //     }\n            //     currentObject = obj;\n            // }\n            if (newIsObjectOrArray) {\n                mainNode.value = currentObject;\n            }\n        }\n        if (newIsObjectOrArray) {\n            // Object or array. Determine which properties can be stored in the main node,\n            // and which should be stored in their own nodes\n            if (!options.merge) {\n                // Check which keys are present in the old object, but not in newly given object\n                Object.keys(mainNode.value).forEach(key => {\n                    if (!(key in value)) {\n                        // Property that was in old object, is not in new value -> set to null to mark deletion!\n                        value[key] = null;\n                    }\n                });\n            }\n            Object.keys(value).forEach(key => {\n                const val = value[key];\n                delete mainNode.value[key]; // key is being overwritten, moved from inline to dedicated, or deleted. TODO: check if this needs to be done SQLite & MSSQL implementations too\n                if (val === null) { //  || typeof val === 'undefined'\n                    // This key is being removed\n                    return;\n                }\n                else if (typeof val === 'undefined') {\n                    if (this.settings.removeVoidProperties === true) {\n                        delete value[key]; // Kill the property in the passed object as well, to prevent differences in stored and working values\n                        return;\n                    }\n                    else {\n                        throw new Error(`Property \"${key}\" has invalid value. Cannot store undefined values. Set removeVoidProperties option to true to automatically remove undefined properties`);\n                    }\n                }\n                // Where to store this value?\n                if (this.valueFitsInline(val)) {\n                    // Store in main node\n                    mainNode.value[key] = val;\n                }\n                else {\n                    // Store in child node\n                    childNodeValues[key] = val;\n                }\n            });\n        }\n        // Insert or update node\n        const isArray = mainNode.type === VALUE_TYPES.ARRAY;\n        if (currentRow) {\n            // update\n            this.debug.log(`Node \"/${path}\" is being ${options.merge ? 'updated' : 'overwritten'}`.colorize(ColorStyle.cyan));\n            // If existing is an array or object, we have to find out which children are affected\n            if (currentIsObjectOrArray || newIsObjectOrArray) {\n                // Get current child nodes in dedicated child records\n                const pathInfo = PathInfo.get(path);\n                const keys = [];\n                let checkExecuted = false;\n                const includeChildCheck = (childPath) => {\n                    checkExecuted = true;\n                    if (!transaction.production && !pathInfo.isParentOf(childPath)) {\n                        // Double check failed\n                        this.throwImplementationError(`\"${childPath}\" is not a child of \"${path}\" - childrenOf must only check and return paths that are children`);\n                    }\n                    return true;\n                };\n                const addChildPath = (childPath) => {\n                    if (!checkExecuted) {\n                        this.throwImplementationError(`childrenOf did not call checkCallback before addCallback`);\n                    }\n                    const key = PathInfo.get(childPath).key;\n                    keys.push(key.toString()); // .toString to make sure all keys are compared as strings\n                    return true; // Keep streaming\n                };\n                await transaction.childrenOf(path, { metadata: false, value: false }, includeChildCheck, addChildPath);\n                children.current = children.current.concat(keys);\n                if (newIsObjectOrArray) {\n                    if (options && options.merge) {\n                        children.new = children.current.slice();\n                    }\n                    Object.keys(value).forEach(key => {\n                        if (!children.new.includes(key)) {\n                            children.new.push(key);\n                        }\n                    });\n                }\n                const changes = {\n                    insert: children.new.filter(key => !children.current.includes(key)),\n                    update: [],\n                    delete: options && options.merge ? Object.keys(value).filter(key => value[key] === null) : children.current.filter(key => !children.new.includes(key)),\n                };\n                changes.update = children.new.filter(key => children.current.includes(key) && !changes.delete.includes(key));\n                if (isArray && options.merge && (changes.insert.length > 0 || changes.delete.length > 0)) {\n                    // deletes or inserts of individual array entries are not allowed, unless it is the last entry:\n                    // - deletes would cause the paths of following items to change, which is unwanted because the actual data does not change,\n                    // eg: removing index 3 on array of size 10 causes entries with index 4 to 9 to 'move' to indexes 3 to 8\n                    // - inserts might introduce gaps in indexes,\n                    // eg: adding to index 7 on an array of size 3 causes entries with indexes 3 to 6 to go 'missing'\n                    const newArrayKeys = changes.update.concat(changes.insert);\n                    const isExhaustive = newArrayKeys.every((k, index, arr) => arr.includes(index.toString()));\n                    if (!isExhaustive) {\n                        throw new Error(`Elements cannot be inserted beyond, or removed before the end of an array. Rewrite the whole array at path \"${path}\" or change your schema to use an object collection instead`);\n                    }\n                }\n                // (over)write all child nodes that must be stored in their own record\n                const writePromises = Object.keys(childNodeValues).map(key => {\n                    const keyOrIndex = isArray ? parseInt(key) : key;\n                    const childDiff = typeof options.diff === 'object' ? options.diff.forChild(keyOrIndex) : undefined;\n                    if (childDiff === 'identical') {\n                        // console.warn(`Skipping _writeNode recursion for child \"${keyOrIndex}\"`);\n                        return; // Skip\n                    }\n                    const childPath = pathInfo.childPath(keyOrIndex); // PathInfo.getChildPath(path, key);\n                    const childValue = childNodeValues[keyOrIndex];\n                    // Pass current child value to _writeNode\n                    const currentChildValue = typeof options.currentValue === 'undefined' // Fixing issue #20\n                        ? undefined\n                        : options.currentValue !== null && typeof options.currentValue === 'object' && keyOrIndex in options.currentValue\n                            ? options.currentValue[keyOrIndex]\n                            : null;\n                    return this._writeNode(childPath, childValue, { transaction, revision, merge: false, currentValue: currentChildValue, diff: childDiff });\n                });\n                // Delete all child nodes that were stored in their own record, but are being removed\n                // Also delete nodes that are being moved from a dedicated record to inline\n                const movingNodes = newIsObjectOrArray ? keys.filter(key => key in mainNode.value) : []; // moving from dedicated to inline value\n                const deleteDedicatedKeys = changes.delete.concat(movingNodes);\n                const deletePromises = deleteDedicatedKeys.map(key => {\n                    const keyOrIndex = isArray ? parseInt(key) : key;\n                    const childPath = pathInfo.childPath(keyOrIndex);\n                    return this._deleteNode(childPath, { transaction });\n                });\n                const promises = writePromises.concat(deletePromises);\n                await Promise.all(promises);\n            }\n            // Update main node\n            // TODO: Check if revision should change?\n            const p = this._storeNode(path, {\n                type: mainNode.type,\n                value: mainNode.value,\n                revision: currentRow.revision,\n                revision_nr: currentRow.revision_nr + 1,\n                created: currentRow.created,\n                modified: Date.now(),\n            }, {\n                transaction,\n            });\n            if (p instanceof Promise) {\n                return await p;\n            }\n        }\n        else {\n            // Current node does not exist, create it and any child nodes\n            // write all child nodes that must be stored in their own record\n            this.debug.log(`Node \"/${path}\" is being created`.colorize(ColorStyle.cyan));\n            if (isArray) {\n                // Check if the array is \"intact\" (all entries have an index from 0 to the end with no gaps)\n                const arrayKeys = Object.keys(mainNode.value).concat(Object.keys(childNodeValues));\n                const isExhaustive = arrayKeys.every((k, index, arr) => arr.includes(index.toString()));\n                if (!isExhaustive) {\n                    throw new Error(`Cannot store arrays with missing entries`);\n                }\n            }\n            const promises = Object.keys(childNodeValues).map(key => {\n                const keyOrIndex = isArray ? parseInt(key) : key;\n                const childPath = PathInfo.getChildPath(path, keyOrIndex);\n                const childValue = childNodeValues[keyOrIndex];\n                return this._writeNode(childPath, childValue, { transaction, revision, merge: false, currentValue: null });\n            });\n            // Create current node\n            const p = this._storeNode(path, {\n                type: mainNode.type,\n                value: mainNode.value,\n                revision,\n                revision_nr: 1,\n                created: Date.now(),\n                modified: Date.now(),\n            }, {\n                transaction,\n            });\n            if (p instanceof Promise) {\n                promises.push(p);\n            }\n            await Promise.all(promises);\n        }\n    }\n    /**\n     * Deletes (dedicated) node and all subnodes without checking for existence. Use with care - all removed nodes will lose their revision stats! DOES NOT REMOVE INLINE CHILD NODES!\n     */\n    async _deleteNode(path, options) {\n        const pathInfo = PathInfo.get(path);\n        this.debug.log(`Node \"/${path}\" is being deleted`.colorize(ColorStyle.cyan));\n        const deletePaths = [path];\n        let checkExecuted = false;\n        const includeDescendantCheck = (descPath) => {\n            checkExecuted = true;\n            if (!transaction.production && !pathInfo.isAncestorOf(descPath)) {\n                // Double check failed\n                this.throwImplementationError(`\"${descPath}\" is not a descendant of \"${path}\" - descendantsOf must only check and return paths that are descendants`);\n            }\n            return true;\n        };\n        const addDescendant = (descPath) => {\n            if (!checkExecuted) {\n                this.throwImplementationError(`descendantsOf did not call checkCallback before addCallback`);\n            }\n            deletePaths.push(descPath);\n            return true;\n        };\n        const transaction = options.transaction;\n        await transaction.descendantsOf(path, { metadata: false, value: false }, includeDescendantCheck, addDescendant);\n        this.debug.log(`Nodes ${deletePaths.map(p => `\"/${p}\"`).join(',')} are being deleted`.colorize(ColorStyle.cyan));\n        return transaction.removeMultiple(deletePaths);\n    }\n    /**\n     * Enumerates all children of a given Node for reflection purposes\n     */\n    getChildren(path, options = {}) {\n        let callback;\n        const generator = {\n            /**\n             *\n             * @param valueCallback callback function to run for each child. Return false to stop iterating\n             * @returns returns a promise that resolves with a boolean indicating if all children have been enumerated, or was canceled by the valueCallback function\n             */\n            next(valueCallback) {\n                callback = valueCallback;\n                return start();\n            },\n        };\n        const start = async () => {\n            const transaction = options.transaction || await this._customImplementation.getTransaction({ path, write: false });\n            try {\n                let canceled = false;\n                await (async () => {\n                    const node = await this._readNode(path, { transaction });\n                    if (!node) {\n                        throw new NodeNotFoundError(`Node \"/${path}\" does not exist`);\n                    }\n                    if (![VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(node.type)) {\n                        // No children\n                        return;\n                    }\n                    const isArray = node.type === VALUE_TYPES.ARRAY;\n                    const value = node.value;\n                    let keys = Object.keys(value).map(key => isArray ? parseInt(key) : key);\n                    if (options.keyFilter) {\n                        keys = keys.filter(key => options.keyFilter.includes(key));\n                    }\n                    const pathInfo = PathInfo.get(path);\n                    keys.length > 0 && keys.every(key => {\n                        const child = this._getTypeFromStoredValue(value[key]);\n                        const info = new CustomStorageNodeInfo({\n                            path: pathInfo.childPath(key),\n                            key: isArray ? null : key,\n                            index: isArray ? key : null,\n                            type: child.type,\n                            address: null,\n                            exists: true,\n                            value: child.value,\n                            revision: node.revision,\n                            revision_nr: node.revision_nr,\n                            created: new Date(node.created),\n                            modified: new Date(node.modified),\n                        });\n                        canceled = callback(info) === false;\n                        return !canceled; // stop .every loop if canceled\n                    });\n                    if (canceled) {\n                        return;\n                    }\n                    // Go on... get other children\n                    let checkExecuted = false;\n                    const includeChildCheck = (childPath) => {\n                        checkExecuted = true;\n                        if (!transaction.production && !pathInfo.isParentOf(childPath)) {\n                            // Double check failed\n                            this.throwImplementationError(`\"${childPath}\" is not a child of \"${path}\" - childrenOf must only check and return paths that are children`);\n                        }\n                        if (options.keyFilter) {\n                            const key = PathInfo.get(childPath).key;\n                            return options.keyFilter.includes(key);\n                        }\n                        return true;\n                    };\n                    const addChildNode = (childPath, node) => {\n                        if (!checkExecuted) {\n                            this.throwImplementationError(`childrenOf did not call checkCallback before addCallback`);\n                        }\n                        const key = PathInfo.get(childPath).key;\n                        const info = new CustomStorageNodeInfo({\n                            path: childPath,\n                            type: node.type,\n                            key: isArray ? null : key,\n                            index: isArray ? key : null,\n                            address: new NodeAddress(childPath),\n                            exists: true,\n                            value: null,\n                            revision: node.revision,\n                            revision_nr: node.revision_nr,\n                            created: new Date(node.created),\n                            modified: new Date(node.modified),\n                        });\n                        canceled = callback(info) === false;\n                        return !canceled;\n                    };\n                    await transaction.childrenOf(path, { metadata: true, value: false }, includeChildCheck, addChildNode);\n                })();\n                if (!options.transaction) {\n                    // transaction was created by us, commit\n                    await transaction.commit();\n                }\n                return canceled;\n            }\n            catch (err) {\n                if (!options.transaction) {\n                    // transaction was created by us, rollback\n                    await transaction.rollback(err);\n                }\n                throw err;\n            }\n        }; // start()\n        return generator;\n    }\n    async getNode(path, options) {\n        // path = path.replace(/'/g, '');  // prevent sql injection, remove single quotes\n        options = options || {};\n        const transaction = options.transaction || await this._customImplementation.getTransaction({ path, write: false });\n        try {\n            const node = await (async () => {\n                // Get path, path/* and path[*\n                const filtered = (options.include && options.include.length > 0) || (options.exclude && options.exclude.length > 0) || options.child_objects === false;\n                const pathInfo = PathInfo.get(path);\n                const targetNode = await this._readNode(path, { transaction });\n                if (!targetNode) {\n                    // Lookup parent node\n                    if (path === '') {\n                        return { value: null };\n                    } // path is root. There is no parent.\n                    const lockPath = await transaction.moveToParentPath(pathInfo.parentPath);\n                    assert(lockPath === pathInfo.parentPath, `transaction.moveToParentPath() did not move to the right parent path of \"${path}\"`);\n                    const parentNode = await this._readNode(pathInfo.parentPath, { transaction });\n                    if (parentNode && [VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(parentNode.type) && pathInfo.key in parentNode.value) {\n                        const childValueInfo = this._getTypeFromStoredValue(parentNode.value[pathInfo.key]);\n                        return {\n                            revision: parentNode.revision,\n                            revision_nr: parentNode.revision_nr,\n                            created: parentNode.created,\n                            modified: parentNode.modified,\n                            type: childValueInfo.type,\n                            value: childValueInfo.value,\n                        };\n                    }\n                    return { value: null };\n                }\n                const isArray = targetNode.type === VALUE_TYPES.ARRAY;\n                /**\n                 * Convert include & exclude filters to PathInfo instances for easier handling\n                 */\n                const convertFilterArray = (arr) => {\n                    const isNumber = (key) => /^[0-9]+$/.test(key);\n                    return arr.map(path => PathInfo.get(isArray && isNumber(path) ? `[${path}]` : path));\n                };\n                const includeFilter = options.include ? convertFilterArray(options.include) : [];\n                const excludeFilter = options.exclude ? convertFilterArray(options.exclude) : [];\n                /**\n                 * Apply include filters to prevent unwanted properties stored inline to be added.\n                 *\n                 * Removes properties that are not on the trail of any include filter, but were loaded because they are\n                 * stored inline in the parent node.\n                 *\n                 * Example:\n                 * data of `\"users/someuser/posts/post1\"`: `{ title: 'My first post', posted: (date), history: {} }`\n                 * code: `db.ref('users/someuser').get({ include: ['posts/*\\/title'] })`\n                 * descPath: `\"users/someuser/posts/post1\"`,\n                 * trailKeys: `[\"posts\", \"post1\"]`,\n                 * includeFilter[0]: `[\"posts\", \"*\", \"title\"]`\n                 * properties `posted` and `history` must be removed from the object\n                 */\n                const applyFiltersOnInlineData = (descPath, node) => {\n                    if ([VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(node.type) && includeFilter.length > 0) {\n                        const trailKeys = PathInfo.getPathKeys(descPath).slice(pathInfo.keys.length);\n                        const checkPathInfo = new PathInfo(trailKeys);\n                        const remove = [];\n                        const includes = includeFilter.filter(info => info.isDescendantOf(checkPathInfo));\n                        if (includes.length > 0) {\n                            const isArray = node.type === VALUE_TYPES.ARRAY;\n                            remove.push(...Object.keys(node.value).map(key => isArray ? +key : key)); // Mark all at first\n                            for (const info of includes) {\n                                const targetProp = info.keys[trailKeys.length];\n                                if (typeof targetProp === 'string' && (targetProp === '*' || targetProp.startsWith('$'))) {\n                                    remove.splice(0);\n                                    break;\n                                }\n                                const index = remove.indexOf(targetProp);\n                                index >= 0 && remove.splice(index, 1);\n                            }\n                        }\n                        const hasIncludeOnChild = includeFilter.some(info => info.isChildOf(checkPathInfo));\n                        const hasExcludeOnChild = excludeFilter.some(info => info.isChildOf(checkPathInfo));\n                        if (hasExcludeOnChild && !hasIncludeOnChild) {\n                            // do not remove children that are NOT in direct exclude filters (which includes them again)\n                            const excludes = excludeFilter.filter(info => info.isChildOf(checkPathInfo));\n                            for (let i = 0; i < remove.length; i++) {\n                                if (!excludes.find(info => info.equals(remove[i]))) {\n                                    remove.splice(i, 1);\n                                    i--;\n                                }\n                            }\n                        }\n                        // remove.length > 0 && this.debug.log(`Remove properties:`, remove);\n                        for (const key of remove) {\n                            delete node.value[key];\n                        }\n                    }\n                };\n                applyFiltersOnInlineData(path, targetNode);\n                let checkExecuted = false;\n                const includeDescendantCheck = (descPath, metadata) => {\n                    checkExecuted = true;\n                    if (!transaction.production && !pathInfo.isAncestorOf(descPath)) {\n                        // Double check failed\n                        this.throwImplementationError(`\"${descPath}\" is not a descendant of \"${path}\" - descendantsOf must only check and return paths that are descendants`);\n                    }\n                    if (!filtered) {\n                        return true;\n                    }\n                    // Apply include & exclude filters\n                    const descPathKeys = PathInfo.getPathKeys(descPath);\n                    const trailKeys = descPathKeys.slice(pathInfo.keys.length);\n                    const checkPathInfo = new PathInfo(trailKeys);\n                    let include = (includeFilter.length > 0\n                        ? includeFilter.some(info => checkPathInfo.isOnTrailOf(info))\n                        : true)\n                        && (excludeFilter.length > 0\n                            ? !excludeFilter.some(info => info.equals(checkPathInfo) || info.isAncestorOf(checkPathInfo))\n                            : true);\n                    // Apply child_objects filter. If metadata is not loaded, we can only skip deeper descendants here - any child object that does get through will be ignored by addDescendant\n                    if (include\n                        && options.child_objects === false\n                        && (pathInfo.isParentOf(descPath) && [VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(metadata ? metadata.type : -1)\n                            || PathInfo.getPathKeys(descPath).length > pathInfo.pathKeys.length + 1)) {\n                        include = false;\n                    }\n                    return include;\n                };\n                const descRows = [];\n                const addDescendant = (descPath, node) => {\n                    // console.warn(`Adding descendant \"${descPath}\"`);\n                    if (!checkExecuted) {\n                        this.throwImplementationError('descendantsOf did not call checkCallback before addCallback');\n                    }\n                    if (options.child_objects === false && [VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(node.type)) {\n                        // child objects are filtered out, but this one got through because includeDescendantCheck did not have access to its metadata,\n                        // which is ok because doing that might drastically improve performance in client code. Skip it now.\n                        return true;\n                    }\n                    // Apply include filters to prevent unwanted properties stored inline to be added\n                    applyFiltersOnInlineData(descPath, node);\n                    // Process the value\n                    this._processReadNodeValue(node);\n                    // Add node\n                    const row = node;\n                    row.path = descPath;\n                    descRows.push(row);\n                    return true; // Keep streaming\n                };\n                await transaction.descendantsOf(path, { metadata: true, value: true }, includeDescendantCheck, addDescendant);\n                this.debug.log(`Read node \"/${path}\" and ${filtered ? '(filtered) ' : ''}descendants from ${descRows.length + 1} records`.colorize(ColorStyle.magenta));\n                const result = targetNode;\n                const objectToArray = (obj) => {\n                    // Convert object value to array\n                    const arr = [];\n                    Object.keys(obj).forEach(key => {\n                        const index = parseInt(key);\n                        arr[index] = obj[index];\n                    });\n                    return arr;\n                };\n                if (targetNode.type === VALUE_TYPES.ARRAY) {\n                    result.value = objectToArray(result.value);\n                }\n                if (targetNode.type === VALUE_TYPES.OBJECT || targetNode.type === VALUE_TYPES.ARRAY) {\n                    // target node is an object or array\n                    // merge with other found (child) nodes\n                    const targetPathKeys = PathInfo.getPathKeys(path);\n                    const value = targetNode.value;\n                    for (let i = 0; i < descRows.length; i++) {\n                        const otherNode = descRows[i];\n                        const pathKeys = PathInfo.getPathKeys(otherNode.path);\n                        const trailKeys = pathKeys.slice(targetPathKeys.length);\n                        let parent = value;\n                        for (let j = 0; j < trailKeys.length; j++) {\n                            assert(typeof parent === 'object', 'parent must be an object/array to have children!!');\n                            const key = trailKeys[j];\n                            const isLast = j === trailKeys.length - 1;\n                            const nodeType = isLast\n                                ? otherNode.type\n                                : typeof trailKeys[j + 1] === 'number'\n                                    ? VALUE_TYPES.ARRAY\n                                    : VALUE_TYPES.OBJECT;\n                            let nodeValue;\n                            if (!isLast) {\n                                nodeValue = nodeType === VALUE_TYPES.OBJECT ? {} : [];\n                            }\n                            else {\n                                nodeValue = otherNode.value;\n                                if (nodeType === VALUE_TYPES.ARRAY) {\n                                    nodeValue = objectToArray(nodeValue);\n                                }\n                            }\n                            if (key in parent) {\n                                // Merge with parent\n                                const mergePossible = typeof parent[key] === typeof nodeValue && [VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(nodeType);\n                                if (!mergePossible) {\n                                    // Ignore the value in the child record, see issue #20: \"Assertion failed: Merging child values can only be done if existing and current values are both an array or object\"\n                                    this.debug.error(`The value stored in node \"${otherNode.path}\" cannot be merged with the parent node, value will be ignored. This error should disappear once the target node value is updated. See issue #20 for more information`, { path, parent, key, nodeType, nodeValue });\n                                }\n                                else {\n                                    Object.keys(nodeValue).forEach(childKey => {\n                                        if (childKey in parent[key]) {\n                                            this.throwImplementationError(`Custom storage merge error: child key \"${childKey}\" is in parent value already! Make sure the get/childrenOf/descendantsOf methods of the custom storage class return values that can be modified by AceBase without affecting the stored source`);\n                                        }\n                                        parent[key][childKey] = nodeValue[childKey];\n                                    });\n                                }\n                            }\n                            else {\n                                parent[key] = nodeValue;\n                            }\n                            parent = parent[key];\n                        }\n                    }\n                }\n                else if (descRows.length > 0) {\n                    this.throwImplementationError(`multiple records found for non-object value!`);\n                }\n                // Post process filters to remove any data that got through because they were\n                // not stored in dedicated records. This will happen with smaller values because\n                // they are stored inline in their parent node.\n                // eg:\n                // { number: 1, small_string: 'small string', bool: true, obj: {}, arr: [] }\n                // All properties of this object are stored inline,\n                // if exclude: ['obj'], or child_objects: false was passed, these will still\n                // have to be removed from the value\n                if (options.child_objects === false) {\n                    Object.keys(result.value).forEach(key => {\n                        if (typeof result.value[key] === 'object' && result.value[key].constructor === Object) {\n                            // This can only happen if the object was empty\n                            assert(Object.keys(result.value[key]).length === 0);\n                            delete result.value[key];\n                        }\n                    });\n                }\n                if (options.include) {\n                    // TODO: remove any unselected children that did get through\n                }\n                if (options.exclude) {\n                    const process = (obj, keys) => {\n                        if (typeof obj !== 'object') {\n                            return;\n                        }\n                        const key = keys[0];\n                        if (key === '*') {\n                            Object.keys(obj).forEach(k => {\n                                process(obj[k], keys.slice(1));\n                            });\n                        }\n                        else if (keys.length > 1) {\n                            key in obj && process(obj[key], keys.slice(1));\n                        }\n                        else {\n                            delete obj[key];\n                        }\n                    };\n                    options.exclude.forEach(path => {\n                        const checkKeys = PathInfo.getPathKeys(path);\n                        process(result.value, checkKeys);\n                    });\n                }\n                return result;\n            })();\n            if (!options.transaction) {\n                // transaction was created by us, commit\n                await transaction.commit();\n            }\n            return node;\n        }\n        catch (err) {\n            if (!options.transaction) {\n                // transaction was created by us, rollback\n                await transaction.rollback(err);\n            }\n            throw err;\n        }\n    }\n    async getNodeInfo(path, options = {}) {\n        options = options || {};\n        const pathInfo = PathInfo.get(path);\n        const transaction = options.transaction || await this._customImplementation.getTransaction({ path, write: false });\n        try {\n            const node = await this._readNode(path, { transaction });\n            const info = new CustomStorageNodeInfo({\n                path,\n                key: typeof pathInfo.key === 'string' ? pathInfo.key : null,\n                index: typeof pathInfo.key === 'number' ? pathInfo.key : null,\n                type: node ? node.type : 0,\n                exists: node !== null,\n                address: node ? new NodeAddress(path) : null,\n                created: node ? new Date(node.created) : null,\n                modified: node ? new Date(node.modified) : null,\n                revision: node ? node.revision : null,\n                revision_nr: node ? node.revision_nr : null,\n            });\n            if (!node && path !== '') {\n                // Try parent node\n                const lockPath = await transaction.moveToParentPath(pathInfo.parentPath);\n                assert(lockPath === pathInfo.parentPath, `transaction.moveToParentPath() did not move to the right parent path of \"${path}\"`);\n                const parent = await this._readNode(pathInfo.parentPath, { transaction });\n                if (parent && [VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(parent.type) && pathInfo.key in parent.value) {\n                    // Stored in parent node\n                    info.exists = true;\n                    info.value = parent.value[pathInfo.key];\n                    info.address = null;\n                    info.type = parent.type;\n                    info.created = new Date(parent.created);\n                    info.modified = new Date(parent.modified);\n                    info.revision = parent.revision;\n                    info.revision_nr = parent.revision_nr;\n                }\n                else {\n                    // Parent doesn't exist, so the node we're looking for cannot exist either\n                    info.address = null;\n                }\n            }\n            if (options.include_child_count) {\n                info.childCount = 0;\n                if ([VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(info.valueType) && info.address) {\n                    // Get number of children\n                    info.childCount = node.value ? Object.keys(node.value).length : 0;\n                    info.childCount += await transaction.getChildCount(path);\n                }\n            }\n            if (!options.transaction) {\n                // transaction was created by us, commit\n                await transaction.commit();\n            }\n            return info;\n        }\n        catch (err) {\n            if (!options.transaction) {\n                // transaction was created by us, rollback\n                await transaction.rollback(err);\n            }\n            throw err;\n        }\n    }\n    // TODO: Move to Storage base class?\n    async setNode(path, value, options = { suppress_events: false, context: null }) {\n        if (this.settings.readOnly) {\n            throw new Error(`Database is opened in read-only mode`);\n        }\n        const pathInfo = PathInfo.get(path);\n        const transaction = options.transaction || await this._customImplementation.getTransaction({ path, write: true });\n        try {\n            if (path === '') {\n                if (value === null || typeof value !== 'object' || value instanceof Array || value instanceof ArrayBuffer || ('buffer' in value && value.buffer instanceof ArrayBuffer)) {\n                    throw new Error(`Invalid value for root node: ${value}`);\n                }\n                await this._writeNodeWithTracking('', value, { merge: false, transaction, suppress_events: options.suppress_events, context: options.context });\n            }\n            else if (typeof options.assert_revision !== 'undefined') {\n                const info = await this.getNodeInfo(path, { transaction });\n                if (info.revision !== options.assert_revision) {\n                    throw new NodeRevisionError(`revision '${info.revision}' does not match requested revision '${options.assert_revision}'`);\n                }\n                if (info.address && info.address.path === path && value !== null && !this.valueFitsInline(value)) {\n                    // Overwrite node\n                    await this._writeNodeWithTracking(path, value, { merge: false, transaction, suppress_events: options.suppress_events, context: options.context });\n                }\n                else {\n                    // Update parent node\n                    const lockPath = await transaction.moveToParentPath(pathInfo.parentPath);\n                    assert(lockPath === pathInfo.parentPath, `transaction.moveToParentPath() did not move to the right parent path of \"${path}\"`);\n                    await this._writeNodeWithTracking(pathInfo.parentPath, { [pathInfo.key]: value }, { merge: true, transaction, suppress_events: options.suppress_events, context: options.context });\n                }\n            }\n            else {\n                // Delegate operation to update on parent node\n                const lockPath = await transaction.moveToParentPath(pathInfo.parentPath);\n                assert(lockPath === pathInfo.parentPath, `transaction.moveToParentPath() did not move to the right parent path of \"${path}\"`);\n                await this.updateNode(pathInfo.parentPath, { [pathInfo.key]: value }, { transaction, suppress_events: options.suppress_events, context: options.context });\n            }\n            if (!options.transaction) {\n                // transaction was created by us, commit\n                await transaction.commit();\n            }\n        }\n        catch (err) {\n            if (!options.transaction) {\n                // transaction was created by us, rollback\n                await transaction.rollback(err);\n            }\n            throw err;\n        }\n    }\n    // TODO: Move to Storage base class?\n    async updateNode(path, updates, options = { suppress_events: false, context: null }) {\n        if (this.settings.readOnly) {\n            throw new Error(`Database is opened in read-only mode`);\n        }\n        if (typeof updates !== 'object') {\n            throw new Error(`invalid updates argument`); //. Must be a non-empty object or array\n        }\n        else if (Object.keys(updates).length === 0) {\n            return; // Nothing to update. Done!\n        }\n        const transaction = options.transaction || await this._customImplementation.getTransaction({ path, write: true });\n        try {\n            // Get info about current node\n            const nodeInfo = await this.getNodeInfo(path, { transaction });\n            const pathInfo = PathInfo.get(path);\n            if (nodeInfo.exists && nodeInfo.address && nodeInfo.address.path === path) {\n                // Node exists and is stored in its own record.\n                // Update it\n                await this._writeNodeWithTracking(path, updates, { transaction, merge: true, suppress_events: options.suppress_events, context: options.context });\n            }\n            else if (nodeInfo.exists) {\n                // Node exists, but is stored in its parent node.\n                const pathInfo = PathInfo.get(path);\n                const lockPath = await transaction.moveToParentPath(pathInfo.parentPath);\n                assert(lockPath === pathInfo.parentPath, `transaction.moveToParentPath() did not move to the right parent path of \"${path}\"`);\n                await this._writeNodeWithTracking(pathInfo.parentPath, { [pathInfo.key]: updates }, { transaction, merge: true, suppress_events: options.suppress_events, context: options.context });\n            }\n            else {\n                // The node does not exist, it's parent doesn't have it either. Update the parent instead\n                const lockPath = await transaction.moveToParentPath(pathInfo.parentPath);\n                assert(lockPath === pathInfo.parentPath, `transaction.moveToParentPath() did not move to the right parent path of \"${path}\"`);\n                await this.updateNode(pathInfo.parentPath, { [pathInfo.key]: updates }, { transaction, suppress_events: options.suppress_events, context: options.context });\n            }\n            if (!options.transaction) {\n                // transaction was created by us, commit\n                await transaction.commit();\n            }\n        }\n        catch (err) {\n            if (!options.transaction) {\n                // transaction was created by us, rollback\n                await transaction.rollback(err);\n            }\n            throw err;\n        }\n    }\n}\n//# sourceMappingURL=index.js.map","export class AsyncTaskBatch {\n    /**\n     * Creates a new batch: runs a maximum amount of async tasks simultaniously and waits until they are all resolved.\n     * If all tasks succeed, returns the results in the same order tasks were added (like `Promise.all` would do), but\n     * cancels any waiting tasks upon failure of one task. Note that the execution order of tasks added after the set\n     * limit is unknown.\n     * @param limit Max amount of async functions to execute simultaniously. Default is `1000`\n     * @param options Additional options\n     */\n    constructor(limit = 1000, options) {\n        this.limit = limit;\n        this.options = options;\n        this.added = 0;\n        this.scheduled = [];\n        this.running = 0;\n        this.results = [];\n        this.done = false;\n    }\n    async execute(task, index) {\n        try {\n            this.running++;\n            const result = await task();\n            this.results[index] = result;\n            this.running--;\n            if (this.running === 0 && this.scheduled.length === 0) {\n                // Finished\n                this.done = true;\n                this.doneCallback?.(this.results);\n            }\n            else if (this.scheduled.length > 0) {\n                // Run next scheduled task\n                const next = this.scheduled.shift();\n                this.execute(next.task, next.index);\n            }\n        }\n        catch (err) {\n            this.done = true;\n            this.errorCallback?.(err);\n        }\n    }\n    add(task) {\n        if (this.done) {\n            throw new Error(`Cannot add to a batch that has already finished. Use wait option and start batch processing manually if you are adding tasks in an async loop`);\n        }\n        const index = this.added++;\n        if (this.options?.wait !== true && this.running < this.limit) {\n            this.execute(task, index);\n        }\n        else {\n            this.scheduled.push({ task, index });\n        }\n    }\n    /**\n     * Manually starts batch processing, mus be done if the `wait` option was used\n     */\n    start() {\n        while (this.running < this.limit) {\n            const next = this.scheduled.shift();\n            this.execute(next.task, next.index);\n        }\n    }\n    async finish() {\n        if (this.running === 0 && this.scheduled.length === 0) {\n            return this.results;\n        }\n        await new Promise((resolve, reject) => {\n            this.doneCallback = resolve;\n            this.errorCallback = reject;\n        });\n        return this.results;\n    }\n}\n//# sourceMappingURL=async-task-batch.js.map","import { ID, PathInfo } from 'acebase-core';\nimport { VALUE_TYPES } from './node-value-types.js';\nimport { NodeNotFoundError } from './node-errors.js';\nimport { DataIndex, FullTextIndex } from './data-index/index.js';\nimport { AsyncTaskBatch } from './async-task-batch.js';\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst noop = () => { };\n/**\n *\n * @param storage Target storage instance\n * @param path Path of the object collection to perform query on\n * @param query Query to execute\n * @param options Additional options\n * @returns Returns a promise that resolves with matching data or paths in `results`\n */\nexport async function executeQuery(api, path, query, options = { snapshots: false, include: undefined, exclude: undefined, child_objects: undefined, eventHandler: noop }) {\n    // TODO: Refactor to async\n    if (typeof options !== 'object') {\n        options = {};\n    }\n    if (typeof options.snapshots === 'undefined') {\n        options.snapshots = false;\n    }\n    const context = {};\n    if (api.storage.settings.transactions?.log) {\n        context.acebase_cursor = ID.generate();\n    }\n    const queryFilters = query.filters.map(f => ({ ...f }));\n    const querySort = query.order.map(s => ({ ...s }));\n    const sortMatches = (matches) => {\n        matches.sort((a, b) => {\n            const compare = (i) => {\n                const o = querySort[i];\n                const trailKeys = PathInfo.getPathKeys(typeof o.key === 'number' ? `[${o.key}]` : o.key);\n                const left = trailKeys.reduce((val, key) => val !== null && typeof val === 'object' && key in val ? val[key] : null, a.val);\n                const right = trailKeys.reduce((val, key) => val !== null && typeof val === 'object' && key in val ? val[key] : null, b.val);\n                if (left === null) {\n                    return right === null ? 0 : o.ascending ? -1 : 1;\n                }\n                if (right === null) {\n                    return o.ascending ? 1 : -1;\n                }\n                // TODO: add collation options using Intl.Collator. Note this also has to be implemented in the matching engines (inclusing indexes)\n                // See discussion https://github.com/appy-one/acebase/discussions/27\n                if (left == right) {\n                    if (i < querySort.length - 1) {\n                        return compare(i + 1);\n                    }\n                    else {\n                        return a.path < b.path ? -1 : 1;\n                    } // Sort by path if property values are equal\n                }\n                else if (left < right) {\n                    return o.ascending ? -1 : 1;\n                }\n                // else if (left > right) {\n                return o.ascending ? 1 : -1;\n                // }\n            };\n            return compare(0);\n        });\n    };\n    const loadResultsData = async (preResults, options) => {\n        // Limit the amount of concurrent getValue calls by batching them\n        if (preResults.length === 0) {\n            return [];\n        }\n        const maxBatchSize = 50;\n        const batch = new AsyncTaskBatch(maxBatchSize);\n        const results = [];\n        preResults.forEach(({ path }, index) => batch.add(async () => {\n            const node = await api.storage.getNode(path, options);\n            const val = node.value;\n            if (val === null) {\n                // Record was deleted, but index isn't updated yet?\n                api.storage.debug.warn(`Indexed result \"/${path}\" does not have a record!`);\n                // TODO: let index rebuild\n                return;\n            }\n            const result = { path, val };\n            if (stepsExecuted.sorted) {\n                // Put the result in the same index as the preResult was\n                results[index] = result;\n            }\n            else {\n                results.push(result);\n                if (!stepsExecuted.skipped && results.length > query.skip + Math.abs(query.take)) {\n                    // we can toss a value! sort, toss last one\n                    sortMatches(results);\n                    results.pop(); // Always toss last value, results have been sorted already\n                }\n            }\n        }));\n        await batch.finish();\n        return results;\n    };\n    const pathInfo = PathInfo.get(path);\n    const isWildcardPath = pathInfo.keys.some(key => key === '*' || key.toString().startsWith('$')); // path.includes('*');\n    const availableIndexes = api.storage.indexes.get(path);\n    const usingIndexes = [];\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    let stop = async () => { };\n    if (isWildcardPath) {\n        // Check if path contains $vars with explicit filter values. If so, execute multiple queries and merge results\n        const vars = pathInfo.keys.filter(key => typeof key === 'string' && key.startsWith('$'));\n        const hasExplicitFilterValues = vars.length > 0 && vars.every(v => query.filters.some(f => f.key === v && ['==', 'in'].includes(f.op)));\n        const isRealtime = typeof options.monitor === 'object' && [options.monitor?.add, options.monitor?.change, options.monitor?.remove].some(val => val === true);\n        if (hasExplicitFilterValues && !isRealtime) {\n            // create path combinations\n            const combinations = [];\n            for (const v of vars) {\n                const filters = query.filters.filter(f => f.key === v);\n                const filterValues = filters.reduce((values, f) => {\n                    if (f.op === '==') {\n                        values.push(f.compare);\n                    }\n                    if (f.op === 'in') {\n                        if (!(f.compare instanceof Array)) {\n                            throw new Error(`compare argument for 'in' operator must be an Array`);\n                        }\n                        values.push(...f.compare);\n                    }\n                    return values;\n                }, []);\n                // Expand all current combinations with these filter values\n                const prevCombinations = combinations.splice(0);\n                filterValues.forEach(fv => {\n                    if (prevCombinations.length === 0) {\n                        combinations.push({ [v]: fv });\n                    }\n                    else {\n                        combinations.push(...prevCombinations.map(c => ({ ...c, [v]: fv })));\n                    }\n                });\n            }\n            // create queries\n            const filters = query.filters.filter(f => !vars.includes(f.key));\n            const paths = combinations.map(vars => PathInfo.get(PathInfo.getPathKeys(path).map(key => vars[key] ?? key)).path);\n            const loadData = query.order.length > 0;\n            const promises = paths.map(path => executeQuery(api, path, { filters, take: 0, skip: 0, order: [] }, {\n                snapshots: loadData,\n                cache_mode: options.cache_mode,\n                include: [...(options.include ?? []), ...query.order.map(o => o.key)],\n                exclude: options.exclude,\n            }));\n            const resultSets = await Promise.all(promises);\n            let results = resultSets.reduce((results, set) => (results.push(...set.results), results), []);\n            if (loadData) {\n                sortMatches(results);\n            }\n            if (query.skip > 0) {\n                results.splice(0, query.skip);\n            }\n            if (query.take > 0) {\n                results.splice(query.take);\n            }\n            if (options.snapshots && (!loadData || options.include?.length > 0 || options.exclude?.length > 0 || !options.child_objects)) {\n                const { include, exclude, child_objects } = options;\n                results = await loadResultsData(results, { include, exclude, child_objects });\n            }\n            return { results, context: null, stop };\n            // const results = options.snapshots ? results\n        }\n        else if (availableIndexes.length === 0) {\n            // Wildcard paths require data to be indexed\n            const err = new Error(`Query on wildcard path \"/${path}\" requires an index`);\n            return Promise.reject(err);\n        }\n        if (queryFilters.length === 0) {\n            // Filterless query on wildcard path. Use first available index with filter on non-null key value (all results)\n            const index = availableIndexes.filter((index) => index.type === 'normal')[0];\n            queryFilters.push({ key: index.key, op: '!=', compare: null });\n        }\n    }\n    // Check if there are path specific indexes\n    // eg: index on \"users/$uid/posts\", key \"$uid\", including \"title\" (or key \"title\", including \"$uid\")\n    // Which are very useful for queries on \"users/98sdfkb37/posts\" with filter or sort on \"title\"\n    // const indexesOnPath = availableIndexes\n    //     .map(index => {\n    //         if (!index.path.includes('$')) { return null; }\n    //         const pattern = '^' + index.path.replace(/(\\$[a-z0-9_]+)/gi, (match, name) => `(?<${name}>[a-z0-9_]+|\\\\*)`) + '$';\n    //         const re = new RegExp(pattern, 'i');\n    //         const match = path.match(re);\n    //         const canBeUsed = index.key[0] === '$'\n    //             ? match.groups[index.key] !== '*' // Index key value MUST be present in the path\n    //             : null !== ourFilters.find(filter => filter.key === index.key); // Index key MUST be in a filter\n    //         if (!canBeUsed) { return null; }\n    //         return {\n    //             index,\n    //             wildcards: match.groups, // eg: { \"$uid\": \"98sdfkb37\" }\n    //             filters: Object.keys(match.groups).filter(name => match.groups[name] !== '*').length\n    //         }\n    //     })\n    //     .filter(info => info !== null)\n    //     .sort((a, b) => {\n    //         a.filters > b.filters ? -1 : 1\n    //     });\n    // TODO:\n    // if (ourFilters.length === 0 && indexesOnPath.length > 0) {\n    //     ourFilters = ourFilters.concat({ key: })\n    //     usingIndexes.push({ index: filter.index, description: filter.index.description});\n    // }\n    queryFilters.forEach(filter => {\n        if (filter.index) {\n            // Index has been assigned already\n            return;\n        }\n        // // Check if there are path indexes we can use\n        // const pathIndexesWithKey = DataIndex.validOperators.includes(filter.op)\n        //     ? indexesOnPath.filter(info => info.index.key === filter.key || info.index.includeKeys.includes(filter.key))\n        //     : [];\n        // Check if there are indexes on this filter key\n        const indexesOnKey = availableIndexes\n            .filter(index => index.key === filter.key)\n            .filter(index => {\n            return index.validOperators.includes(filter.op);\n        });\n        if (indexesOnKey.length >= 1) {\n            // If there are multiple indexes on 1 key (happens when index includes other keys),\n            // we should check other .filters and .order to determine the best one to use\n            // TODO: Create a good strategy here...\n            const otherFilterKeys = queryFilters.filter(f => f !== filter).map(f => f.key);\n            const sortKeys = querySort.map(o => o.key).filter(key => key !== filter.key);\n            const beneficialIndexes = indexesOnKey.map(index => {\n                const availableKeys = index.includeKeys.concat(index.key);\n                const forOtherFilters = availableKeys.filter(key => otherFilterKeys.includes(key));\n                const forSorting = availableKeys.filter(key => sortKeys.includes(key));\n                const forBoth = forOtherFilters.concat(forSorting.filter(index => !forOtherFilters.includes(index)));\n                const points = {\n                    filters: forOtherFilters.length,\n                    sorting: forSorting.length * (query.take !== 0 ? forSorting.length : 1),\n                    both: forBoth.length * forBoth.length,\n                    get total() {\n                        return this.filters + this.sorting + this.both;\n                    },\n                };\n                return { index, points: points.total, filterKeys: forOtherFilters, sortKeys: forSorting };\n            });\n            // Use index with the most points\n            beneficialIndexes.sort((a, b) => a.points > b.points ? -1 : 1);\n            const bestBenificialIndex = beneficialIndexes[0];\n            // Assign to this filter\n            filter.index = bestBenificialIndex.index;\n            // Assign to other filters and sorts\n            bestBenificialIndex.filterKeys.forEach(key => {\n                queryFilters.filter(f => f !== filter && f.key === key).forEach(f => {\n                    if (!DataIndex.validOperators.includes(f.op)) {\n                        // The used operator for this filter is invalid for use on metadata\n                        // Probably because it is an Array/Fulltext/Geo query operator\n                        return;\n                    }\n                    f.indexUsage = 'filter';\n                    f.index = bestBenificialIndex.index;\n                });\n            });\n            bestBenificialIndex.sortKeys.forEach(key => {\n                querySort.filter(s => s.key === key).forEach(s => {\n                    s.index = bestBenificialIndex.index;\n                });\n            });\n        }\n        if (filter.index) {\n            usingIndexes.push({ index: filter.index, description: filter.index.description });\n        }\n    });\n    if (querySort.length > 0 && query.take !== 0 && queryFilters.length === 0) {\n        // Check if we can use assign an index to sorts in a filterless take & sort query\n        querySort.forEach(sort => {\n            if (sort.index) {\n                // Index has been assigned already\n                return;\n            }\n            sort.index = availableIndexes\n                .filter(index => index.key === sort.key)\n                .find(index => index.type === 'normal');\n            // if (sort.index) {\n            //     usingIndexes.push({ index: sort.index, description: `${sort.index.description} (for sorting)`});\n            // }\n        });\n    }\n    // const usingIndexes = ourFilters.map(filter => filter.index).filter(index => index);\n    const indexDescriptions = usingIndexes.map(index => index.description).join(', ');\n    usingIndexes.length > 0 && api.storage.debug.log(`Using indexes for query: ${indexDescriptions}`);\n    // Filters that should run on all nodes after indexed results:\n    const tableScanFilters = queryFilters.filter(filter => !filter.index);\n    // Check if there are filters that require an index to run (such as \"fulltext:contains\", and \"geo:nearby\" etc)\n    const specialOpsRegex = /^[a-z]+:/i;\n    if (tableScanFilters.some(filter => specialOpsRegex.test(filter.op))) {\n        const f = tableScanFilters.find(filter => specialOpsRegex.test(filter.op));\n        const err = new Error(`query contains operator \"${f.op}\" which requires a special index that was not found on path \"${path}\", key \"${f.key}\"`);\n        return Promise.reject(err);\n    }\n    // Check if the filters are using valid operators\n    const allowedTableScanOperators = ['<', '<=', '==', '!=', '>=', '>', 'like', '!like', 'in', '!in', 'matches', '!matches', 'between', '!between', 'has', '!has', 'contains', '!contains', 'exists', '!exists']; // DISABLED \"custom\" because it is not fully implemented and only works locally\n    for (let i = 0; i < tableScanFilters.length; i++) {\n        const f = tableScanFilters[i];\n        if (!allowedTableScanOperators.includes(f.op)) {\n            return Promise.reject(new Error(`query contains unknown filter operator \"${f.op}\" on path \"${path}\", key \"${f.key}\"`));\n        }\n    }\n    // Check if the available indexes are sufficient for this wildcard query\n    if (isWildcardPath && tableScanFilters.length > 0) {\n        // There are unprocessed filters, which means the fields aren't indexed.\n        // We're not going to get all data of a wildcard path to query manually.\n        // Indexes must be created\n        const keys = tableScanFilters.reduce((keys, f) => {\n            if (keys.indexOf(f.key) < 0) {\n                keys.push(f.key);\n            }\n            return keys;\n        }, []).map(key => `\"${key}\"`);\n        const err = new Error(`This wildcard path query on \"/${path}\" requires index(es) on key(s): ${keys.join(', ')}. Create the index(es) and retry`);\n        return Promise.reject(err);\n    }\n    // Run queries on available indexes\n    const indexScanPromises = [];\n    queryFilters.forEach(filter => {\n        if (filter.index && filter.indexUsage !== 'filter') {\n            let promise = filter.index.query(filter.op, filter.compare)\n                .then(results => {\n                options.eventHandler && options.eventHandler({ name: 'stats', type: 'index_query', source: filter.index.description, stats: results.stats });\n                if (results.hints.length > 0) {\n                    options.eventHandler && options.eventHandler({ name: 'hints', type: 'index_query', source: filter.index.description, hints: results.hints });\n                }\n                return results;\n            });\n            // Get other filters that can be executed on these indexed results (eg filters on included keys of the index)\n            const resultFilters = queryFilters.filter(f => f.index === filter.index && f.indexUsage === 'filter');\n            if (resultFilters.length > 0) {\n                // Hook into the promise\n                promise = promise.then(results => {\n                    resultFilters.forEach(filter => {\n                        const { key, op, index } = filter;\n                        let { compare } = filter;\n                        if (typeof compare === 'string' && !index.caseSensitive) {\n                            compare = compare.toLocaleLowerCase(index.textLocale);\n                        }\n                        results = results.filterMetadata(key, op, compare);\n                    });\n                    return results;\n                });\n            }\n            indexScanPromises.push(promise);\n        }\n    });\n    const stepsExecuted = {\n        filtered: queryFilters.length === 0,\n        skipped: query.skip === 0,\n        taken: query.take === 0,\n        sorted: querySort.length === 0,\n        preDataLoaded: false,\n        dataLoaded: false,\n    };\n    if (queryFilters.length === 0 && query.take === 0) {\n        api.storage.debug.warn(`Filterless queries must use .take to limit the results. Defaulting to 100 for query on path \"${path}\"`);\n        query.take = 100;\n    }\n    if (querySort.length > 0 && querySort[0].index) {\n        const sortIndex = querySort[0].index;\n        const ascending = query.take < 0 ? !querySort[0].ascending : querySort[0].ascending;\n        if (queryFilters.length === 0 && querySort.slice(1).every(s => sortIndex.allMetadataKeys.includes(s.key))) {\n            api.storage.debug.log(`Using index for sorting: ${sortIndex.description}`);\n            const metadataSort = querySort.slice(1).map(s => {\n                s.index = sortIndex; // Assign index to skip later processing of this sort operation\n                return { key: s.key, ascending: s.ascending };\n            });\n            const promise = sortIndex.take(query.skip, Math.abs(query.take), { ascending, metadataSort })\n                .then(results => {\n                options.eventHandler && options.eventHandler({ name: 'stats', type: 'sort_index_take', source: sortIndex.description, stats: results.stats });\n                if (results.hints.length > 0) {\n                    options.eventHandler && options.eventHandler({ name: 'hints', type: 'sort_index_take', source: sortIndex.description, hints: results.hints });\n                }\n                return results;\n            });\n            indexScanPromises.push(promise);\n            stepsExecuted.skipped = true;\n            stepsExecuted.taken = true;\n            stepsExecuted.sorted = true;\n        }\n        // else if (queryFilters.every(f => [sortIndex.key, ...sortIndex.includeKeys].includes(f.key))) {\n        //  TODO: If an index can be used for sorting, and all filter keys are included in its metadata: query the index!\n        //  Implement:\n        //  sortIndex.query(ourFilters);\n        //  etc\n        // }\n    }\n    return Promise.all(indexScanPromises)\n        .then(async (indexResultSets) => {\n        // Merge all results in indexResultSets, get distinct nodes\n        let indexedResults = [];\n        if (indexResultSets.length === 1) {\n            const resultSet = indexResultSets[0];\n            indexedResults = resultSet.map(match => {\n                const result = { key: match.key, path: match.path, val: { [resultSet.filterKey]: match.value } };\n                match.metadata && Object.assign(result.val, match.metadata);\n                return result;\n            });\n            stepsExecuted.filtered = true;\n        }\n        else if (indexResultSets.length > 1) {\n            indexResultSets.sort((a, b) => a.length < b.length ? -1 : 1); // Sort results, shortest result set first\n            const shortestSet = indexResultSets[0];\n            const otherSets = indexResultSets.slice(1);\n            indexedResults = shortestSet.reduce((results, match) => {\n                // Check if the key is present in the other result sets\n                const result = { key: match.key, path: match.path, val: { [shortestSet.filterKey]: match.value } };\n                const matchedInAllSets = otherSets.every(set => set.findIndex(m => m.path === match.path) >= 0);\n                if (matchedInAllSets) {\n                    match.metadata && Object.assign(result.val, match.metadata);\n                    otherSets.forEach(set => {\n                        const otherResult = set.find(r => r.path === result.path);\n                        result.val[set.filterKey] = otherResult.value;\n                        otherResult.metadata && Object.assign(result.val, otherResult.metadata);\n                    });\n                    results.push(result);\n                }\n                return results;\n            }, []);\n            stepsExecuted.filtered = true;\n        }\n        if (isWildcardPath || (indexScanPromises.length > 0 && tableScanFilters.length === 0)) {\n            if (querySort.length === 0 || querySort.every(o => o.index)) {\n                // No sorting, or all sorts are on indexed keys. We can use current index results\n                stepsExecuted.preDataLoaded = true;\n                if (!stepsExecuted.sorted && querySort.length > 0) {\n                    sortMatches(indexedResults);\n                }\n                stepsExecuted.sorted = true;\n                if (!stepsExecuted.skipped && query.skip > 0) {\n                    indexedResults = query.take < 0\n                        ? indexedResults.slice(0, -query.skip)\n                        : indexedResults.slice(query.skip);\n                }\n                if (!stepsExecuted.taken && query.take !== 0) {\n                    indexedResults = query.take < 0\n                        ? indexedResults.slice(query.take)\n                        : indexedResults.slice(0, query.take);\n                }\n                stepsExecuted.skipped = true;\n                stepsExecuted.taken = true;\n                if (!options.snapshots) {\n                    return indexedResults;\n                }\n                // TODO: exclude already known key values, merge loaded with known\n                const childOptions = { include: options.include, exclude: options.exclude, child_objects: options.child_objects };\n                return loadResultsData(indexedResults, childOptions)\n                    .then(results => {\n                    stepsExecuted.dataLoaded = true;\n                    return results;\n                });\n            }\n            if (options.snapshots || !stepsExecuted.sorted) {\n                const loadPartialResults = querySort.length > 0;\n                const childOptions = loadPartialResults\n                    ? { include: querySort.map(order => order.key) }\n                    : { include: options.include, exclude: options.exclude, child_objects: options.child_objects };\n                return loadResultsData(indexedResults, childOptions)\n                    .then(results => {\n                    if (querySort.length > 0) {\n                        sortMatches(results);\n                    }\n                    stepsExecuted.sorted = true;\n                    if (query.skip > 0) {\n                        results = query.take < 0\n                            ? results.slice(0, -query.skip)\n                            : results.slice(query.skip);\n                    }\n                    if (query.take !== 0) {\n                        results = query.take < 0\n                            ? results.slice(query.take)\n                            : results.slice(0, query.take);\n                    }\n                    stepsExecuted.skipped = true;\n                    stepsExecuted.taken = true;\n                    if (options.snapshots && loadPartialResults) {\n                        // Get the rest\n                        return loadResultsData(results, { include: options.include, exclude: options.exclude, child_objects: options.child_objects });\n                    }\n                    return results;\n                });\n            }\n            else {\n                // No need to take further actions, return what we have now\n                return indexedResults;\n            }\n        }\n        // If we get here, this is a query on a regular path (no wildcards) with additional non-indexed filters left,\n        // we can get child records from a single parent. Merge index results by key\n        let indexKeyFilter;\n        if (indexedResults.length > 0) {\n            indexKeyFilter = indexedResults.map(result => result.key);\n        }\n        let matches = [];\n        let preliminaryStop = false;\n        const loadPartialData = querySort.length > 0;\n        const childOptions = loadPartialData\n            ? { include: querySort.map(order => order.key) }\n            : { include: options.include, exclude: options.exclude, child_objects: options.child_objects };\n        const batch = {\n            promises: [],\n            add(promise) {\n                this.promises.push(promise);\n                if (this.promises.length >= 1000) {\n                    return Promise.all(this.promises.splice(0)).then(_ => undefined);\n                }\n            },\n        };\n        try {\n            await api.storage.getChildren(path, { keyFilter: indexKeyFilter, async: true }).next(child => {\n                if (child.type !== VALUE_TYPES.OBJECT) {\n                    return;\n                }\n                if (!child.address) {\n                    // Currently only happens if object has no properties\n                    // ({}, stored as a tiny_value in parent record). In that case,\n                    // should it be matched in any query? -- That answer could be YES, when testing a property for !exists. Ignoring for now\n                    return;\n                }\n                if (preliminaryStop) {\n                    return false;\n                }\n                const matchNode = async () => {\n                    const isMatch = await api.storage.matchNode(child.address.path, tableScanFilters);\n                    if (!isMatch) {\n                        return;\n                    }\n                    const childPath = child.address.path;\n                    let result;\n                    if (options.snapshots || querySort.length > 0) {\n                        const node = await api.storage.getNode(childPath, childOptions);\n                        result = { path: childPath, val: node.value };\n                    }\n                    else {\n                        result = { path: childPath };\n                    }\n                    // If a maximumum number of results is requested, we can check if we can preliminary toss this result\n                    // This keeps the memory space used limited to skip + take\n                    // TODO: see if we can limit it to the max number of results returned (.take)\n                    matches.push(result);\n                    if (query.take !== 0 && matches.length > Math.abs(query.take) + query.skip) {\n                        if (querySort.length > 0) {\n                            // A query order has been set. If this value falls in between it can replace some other value\n                            // matched before.\n                            sortMatches(matches);\n                        }\n                        else if (query.take > 0) {\n                            // No query order set, we can stop after 'take' + 'skip' results\n                            preliminaryStop = true; // Flags the loop that no more nodes have to be checked\n                        }\n                        // const ascending = querySort.length === 0 || (query.take >= 0 ? querySort[0].ascending : !querySort[0].ascending);\n                        // if (ascending) {\n                        //     matches.pop(); // ascending sort order, toss last value\n                        // }\n                        // else {\n                        //     matches.shift(); // descending, toss first value\n                        // }\n                        matches.pop(); // Always toss last value, results have been sorted already\n                    }\n                };\n                const p = batch.add(matchNode());\n                if (p instanceof Promise) {\n                    // If this returns a promise, child iteration should pause automatically\n                    return p;\n                }\n            });\n        }\n        catch (reason) {\n            // No record?\n            if (!(reason instanceof NodeNotFoundError)) {\n                api.storage.debug.warn(`Error getting child stream: ${reason}`);\n            }\n            return [];\n        }\n        // Done iterating all children, wait for all match promises to resolve\n        await Promise.all(batch.promises);\n        stepsExecuted.preDataLoaded = loadPartialData;\n        stepsExecuted.dataLoaded = !loadPartialData;\n        if (querySort.length > 0) {\n            sortMatches(matches);\n        }\n        stepsExecuted.sorted = true;\n        if (query.skip > 0) {\n            matches = query.take < 0\n                ? matches.slice(0, -query.skip)\n                : matches.slice(query.skip);\n        }\n        stepsExecuted.skipped = true;\n        if (query.take !== 0) {\n            // (should not be necessary, basically it has already been done in the loop?)\n            matches = query.take < 0\n                ? matches.slice(query.take)\n                : matches.slice(0, query.take);\n        }\n        stepsExecuted.taken = true;\n        if (!stepsExecuted.dataLoaded) {\n            matches = await loadResultsData(matches, { include: options.include, exclude: options.exclude, child_objects: options.child_objects });\n            stepsExecuted.dataLoaded = true;\n        }\n        return matches;\n    })\n        .then(matches => {\n        // Order the results\n        if (!stepsExecuted.sorted && querySort.length > 0) {\n            sortMatches(matches);\n        }\n        if (!options.snapshots) {\n            // Remove the loaded values from the results, because they were not requested (and aren't complete, we only have data of the sorted keys)\n            matches = matches.map(match => match.path);\n        }\n        // Limit result set\n        if (!stepsExecuted.skipped && query.skip > 0) {\n            matches = query.take < 0\n                ? matches.slice(0, -query.skip)\n                : matches.slice(query.skip);\n        }\n        if (!stepsExecuted.taken && query.take !== 0) {\n            matches = query.take < 0\n                ? matches.slice(query.take)\n                : matches.slice(0, query.take);\n        }\n        // NEW: Check if this is a realtime query - future updates must send query result updates\n        if (options.monitor === true) {\n            options.monitor = { add: true, change: true, remove: true };\n        }\n        if (typeof options.monitor === 'object' && (options.monitor.add || options.monitor.change || options.monitor.remove)) {\n            // TODO: Refactor this to use 'mutations' event instead of 'notify_child_*'\n            const monitor = options.monitor;\n            const matchedPaths = options.snapshots ? matches.map(match => match.path) : matches.slice();\n            const ref = api.db.ref(path);\n            const removeMatch = (path) => {\n                const index = matchedPaths.indexOf(path);\n                if (index < 0) {\n                    return;\n                }\n                matchedPaths.splice(index, 1);\n            };\n            const addMatch = (path) => {\n                if (matchedPaths.includes(path)) {\n                    return;\n                }\n                matchedPaths.push(path);\n            };\n            const stopMonitoring = () => {\n                api.unsubscribe(ref.path, 'child_changed', childChangedCallback);\n                api.unsubscribe(ref.path, 'child_added', childAddedCallback);\n                api.unsubscribe(ref.path, 'notify_child_removed', childRemovedCallback);\n            };\n            stop = async () => { stopMonitoring(); };\n            const childChangedCallback = async (err, path, newValue, oldValue) => {\n                const wasMatch = matchedPaths.includes(path);\n                let keepMonitoring = true;\n                // check if the properties we already have match filters,\n                // and if we have to check additional properties\n                const checkKeys = [];\n                queryFilters.forEach(f => !checkKeys.includes(f.key) && checkKeys.push(f.key));\n                const seenKeys = [];\n                typeof oldValue === 'object' && Object.keys(oldValue).forEach(key => !seenKeys.includes(key) && seenKeys.push(key));\n                typeof newValue === 'object' && Object.keys(newValue).forEach(key => !seenKeys.includes(key) && seenKeys.push(key));\n                const missingKeys = [];\n                let isMatch = seenKeys.every(key => {\n                    if (!checkKeys.includes(key)) {\n                        return true;\n                    }\n                    const filters = queryFilters.filter(filter => filter.key === key);\n                    return filters.every(filter => {\n                        if (filter.index?.textLocaleKey && !seenKeys.includes(filter.index.textLocaleKey)) {\n                            // Can't check because localeKey is missing\n                            missingKeys.push(filter.index.textLocaleKey);\n                            return true; // so we'll know if all others did match\n                        }\n                        else if (allowedTableScanOperators.includes(filter.op)) {\n                            return api.storage.test(newValue[key], filter.op, filter.compare);\n                        }\n                        else {\n                            // specific index filter\n                            return filter.index.test(newValue, filter.op, filter.compare);\n                        }\n                    });\n                });\n                if (isMatch) {\n                    // Matches all checked (updated) keys. BUT. Did we have all data needed?\n                    // If it was a match before, other properties don't matter because they didn't change and won't\n                    // change the current outcome\n                    missingKeys.push(...checkKeys.filter(key => !seenKeys.includes(key)));\n                    // let promise = Promise.resolve(true);\n                    if (!wasMatch && missingKeys.length > 0) {\n                        // We have to check if this node becomes a match\n                        const filterQueue = queryFilters.filter(f => missingKeys.includes(f.key));\n                        const simpleFilters = filterQueue.filter(f => allowedTableScanOperators.includes(f.op));\n                        const indexFilters = filterQueue.filter(f => !allowedTableScanOperators.includes(f.op));\n                        if (simpleFilters.length > 0) {\n                            isMatch = await api.storage.matchNode(path, simpleFilters);\n                        }\n                        if (isMatch && indexFilters.length > 0) {\n                            // TODO: ask index what keys to load (eg: FullTextIndex might need key specified by localeKey)\n                            const keysToLoad = indexFilters.reduce((keys, filter) => {\n                                if (!keys.includes(filter.key)) {\n                                    keys.push(filter.key);\n                                }\n                                if (filter.index instanceof FullTextIndex && filter.index.config.localeKey && !keys.includes(filter.index.config.localeKey)) {\n                                    keys.push(filter.index.config.localeKey);\n                                }\n                                return keys;\n                            }, []);\n                            const node = await api.storage.getNode(path, { include: keysToLoad });\n                            if (node.value === null) {\n                                return false;\n                            }\n                            isMatch = indexFilters.every(filter => filter.index.test(node.value, filter.op, filter.compare));\n                        }\n                    }\n                }\n                if (isMatch) {\n                    if (!wasMatch) {\n                        addMatch(path);\n                    }\n                    // load missing data if snapshots are requested\n                    if (options.snapshots) {\n                        const loadOptions = { include: options.include, exclude: options.exclude, child_objects: options.child_objects };\n                        const node = await api.storage.getNode(path, loadOptions);\n                        newValue = node.value;\n                    }\n                    if (wasMatch && monitor.change) {\n                        keepMonitoring = options.eventHandler({ name: 'change', path, value: newValue }) !== false;\n                    }\n                    else if (!wasMatch && monitor.add) {\n                        keepMonitoring = options.eventHandler({ name: 'add', path, value: newValue }) !== false;\n                    }\n                }\n                else if (wasMatch) {\n                    removeMatch(path);\n                    if (monitor.remove) {\n                        keepMonitoring = options.eventHandler({ name: 'remove', path: path, value: oldValue }) !== false;\n                    }\n                }\n                if (keepMonitoring === false) {\n                    stopMonitoring();\n                }\n            };\n            const childAddedCallback = (err, path, newValue) => {\n                const isMatch = queryFilters.every(filter => {\n                    if (allowedTableScanOperators.includes(filter.op)) {\n                        return api.storage.test(newValue[filter.key], filter.op, filter.compare);\n                    }\n                    else {\n                        return filter.index.test(newValue, filter.op, filter.compare);\n                    }\n                });\n                let keepMonitoring = true;\n                if (isMatch) {\n                    addMatch(path);\n                    if (monitor.add) {\n                        keepMonitoring = options.eventHandler({ name: 'add', path: path, value: options.snapshots ? newValue : null }) !== false;\n                    }\n                }\n                if (keepMonitoring === false) {\n                    stopMonitoring();\n                }\n            };\n            const childRemovedCallback = (err, path, newValue, oldValue) => {\n                let keepMonitoring = true;\n                removeMatch(path);\n                if (monitor.remove) {\n                    keepMonitoring = options.eventHandler({ name: 'remove', path: path, value: options.snapshots ? oldValue : null }) !== false;\n                }\n                if (keepMonitoring === false) {\n                    stopMonitoring();\n                }\n            };\n            if (options.monitor.add || options.monitor.change || options.monitor.remove) {\n                // Listen for child_changed events\n                api.subscribe(ref.path, 'child_changed', childChangedCallback);\n            }\n            if (options.monitor.remove) {\n                api.subscribe(ref.path, 'notify_child_removed', childRemovedCallback);\n            }\n            if (options.monitor.add) {\n                api.subscribe(ref.path, 'child_added', childAddedCallback);\n            }\n        }\n        return { results: matches, context, stop };\n    });\n}\n//# sourceMappingURL=query.js.map","import { Api } from 'acebase-core';\nimport { AceBaseStorage, AceBaseStorageSettings } from './storage/binary/index.js';\nimport { SQLiteStorage, SQLiteStorageSettings } from './storage/sqlite/index.js';\nimport { MSSQLStorage, MSSQLStorageSettings } from './storage/mssql/index.js';\nimport { CustomStorage, CustomStorageSettings } from './storage/custom/index.js';\nimport { VALUE_TYPES } from './node-value-types.js';\nimport { executeQuery } from './query.js';\nimport { NodeNotFoundError } from './node-errors.js';\nexport class LocalApi extends Api {\n    constructor(dbname = 'default', init, readyCallback) {\n        super();\n        this.db = init.db;\n        const storageEnv = { logLevel: init.settings.logLevel };\n        if (typeof init.settings.storage === 'object') {\n            // settings.storage.logLevel = settings.logLevel;\n            if (SQLiteStorageSettings && (init.settings.storage instanceof SQLiteStorageSettings)) { //  || env.settings.storage.type === 'sqlite'\n                this.storage = new SQLiteStorage(dbname, init.settings.storage, storageEnv);\n            }\n            else if (MSSQLStorageSettings && (init.settings.storage instanceof MSSQLStorageSettings)) { //  || env.settings.storage.type === 'mssql'\n                this.storage = new MSSQLStorage(dbname, init.settings.storage, storageEnv);\n            }\n            else if (CustomStorageSettings && (init.settings.storage instanceof CustomStorageSettings)) { //  || settings.storage.type === 'custom'\n                this.storage = new CustomStorage(dbname, init.settings.storage, storageEnv);\n            }\n            else {\n                const storageSettings = init.settings.storage instanceof AceBaseStorageSettings\n                    ? init.settings.storage\n                    : new AceBaseStorageSettings(init.settings.storage);\n                this.storage = new AceBaseStorage(dbname, storageSettings, storageEnv);\n            }\n        }\n        else {\n            this.storage = new AceBaseStorage(dbname, new AceBaseStorageSettings(), storageEnv);\n        }\n        this.storage.on('ready', readyCallback);\n    }\n    async stats(options) {\n        return this.storage.stats;\n    }\n    subscribe(path, event, callback) {\n        this.storage.subscriptions.add(path, event, callback);\n    }\n    unsubscribe(path, event, callback) {\n        this.storage.subscriptions.remove(path, event, callback);\n    }\n    /**\n     * Creates a new node or overwrites an existing node\n     * @param path\n     * @param value Any value will do. If the value is small enough to be stored in a parent record, it will take care of it\n     * @returns returns a promise with the new cursor (if transaction logging is enabled)\n     */\n    async set(path, value, options = {\n        suppress_events: false,\n        context: null,\n    }) {\n        const cursor = await this.storage.setNode(path, value, { suppress_events: options.suppress_events, context: options.context });\n        return { ...(cursor && { cursor }) };\n    }\n    /**\n     * Updates an existing node, or creates a new node.\n     * @returns returns a promise with the new cursor (if transaction logging is enabled)\n     */\n    async update(path, updates, options = {\n        suppress_events: false,\n        context: null,\n    }) {\n        const cursor = await this.storage.updateNode(path, updates, { suppress_events: options.suppress_events, context: options.context });\n        return { ...(cursor && { cursor }) };\n    }\n    get transactionLoggingEnabled() {\n        return this.storage.settings.transactions && this.storage.settings.transactions.log === true;\n    }\n    /**\n     * Gets the value of a node\n     * @param options when omitted retrieves all nested data. If `include` is set to an array of keys it will only return those children.\n     * If `exclude` is set to an array of keys, those values will not be included\n     */\n    async get(path, options) {\n        if (!options) {\n            options = {};\n        }\n        if (typeof options.include !== 'undefined' && !(options.include instanceof Array)) {\n            throw new TypeError(`options.include must be an array of key names`);\n        }\n        if (typeof options.exclude !== 'undefined' && !(options.exclude instanceof Array)) {\n            throw new TypeError(`options.exclude must be an array of key names`);\n        }\n        if (['undefined', 'boolean'].indexOf(typeof options.child_objects) < 0) {\n            throw new TypeError(`options.child_objects must be a boolean`);\n        }\n        const node = await this.storage.getNode(path, options);\n        return { value: node.value, context: { acebase_cursor: node.cursor }, cursor: node.cursor };\n    }\n    /**\n     * Performs a transaction on a Node\n     * @param path\n     * @param callback callback is called with the current value. The returned value (or promise) will be used as the new value. When the callbacks returns undefined, the transaction will be canceled. When callback returns null, the node will be removed.\n     * @returns returns a promise with the new cursor (if transaction logging is enabled)\n     */\n    async transaction(path, callback, options = {\n        suppress_events: false,\n        context: null,\n    }) {\n        const cursor = await this.storage.transactNode(path, callback, { suppress_events: options.suppress_events, context: options.context });\n        return { ...(cursor && { cursor }) };\n    }\n    async exists(path) {\n        const nodeInfo = await this.storage.getNodeInfo(path);\n        return nodeInfo.exists;\n    }\n    // query2(path, query, options = { snapshots: false, include: undefined, exclude: undefined, child_objects: undefined }) {\n    //     /*\n    //     Now that we're using indexes to filter data and order upon, each query requires a different strategy\n    //     to get the results the quickest.\n    //     So, we'll analyze the query first, build a strategy and then execute the strategy\n    //     Analyze stage:\n    //     - what path is being queried (wildcard path or single parent)\n    //     - which indexes are available for the path\n    //     - which indexes can be used for filtering\n    //     - which indexes can be used for sorting\n    //     - is take/skip used to limit the result set\n    //     Strategy stage:\n    //     - chain index filtering\n    //     - ....\n    //     TODO!\n    //     */\n    // }\n    /**\n     * @returns Returns a promise that resolves with matching data or paths in `results`\n     */\n    async query(path, query, options = { snapshots: false }) {\n        const results = await executeQuery(this, path, query, options);\n        return results;\n    }\n    /**\n     * Creates an index on key for all child nodes at path\n     */\n    createIndex(path, key, options) {\n        return this.storage.indexes.create(path, key, options);\n    }\n    /**\n     * Gets all indexes\n     */\n    async getIndexes() {\n        return this.storage.indexes.list();\n    }\n    /**\n     * Deletes an existing index from the database\n     */\n    async deleteIndex(filePath) {\n        return this.storage.indexes.delete(filePath);\n    }\n    async reflect(path, type, args) {\n        args = args || {};\n        const getChildren = async (path, limit = 50, skip = 0, from = null) => {\n            if (typeof limit === 'string') {\n                limit = parseInt(limit);\n            }\n            if (typeof skip === 'string') {\n                skip = parseInt(skip);\n            }\n            if (['null', 'undefined'].includes(from)) {\n                from = null;\n            }\n            const children = []; // Array<{ key: string | number; type: string; value: any; address?: any }>;\n            let n = 0, stop = false, more = false; //stop = skip + limit,\n            await this.storage.getChildren(path)\n                .next(childInfo => {\n                if (stop) {\n                    // Stop 1 child too late on purpose to make sure there's more\n                    more = true;\n                    return false; // Stop iterating\n                }\n                n++;\n                const include = from !== null ? childInfo.key > from : skip === 0 || n > skip;\n                if (include) {\n                    children.push({\n                        key: typeof childInfo.key === 'string' ? childInfo.key : childInfo.index,\n                        type: childInfo.valueTypeName,\n                        value: childInfo.value,\n                        // address is now only added when storage is acebase. Not when eg sqlite, mssql\n                        ...(typeof childInfo.address === 'object' && 'pageNr' in childInfo.address && {\n                            address: {\n                                pageNr: childInfo.address.pageNr,\n                                recordNr: childInfo.address.recordNr,\n                            },\n                        }),\n                    });\n                }\n                stop = limit > 0 && children.length === limit; // flag, but don't stop now. Otherwise we won't know if there's more\n            })\n                .catch(err => {\n                // Node doesn't exist? No children..\n                if (!(err instanceof NodeNotFoundError)) {\n                    throw err;\n                }\n            });\n            return {\n                more,\n                list: children,\n            };\n        };\n        switch (type) {\n            case 'children': {\n                const result = await getChildren(path, args.limit, args.skip, args.from);\n                return result;\n            }\n            case 'info': {\n                const info = {\n                    key: '',\n                    exists: false,\n                    type: 'unknown',\n                    value: undefined,\n                    address: undefined,\n                    children: {\n                        count: 0,\n                        more: false,\n                        list: [],\n                    },\n                };\n                const nodeInfo = await this.storage.getNodeInfo(path, { include_child_count: args.child_count === true });\n                info.key = typeof nodeInfo.key !== 'undefined' ? nodeInfo.key : nodeInfo.index;\n                info.exists = nodeInfo.exists;\n                info.type = nodeInfo.exists ? nodeInfo.valueTypeName : undefined;\n                info.value = nodeInfo.value;\n                info.address = typeof nodeInfo.address === 'object' && 'pageNr' in nodeInfo.address\n                    ? {\n                        pageNr: nodeInfo.address.pageNr,\n                        recordNr: nodeInfo.address.recordNr,\n                    }\n                    : undefined;\n                const isObjectOrArray = nodeInfo.exists && nodeInfo.address && [VALUE_TYPES.OBJECT, VALUE_TYPES.ARRAY].includes(nodeInfo.type);\n                if (args.child_count === true) {\n                    // set child count instead of enumerating\n                    info.children = { count: isObjectOrArray ? nodeInfo.childCount : 0 };\n                }\n                else if (typeof args.child_limit === 'number' && args.child_limit > 0) {\n                    if (isObjectOrArray) {\n                        info.children = await getChildren(path, args.child_limit, args.child_skip, args.child_from);\n                    }\n                }\n                return info;\n            }\n        }\n    }\n    export(path, stream, options = {\n        format: 'json',\n        type_safe: true,\n    }) {\n        return this.storage.exportNode(path, stream, options);\n    }\n    import(path, read, options = {\n        format: 'json',\n        suppress_events: false,\n        method: 'set',\n    }) {\n        return this.storage.importNode(path, read, options);\n    }\n    async setSchema(path, schema, warnOnly = false) {\n        return this.storage.setSchema(path, schema, warnOnly);\n    }\n    async getSchema(path) {\n        return this.storage.getSchema(path);\n    }\n    async getSchemas() {\n        return this.storage.getSchemas();\n    }\n    async validateSchema(path, value, isUpdate) {\n        return this.storage.validateSchema(path, value, { updates: isUpdate });\n    }\n    /**\n     * Gets all relevant mutations for specific events on a path and since specified cursor\n     */\n    async getMutations(filter) {\n        if (typeof this.storage.getMutations !== 'function') {\n            throw new Error('Used storage type does not support getMutations');\n        }\n        if (typeof filter !== 'object') {\n            throw new Error('No filter specified');\n        }\n        if (typeof filter.cursor !== 'string' && typeof filter.timestamp !== 'number') {\n            throw new Error('No cursor or timestamp given');\n        }\n        return this.storage.getMutations(filter);\n    }\n    /**\n     * Gets all relevant effective changes for specific events on a path and since specified cursor\n     */\n    async getChanges(filter) {\n        if (typeof this.storage.getChanges !== 'function') {\n            throw new Error('Used storage type does not support getChanges');\n        }\n        if (typeof filter !== 'object') {\n            throw new Error('No filter specified');\n        }\n        if (typeof filter.cursor !== 'string' && typeof filter.timestamp !== 'number') {\n            throw new Error('No cursor or timestamp given');\n        }\n        return this.storage.getChanges(filter);\n    }\n}\n//# sourceMappingURL=api-local.js.map","import { StorageSettings } from '../../index.js';\nexport class LocalStorageSettings extends StorageSettings {\n    constructor(settings) {\n        super(settings);\n        /**\n         * whether to use sessionStorage instead of localStorage\n         * @default false\n         */\n        this.temp = false;\n        /**\n         * Whether to enable cross-tab synchronization\n         * @default false\n         */\n        this.multipleTabs = false;\n        if (typeof settings.temp === 'boolean') {\n            this.temp = settings.temp;\n        }\n        if (typeof settings.provider === 'object') {\n            this.provider = settings.provider;\n        }\n        if (typeof settings.multipleTabs === 'boolean') {\n            this.multipleTabs = settings.multipleTabs;\n        }\n        if (typeof settings.logLevel === 'string') {\n            this.logLevel = settings.logLevel;\n        }\n        if (typeof settings.sponsor === 'boolean') {\n            this.sponsor = settings.sponsor;\n        }\n        ['type', 'ipc', 'path'].forEach((prop) => {\n            if (prop in settings) {\n                console.warn(`${prop} setting is not supported for AceBase LocalStorage`);\n            }\n        });\n    }\n}\n//# sourceMappingURL=settings.js.map","import { CustomStorageHelpers, CustomStorageTransaction } from '../index.js';\n// Setup CustomStorageTransaction for browser's LocalStorage\nexport class LocalStorageTransaction extends CustomStorageTransaction {\n    constructor(context, target) {\n        super(target);\n        this.context = context;\n        this._storageKeysPrefix = `${this.context.dbname}.acebase::`;\n    }\n    async commit() {\n        // All changes have already been committed. TODO: use same approach as IndexedDB\n    }\n    async rollback(err) {\n        // Not able to rollback changes, because we did not keep track\n    }\n    async get(path) {\n        // Gets value from localStorage, wrapped in Promise\n        const json = this.context.localStorage.getItem(this.getStorageKeyForPath(path));\n        const val = JSON.parse(json);\n        return val;\n    }\n    async set(path, val) {\n        // Sets value in localStorage, wrapped in Promise\n        const json = JSON.stringify(val);\n        this.context.localStorage.setItem(this.getStorageKeyForPath(path), json);\n    }\n    async remove(path) {\n        // Removes a value from localStorage, wrapped in Promise\n        this.context.localStorage.removeItem(this.getStorageKeyForPath(path));\n    }\n    async childrenOf(path, include, checkCallback, addCallback) {\n        // Streams all child paths\n        // Cannot query localStorage, so loop through all stored keys to find children\n        const pathInfo = CustomStorageHelpers.PathInfo.get(path);\n        for (let i = 0; i < this.context.localStorage.length; i++) {\n            const key = this.context.localStorage.key(i);\n            if (!key.startsWith(this._storageKeysPrefix)) {\n                continue;\n            }\n            const otherPath = this.getPathFromStorageKey(key);\n            if (pathInfo.isParentOf(otherPath) && checkCallback(otherPath)) {\n                let node;\n                if (include.metadata || include.value) {\n                    const json = this.context.localStorage.getItem(key);\n                    node = JSON.parse(json);\n                }\n                const keepGoing = addCallback(otherPath, node);\n                if (!keepGoing) {\n                    break;\n                }\n            }\n        }\n    }\n    async descendantsOf(path, include, checkCallback, addCallback) {\n        // Streams all descendant paths\n        // Cannot query localStorage, so loop through all stored keys to find descendants\n        const pathInfo = CustomStorageHelpers.PathInfo.get(path);\n        for (let i = 0; i < this.context.localStorage.length; i++) {\n            const key = this.context.localStorage.key(i);\n            if (!key.startsWith(this._storageKeysPrefix)) {\n                continue;\n            }\n            const otherPath = this.getPathFromStorageKey(key);\n            if (pathInfo.isAncestorOf(otherPath) && checkCallback(otherPath)) {\n                let node;\n                if (include.metadata || include.value) {\n                    const json = this.context.localStorage.getItem(key);\n                    node = JSON.parse(json);\n                }\n                const keepGoing = addCallback(otherPath, node);\n                if (!keepGoing) {\n                    break;\n                }\n            }\n        }\n    }\n    /**\n     * Helper function to get the path from a localStorage key\n     */\n    getPathFromStorageKey(key) {\n        return key.slice(this._storageKeysPrefix.length);\n    }\n    /**\n     * Helper function to get the localStorage key for a path\n     */\n    getStorageKeyForPath(path) {\n        return `${this._storageKeysPrefix}${path}`;\n    }\n}\n//# sourceMappingURL=transaction.js.map","import { CustomStorageSettings } from '../index.js';\nimport { AceBase } from '../../../index.js';\nimport { LocalStorageSettings } from './settings.js';\nimport { LocalStorageTransaction } from './transaction.js';\nexport { LocalStorageSettings, LocalStorageTransaction };\nexport function createLocalStorageInstance(dbname, init = {}) {\n    const settings = new LocalStorageSettings(init);\n    // Determine whether to use localStorage or sessionStorage\n    const localStorage = settings.provider ? settings.provider : settings.temp ? window.localStorage : window.sessionStorage;\n    // Setup our CustomStorageSettings\n    const storageSettings = new CustomStorageSettings({\n        name: 'LocalStorage',\n        locking: true,\n        removeVoidProperties: settings.removeVoidProperties,\n        maxInlineValueSize: settings.maxInlineValueSize,\n        async ready() {\n            // LocalStorage is always ready\n        },\n        async getTransaction(target) {\n            // Create an instance of our transaction class\n            const context = {\n                debug: true,\n                dbname,\n                localStorage,\n            };\n            const transaction = new LocalStorageTransaction(context, target);\n            return transaction;\n        },\n    });\n    const db = new AceBase(dbname, { logLevel: settings.logLevel, storage: storageSettings, sponsor: settings.sponsor });\n    db.settings.ipcEvents = settings.multipleTabs === true;\n    return db;\n}\n//# sourceMappingURL=index.js.map","import { StorageSettings } from '../../index.js';\nexport class IndexedDBStorageSettings extends StorageSettings {\n    constructor(settings) {\n        super(settings);\n        /**\n         * Whether to enable cross-tab synchronization\n         * @default false\n         */\n        this.multipleTabs = false;\n        /**\n         * How many seconds to keep node info in memory, to speed up IndexedDB performance.\n         * @default 60\n         */\n        this.cacheSeconds = 60;\n        /**\n         * You can turn this on if you are a sponsor\n         * @default false\n         */\n        this.sponsor = false;\n        if (typeof settings.logLevel === 'string') {\n            this.logLevel = settings.logLevel;\n        }\n        if (typeof settings.multipleTabs === 'boolean') {\n            this.multipleTabs = settings.multipleTabs;\n        }\n        if (typeof settings.cacheSeconds === 'number') {\n            this.cacheSeconds = settings.cacheSeconds;\n        }\n        if (typeof settings.sponsor === 'boolean') {\n            this.sponsor = settings.sponsor;\n        }\n        ['type', 'ipc', 'path'].forEach((prop) => {\n            if (prop in settings) {\n                console.warn(`${prop} setting is not supported for AceBase IndexedDBStorage`);\n            }\n        });\n    }\n}\n//# sourceMappingURL=settings.js.map","import { AceBaseBase, AceBaseBaseSettings } from 'acebase-core';\nimport { AceBaseStorage } from './storage/binary/index.js';\nimport { LocalApi } from './api-local.js';\nimport { createLocalStorageInstance, LocalStorageSettings } from './storage/custom/local-storage/index.js';\nimport { IndexedDBStorageSettings } from './storage/custom/indexed-db/settings.js';\nexport { LocalStorageSettings, IndexedDBStorageSettings };\nexport class AceBaseLocalSettings extends AceBaseBaseSettings {\n    constructor(options = {}) {\n        super(options);\n        if (options.storage) {\n            this.storage = options.storage;\n            // If they were set on global settings, copy IPC and transaction settings to storage settings\n            if (options.ipc) {\n                this.storage.ipc = options.ipc;\n            }\n            if (options.transactions) {\n                this.storage.transactions = options.transactions;\n            }\n        }\n    }\n}\nexport class AceBase extends AceBaseBase {\n    /**\n     * @param dbname Name of the database to open or create\n     */\n    constructor(dbname, init = {}) {\n        const settings = new AceBaseLocalSettings(init);\n        super(dbname, settings);\n        this.recovery = {\n            /**\n             * Repairs a node that cannot be loaded by removing the reference from its parent, or marking it as removed\n             */\n            repairNode: async (path, options) => {\n                await this.ready();\n                if (this.api.storage instanceof AceBaseStorage) {\n                    await this.api.storage.repairNode(path, options);\n                }\n                else if (!this.api.storage.repairNode) {\n                    throw new Error(`repairNode is not supported with chosen storage engine`);\n                }\n            },\n            /**\n             * Repairs a node that uses a B+Tree for its keys (100+ children).\n             * See https://github.com/appy-one/acebase/issues/183\n             * @param path Target path to fix\n             */\n            repairNodeTree: async (path) => {\n                await this.ready();\n                const storage = this.api.storage;\n                await storage.repairNodeTree(path);\n            },\n        };\n        const apiSettings = {\n            db: this,\n            settings,\n        };\n        this.api = new LocalApi(dbname, apiSettings, () => {\n            this.emit('ready');\n        });\n    }\n    async close() {\n        // Close the database by calling exit on the ipc channel, which will emit an 'exit' event when the database can be safely closed.\n        await this.api.storage.close();\n    }\n    get settings() {\n        const ipc = this.api.storage.ipc, debug = this.debug;\n        return {\n            get logLevel() { return debug.level; },\n            set logLevel(level) { debug.setLevel(level); },\n            get ipcEvents() { return ipc.eventsEnabled; },\n            set ipcEvents(enabled) { ipc.eventsEnabled = enabled; },\n        };\n    }\n    /**\n     * Creates an AceBase database instance using LocalStorage or SessionStorage as storage engine. When running in non-browser environments, set\n     * settings.provider to a custom LocalStorage provider, eg 'node-localstorage'\n     * @param dbname Name of the database\n     * @param settings optional settings\n     */\n    static WithLocalStorage(dbname, settings = {}) {\n        const db = createLocalStorageInstance(dbname, settings);\n        return db;\n    }\n    /**\n     * Creates an AceBase database instance using IndexedDB as storage engine. Only available in browser contexts!\n     * @param dbname Name of the database\n     * @param settings optional settings\n     */\n    static WithIndexedDB(dbname, init = {}) {\n        throw new Error(`IndexedDB storage can only be used in browser contexts`);\n    }\n}\n//# sourceMappingURL=acebase-local.js.map","import { CustomStorageHelpers, CustomStorageTransaction } from '../index.js';\nfunction _requestToPromise(request) {\n    return new Promise((resolve, reject) => {\n        request.onsuccess = event => {\n            return resolve(request.result || null);\n        };\n        request.onerror = reject;\n    });\n}\nexport class IndexedDBStorageTransaction extends CustomStorageTransaction {\n    /**\n     * Creates a transaction object for IndexedDB usage. Because IndexedDB automatically commits\n     * transactions when they have not been touched for a number of microtasks (eg promises\n     * resolving whithout querying data), we will enqueue set and remove operations until commit\n     * or rollback. We'll create separate IndexedDB transactions for get operations, caching their\n     * values to speed up successive requests for the same data.\n     */\n    constructor(context, target) {\n        super(target);\n        this.context = context;\n        this.production = true; // Improves performance, only set when all works well\n        this._pending = [];\n    }\n    _createTransaction(write = false) {\n        const tx = this.context.db.transaction(['nodes', 'content'], write ? 'readwrite' : 'readonly');\n        return tx;\n    }\n    _splitMetadata(node) {\n        const value = node.value;\n        const copy = { ...node };\n        delete copy.value;\n        const metadata = copy;\n        return { metadata, value };\n    }\n    async commit() {\n        // console.log(`*** commit ${this._pending.length} operations ****`);\n        if (this._pending.length === 0) {\n            return;\n        }\n        const batch = this._pending.splice(0);\n        this.context.ipc.sendNotification({ action: 'cache.invalidate', paths: batch.map(op => op.path) });\n        const tx = this._createTransaction(true);\n        try {\n            await new Promise((resolve, reject) => {\n                let stop = false, processed = 0;\n                const handleError = (err) => {\n                    stop = true;\n                    reject(err);\n                };\n                const handleSuccess = () => {\n                    if (++processed === batch.length) {\n                        resolve();\n                    }\n                };\n                batch.forEach((op, i) => {\n                    if (stop) {\n                        return;\n                    }\n                    let r1, r2;\n                    const path = op.path;\n                    if (op.action === 'set') {\n                        const { metadata, value } = this._splitMetadata(op.node);\n                        const nodeInfo = { path, metadata };\n                        r1 = tx.objectStore('nodes').put(nodeInfo); // Insert into \"nodes\" object store\n                        r2 = tx.objectStore('content').put(value, path); // Add value to \"content\" object store\n                        this.context.cache.set(path, op.node);\n                    }\n                    else if (op.action === 'remove') {\n                        r1 = tx.objectStore('content').delete(path); // Remove from \"content\" object store\n                        r2 = tx.objectStore('nodes').delete(path); // Remove from \"nodes\" data store\n                        this.context.cache.set(path, null);\n                    }\n                    else {\n                        handleError(new Error(`Unknown pending operation \"${op.action}\" on path \"${path}\" `));\n                    }\n                    let succeeded = 0;\n                    r1.onsuccess = r2.onsuccess = () => {\n                        if (++succeeded === 2) {\n                            handleSuccess();\n                        }\n                    };\n                    r1.onerror = r2.onerror = handleError;\n                });\n            });\n            tx.commit && tx.commit();\n        }\n        catch (err) {\n            console.error(err);\n            tx.abort && tx.abort();\n            throw err;\n        }\n    }\n    async rollback(err) {\n        // Nothing has committed yet, so we'll leave it like that\n        this._pending = [];\n    }\n    async get(path) {\n        // console.log(`*** get \"${path}\" ****`);\n        if (this.context.cache.has(path)) {\n            const cache = this.context.cache.get(path);\n            // console.log(`Using cached node for path \"${path}\": `, cache);\n            return cache;\n        }\n        const tx = this._createTransaction(false);\n        const r1 = _requestToPromise(tx.objectStore('nodes').get(path)); // Get metadata from \"nodes\" object store\n        const r2 = _requestToPromise(tx.objectStore('content').get(path)); // Get content from \"content\" object store\n        try {\n            const results = await Promise.all([r1, r2]);\n            tx.commit && tx.commit();\n            const info = results[0];\n            if (!info) {\n                // Node doesn't exist\n                this.context.cache.set(path, null);\n                return null;\n            }\n            const node = info.metadata;\n            node.value = results[1];\n            this.context.cache.set(path, node);\n            return node;\n        }\n        catch (err) {\n            console.error(`IndexedDB get error`, err);\n            tx.abort && tx.abort();\n            throw err;\n        }\n    }\n    set(path, node) {\n        // Queue the operation until commit\n        this._pending.push({ action: 'set', path, node });\n    }\n    remove(path) {\n        // Queue the operation until commit\n        this._pending.push({ action: 'remove', path });\n    }\n    async removeMultiple(paths) {\n        // Queues multiple items at once, dramatically improves performance for large datasets\n        paths.forEach(path => {\n            this._pending.push({ action: 'remove', path });\n        });\n    }\n    childrenOf(path, include, checkCallback, addCallback) {\n        // console.log(`*** childrenOf \"${path}\" ****`);\n        return this._getChildrenOf(path, { ...include, descendants: false }, checkCallback, addCallback);\n    }\n    descendantsOf(path, include, checkCallback, addCallback) {\n        // console.log(`*** descendantsOf \"${path}\" ****`);\n        return this._getChildrenOf(path, { ...include, descendants: true }, checkCallback, addCallback);\n    }\n    _getChildrenOf(path, include, checkCallback, addCallback) {\n        // Use cursor to loop from path on\n        return new Promise((resolve, reject) => {\n            const pathInfo = CustomStorageHelpers.PathInfo.get(path);\n            const tx = this._createTransaction(false);\n            const store = tx.objectStore('nodes');\n            const query = IDBKeyRange.lowerBound(path, true);\n            const cursor = include.metadata ? store.openCursor(query) : store.openKeyCursor(query);\n            cursor.onerror = e => {\n                tx.abort?.();\n                reject(e);\n            };\n            cursor.onsuccess = async (e) => {\n                const otherPath = cursor.result?.key ?? null;\n                let keepGoing = true;\n                if (otherPath === null) {\n                    // No more results\n                    keepGoing = false;\n                }\n                else if (!pathInfo.isAncestorOf(otherPath)) {\n                    // Paths are sorted, no more children or ancestors to be expected!\n                    keepGoing = false;\n                }\n                else if (include.descendants || pathInfo.isParentOf(otherPath)) {\n                    let node;\n                    if (include.metadata) {\n                        const valueCursor = cursor;\n                        const data = valueCursor.result.value;\n                        node = data.metadata;\n                    }\n                    const shouldAdd = checkCallback(otherPath, node);\n                    if (shouldAdd) {\n                        if (include.value) {\n                            // Load value!\n                            if (this.context.cache.has(otherPath)) {\n                                const cache = this.context.cache.get(otherPath);\n                                node.value = cache.value;\n                            }\n                            else {\n                                const req = tx.objectStore('content').get(otherPath);\n                                node.value = await new Promise((resolve, reject) => {\n                                    req.onerror = e => {\n                                        resolve(null); // Value missing?\n                                    };\n                                    req.onsuccess = e => {\n                                        resolve(req.result);\n                                    };\n                                });\n                                this.context.cache.set(otherPath, node.value === null ? null : node);\n                            }\n                        }\n                        keepGoing = addCallback(otherPath, node);\n                    }\n                }\n                if (keepGoing) {\n                    try {\n                        cursor.result.continue();\n                    }\n                    catch (err) {\n                        // We reached the end of the cursor?\n                        keepGoing = false;\n                    }\n                }\n                if (!keepGoing) {\n                    tx.commit?.();\n                    resolve();\n                }\n            };\n        });\n    }\n}\n//# sourceMappingURL=transaction.js.map","import { SimpleCache } from 'acebase-core';\nimport { CustomStorageSettings } from '../index.js';\nimport { AceBase } from '../../../index.js';\nimport { IndexedDBStorageSettings } from './settings.js';\nimport { IndexedDBStorageTransaction } from './transaction.js';\nexport function createIndexedDBInstance(dbname, init = {}) {\n    const settings = new IndexedDBStorageSettings(init);\n    // We'll create an IndexedDB with name \"dbname.acebase\"\n    const IndexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB; // browser prefixes not really needed, see https://caniuse.com/#feat=indexeddb\n    const request = IndexedDB.open(`${dbname}.acebase`, 1);\n    request.onupgradeneeded = (e) => {\n        // create datastore\n        const db = request.result;\n        // Create \"nodes\" object store for metadata\n        db.createObjectStore('nodes', { keyPath: 'path' });\n        // Create \"content\" object store with all data\n        db.createObjectStore('content');\n    };\n    let idb;\n    const readyPromise = new Promise((resolve, reject) => {\n        request.onsuccess = e => {\n            idb = request.result;\n            resolve();\n        };\n        request.onerror = e => {\n            reject(e);\n        };\n    });\n    const cache = new SimpleCache(typeof settings.cacheSeconds === 'number' ? settings.cacheSeconds : 60); // 60 second node cache by default\n    // cache.enabled = false;\n    const storageSettings = new CustomStorageSettings({\n        name: 'IndexedDB',\n        locking: true,\n        removeVoidProperties: settings.removeVoidProperties,\n        maxInlineValueSize: settings.maxInlineValueSize,\n        lockTimeout: settings.lockTimeout,\n        ready() {\n            return readyPromise;\n        },\n        async getTransaction(target) {\n            await readyPromise;\n            const context = {\n                debug: false,\n                db: idb,\n                cache,\n                ipc,\n            };\n            return new IndexedDBStorageTransaction(context, target);\n        },\n    });\n    const db = new AceBase(dbname, {\n        logLevel: settings.logLevel,\n        storage: storageSettings,\n        sponsor: settings.sponsor,\n        // isolated: settings.isolated,\n    });\n    const ipc = db.api.storage.ipc;\n    db.settings.ipcEvents = settings.multipleTabs === true;\n    ipc.on('notification', async (notification) => {\n        const message = notification.data;\n        if (typeof message !== 'object') {\n            return;\n        }\n        if (message.action === 'cache.invalidate') {\n            // console.warn(`Invalidating cache for paths`, message.paths);\n            for (const path of message.paths) {\n                cache.remove(path);\n            }\n        }\n    });\n    return db;\n}\n//# sourceMappingURL=index.js.map","import { AceBase } from './acebase-local.js';\nimport { createIndexedDBInstance } from './storage/custom/indexed-db/index.js';\nconst deprecatedConstructorError = `Using AceBase constructor in the browser to use localStorage is deprecated!\r\nSwitch to:\r\nIndexedDB implementation (FASTER, MORE RELIABLE):\r\n    let db = AceBase.WithIndexedDB(name, settings)\r\nOr, new LocalStorage implementation:\r\n    let db = AceBase.WithLocalStorage(name, settings)\r\nOr, write your own CustomStorage adapter:\r\n    let myCustomStorage = new CustomStorageSettings({ ... });\r\n    let db = new AceBase(name, { storage: myCustomStorage })`;\nexport class BrowserAceBase extends AceBase {\n    /**\n     * Constructor that is used in browser context\n     * @param name database name\n     * @param settings settings\n     */\n    constructor(name, settings) {\n        if (typeof settings !== 'object' || typeof settings.storage !== 'object') {\n            // Client is using old AceBaseBrowser signature, eg:\n            // let db = new AceBase('name', { temp: false })\n            //\n            // Don't allow this anymore. If client wants to use localStorage,\n            // they need to switch to AceBase.WithLocalStorage('name', settings).\n            // If they want to use custom storage in the browser, they must\n            // use the same constructor signature AceBase has:\n            // let db = new AceBase('name', { storage: new CustomStorageSettings({ ... }) });\n            throw new Error(deprecatedConstructorError);\n        }\n        super(name, settings);\n        this.settings.ipcEvents = settings.multipleTabs === true;\n    }\n    /**\n     * Creates an AceBase database instance using IndexedDB as storage engine\n     * @param dbname Name of the database\n     * @param settings optional settings\n     */\n    static WithIndexedDB(dbname, init = {}) {\n        return createIndexedDBInstance(dbname, init);\n    }\n}\n//# sourceMappingURL=acebase-browser.js.map","/**\n   ________________________________________________________________________________\n\n      ___          ______\n     / _ \\         | ___ \\\n    / /_\\ \\ ___ ___| |_/ / __ _ ___  ___\n    |  _  |/ __/ _ \\ ___ \\/ _` / __|/ _ \\\n    | | | | (_|  __/ |_/ / (_| \\__ \\  __/\n    \\_| |_/\\___\\___\\____/ \\__,_|___/\\___|\n                        realtime database\n\n   Copyright 2018-2022 by Ewout Stortenbeker (me@appy.one)\n   Published under MIT license\n\n   See docs at https://github.com/appy-one/acebase\n   ________________________________________________________________________________\n\n*/\nimport { DataReference, DataSnapshot, EventSubscription, PathReference, TypeMappings, ID, proxyAccess, DataSnapshotsArray, ObjectCollection, DataReferencesArray, EventStream, PartialArray } from 'acebase-core';\nimport { AceBaseLocalSettings } from './acebase-local.js';\nimport { BrowserAceBase } from './acebase-browser.js';\nimport { CustomStorageSettings, CustomStorageTransaction, CustomStorageHelpers } from './storage/custom/index.js';\nconst acebase = {\n    AceBase: BrowserAceBase,\n    AceBaseLocalSettings,\n    DataReference,\n    DataSnapshot,\n    EventSubscription,\n    PathReference,\n    TypeMappings,\n    CustomStorageSettings,\n    CustomStorageTransaction,\n    CustomStorageHelpers,\n    ID,\n    proxyAccess,\n    DataSnapshotsArray,\n};\n// Expose classes to window.acebase:\nwindow.acebase = acebase;\n// Expose BrowserAceBase class as window.AceBase:\nwindow.AceBase = BrowserAceBase;\n// Expose classes for module imports:\nexport default acebase;\n// acebase-core exports\nexport { DataSnapshot, DataReference, DataSnapshotsArray, DataReferencesArray, EventStream, EventSubscription, PathReference, TypeMappings, ObjectCollection, ID, proxyAccess, PartialArray, };\n// acebase exports\nexport { BrowserAceBase as AceBase, };\nexport { AceBaseLocalSettings, LocalStorageSettings, IndexedDBStorageSettings, } from './acebase-local.js';\nexport { AceBaseStorageSettings } from './storage/binary/index.js';\nexport { SQLiteStorageSettings } from './storage/sqlite/index.js';\nexport { MSSQLStorageSettings } from './storage/mssql/index.js';\nexport { CustomStorageTransaction, CustomStorageSettings, CustomStorageHelpers, ICustomStorageNode, ICustomStorageNodeMetaData, } from './storage/custom/index.js';\nexport { StorageSettings, SchemaValidationError, } from './storage/index.js';\n//# sourceMappingURL=browser.js.map","let generateQuickGuid=()=>{\r\n  return Math.random().toString(36).substring(2, 15) +\r\n    Math.random().toString(36).substring(2, 15);\r\n}\r\nlet privateRequest=(()=>{\r\n  return '/ps'+generateQuickGuid()+'/pe'\r\n})()\r\nconst crudRoute={\r\n  req:'/custom',\r\n  create:{\r\n    one:'/create-one',\r\n    many:'/create-many',\r\n  },\r\n  send:{\r\n    one:'/send-one',\r\n    many:'/send-many',\r\n  },\r\n  find:{\r\n    one:'/find-one',\r\n    many:'/find-many',\r\n  },\r\n  get:{\r\n    one:'/get-one',\r\n    many:'/get-many',\r\n  },\r\n  query:{\r\n    many:'/get-many',\r\n  },\r\n  update:{\r\n    one:'/update-one',\r\n    many:'/update-many',\r\n  },\r\n  delete:{\r\n    one:'/delete-one',\r\n    many:'/delete-many',\r\n  },\r\n}\r\nconst listenRoute={\r\n  create:'/create',\r\n  find:'/find',\r\n  get:'/get',\r\n  query:'/get',\r\n  update:'/update',\r\n  delete:'/delete',\r\n  req:'/custom',\r\n  upload:'/upload',\r\n  send:'/send',\r\n  user:{\r\n    base:'/user',\r\n    example:'/user/device-connected',\r\n    join:'',\r\n    status:'/user/status',\r\n    device:{\r\n      connected:'/user/device-connected',\r\n      removed:'/user/device-removed',\r\n      disconnected:'/user/device-disconnected'\r\n    }\r\n  },\r\n\r\n}\r\nconst emitRoute={\r\n  user:{\r\n    base:'/user',\r\n    //example:'/user/device-remove',\r\n    device:{\r\n      remove:'/user/device-remove',\r\n      list:'/user/device-list'\r\n    }\r\n  },\r\n  users:{\r\n    base:'/users',\r\n    device:{\r\n      list:'/users/device-list'\r\n    }\r\n  }\r\n}\r\n\r\nconst authRoute={\r\n    base:'/auth',\r\n    //example:'/auth/login**/get-one',\r\n    login:'/login/get-one',\r\n    verify_token_code:'/verify-token-code/get-one',\r\n    verify_pass_code:'/verify-pass-code/get-one',\r\n    verify_email_code:'/verify-email-code/get-one',\r\n    req:'/custom',\r\n    user:'/user/'+privateRequest+'/get-one',\r\n    register:'/register/get-one',\r\n    forgotPassword:'/forgot-password/get-one'+privateRequest+'/get-one',\r\n    deleteAccount:'/delete-account/get-one',\r\n    refreshToken:'/refresh-token'+privateRequest+'/get-one',\r\n    users:{\r\n      base:'/users',\r\n      //example:'/auth/users**/create-one',\r\n    },\r\n}\r\n\r\nconst storageRoute={\r\n  base:'/storage',\r\n  //example:'/storage/**/create-one',\r\n  upload:'/upload',\r\n  download:{\r\n    one:'download-one',\r\n    many:'download-many'\r\n  }\r\n\r\n}\r\n\r\n\r\nexport {\r\n  listenRoute,\r\n  emitRoute,\r\n  crudRoute,\r\n  authRoute,\r\n  storageRoute,\r\n}\r\n","import jwtDecode from \"jwt-decode\";\r\nimport AxiosService from \"./axios/index.service.js\";\r\nimport {v4} from \"uuid\";\r\nimport EventEmitter from \"eventemitter3\"\r\nimport objectPath from 'dottie'\r\nimport {AceBase} from \"acebase\";\r\nimport {authRoute, crudRoute, listenRoute, storageRoute} from './api-route.js'\r\n\r\nclass SwygerClient{\r\n  #listen='/on'\r\n  #requireAuth=true\r\n\r\n  #redirectTo\r\n\r\n  #extrasRef\r\n\r\n  #storage\r\n  #basePath\r\n  #storageConfig\r\n  #mail\r\n  #eventEmitter=new EventEmitter()\r\n\r\n  #syncWithLocal\r\n  #dataBaseConnected\r\n  #config\r\n  #db\r\n  constructor(config={}) {\r\n    this.#config=config\r\n    let {ENV,OFFLINE_DB_NAME}=this.#config\r\n    this.#db=AceBase.WithIndexedDB(OFFLINE_DB_NAME?.STORAGE||'swyger_storage') //db = localStorage\r\n    let doInInactivity=async ()=>{\r\n      try {\r\n        let userInfo\r\n        let accessToken=localStorage.getItem('accessToken')\r\n        let tokenIsExpired=(()=>{\r\n          try {\r\n            userInfo=JSON.parse(localStorage.getItem('userInfo')?localStorage.getItem('userInfo'):\"{}\")\r\n            let decoded=jwtDecode(accessToken)\r\n            return  Date?.parse(new Date(decoded?.exp*1000)?.toString())<Date.now()\r\n\r\n          }catch (e) {\r\n            return false\r\n          }\r\n        })()\r\n        if(tokenIsExpired && userInfo.uid){\r\n          try {\r\n            if(ENV==='dev') console.log('Token expired on inactivity, Trying to request a new refresh token')\r\n            //await new SwygerClient().init()?.auth?.user()\r\n          }catch (e) {\r\n\r\n          }\r\n        }\r\n      }catch (e) {\r\n\r\n      }\r\n\r\n\r\n    }\r\n    //visit: https://developer.chrome.com/blog/using-requestidlecallback/\r\n    if (\"requestIdleCallback\" in window) {\r\n      // if method exists\r\n      // do some work\r\n\r\n      // call method requestIdleCallback() and\r\n      // passing myLowPriorityJob() callback function\r\n      // as first argument.\r\n      requestIdleCallback(doInInactivity,\r\n          //{timeout:AUTO_REFRESH_TOKEN_TIMEOUT}\r\n      );\r\n    } else {\r\n      // just do the work\r\n      // by using a polyfill or a shim\r\n    }\r\n  }\r\n  init=(req)=>{\r\n    let {ENV,HOST_SERVER,API_VERSION}=this.#config\r\n    let offlineDatabaseHandler=async ()=>{\r\n\r\n      let transaction='/transaction'\r\n      let dataRef='/database'\r\n      let trans=await this.#db?.ref(transaction)?.get()?.catch((e)=>{})\r\n      let data=await this.#db?.ref(dataRef)?.get()?.catch((e)=>{})\r\n      if(trans.exists()){\r\n        trans=trans.val()\r\n        let keys=Object.keys(trans)\r\n        //console.log('Connected: ',socket?.database?.connected)\r\n        //console.log('Keys: ',keys)\r\n        if(keys?.length>0){\r\n          for(let item in keys){\r\n            let transaction=trans[item]\r\n            if(transaction?.path && transaction?.method && transaction?.value)\r\n              await this.init(req).database().ref(transaction?.path).req(\r\n                transaction?.method,\r\n                transaction?.path,\r\n                transaction?.value\r\n              ).val()\r\n          }\r\n          if(data.exists())\r\n            await this.#db?.ref(dataRef)?.remove()?.catch((e)=>{})\r\n          await this.#db?.ref(transaction)?.remove()?.catch((e)=>{})\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n    req?.socket?.storage?.on('connect',()=>{\r\n      //console.log('device connected')\r\n      this.#dataBaseConnected=true\r\n      offlineDatabaseHandler()\r\n    })\r\n    req?.socket?.storage?.on('disconnect',()=>{\r\n      this.#dataBaseConnected=false\r\n    })\r\n\r\n\r\n    const axiosData=(data={})=>{\r\n\r\n      let request={}\r\n      if(data && Object.keys(data).length>0) request.data=data\r\n      if(this.#storage){\r\n        request.storage=this.#storage\r\n        request.config=this.#storageConfig\r\n      }\r\n      if(this.#mail){\r\n        let formData=new FormData()\r\n        if(Array.isArray(data)){\r\n          data.map((elt,i)=>{\r\n            if(typeof elt=='object'){\r\n              elt.attachmentName='attachment'+i\r\n              elt?.attachments.forEach((file)=>{\r\n                if(file?.data){\r\n                  formData.append('attachments'+i,file?.data,file?.name)\r\n                }else {\r\n                  formData.append('attachments'+i,file)\r\n                }\r\n              })\r\n            }\r\n          })\r\n          formData.append('field',JSON.stringify(request))\r\n        }else {\r\n          if(Array.isArray(data?.attachments)){\r\n            data?.attachments.forEach((file)=>{\r\n              if(file?.data){\r\n                formData.append('attachments',file?.data,file?.name)\r\n              }else {\r\n                formData.append('attachments',file)\r\n              }\r\n            })\r\n            delete request.data.attachments\r\n            formData.append('field',JSON.stringify(request))\r\n          }\r\n        }\r\n        request=formData\r\n      }else\r\n      if( this.#storage && data?.file) {\r\n        //visit: https://developer.mozilla.org/en-US/docs/Web/API/FormData\r\n        //visit: https://stackabuse.com/axios-multipart-form-data-sending-file-through-a-form-with-javascript/\r\n        let formData=new FormData()\r\n        if(data?.file){\r\n          if(data.file?.data){\r\n            formData.append('file',data.file?.data,data.file?.name)\r\n          }else {\r\n            formData.append('file',data.file)\r\n          }\r\n          delete request.data.file\r\n          formData.append('field',JSON.stringify(request))\r\n          //console.log('get form data, ',formData.get('file'))\r\n        }else if(Array.isArray(data?.directory)){\r\n          data?.directory.forEach((file)=>{\r\n            if(file?.data){\r\n              formData.append('file',file?.data,file?.name)\r\n            }else {\r\n              formData.append('file',file)\r\n            }\r\n          })\r\n          delete request.data.directory\r\n          formData.append('field',JSON.stringify(request))\r\n          request=formData\r\n        }\r\n        request=formData\r\n\r\n      }\r\n\r\n\r\n      return request\r\n    }\r\n    let checkHttpAuthorization=async (result,callback)=>{\r\n      if(result?.error?.token && this.#requireAuth){\r\n        this.#requireAuth=false\r\n        if(localStorage.getItem('refreshToken')){\r\n          if(ENV==='dev') console.log('Token expired or not found: ',result.error?.token, ' Trying to request a new refresh token')\r\n          let cb=await this?.init(req)?.auth()?.req(authRoute.refreshToken,\r\n            {\r\n              token:localStorage.getItem('refreshToken')\r\n            }\r\n          ).val()\r\n          if(cb?.error){\r\n            if(ENV==='dev') console.log('Refresh token expired or not found: ',cb)\r\n            if(this.#redirectTo) window.top.location.href = this.#redirectTo\r\n            return cb\r\n          }else {\r\n            if(cb?.data){\r\n              if(ENV==='dev') console.log('We got a new refresh token ,',cb?.data)\r\n              if(cb?.data?.token) localStorage.setItem('accessToken',cb?.data?.token)\r\n              if(cb?.data?.refreshToken) localStorage.setItem('refreshToken',cb?.data?.refreshToken)\r\n              if(ENV==='dev') console.log('Trying to restart your request...')\r\n              if(typeof callback=='function'){\r\n                return  await callback()\r\n              }\r\n\r\n            }\r\n          }\r\n\r\n\r\n\r\n        }\r\n\r\n      }\r\n      else {\r\n        return result\r\n      }\r\n\r\n    }\r\n    let removeCommonValue=()=>{\r\n      //this.#listenID=undefined\r\n      //this.#extrasRef=undefined\r\n      //this.#newToken=undefined\r\n    }\r\n\r\n    const listenSocket=(socket,config,ref,callback=()=>{})=>{\r\n      const listenLocal=this.#listen\r\n\r\n      let eventName=config.version+listenLocal+config.base+ref\r\n      eventName=eventName.replace(/\\/\\//g,'/')\r\n\r\n      if(ENV==='dev') console.log('socket listen local path: ', eventName)\r\n      socket?.on(eventName,callback)\r\n    }\r\n    const listenEmitter=(ref,callback=()=>{})=>{\r\n      const listenLocal=this.#listen\r\n\r\n      let eventName=API_VERSION?.STORAGE+listenLocal+ref\r\n      eventName=eventName.replace(/\\/\\//g,'/')\r\n      if(ENV==='dev') console.log('emitter listen local path: ', eventName)\r\n      this.#eventEmitter?.on(eventName,callback)\r\n    }\r\n    let socketListener=(socket,config,node,ref)=>{\r\n\r\n      if(this.#extrasRef) ref=ref+this.#extrasRef\r\n      //console.log('listener ', ref)\r\n      let listenReq={\r\n        req: (callback) => {\r\n          listenSocket(socket,config,ref+listenRoute.req, (res) => {\r\n            if (!res?.error?.error?.token && !res?.error?.token || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        create: (callback) => {\r\n          listenSocket(socket,config,ref + listenRoute.create, (res) => {\r\n            if (!res?.error?.error?.token && !res?.error?.token || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        find: (callback) => {\r\n          listenSocket(socket,config,ref + listenRoute.find, (res) => {\r\n            if (!res?.error?.error?.token && !res?.error?.token || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        get: (callback) => {\r\n          listenSocket(socket,config,ref + listenRoute.get, (res) => {\r\n            if (!res?.error?.error?.token && !res?.error?.token || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        query: (callback) => {\r\n          listenSocket(socket,config,ref + listenRoute.query, (res) => {\r\n            if (!res?.error?.error?.token && !res?.error?.token || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        update: (callback) => {\r\n          listenSocket(socket,config,ref + listenRoute.update, (res) => {\r\n            if (!res?.error?.error?.token && !res?.error?.token || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        delete: (callback) => {\r\n          listenSocket(socket,config,ref + listenRoute.delete, (res) => {\r\n            if (!res?.error?.error?.token && !res?.error?.token || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n      }\r\n      if(this.#storage){\r\n        listenReq.upload=(callback) => {\r\n          listenSocket(socket,config,ref + listenRoute.upload, (res) => {\r\n            if (!res?.error?.error?.token && !res?.error?.token || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        }\r\n      }\r\n\r\n      return listenReq\r\n    }\r\n    let emitterListener=(path,node)=>{\r\n      return {\r\n\r\n        create: (callback) => {\r\n          listenEmitter(path + listenRoute.create, (res) => {\r\n            if (!res?.error || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        find: (callback) => {\r\n          listenEmitter(path + listenRoute.find, (res) => {\r\n            if (!res?.error || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        get: (callback) => {\r\n          listenEmitter(path + listenRoute.get, (res) => {\r\n            if (!res?.error || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        query: (callback) => {\r\n          listenEmitter(path + listenRoute.query, (res) => {\r\n            if (!res?.error || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        update: (callback) => {\r\n          listenEmitter(path + listenRoute.update, (res) => {\r\n            if (!res?.error || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n        delete: (callback) => {\r\n          listenEmitter(path + listenRoute.delete, (res) => {\r\n            if (!res?.error || res?.data) {\r\n              if (typeof callback == 'function') callback({...node, value: res})\r\n            }\r\n          })\r\n          return node\r\n        },\r\n      }\r\n    }\r\n\r\n    let AxiosReq=AxiosService.init(this.#config)\r\n\r\n    let authRequest=(path='',data={},onRequest={},node={},callback)=>{\r\n      path=path.trim()\r\n      //path=path.replace(/\\/\\//g,'/')\r\n      if(path.charAt(path.length-1)==='/') path=path.slice(0, -1)\r\n\r\n      let handlerRequest=async ()=>{\r\n        let request=async ()=>await AxiosReq('post',HOST_SERVER.AUTH+API_VERSION.AUTH+authRoute.base+path,axiosData(data))\r\n        let result= await request()\r\n        if(this.#requireAuth){\r\n          result=await checkHttpAuthorization(result,async ()=> await request())\r\n        }\r\n        if(typeof callback=='function'){\r\n          callback({...node,value:result})\r\n        }\r\n        return result\r\n      }\r\n      let handler=handlerRequest()\r\n      removeCommonValue()\r\n      return {...node,val:()=>handler}\r\n    }\r\n    let dataRequest=(method,path,data,onRequest={},node={},callback)=>{\r\n      //path=path.replace(/\\/\\//g,'/')\r\n      let handlerRequest=async ()=>{\r\n        let request=async ()=>await AxiosReq(method,path,axiosData(data),onRequest)\r\n        let result=await request()\r\n        if(this.#requireAuth){\r\n          result=await checkHttpAuthorization(result,async ()=> await request())\r\n        }\r\n        if(typeof callback=='function'){\r\n          callback({...node,value:result})\r\n        }\r\n        return result\r\n      }\r\n      let handler=handlerRequest()\r\n      removeCommonValue()\r\n      return {...node,val:()=>handler}\r\n    }\r\n    let extractArgs=(args)=>{\r\n      let onRequest={},callback\r\n      let [data={},,,]=args\r\n      //console.log('Sync with data', typeof data)\r\n      if(args.length===1 && typeof data == \"function\"){\r\n        callback=args[0]\r\n        data={}\r\n      }\r\n      if(args.length===2){\r\n        if(typeof args[1]=='object'){\r\n          onRequest=args[1]\r\n        }else if(typeof args[1]=='function'){\r\n          callback=args[1]\r\n        }\r\n      }\r\n      if(args.length>=3){\r\n        let [,reqOn,cb,]=args\r\n        if(typeof reqOn=='object') onRequest=reqOn\r\n        callback=cb\r\n\r\n      }\r\n\r\n      return {\r\n        data,\r\n        onRequest,\r\n        callback\r\n      }\r\n    }\r\n    let generateQuickGuid=()=>{\r\n      return Math.random().toString(36).substring(2, 15) +\r\n        Math.random().toString(36).substring(2, 15);\r\n    }\r\n    let pathToJson=async (result={},method,path,value={})=>{\r\n\r\n      path=path.replace(/^\\//,'')\r\n      path=path.replace(/\\//g,'.')\r\n      let childValue\r\n      let database\r\n      return await new Promise(resolve=>{\r\n        //visit: https://www.npmjs.com/package/dottie\r\n        switch (method) {\r\n          case 'create':\r\n            objectPath?.set(result,path,value)\r\n            database=objectPath?.get(result,'root')\r\n            childValue=objectPath?.get(result,path.replace('root.',''))\r\n            if(childValue){\r\n              result={\r\n                database,\r\n                data:childValue\r\n              }\r\n            }else {\r\n              result={\r\n                error:{\r\n                  message:'We could not create value'\r\n                }\r\n              }\r\n            }\r\n            break;\r\n          case 'update':\r\n            let split=path.split('/')\r\n            let start=split.shift()\r\n            let updatePath=path.replace(start+'.','')\r\n            let oldValue=objectPath?.get(result,path.replace('root.',''))\r\n            //console.log('oldValue: ', oldValue)\r\n\r\n            if(typeof oldValue=='object'){\r\n              objectPath?.set(result,path,{\r\n                ...oldValue,\r\n                ...value\r\n              })\r\n            }else {\r\n              objectPath?.set(result,path,value)\r\n            }\r\n            database=objectPath?.get(result,'root')\r\n            childValue=objectPath?.get(result,path.replace('root.',''))\r\n            if(childValue){\r\n              result={\r\n                database,\r\n                data:childValue\r\n              }\r\n            }else {\r\n              result={\r\n                error:{\r\n                  message:'We could not update value'\r\n                }\r\n              }\r\n            }\r\n            //console.log('newValue: ', childValue)\r\n            break;\r\n          case 'get':\r\n            result=objectPath?.get(result,path)\r\n            database=objectPath?.get(result,'root')\r\n            childValue=objectPath?.get(result,path.replace('root.',''))\r\n            if(childValue){\r\n              result={\r\n                data:childValue\r\n              }\r\n            }else {\r\n              result={\r\n                error:{\r\n                  message:'We could not update value'\r\n                }\r\n              }\r\n            }\r\n            break;\r\n          case 'delete':\r\n            database=objectPath?.get(result,'root')\r\n            childValue=objectPath?.get(result,path.replace('root.',''))\r\n            objectPath?.set(result,path,undefined)\r\n            if(childValue){\r\n              result={\r\n                database,\r\n                data:childValue\r\n              }\r\n            }else {\r\n              result={\r\n                error:{\r\n                  message:'We could not delete value'\r\n                }\r\n              }\r\n            }\r\n            break;\r\n        }\r\n        //console.log('get result: ',result)\r\n        resolve(result)\r\n      })\r\n    }\r\n    let localDatabase=(method,path,data={},node,callback)=>{\r\n      path=path.replace(/\\/\\//g,'/')\r\n      let handlerRequest=async ()=>{\r\n        let transaction='/transaction'\r\n        //pathToJson(path,'')\r\n        let result,max\r\n        let error={\r\n          error:{\r\n            message:'We could not execute the '+method+' method for path: '+path\r\n          }\r\n        }\r\n        switch (method) {\r\n          case 'create':\r\n            await this.#db?.ref(path)?.set(data)?.catch((e)=>error)\r\n            break;\r\n          case 'update':\r\n            await this.#db?.ref(path)?.update(data)?.catch((e)=>error)\r\n            break;\r\n          case 'query':\r\n            let query=this.#db?.query(path)\r\n            if(Array.isArray(data?.where)){\r\n              await Promise.all(data?.where.map(async (search)=>{\r\n                return await new Promise(resolve=>{\r\n                  //query?.filter('version','==','1.0')\r\n                  query?.filter(...search)\r\n                  resolve()\r\n                })\r\n              }))\r\n            }\r\n\r\n            if(data?.take) query?.take(data?.take)\r\n            if(data?.skip) query?.take(data?.skip)\r\n            if(data?.order){\r\n              if(Array.isArray(data?.order)){\r\n                await Promise.all(data?.order.map(async (sort)=>{\r\n                  return await new Promise(resolve=>{\r\n                    query?.sort(...sort)\r\n                    resolve()\r\n                  })\r\n                }))\r\n              }\r\n            }\r\n            max=await query?.count()\r\n            result=await query?.get({...data?.$option})?.catch((e)=>error)\r\n            break;\r\n          case 'delete':\r\n            result=await this.#db?.ref(path)?.get()?.catch((e)=>error)\r\n            await this.#db?.ref(path)?.remove()?.catch((e)=>error)\r\n            break;\r\n        }\r\n        if(method!=='delete' && method!=='query')\r\n        result=await this.#db?.ref(path)?.get({...data?.$option})?.catch((e)=>error)\r\n        if(method==='query'){\r\n          if(result.exists()){\r\n            result=result?.getValues()\r\n            result={\r\n              data:result,\r\n              max,\r\n              take:data?.take,\r\n              skip:data?.skip\r\n            }\r\n\r\n          }else {\r\n            result={\r\n              ...error\r\n            }\r\n          }\r\n        }else {\r\n          if(result.exists()){\r\n            result=result?.val()\r\n            result={\r\n              data:result\r\n            }\r\n\r\n          }else {\r\n            result={\r\n              ...error\r\n            }\r\n          }\r\n        }\r\n        if(this.#syncWithLocal && node.auth().$currentUserId)\r\n        if(!this.#dataBaseConnected && ['create','delete','update'].includes(method)){\r\n          if(result?.data){\r\n\r\n            let trans=await this.#db?.ref(transaction)?.get()?.catch((e)=>error)\r\n            if(trans.exists()){\r\n              trans=trans.val()\r\n            }else {\r\n              trans={}\r\n            }\r\n            let cuid\r\n            let keys=Object.keys(trans)\r\n            if(keys.length>0){\r\n              cuid=keys.length+1\r\n            }else {\r\n              cuid=0\r\n            }\r\n            switch (method) {\r\n              case 'create':\r\n                 method='post'\r\n                break;\r\n              case 'update':\r\n                method='put'\r\n                break;\r\n              case 'delete':\r\n                method='delete'\r\n                break;\r\n            }\r\n            if(method!=='get')\r\n            await this.#db?.ref(transaction+'/'+cuid)?.set({\r\n              path:path,\r\n              method,\r\n              uid:cuid,\r\n              value:result.data\r\n            })?.catch((e)=>error)\r\n\r\n          }\r\n\r\n        }\r\n\r\n\r\n\r\n        /*try {\r\n          result=JSON.parse(result)\r\n        }catch (e) {\r\n          result={}\r\n        }\r\n\r\n        if(typeof result!='object') result={}\r\n        //console.log('database: ', result)\r\n        result=await pathToJson(result,method,path,data)\r\n        if(method!=='get')\r\n        await new Promise((resolve)=>{\r\n          try {\r\n            let newDatabase=result?.database\r\n            delete result.database\r\n            db?.['setItem'](database,JSON.stringify(newDatabase))\r\n          }catch (e) {\r\n\r\n          }\r\n          resolve()\r\n        })*/\r\n\r\n        const listenLocal=this.#listen\r\n        let eventName=API_VERSION?.STORAGE+listenLocal+path+'/'+method\r\n        //console.log('eventName: ',eventName)\r\n        eventName=eventName.replace(/\\/\\//g,'/')\r\n        this.#eventEmitter.emit(eventName,result)\r\n        if(typeof callback=='function'){\r\n          callback({...node,value:result})\r\n        }\r\n        return result\r\n      }\r\n      let handler=handlerRequest()\r\n      removeCommonValue()\r\n      return {...node,val:()=>handler}\r\n    }\r\n    let ready=(callback,socket)=>{\r\n      if(typeof callback=='function')\r\n        socket?.on('connect',callback)\r\n    }\r\n    let event=(path,socket)=>{\r\n      let ref='%'+path\r\n      let parent=this.init(req)?.storage()\r\n      return {\r\n        private:(id=generateQuickGuid())=>{\r\n          return parent.event(path + id)\r\n        },\r\n        child:(childPath)=>{\r\n          return parent.event(path + childPath)\r\n        },\r\n        push:(data,callback)=>{\r\n          let event=parent.event(path)\r\n          socket?.emit(ref,data)\r\n          if(typeof callback=='function') event?.onValue(callback)\r\n          return {\r\n            ...event,\r\n            ...parent\r\n          }\r\n        },\r\n        onValue:(callback)=>{\r\n          let event=parent.event(path)\r\n          socket?.on(ref,(result)=>{\r\n            if(typeof callback=='function')\r\n              callback({\r\n                ...event,\r\n                ...parent,\r\n                value:result\r\n              })\r\n          })\r\n          return {\r\n            ...event,\r\n            ...parent\r\n          }\r\n        },\r\n        onAnyValue:(callback)=>{\r\n          socket?.onAny((eventName,args)=>{\r\n            let event=parent.event(eventName)\r\n            if(typeof callback =='function') callback(\r\n              eventName,\r\n              {\r\n                value:args,\r\n                ...event,\r\n                ...parent\r\n              }\r\n            )\r\n          })\r\n          return {\r\n            ...parent\r\n          }\r\n        }\r\n      }\r\n    }\r\n    let apiService=(node,config,socket)=>{\r\n      return {\r\n        ...node,\r\n        $io:socket,\r\n        connected:()=>{\r\n          return socket?.connected\r\n        },\r\n        event:(path)=>{\r\n          return event(path,socket)\r\n        },\r\n        ready:(callback)=>{\r\n          return ready(callback,socket)\r\n        },\r\n        ref:(path='')=>{\r\n          return node.ref(path,config,socket)\r\n        }\r\n      }\r\n    }\r\n    return {\r\n      $connected:this.#dataBaseConnected,\r\n      activity:()=>{\r\n        let parent=this.init(req)\r\n        return { //window activities like onload...etc\r\n          onStart:(callback)=>{//DOMContentLoaded\r\n            //useful when u don't want to wait external assets data to load ( css,img , js), only DOM ex: <img id=''>\r\n            if(typeof callback=='function')\r\n            document.addEventListener(\"DOMContentLoaded\", callback)\r\n            return {\r\n              ...parent,\r\n              ...parent.activity()\r\n            }\r\n          },\r\n          onCreate:(callback)=>{//onload\r\n            // when all elements/resources(img,styles...) are fully loaded\r\n            if(typeof callback=='function')\r\n            window.onload = callback\r\n            return {\r\n              ...parent,\r\n              ...parent.activity()\r\n            }\r\n          },\r\n          onPause:(callback)=>{//beforeunload'\r\n            window.addEventListener('beforeunload',function (e) {\r\n              // user want to reload page , and u want to save some data  before\r\n              if(typeof callback=='function')\r\n                callback()\r\n              e.returnValue='onbeforeunload'\r\n            })\r\n            return {\r\n              ...parent,\r\n              ...parent.activity()\r\n            }\r\n          },\r\n          onResume:()=>{//for native devices\r\n            return {\r\n              ...parent,\r\n              ...parent.activity()\r\n            }\r\n          },\r\n          onLeave:(callback)=>{//onunload\r\n            // user quit the page, we can do something in background ( set in ur database, user is offline)\r\n            if(typeof callback=='function')\r\n            window.onunload = callback\r\n            return {\r\n              ...parent,\r\n              ...parent.activity()\r\n            }\r\n          },\r\n        }\r\n      },\r\n      socket:{\r\n        storage:req?.socket?.storage,\r\n      },\r\n      $randomUID:()=>v4(),\r\n      $randomId:()=>generateQuickGuid(),\r\n      $axios:AxiosService,\r\n      local:(config={})=>{ //for offline mode\r\n        const local=this.init(req)\r\n        delete local.local\r\n        delete local.auth().register\r\n        delete local.auth().login\r\n        return {\r\n          database:(dataRef='/database')=>{// NoSQL only,  sync with the cache and the remote database,  if offline it will send data in background process\r\n\r\n            return {\r\n              ref:(path='/database')=>{\r\n                let parent=this.init(req)\r\n                delete parent.auth().login\r\n                delete parent.auth().register\r\n                path=path.trim()\r\n                path=path.replace(/\\/\\//g,'/')\r\n                dataRef=dataRef+'/'+path\r\n                dataRef=dataRef.replace(/\\/\\//g,'/')\r\n\r\n                if(path.charAt(path.length-1)==='/') path=path.slice(0, -1)\r\n                return {\r\n                  child:(childRef='')=>{\r\n                    childRef=childRef.trim()\r\n                    childRef=childRef.replace(/\\/\\//g,'/')\r\n                    if(childRef.charAt(childRef.length-1)==='/') childRef=childRef.slice(0, -1)\r\n                    if(childRef.charAt(0)!=='/') childRef='/'+childRef\r\n                    return parent.local()?.database()?.ref(path+childRef)\r\n                  },\r\n                  push:(...args)=>{\r\n                    let generatedUID=v4()\r\n                    if(!args.length>0){\r\n                      return {\r\n                        getKey:()=>generatedUID\r\n                      }\r\n                    }else {\r\n                      return parent.local()?.database()?.ref(path+'/'+generatedUID).create(args)\r\n                    }\r\n                  },\r\n                  create:(...args)=>{\r\n                    let node={\r\n                      ...parent.local(config)?.database()?.ref(path),\r\n                      ...parent\r\n                    }\r\n                    let {data,callback}=extractArgs(args)\r\n                    return localDatabase(config,'create',dataRef,data,node,callback)\r\n\r\n                  },\r\n                  get:(...args)=>{\r\n                    let node={\r\n                      ...parent.local()?.database()?.ref(path),\r\n                      ...parent\r\n                    }\r\n                    let {data,callback}=extractArgs(args)\r\n                    return localDatabase('get',dataRef,data,node,callback)\r\n                  },\r\n                  find:(...args)=>{\r\n                    let node={\r\n                      ...parent.local()?.database()?.ref(path),\r\n                      ...parent\r\n                    }\r\n                    let {data,callback}=extractArgs(args)\r\n                    return localDatabase('get',dataRef,data,node,callback)\r\n                  },\r\n                  query:()=>{},\r\n                  update:(...args)=>{\r\n                    let node={\r\n                      ...parent.local()?.database()?.ref(path),\r\n                      ...parent\r\n                    }\r\n                    let {data,callback}=extractArgs(args)\r\n                    return localDatabase('update',dataRef,data,node,callback)\r\n\r\n                  },\r\n                  delete:(...args)=>{\r\n                    let node={\r\n                      ...parent.local()?.database()?.ref(path),\r\n                      ...parent\r\n                    }\r\n                    let {data,callback}=extractArgs(args)\r\n                    return localDatabase('delete',dataRef,data,node,callback)\r\n                  },\r\n                  on:()=>{\r\n                    let node={\r\n                      ...parent.local()?.database()?.ref(path),\r\n                      ...parent\r\n                    }\r\n                    return emitterListener(path, node);\r\n                  },\r\n                  onValue:(callback)=>{\r\n                    let node={\r\n                      ...parent.local()?.database()?.ref(path),\r\n                      ...parent\r\n                    }\r\n                    let listen=parent.local()?.database()?.ref(path)\r\n                    listen?.on()?.create(callback)\r\n                    listen?.on()?.update(callback)\r\n                    listen?.on()?.delete(callback)\r\n                    return node\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          },\r\n          cache:(path='/cache')=>{// NoSQL only, because we will save it in the browser.The data won't be sent to the remote server.\r\n            let parent=this.init(req)\r\n            delete parent.auth().login\r\n            delete parent.auth().register\r\n            return parent.local()?.database(path)\r\n          },\r\n          storage:()=>{// Will be only available for native device to read internal storage and permissions (android, PC, Mac)\r\n            return {\r\n\r\n            }\r\n          }\r\n        }\r\n      },\r\n      cron:(config)=>{},\r\n      task:(config)=>{},\r\n      storage:(location='local',config)=>{\r\n        this.#syncWithLocal=false\r\n        this.#storage=location\r\n        switch (location) {\r\n          case 'aws':\r\n            break;\r\n          case 'discord':\r\n            this.#storageConfig={\r\n              token:config?.token,\r\n              channelId:config?.channelId\r\n            }\r\n            break;\r\n        }\r\n        const storage=this.init(req)\r\n        delete storage.storage\r\n        delete storage.auth().register\r\n        delete storage.auth().login\r\n\r\n        return apiService(storage,{\r\n          host:HOST_SERVER.STORAGE,\r\n          version:API_VERSION.STORAGE,\r\n          base:storageRoute.base\r\n        },req?.socket?.storage)\r\n\r\n      },\r\n      //for browser to detect if there is connection\r\n      //visit: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/onLine\r\n      $online:navigator?.onLine,\r\n      auth:()=>{\r\n        return {\r\n          req:(path,data,callback)=>{\r\n            let parent=this.init(req)\r\n            delete parent.auth().login\r\n            delete parent.auth().register\r\n            let node={\r\n              ...parent,\r\n              ...parent.auth()\r\n            }\r\n            return authRequest(path+authRoute.req,data,null,node,callback)\r\n          },\r\n        }\r\n      },\r\n      syncDatabase:(shouldSync=true)=>{ //Sync with local database\r\n        const sync=this.init(req)\r\n        this.#syncWithLocal=typeof shouldSync =='boolean'?shouldSync:true\r\n        return sync.database()\r\n      },\r\n      ref:(path='',config={\r\n        host:HOST_SERVER.STORAGE,\r\n        version:API_VERSION.STORAGE,\r\n        base:storageRoute.base\r\n      },socket=req?.socket?.database,requireAuth=true)=>{\r\n        path=path.trim()\r\n        path=path.replace(/\\/\\//g,'/')\r\n        if(path.charAt(0)==='/' && path.length<=1) path='/root'\r\n        if(path.charAt(path.length-1)==='/') path=path.slice(0, -1)\r\n        const ref=config.host+config.version+config.base+path\r\n        let parent=this.init(req)\r\n        delete parent.auth().login\r\n        delete parent.auth().register\r\n        this.#requireAuth=requireAuth\r\n        let requestRef={\r\n          push:(...args)=>{\r\n            let generatedUID=v4()\r\n            if(!args.length>0){\r\n              return {\r\n                getKey:()=>generatedUID\r\n              }\r\n            }else {\r\n              return parent.ref(path+'/'+generatedUID,config,socket).create(args)\r\n            }\r\n          },\r\n          private:(id=generateQuickGuid())=>{\r\n            //private /ps**/pe will be removed on server,\r\n            //Will send /ps**/pe in socket only\r\n            return parent.ref(path + '/ps' + id + '/pe',config,socket)\r\n          },\r\n          setAuthAccess:(required=true,redirect=this.#redirectTo)=>{\r\n            this.#redirectTo=redirect\r\n            return parent.ref(path,config,socket,required)\r\n          },\r\n          req:(...args)=>{\r\n            let node={\r\n              ...parent.ref(path,config,socket),\r\n              ...parent\r\n            }\r\n            if(args.length>=2){\r\n              let [method='post',data={},onRequest={},callback]=args\r\n              if((typeof method==='string' && ['post','put','delete','get'].includes(method))){\r\n                let customPath=crudRoute.req\r\n                return dataRequest(method,ref+customPath,data,onRequest,node,callback)\r\n              }\r\n              return node\r\n            }else {\r\n              let callback=args.filter(arg=>typeof arg=='function')\r\n              if(callback.length>0){\r\n                callback=callback[0]\r\n                if(typeof callback=='function')\r\n                callback(node)\r\n              }else {\r\n                return node\r\n              }\r\n            }\r\n\r\n          },\r\n          child:(childRef='')=>{\r\n            childRef=childRef.trim()\r\n            childRef=childRef.replace(/\\/\\//g,'/')\r\n            if(childRef.charAt(childRef.length-1)==='/') childRef=childRef.slice(0, -1)\r\n            if(childRef.charAt(0)!=='/') childRef='/'+childRef\r\n            return parent.ref(path+childRef,config,socket)\r\n          },\r\n          set:(...args)=>parent.ref(path,config,socket)?.create(...args),\r\n          create:(...args)=>{\r\n            //do online request\r\n            let {data,onRequest,callback}=extractArgs(args)\r\n            let customPath=crudRoute.create.one\r\n            if(this.#storage){\r\n              if(data?.file || data?.directory){\r\n                return  parent.ref(path)?.upload(data,null, callback)\r\n              }else {\r\n                if(Array.isArray(data.folders)) customPath=crudRoute.create.many\r\n              }\r\n            }\r\n            else if(Array?.isArray(data)){\r\n              customPath=crudRoute.create.many\r\n            }\r\n            return dataRequest('post',ref+customPath,data,onRequest,node,callback)\r\n\r\n          },\r\n          find:(...args)=>{\r\n            //do online request\r\n            if(ENV==='dev') console.log('Find: We are online')\r\n            let node={\r\n              ...parent.ref(path,config,socket),\r\n              ...parent\r\n            }\r\n            let {data,onRequest,callback}=extractArgs(args)\r\n            let customPath=crudRoute.find.one\r\n            if(this.#storage){\r\n              if(Array.isArray(data?.files) || Array.isArray(data?.folders)){\r\n                if(Array.isArray(data?.files)) data.isFolder=false\r\n                if(Array.isArray(data?.folders)) data.isFolder=true\r\n                customPath=crudRoute.find.many\r\n              }\r\n            }\r\n            else if(Object.keys(data)?.length<=0 || data.order || data.where || data.$option || data.skip || data.take){\r\n              customPath=crudRoute.find.many\r\n            }\r\n            return dataRequest('post',ref+customPath,data,onRequest,node,callback)\r\n\r\n\r\n          },\r\n          get:(...args)=>{\r\n            //do online request\r\n            let node={\r\n              ...parent.ref(path,config,socket),\r\n              ...parent\r\n            }\r\n            let {data,onRequest,callback}=extractArgs(args)\r\n            let customPath=crudRoute.get.one\r\n            if(this.#storage){\r\n              if(Array.isArray(data?.files) || Array.isArray(data?.folders)){\r\n                if(Array.isArray(data?.files)) data.isFolder=false\r\n                if(Array.isArray(data?.folders)) data.isFolder=true\r\n\r\n                customPath=crudRoute.get.many\r\n              }\r\n            }\r\n            else if(Object.keys(data)?.length<=0 || data.order || data.where || data.$option || data.skip || data.take){\r\n              customPath=crudRoute.get.many\r\n            }\r\n            return  dataRequest('get',ref+customPath+'?query='+JSON.stringify(axiosData(data)),null,onRequest,node,callback)\r\n          },\r\n          query:(...args)=>{\r\n            if(parent.auth().$currentUserId && config?.host===HOST_SERVER?.DATABASE && this.#syncWithLocal && !this.#dataBaseConnected){\r\n              //save data when offline to transaction and database locally, then do background process\r\n              // when online to send data and erase previous transaction\r\n              return parent.local()?.database()?.ref(path)?.query(...args)\r\n            }else {\r\n              //do online request\r\n              let node={\r\n                ...parent.ref(path,config,socket),\r\n                ...parent\r\n              }\r\n              let {data,onRequest,callback}=extractArgs(args)\r\n              //For SQL and NoSQL with TypeORM\r\n              /*const data={\r\n                    //relations:{comments:true}\r\n                    //where:  { token:token } for mysql, //where: { token:{$eq:token} } for mongodb\r\n                    //where:  data,\r\n                    order:{\r\n                      uid:'ASC',//DESC\r\n                    },\r\n                    //select:['fullName'],\r\n                    //skip:5, //where entities should start , pagination start\r\n                    //take:10, //number of data that should be taken , pagination end\r\n              }*/\r\n              //For Acebase database\r\n              /*const data={\r\n                where:  [\r\n                  ['version','==','1.0']\r\n                ],\r\n                order:[\r\n                  ['version']\r\n                ],\r\n                option:{\r\n                  exclude:['title','name'],\r\n                  include:['fullName'],\r\n                  snapshots:false //don't use snapshot\r\n                },\r\n                skip:5, //where entities should start , pagination start\r\n                take:10, //number of data that should be taken , pagination end\r\n              }*/\r\n\r\n              if(!data || data===''){\r\n                data={\r\n                  take:15\r\n                }\r\n                if(!this.#extrasRef && !data.order)\r\n                  data.order={\r\n                    uid:'ASC',\r\n                  }\r\n              }\r\n              return dataRequest('get',ref+crudRoute.get.many+'?query='+JSON.stringify(axiosData(data)),null,onRequest,node,callback)\r\n            }\r\n          },\r\n          update:(...args)=>{\r\n            //do online request\r\n            let node={\r\n              ...parent.ref(path,config,socket),\r\n              ...parent\r\n            }\r\n            let {data,onRequest,callback}=extractArgs(args)\r\n            let customPath=crudRoute.update.one\r\n            if(this.#storage){\r\n              if(Array.isArray(data?.files) || Array.isArray(data?.folders)){\r\n                if(Array.isArray(data?.files)) data.isFolder=false\r\n                if(Array.isArray(data?.folders)) data.isFolder=true\r\n                customPath=crudRoute.update.many\r\n              }\r\n            }\r\n            else if(Array.isArray(data)){\r\n              customPath=crudRoute.find.many\r\n            }\r\n            return dataRequest('put',ref+customPath,data,onRequest,node,callback)\r\n\r\n          },\r\n          delete:(...args)=>{\r\n            if(parent.auth().$currentUserId && config?.host===HOST_SERVER?.STORAGE && this.#syncWithLocal && !this.#dataBaseConnected){\r\n              //save data when offline to transaction and database locally, then do background process\r\n              // when online to send data and erase previous transaction\r\n              return parent.local()?.database()?.ref(path)?.delete(...args)\r\n            }else {\r\n              //do online request\r\n              let node={\r\n                ...parent.ref(path,config,socket),\r\n                ...parent\r\n              }\r\n              let {data,onRequest,callback}=extractArgs(args)\r\n              let customPath=crudRoute.delete.one\r\n              if(this.#storage){\r\n                if(Array.isArray(data?.files) || Array.isArray(data?.folders)){\r\n                  if(Array.isArray(data?.files)) data.isFolder=false\r\n                  if(Array.isArray(data?.folders)) data.isFolder=true\r\n                  if(Object.keys(data).length<=0) data.isFolder=true\r\n                  customPath=crudRoute.delete.many\r\n                }\r\n              }\r\n              else if(Array.isArray(data) || data.where){\r\n                customPath=crudRoute.delete.many\r\n              }\r\n              return dataRequest('delete',ref+customPath,data,onRequest,node,callback)\r\n            }\r\n          },\r\n          on:()=>{\r\n            let node={\r\n              ...parent.ref(path,config,socket),\r\n              ...parent\r\n            }\r\n            return socketListener(socket,config,node,path);\r\n          },\r\n          onValue:(callback)=>{\r\n            let node={\r\n              ...parent.ref(path,config,socket),\r\n              ...parent\r\n            }\r\n            let listen=parent.ref(path,config,socket)\r\n            listen?.on()?.create(callback)\r\n            listen?.on()?.update(callback)\r\n            listen?.on()?.delete(callback)\r\n            listen?.on()?.upload(callback)\r\n            return node\r\n          }\r\n        }\r\n        if(this.#storage){\r\n          requestRef.download=(...args)=>{\r\n            let node={\r\n              ...parent.ref(path,config,socket),\r\n              ...parent\r\n            }\r\n            let {data,onRequest,callback}=extractArgs(args)\r\n            let customPath=storageRoute.download.one\r\n            if(Array.isArray(data?.files) || Array.isArray(data?.folders)){\r\n              customPath=storageRoute.download.many\r\n            }\r\n            return dataRequest('get',ref+customPath+'?query='+JSON.stringify(axiosData(data)),null,onRequest,node,callback)\r\n\r\n          }\r\n          requestRef.upload=(...args)=>{\r\n            let node={\r\n              ...parent.ref(path,config,socket),\r\n              ...parent\r\n            }\r\n            let {data,onRequest,callback}=extractArgs(args)\r\n\r\n            /*//visit: https://thecodersblog.com/add-upload-progress-axios-request\r\n            onRequest={\r\n              onUploadProgress:(progress)=>{\r\n                const {loaded,total}=progress\r\n                let percent=Math.floor((loaded*100)/total)\r\n                if(percent<100){\r\n                  //do logic\r\n                  //console.log(loaded, 'bytes of ',total,' bytes. ', percent)\r\n                }\r\n              }\r\n            }*/\r\n\r\n            let customPath=storageRoute.upload+'?query='+JSON.stringify({\r\n              storage:this.#storage,\r\n              config:this.#storageConfig\r\n            })\r\n            /*if(Array.isArray(data?.file) || Array.isArray(data?.directory)){\r\n              customPath='/upload?storage='+this.#storage\r\n            }*/\r\n            return dataRequest('post', ref + customPath, data, onRequest, node, callback,);\r\n\r\n          }\r\n        }\r\n        return requestRef\r\n      },\r\n\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\nconst RemoteService={\r\n  init:(config)=>{\r\n    try{\r\n      return (req={})=>new SwygerClient(config).init(req)\r\n    }catch (e) {\r\n      return {}\r\n    }\r\n\r\n  },\r\n\r\n}\r\nexport default RemoteService\r\n","let Config={\r\n    init:(ClientConfig)=>{\r\n        return {\r\n            //Configure the offline DB\r\n            OFFLINE_DB_NAME:{\r\n                STORAGE:ClientConfig?.OFFLINE_DB_NAME?.STORAGE||'swyger_storage'\r\n            },\r\n\r\n            //Configure the server\r\n            ENV:ClientConfig?.ENV||'prod',\r\n            HOST_SERVER:{\r\n                AUTH:ClientConfig?.HOST_SERVER?.AUTH||'http://localhost:4100', //Required for protected route\r\n                STORAGE:ClientConfig?.HOST_SERVER?.STORAGE||'http://localhost:4500',\r\n            },\r\n            API_VERSION:{\r\n                AUTH:ClientConfig?.API_VERSION?.AUTH||'/api/v1',\r\n                STORAGE:ClientConfig?.API_VERSION?.STORAGE||'/api/v1',\r\n            },\r\n            AUTO_REFRESH_TOKEN_TIMEOUT:ClientConfig?.AUTO_REFRESH_TOKEN_TIMEOUT||1500000, //in millisecond= 25 minutes\r\n            API_KEY:ClientConfig?.API_KEY||'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJzd3lnZXIuY29tIiwiaWF0IjoxNjUzNDQwOTkxLCJleHAiOjE2ODQ5NzY5OTEsImF1ZCI6ImRheW52ZXIuY29tIiwic3ViIjoidGVhbUBzd3lnZXIuY29tIiwiR2l2ZW5OYW1lIjoiSXZhbiBKb2VsIiwiU3VybmFtZSI6IlNvYmd1aSIsIkVtYWlsIjoidGVhbUBhZ2dsb215LmNvbSIsIlJvbGUiOlsiQWRtaW4iLCJQcm9qZWN0IEFkbWluaXN0cmF0b3IiXX0.UvlcjBahR9G8dKxIeENJ7k4I87t3_oNJQ16eyPsRcSE'\r\n        }\r\n    }\r\n}\r\nexport default Config\r\n\r\n","import SocketService from \"./api/socket_io/index.service\";\r\nimport RemoteService from \"./api\";\r\nimport Config from \"./api/env\";\r\n\r\n\r\n\r\nconst SwygerStorageClient= {\r\n    init:(ClientConfig)=>{\r\n        let config=Config.init(ClientConfig)\r\n        const service = SocketService.init(config)\r\n        const req={\r\n            socket:{\r\n                storage:service?.storage\r\n            }\r\n        }\r\n        const remote= RemoteService.init(config)\r\n        return remote(req)\r\n    }\r\n}\r\n\r\nexport default SwygerStorageClient","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport default {\r\n    __extends,\r\n    __assign,\r\n    __rest,\r\n    __decorate,\r\n    __param,\r\n    __metadata,\r\n    __awaiter,\r\n    __generator,\r\n    __createBinding,\r\n    __exportStar,\r\n    __values,\r\n    __read,\r\n    __spread,\r\n    __spreadArrays,\r\n    __spreadArray,\r\n    __await,\r\n    __asyncGenerator,\r\n    __asyncDelegator,\r\n    __asyncValues,\r\n    __makeTemplateObject,\r\n    __importStar,\r\n    __importDefault,\r\n    __classPrivateFieldGet,\r\n    __classPrivateFieldSet,\r\n    __classPrivateFieldIn,\r\n};\r\n","export function isFunction(value) {\n    return typeof value === 'function';\n}\n//# sourceMappingURL=isFunction.js.map","export function createErrorClass(createImpl) {\n    var _super = function (instance) {\n        Error.call(instance);\n        instance.stack = new Error().stack;\n    };\n    var ctorFunc = createImpl(_super);\n    ctorFunc.prototype = Object.create(Error.prototype);\n    ctorFunc.prototype.constructor = ctorFunc;\n    return ctorFunc;\n}\n//# sourceMappingURL=createErrorClass.js.map","import { createErrorClass } from './createErrorClass';\nexport var UnsubscriptionError = createErrorClass(function (_super) {\n    return function UnsubscriptionErrorImpl(errors) {\n        _super(this);\n        this.message = errors\n            ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ')\n            : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n    };\n});\n//# sourceMappingURL=UnsubscriptionError.js.map","export function arrRemove(arr, item) {\n    if (arr) {\n        var index = arr.indexOf(item);\n        0 <= index && arr.splice(index, 1);\n    }\n}\n//# sourceMappingURL=arrRemove.js.map","import { __read, __spreadArray, __values } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { arrRemove } from './util/arrRemove';\nvar Subscription = (function () {\n    function Subscription(initialTeardown) {\n        this.initialTeardown = initialTeardown;\n        this.closed = false;\n        this._parentage = null;\n        this._finalizers = null;\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var e_1, _a, e_2, _b;\n        var errors;\n        if (!this.closed) {\n            this.closed = true;\n            var _parentage = this._parentage;\n            if (_parentage) {\n                this._parentage = null;\n                if (Array.isArray(_parentage)) {\n                    try {\n                        for (var _parentage_1 = __values(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {\n                            var parent_1 = _parentage_1_1.value;\n                            parent_1.remove(this);\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                }\n                else {\n                    _parentage.remove(this);\n                }\n            }\n            var initialFinalizer = this.initialTeardown;\n            if (isFunction(initialFinalizer)) {\n                try {\n                    initialFinalizer();\n                }\n                catch (e) {\n                    errors = e instanceof UnsubscriptionError ? e.errors : [e];\n                }\n            }\n            var _finalizers = this._finalizers;\n            if (_finalizers) {\n                this._finalizers = null;\n                try {\n                    for (var _finalizers_1 = __values(_finalizers), _finalizers_1_1 = _finalizers_1.next(); !_finalizers_1_1.done; _finalizers_1_1 = _finalizers_1.next()) {\n                        var finalizer = _finalizers_1_1.value;\n                        try {\n                            execFinalizer(finalizer);\n                        }\n                        catch (err) {\n                            errors = errors !== null && errors !== void 0 ? errors : [];\n                            if (err instanceof UnsubscriptionError) {\n                                errors = __spreadArray(__spreadArray([], __read(errors)), __read(err.errors));\n                            }\n                            else {\n                                errors.push(err);\n                            }\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (_finalizers_1_1 && !_finalizers_1_1.done && (_b = _finalizers_1.return)) _b.call(_finalizers_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n            if (errors) {\n                throw new UnsubscriptionError(errors);\n            }\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var _a;\n        if (teardown && teardown !== this) {\n            if (this.closed) {\n                execFinalizer(teardown);\n            }\n            else {\n                if (teardown instanceof Subscription) {\n                    if (teardown.closed || teardown._hasParent(this)) {\n                        return;\n                    }\n                    teardown._addParent(this);\n                }\n                (this._finalizers = (_a = this._finalizers) !== null && _a !== void 0 ? _a : []).push(teardown);\n            }\n        }\n    };\n    Subscription.prototype._hasParent = function (parent) {\n        var _parentage = this._parentage;\n        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _parentage = this._parentage;\n        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;\n    };\n    Subscription.prototype._removeParent = function (parent) {\n        var _parentage = this._parentage;\n        if (_parentage === parent) {\n            this._parentage = null;\n        }\n        else if (Array.isArray(_parentage)) {\n            arrRemove(_parentage, parent);\n        }\n    };\n    Subscription.prototype.remove = function (teardown) {\n        var _finalizers = this._finalizers;\n        _finalizers && arrRemove(_finalizers, teardown);\n        if (teardown instanceof Subscription) {\n            teardown._removeParent(this);\n        }\n    };\n    Subscription.EMPTY = (function () {\n        var empty = new Subscription();\n        empty.closed = true;\n        return empty;\n    })();\n    return Subscription;\n}());\nexport { Subscription };\nexport var EMPTY_SUBSCRIPTION = Subscription.EMPTY;\nexport function isSubscription(value) {\n    return (value instanceof Subscription ||\n        (value && 'closed' in value && isFunction(value.remove) && isFunction(value.add) && isFunction(value.unsubscribe)));\n}\nfunction execFinalizer(finalizer) {\n    if (isFunction(finalizer)) {\n        finalizer();\n    }\n    else {\n        finalizer.unsubscribe();\n    }\n}\n//# sourceMappingURL=Subscription.js.map","export var config = {\n    onUnhandledError: null,\n    onStoppedNotification: null,\n    Promise: undefined,\n    useDeprecatedSynchronousErrorHandling: false,\n    useDeprecatedNextContext: false,\n};\n//# sourceMappingURL=config.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var timeoutProvider = {\n    setTimeout: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = timeoutProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) {\n            return delegate.setTimeout.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setTimeout.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearTimeout: function (handle) {\n        var delegate = timeoutProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=timeoutProvider.js.map","import { config } from '../config';\nimport { timeoutProvider } from '../scheduler/timeoutProvider';\nexport function reportUnhandledError(err) {\n    timeoutProvider.setTimeout(function () {\n        var onUnhandledError = config.onUnhandledError;\n        if (onUnhandledError) {\n            onUnhandledError(err);\n        }\n        else {\n            throw err;\n        }\n    });\n}\n//# sourceMappingURL=reportUnhandledError.js.map","export function noop() { }\n//# sourceMappingURL=noop.js.map","export var COMPLETE_NOTIFICATION = (function () { return createNotification('C', undefined, undefined); })();\nexport function errorNotification(error) {\n    return createNotification('E', undefined, error);\n}\nexport function nextNotification(value) {\n    return createNotification('N', value, undefined);\n}\nexport function createNotification(kind, value, error) {\n    return {\n        kind: kind,\n        value: value,\n        error: error,\n    };\n}\n//# sourceMappingURL=NotificationFactories.js.map","import { config } from '../config';\nvar context = null;\nexport function errorContext(cb) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        var isRoot = !context;\n        if (isRoot) {\n            context = { errorThrown: false, error: null };\n        }\n        cb();\n        if (isRoot) {\n            var _a = context, errorThrown = _a.errorThrown, error = _a.error;\n            context = null;\n            if (errorThrown) {\n                throw error;\n            }\n        }\n    }\n    else {\n        cb();\n    }\n}\nexport function captureError(err) {\n    if (config.useDeprecatedSynchronousErrorHandling && context) {\n        context.errorThrown = true;\n        context.error = err;\n    }\n}\n//# sourceMappingURL=errorContext.js.map","import { __extends } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { isSubscription, Subscription } from './Subscription';\nimport { config } from './config';\nimport { reportUnhandledError } from './util/reportUnhandledError';\nimport { noop } from './util/noop';\nimport { nextNotification, errorNotification, COMPLETE_NOTIFICATION } from './NotificationFactories';\nimport { timeoutProvider } from './scheduler/timeoutProvider';\nimport { captureError } from './util/errorContext';\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destination) {\n        var _this = _super.call(this) || this;\n        _this.isStopped = false;\n        if (destination) {\n            _this.destination = destination;\n            if (isSubscription(destination)) {\n                destination.add(_this);\n            }\n        }\n        else {\n            _this.destination = EMPTY_OBSERVER;\n        }\n        return _this;\n    }\n    Subscriber.create = function (next, error, complete) {\n        return new SafeSubscriber(next, error, complete);\n    };\n    Subscriber.prototype.next = function (value) {\n        if (this.isStopped) {\n            handleStoppedNotification(nextNotification(value), this);\n        }\n        else {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (this.isStopped) {\n            handleStoppedNotification(errorNotification(err), this);\n        }\n        else {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (this.isStopped) {\n            handleStoppedNotification(COMPLETE_NOTIFICATION, this);\n        }\n        else {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            this.isStopped = true;\n            _super.prototype.unsubscribe.call(this);\n            this.destination = null;\n        }\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        try {\n            this.destination.error(err);\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    Subscriber.prototype._complete = function () {\n        try {\n            this.destination.complete();\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar _bind = Function.prototype.bind;\nfunction bind(fn, thisArg) {\n    return _bind.call(fn, thisArg);\n}\nvar ConsumerObserver = (function () {\n    function ConsumerObserver(partialObserver) {\n        this.partialObserver = partialObserver;\n    }\n    ConsumerObserver.prototype.next = function (value) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.next) {\n            try {\n                partialObserver.next(value);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    ConsumerObserver.prototype.error = function (err) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.error) {\n            try {\n                partialObserver.error(err);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n        else {\n            handleUnhandledError(err);\n        }\n    };\n    ConsumerObserver.prototype.complete = function () {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.complete) {\n            try {\n                partialObserver.complete();\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    return ConsumerObserver;\n}());\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        var partialObserver;\n        if (isFunction(observerOrNext) || !observerOrNext) {\n            partialObserver = {\n                next: (observerOrNext !== null && observerOrNext !== void 0 ? observerOrNext : undefined),\n                error: error !== null && error !== void 0 ? error : undefined,\n                complete: complete !== null && complete !== void 0 ? complete : undefined,\n            };\n        }\n        else {\n            var context_1;\n            if (_this && config.useDeprecatedNextContext) {\n                context_1 = Object.create(observerOrNext);\n                context_1.unsubscribe = function () { return _this.unsubscribe(); };\n                partialObserver = {\n                    next: observerOrNext.next && bind(observerOrNext.next, context_1),\n                    error: observerOrNext.error && bind(observerOrNext.error, context_1),\n                    complete: observerOrNext.complete && bind(observerOrNext.complete, context_1),\n                };\n            }\n            else {\n                partialObserver = observerOrNext;\n            }\n        }\n        _this.destination = new ConsumerObserver(partialObserver);\n        return _this;\n    }\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\nfunction handleUnhandledError(error) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        captureError(error);\n    }\n    else {\n        reportUnhandledError(error);\n    }\n}\nfunction defaultErrorHandler(err) {\n    throw err;\n}\nfunction handleStoppedNotification(notification, subscriber) {\n    var onStoppedNotification = config.onStoppedNotification;\n    onStoppedNotification && timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });\n}\nexport var EMPTY_OBSERVER = {\n    closed: true,\n    next: noop,\n    error: defaultErrorHandler,\n    complete: noop,\n};\n//# sourceMappingURL=Subscriber.js.map","export var observable = (function () { return (typeof Symbol === 'function' && Symbol.observable) || '@@observable'; })();\n//# sourceMappingURL=observable.js.map","export function identity(x) {\n    return x;\n}\n//# sourceMappingURL=identity.js.map","import { identity } from './identity';\nexport function pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexport function pipeFromArray(fns) {\n    if (fns.length === 0) {\n        return identity;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\n//# sourceMappingURL=pipe.js.map","import { SafeSubscriber, Subscriber } from './Subscriber';\nimport { isSubscription } from './Subscription';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\nimport { isFunction } from './util/isFunction';\nimport { errorContext } from './util/errorContext';\nvar Observable = (function () {\n    function Observable(subscribe) {\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var _this = this;\n        var subscriber = isSubscriber(observerOrNext) ? observerOrNext : new SafeSubscriber(observerOrNext, error, complete);\n        errorContext(function () {\n            var _a = _this, operator = _a.operator, source = _a.source;\n            subscriber.add(operator\n                ?\n                    operator.call(subscriber, source)\n                : source\n                    ?\n                        _this._subscribe(subscriber)\n                    :\n                        _this._trySubscribe(subscriber));\n        });\n        return subscriber;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            sink.error(err);\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscriber = new SafeSubscriber({\n                next: function (value) {\n                    try {\n                        next(value);\n                    }\n                    catch (err) {\n                        reject(err);\n                        subscriber.unsubscribe();\n                    }\n                },\n                error: reject,\n                complete: resolve,\n            });\n            _this.subscribe(subscriber);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var _a;\n        return (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber);\n    };\n    Observable.prototype[Symbol_observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        return pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return (value = x); }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexport { Observable };\nfunction getPromiseCtor(promiseCtor) {\n    var _a;\n    return (_a = promiseCtor !== null && promiseCtor !== void 0 ? promiseCtor : config.Promise) !== null && _a !== void 0 ? _a : Promise;\n}\nfunction isObserver(value) {\n    return value && isFunction(value.next) && isFunction(value.error) && isFunction(value.complete);\n}\nfunction isSubscriber(value) {\n    return (value && value instanceof Subscriber) || (isObserver(value) && isSubscription(value));\n}\n//# sourceMappingURL=Observable.js.map","import { isFunction } from './isFunction';\nexport function hasLift(source) {\n    return isFunction(source === null || source === void 0 ? void 0 : source.lift);\n}\nexport function operate(init) {\n    return function (source) {\n        if (hasLift(source)) {\n            return source.lift(function (liftedSource) {\n                try {\n                    return init(liftedSource, this);\n                }\n                catch (err) {\n                    this.error(err);\n                }\n            });\n        }\n        throw new TypeError('Unable to lift unknown Observable type');\n    };\n}\n//# sourceMappingURL=lift.js.map","import { __extends } from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function createOperatorSubscriber(destination, onNext, onComplete, onError, onFinalize) {\n    return new OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize);\n}\nvar OperatorSubscriber = (function (_super) {\n    __extends(OperatorSubscriber, _super);\n    function OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize, shouldUnsubscribe) {\n        var _this = _super.call(this, destination) || this;\n        _this.onFinalize = onFinalize;\n        _this.shouldUnsubscribe = shouldUnsubscribe;\n        _this._next = onNext\n            ? function (value) {\n                try {\n                    onNext(value);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n            }\n            : _super.prototype._next;\n        _this._error = onError\n            ? function (err) {\n                try {\n                    onError(err);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._error;\n        _this._complete = onComplete\n            ? function () {\n                try {\n                    onComplete();\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._complete;\n        return _this;\n    }\n    OperatorSubscriber.prototype.unsubscribe = function () {\n        var _a;\n        if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {\n            var closed_1 = this.closed;\n            _super.prototype.unsubscribe.call(this);\n            !closed_1 && ((_a = this.onFinalize) === null || _a === void 0 ? void 0 : _a.call(this));\n        }\n    };\n    return OperatorSubscriber;\n}(Subscriber));\nexport { OperatorSubscriber };\n//# sourceMappingURL=OperatorSubscriber.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function refCount() {\n    return operate(function (source, subscriber) {\n        var connection = null;\n        source._refCount++;\n        var refCounter = createOperatorSubscriber(subscriber, undefined, undefined, undefined, function () {\n            if (!source || source._refCount <= 0 || 0 < --source._refCount) {\n                connection = null;\n                return;\n            }\n            var sharedConnection = source._connection;\n            var conn = connection;\n            connection = null;\n            if (sharedConnection && (!conn || sharedConnection === conn)) {\n                sharedConnection.unsubscribe();\n            }\n            subscriber.unsubscribe();\n        });\n        source.subscribe(refCounter);\n        if (!refCounter.closed) {\n            connection = source.connect();\n        }\n    });\n}\n//# sourceMappingURL=refCount.js.map","import { __extends } from \"tslib\";\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { refCount as higherOrderRefCount } from '../operators/refCount';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { hasLift } from '../util/lift';\nvar ConnectableObservable = (function (_super) {\n    __extends(ConnectableObservable, _super);\n    function ConnectableObservable(source, subjectFactory) {\n        var _this = _super.call(this) || this;\n        _this.source = source;\n        _this.subjectFactory = subjectFactory;\n        _this._subject = null;\n        _this._refCount = 0;\n        _this._connection = null;\n        if (hasLift(source)) {\n            _this.lift = source.lift;\n        }\n        return _this;\n    }\n    ConnectableObservable.prototype._subscribe = function (subscriber) {\n        return this.getSubject().subscribe(subscriber);\n    };\n    ConnectableObservable.prototype.getSubject = function () {\n        var subject = this._subject;\n        if (!subject || subject.isStopped) {\n            this._subject = this.subjectFactory();\n        }\n        return this._subject;\n    };\n    ConnectableObservable.prototype._teardown = function () {\n        this._refCount = 0;\n        var _connection = this._connection;\n        this._subject = this._connection = null;\n        _connection === null || _connection === void 0 ? void 0 : _connection.unsubscribe();\n    };\n    ConnectableObservable.prototype.connect = function () {\n        var _this = this;\n        var connection = this._connection;\n        if (!connection) {\n            connection = this._connection = new Subscription();\n            var subject_1 = this.getSubject();\n            connection.add(this.source.subscribe(createOperatorSubscriber(subject_1, undefined, function () {\n                _this._teardown();\n                subject_1.complete();\n            }, function (err) {\n                _this._teardown();\n                subject_1.error(err);\n            }, function () { return _this._teardown(); })));\n            if (connection.closed) {\n                this._connection = null;\n                connection = Subscription.EMPTY;\n            }\n        }\n        return connection;\n    };\n    ConnectableObservable.prototype.refCount = function () {\n        return higherOrderRefCount()(this);\n    };\n    return ConnectableObservable;\n}(Observable));\nexport { ConnectableObservable };\n//# sourceMappingURL=ConnectableObservable.js.map","export var performanceTimestampProvider = {\n    now: function () {\n        return (performanceTimestampProvider.delegate || performance).now();\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=performanceTimestampProvider.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { Subscription } from '../Subscription';\nexport var animationFrameProvider = {\n    schedule: function (callback) {\n        var request = requestAnimationFrame;\n        var cancel = cancelAnimationFrame;\n        var delegate = animationFrameProvider.delegate;\n        if (delegate) {\n            request = delegate.requestAnimationFrame;\n            cancel = delegate.cancelAnimationFrame;\n        }\n        var handle = request(function (timestamp) {\n            cancel = undefined;\n            callback(timestamp);\n        });\n        return new Subscription(function () { return cancel === null || cancel === void 0 ? void 0 : cancel(handle); });\n    },\n    requestAnimationFrame: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var delegate = animationFrameProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.requestAnimationFrame) || requestAnimationFrame).apply(void 0, __spreadArray([], __read(args)));\n    },\n    cancelAnimationFrame: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var delegate = animationFrameProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.cancelAnimationFrame) || cancelAnimationFrame).apply(void 0, __spreadArray([], __read(args)));\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=animationFrameProvider.js.map","import { Observable } from '../../Observable';\nimport { performanceTimestampProvider } from '../../scheduler/performanceTimestampProvider';\nimport { animationFrameProvider } from '../../scheduler/animationFrameProvider';\nexport function animationFrames(timestampProvider) {\n    return timestampProvider ? animationFramesFactory(timestampProvider) : DEFAULT_ANIMATION_FRAMES;\n}\nfunction animationFramesFactory(timestampProvider) {\n    return new Observable(function (subscriber) {\n        var provider = timestampProvider || performanceTimestampProvider;\n        var start = provider.now();\n        var id = 0;\n        var run = function () {\n            if (!subscriber.closed) {\n                id = animationFrameProvider.requestAnimationFrame(function (timestamp) {\n                    id = 0;\n                    var now = provider.now();\n                    subscriber.next({\n                        timestamp: timestampProvider ? now : timestamp,\n                        elapsed: now - start,\n                    });\n                    run();\n                });\n            }\n        };\n        run();\n        return function () {\n            if (id) {\n                animationFrameProvider.cancelAnimationFrame(id);\n            }\n        };\n    });\n}\nvar DEFAULT_ANIMATION_FRAMES = animationFramesFactory();\n//# sourceMappingURL=animationFrames.js.map","import { createErrorClass } from './createErrorClass';\nexport var ObjectUnsubscribedError = createErrorClass(function (_super) {\n    return function ObjectUnsubscribedErrorImpl() {\n        _super(this);\n        this.name = 'ObjectUnsubscribedError';\n        this.message = 'object unsubscribed';\n    };\n});\n//# sourceMappingURL=ObjectUnsubscribedError.js.map","import { __extends, __values } from \"tslib\";\nimport { Observable } from './Observable';\nimport { Subscription, EMPTY_SUBSCRIPTION } from './Subscription';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { arrRemove } from './util/arrRemove';\nimport { errorContext } from './util/errorContext';\nvar Subject = (function (_super) {\n    __extends(Subject, _super);\n    function Subject() {\n        var _this = _super.call(this) || this;\n        _this.closed = false;\n        _this.currentObservers = null;\n        _this.observers = [];\n        _this.isStopped = false;\n        _this.hasError = false;\n        _this.thrownError = null;\n        return _this;\n    }\n    Subject.prototype.lift = function (operator) {\n        var subject = new AnonymousSubject(this, this);\n        subject.operator = operator;\n        return subject;\n    };\n    Subject.prototype._throwIfClosed = function () {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n    };\n    Subject.prototype.next = function (value) {\n        var _this = this;\n        errorContext(function () {\n            var e_1, _a;\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                if (!_this.currentObservers) {\n                    _this.currentObservers = Array.from(_this.observers);\n                }\n                try {\n                    for (var _b = __values(_this.currentObservers), _c = _b.next(); !_c.done; _c = _b.next()) {\n                        var observer = _c.value;\n                        observer.next(value);\n                    }\n                }\n                catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                finally {\n                    try {\n                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                    }\n                    finally { if (e_1) throw e_1.error; }\n                }\n            }\n        });\n    };\n    Subject.prototype.error = function (err) {\n        var _this = this;\n        errorContext(function () {\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                _this.hasError = _this.isStopped = true;\n                _this.thrownError = err;\n                var observers = _this.observers;\n                while (observers.length) {\n                    observers.shift().error(err);\n                }\n            }\n        });\n    };\n    Subject.prototype.complete = function () {\n        var _this = this;\n        errorContext(function () {\n            _this._throwIfClosed();\n            if (!_this.isStopped) {\n                _this.isStopped = true;\n                var observers = _this.observers;\n                while (observers.length) {\n                    observers.shift().complete();\n                }\n            }\n        });\n    };\n    Subject.prototype.unsubscribe = function () {\n        this.isStopped = this.closed = true;\n        this.observers = this.currentObservers = null;\n    };\n    Object.defineProperty(Subject.prototype, \"observed\", {\n        get: function () {\n            var _a;\n            return ((_a = this.observers) === null || _a === void 0 ? void 0 : _a.length) > 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Subject.prototype._trySubscribe = function (subscriber) {\n        this._throwIfClosed();\n        return _super.prototype._trySubscribe.call(this, subscriber);\n    };\n    Subject.prototype._subscribe = function (subscriber) {\n        this._throwIfClosed();\n        this._checkFinalizedStatuses(subscriber);\n        return this._innerSubscribe(subscriber);\n    };\n    Subject.prototype._innerSubscribe = function (subscriber) {\n        var _this = this;\n        var _a = this, hasError = _a.hasError, isStopped = _a.isStopped, observers = _a.observers;\n        if (hasError || isStopped) {\n            return EMPTY_SUBSCRIPTION;\n        }\n        this.currentObservers = null;\n        observers.push(subscriber);\n        return new Subscription(function () {\n            _this.currentObservers = null;\n            arrRemove(observers, subscriber);\n        });\n    };\n    Subject.prototype._checkFinalizedStatuses = function (subscriber) {\n        var _a = this, hasError = _a.hasError, thrownError = _a.thrownError, isStopped = _a.isStopped;\n        if (hasError) {\n            subscriber.error(thrownError);\n        }\n        else if (isStopped) {\n            subscriber.complete();\n        }\n    };\n    Subject.prototype.asObservable = function () {\n        var observable = new Observable();\n        observable.source = this;\n        return observable;\n    };\n    Subject.create = function (destination, source) {\n        return new AnonymousSubject(destination, source);\n    };\n    return Subject;\n}(Observable));\nexport { Subject };\nvar AnonymousSubject = (function (_super) {\n    __extends(AnonymousSubject, _super);\n    function AnonymousSubject(destination, source) {\n        var _this = _super.call(this) || this;\n        _this.destination = destination;\n        _this.source = source;\n        return _this;\n    }\n    AnonymousSubject.prototype.next = function (value) {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.next) === null || _b === void 0 ? void 0 : _b.call(_a, value);\n    };\n    AnonymousSubject.prototype.error = function (err) {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.error) === null || _b === void 0 ? void 0 : _b.call(_a, err);\n    };\n    AnonymousSubject.prototype.complete = function () {\n        var _a, _b;\n        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.complete) === null || _b === void 0 ? void 0 : _b.call(_a);\n    };\n    AnonymousSubject.prototype._subscribe = function (subscriber) {\n        var _a, _b;\n        return (_b = (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber)) !== null && _b !== void 0 ? _b : EMPTY_SUBSCRIPTION;\n    };\n    return AnonymousSubject;\n}(Subject));\nexport { AnonymousSubject };\n//# sourceMappingURL=Subject.js.map","import { __extends } from \"tslib\";\nimport { Subject } from './Subject';\nvar BehaviorSubject = (function (_super) {\n    __extends(BehaviorSubject, _super);\n    function BehaviorSubject(_value) {\n        var _this = _super.call(this) || this;\n        _this._value = _value;\n        return _this;\n    }\n    Object.defineProperty(BehaviorSubject.prototype, \"value\", {\n        get: function () {\n            return this.getValue();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    BehaviorSubject.prototype._subscribe = function (subscriber) {\n        var subscription = _super.prototype._subscribe.call(this, subscriber);\n        !subscription.closed && subscriber.next(this._value);\n        return subscription;\n    };\n    BehaviorSubject.prototype.getValue = function () {\n        var _a = this, hasError = _a.hasError, thrownError = _a.thrownError, _value = _a._value;\n        if (hasError) {\n            throw thrownError;\n        }\n        this._throwIfClosed();\n        return _value;\n    };\n    BehaviorSubject.prototype.next = function (value) {\n        _super.prototype.next.call(this, (this._value = value));\n    };\n    return BehaviorSubject;\n}(Subject));\nexport { BehaviorSubject };\n//# sourceMappingURL=BehaviorSubject.js.map","export var dateTimestampProvider = {\n    now: function () {\n        return (dateTimestampProvider.delegate || Date).now();\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=dateTimestampProvider.js.map","import { __extends } from \"tslib\";\nimport { Subject } from './Subject';\nimport { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nvar ReplaySubject = (function (_super) {\n    __extends(ReplaySubject, _super);\n    function ReplaySubject(_bufferSize, _windowTime, _timestampProvider) {\n        if (_bufferSize === void 0) { _bufferSize = Infinity; }\n        if (_windowTime === void 0) { _windowTime = Infinity; }\n        if (_timestampProvider === void 0) { _timestampProvider = dateTimestampProvider; }\n        var _this = _super.call(this) || this;\n        _this._bufferSize = _bufferSize;\n        _this._windowTime = _windowTime;\n        _this._timestampProvider = _timestampProvider;\n        _this._buffer = [];\n        _this._infiniteTimeWindow = true;\n        _this._infiniteTimeWindow = _windowTime === Infinity;\n        _this._bufferSize = Math.max(1, _bufferSize);\n        _this._windowTime = Math.max(1, _windowTime);\n        return _this;\n    }\n    ReplaySubject.prototype.next = function (value) {\n        var _a = this, isStopped = _a.isStopped, _buffer = _a._buffer, _infiniteTimeWindow = _a._infiniteTimeWindow, _timestampProvider = _a._timestampProvider, _windowTime = _a._windowTime;\n        if (!isStopped) {\n            _buffer.push(value);\n            !_infiniteTimeWindow && _buffer.push(_timestampProvider.now() + _windowTime);\n        }\n        this._trimBuffer();\n        _super.prototype.next.call(this, value);\n    };\n    ReplaySubject.prototype._subscribe = function (subscriber) {\n        this._throwIfClosed();\n        this._trimBuffer();\n        var subscription = this._innerSubscribe(subscriber);\n        var _a = this, _infiniteTimeWindow = _a._infiniteTimeWindow, _buffer = _a._buffer;\n        var copy = _buffer.slice();\n        for (var i = 0; i < copy.length && !subscriber.closed; i += _infiniteTimeWindow ? 1 : 2) {\n            subscriber.next(copy[i]);\n        }\n        this._checkFinalizedStatuses(subscriber);\n        return subscription;\n    };\n    ReplaySubject.prototype._trimBuffer = function () {\n        var _a = this, _bufferSize = _a._bufferSize, _timestampProvider = _a._timestampProvider, _buffer = _a._buffer, _infiniteTimeWindow = _a._infiniteTimeWindow;\n        var adjustedBufferSize = (_infiniteTimeWindow ? 1 : 2) * _bufferSize;\n        _bufferSize < Infinity && adjustedBufferSize < _buffer.length && _buffer.splice(0, _buffer.length - adjustedBufferSize);\n        if (!_infiniteTimeWindow) {\n            var now = _timestampProvider.now();\n            var last = 0;\n            for (var i = 1; i < _buffer.length && _buffer[i] <= now; i += 2) {\n                last = i;\n            }\n            last && _buffer.splice(0, last + 1);\n        }\n    };\n    return ReplaySubject;\n}(Subject));\nexport { ReplaySubject };\n//# sourceMappingURL=ReplaySubject.js.map","import { __extends } from \"tslib\";\nimport { Subject } from './Subject';\nvar AsyncSubject = (function (_super) {\n    __extends(AsyncSubject, _super);\n    function AsyncSubject() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._value = null;\n        _this._hasValue = false;\n        _this._isComplete = false;\n        return _this;\n    }\n    AsyncSubject.prototype._checkFinalizedStatuses = function (subscriber) {\n        var _a = this, hasError = _a.hasError, _hasValue = _a._hasValue, _value = _a._value, thrownError = _a.thrownError, isStopped = _a.isStopped, _isComplete = _a._isComplete;\n        if (hasError) {\n            subscriber.error(thrownError);\n        }\n        else if (isStopped || _isComplete) {\n            _hasValue && subscriber.next(_value);\n            subscriber.complete();\n        }\n    };\n    AsyncSubject.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._value = value;\n            this._hasValue = true;\n        }\n    };\n    AsyncSubject.prototype.complete = function () {\n        var _a = this, _hasValue = _a._hasValue, _value = _a._value, _isComplete = _a._isComplete;\n        if (!_isComplete) {\n            this._isComplete = true;\n            _hasValue && _super.prototype.next.call(this, _value);\n            _super.prototype.complete.call(this);\n        }\n    };\n    return AsyncSubject;\n}(Subject));\nexport { AsyncSubject };\n//# sourceMappingURL=AsyncSubject.js.map","import { __extends } from \"tslib\";\nimport { Subscription } from '../Subscription';\nvar Action = (function (_super) {\n    __extends(Action, _super);\n    function Action(scheduler, work) {\n        return _super.call(this) || this;\n    }\n    Action.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        return this;\n    };\n    return Action;\n}(Subscription));\nexport { Action };\n//# sourceMappingURL=Action.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var intervalProvider = {\n    setInterval: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = intervalProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setInterval) {\n            return delegate.setInterval.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setInterval.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearInterval: function (handle) {\n        var delegate = intervalProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearInterval) || clearInterval)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=intervalProvider.js.map","import { __extends } from \"tslib\";\nimport { Action } from './Action';\nimport { intervalProvider } from './intervalProvider';\nimport { arrRemove } from '../util/arrRemove';\nvar AsyncAction = (function (_super) {\n    __extends(AsyncAction, _super);\n    function AsyncAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.pending = false;\n        return _this;\n    }\n    AsyncAction.prototype.schedule = function (state, delay) {\n        var _a;\n        if (delay === void 0) { delay = 0; }\n        if (this.closed) {\n            return this;\n        }\n        this.state = state;\n        var id = this.id;\n        var scheduler = this.scheduler;\n        if (id != null) {\n            this.id = this.recycleAsyncId(scheduler, id, delay);\n        }\n        this.pending = true;\n        this.delay = delay;\n        this.id = (_a = this.id) !== null && _a !== void 0 ? _a : this.requestAsyncId(scheduler, this.id, delay);\n        return this;\n    };\n    AsyncAction.prototype.requestAsyncId = function (scheduler, _id, delay) {\n        if (delay === void 0) { delay = 0; }\n        return intervalProvider.setInterval(scheduler.flush.bind(scheduler, this), delay);\n    };\n    AsyncAction.prototype.recycleAsyncId = function (_scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay != null && this.delay === delay && this.pending === false) {\n            return id;\n        }\n        if (id != null) {\n            intervalProvider.clearInterval(id);\n        }\n        return undefined;\n    };\n    AsyncAction.prototype.execute = function (state, delay) {\n        if (this.closed) {\n            return new Error('executing a cancelled action');\n        }\n        this.pending = false;\n        var error = this._execute(state, delay);\n        if (error) {\n            return error;\n        }\n        else if (this.pending === false && this.id != null) {\n            this.id = this.recycleAsyncId(this.scheduler, this.id, null);\n        }\n    };\n    AsyncAction.prototype._execute = function (state, _delay) {\n        var errored = false;\n        var errorValue;\n        try {\n            this.work(state);\n        }\n        catch (e) {\n            errored = true;\n            errorValue = e ? e : new Error('Scheduled action threw falsy error');\n        }\n        if (errored) {\n            this.unsubscribe();\n            return errorValue;\n        }\n    };\n    AsyncAction.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            var _a = this, id = _a.id, scheduler = _a.scheduler;\n            var actions = scheduler.actions;\n            this.work = this.state = this.scheduler = null;\n            this.pending = false;\n            arrRemove(actions, this);\n            if (id != null) {\n                this.id = this.recycleAsyncId(scheduler, id, null);\n            }\n            this.delay = null;\n            _super.prototype.unsubscribe.call(this);\n        }\n    };\n    return AsyncAction;\n}(Action));\nexport { AsyncAction };\n//# sourceMappingURL=AsyncAction.js.map","var nextHandle = 1;\nvar resolved;\nvar activeHandles = {};\nfunction findAndClearHandle(handle) {\n    if (handle in activeHandles) {\n        delete activeHandles[handle];\n        return true;\n    }\n    return false;\n}\nexport var Immediate = {\n    setImmediate: function (cb) {\n        var handle = nextHandle++;\n        activeHandles[handle] = true;\n        if (!resolved) {\n            resolved = Promise.resolve();\n        }\n        resolved.then(function () { return findAndClearHandle(handle) && cb(); });\n        return handle;\n    },\n    clearImmediate: function (handle) {\n        findAndClearHandle(handle);\n    },\n};\nexport var TestTools = {\n    pending: function () {\n        return Object.keys(activeHandles).length;\n    }\n};\n//# sourceMappingURL=Immediate.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { Immediate } from '../util/Immediate';\nvar setImmediate = Immediate.setImmediate, clearImmediate = Immediate.clearImmediate;\nexport var immediateProvider = {\n    setImmediate: function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var delegate = immediateProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.setImmediate) || setImmediate).apply(void 0, __spreadArray([], __read(args)));\n    },\n    clearImmediate: function (handle) {\n        var delegate = immediateProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearImmediate) || clearImmediate)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=immediateProvider.js.map","import { __extends } from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nimport { immediateProvider } from './immediateProvider';\nvar AsapAction = (function (_super) {\n    __extends(AsapAction, _super);\n    function AsapAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        return _this;\n    }\n    AsapAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay !== null && delay > 0) {\n            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);\n        }\n        scheduler.actions.push(this);\n        return scheduler._scheduled || (scheduler._scheduled = immediateProvider.setImmediate(scheduler.flush.bind(scheduler, undefined)));\n    };\n    AsapAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n        var _a;\n        if (delay === void 0) { delay = 0; }\n        if (delay != null ? delay > 0 : this.delay > 0) {\n            return _super.prototype.recycleAsyncId.call(this, scheduler, id, delay);\n        }\n        var actions = scheduler.actions;\n        if (id != null && ((_a = actions[actions.length - 1]) === null || _a === void 0 ? void 0 : _a.id) !== id) {\n            immediateProvider.clearImmediate(id);\n            if (scheduler._scheduled === id) {\n                scheduler._scheduled = undefined;\n            }\n        }\n        return undefined;\n    };\n    return AsapAction;\n}(AsyncAction));\nexport { AsapAction };\n//# sourceMappingURL=AsapAction.js.map","import { dateTimestampProvider } from './scheduler/dateTimestampProvider';\nvar Scheduler = (function () {\n    function Scheduler(schedulerActionCtor, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        this.schedulerActionCtor = schedulerActionCtor;\n        this.now = now;\n    }\n    Scheduler.prototype.schedule = function (work, delay, state) {\n        if (delay === void 0) { delay = 0; }\n        return new this.schedulerActionCtor(this, work).schedule(state, delay);\n    };\n    Scheduler.now = dateTimestampProvider.now;\n    return Scheduler;\n}());\nexport { Scheduler };\n//# sourceMappingURL=Scheduler.js.map","import { __extends } from \"tslib\";\nimport { Scheduler } from '../Scheduler';\nvar AsyncScheduler = (function (_super) {\n    __extends(AsyncScheduler, _super);\n    function AsyncScheduler(SchedulerAction, now) {\n        if (now === void 0) { now = Scheduler.now; }\n        var _this = _super.call(this, SchedulerAction, now) || this;\n        _this.actions = [];\n        _this._active = false;\n        return _this;\n    }\n    AsyncScheduler.prototype.flush = function (action) {\n        var actions = this.actions;\n        if (this._active) {\n            actions.push(action);\n            return;\n        }\n        var error;\n        this._active = true;\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions.shift()));\n        this._active = false;\n        if (error) {\n            while ((action = actions.shift())) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsyncScheduler;\n}(Scheduler));\nexport { AsyncScheduler };\n//# sourceMappingURL=AsyncScheduler.js.map","import { __extends } from \"tslib\";\nimport { AsyncScheduler } from './AsyncScheduler';\nvar AsapScheduler = (function (_super) {\n    __extends(AsapScheduler, _super);\n    function AsapScheduler() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AsapScheduler.prototype.flush = function (action) {\n        this._active = true;\n        var flushId = this._scheduled;\n        this._scheduled = undefined;\n        var actions = this.actions;\n        var error;\n        action = action || actions.shift();\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions[0]) && action.id === flushId && actions.shift());\n        this._active = false;\n        if (error) {\n            while ((action = actions[0]) && action.id === flushId && actions.shift()) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AsapScheduler;\n}(AsyncScheduler));\nexport { AsapScheduler };\n//# sourceMappingURL=AsapScheduler.js.map","import { AsapAction } from './AsapAction';\nimport { AsapScheduler } from './AsapScheduler';\nexport var asapScheduler = new AsapScheduler(AsapAction);\nexport var asap = asapScheduler;\n//# sourceMappingURL=asap.js.map","import { AsyncAction } from './AsyncAction';\nimport { AsyncScheduler } from './AsyncScheduler';\nexport var asyncScheduler = new AsyncScheduler(AsyncAction);\nexport var async = asyncScheduler;\n//# sourceMappingURL=async.js.map","import { __extends } from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nvar QueueAction = (function (_super) {\n    __extends(QueueAction, _super);\n    function QueueAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        return _this;\n    }\n    QueueAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay > 0) {\n            return _super.prototype.schedule.call(this, state, delay);\n        }\n        this.delay = delay;\n        this.state = state;\n        this.scheduler.flush(this);\n        return this;\n    };\n    QueueAction.prototype.execute = function (state, delay) {\n        return delay > 0 || this.closed ? _super.prototype.execute.call(this, state, delay) : this._execute(state, delay);\n    };\n    QueueAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if ((delay != null && delay > 0) || (delay == null && this.delay > 0)) {\n            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);\n        }\n        scheduler.flush(this);\n        return 0;\n    };\n    return QueueAction;\n}(AsyncAction));\nexport { QueueAction };\n//# sourceMappingURL=QueueAction.js.map","import { __extends } from \"tslib\";\nimport { AsyncScheduler } from './AsyncScheduler';\nvar QueueScheduler = (function (_super) {\n    __extends(QueueScheduler, _super);\n    function QueueScheduler() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return QueueScheduler;\n}(AsyncScheduler));\nexport { QueueScheduler };\n//# sourceMappingURL=QueueScheduler.js.map","import { QueueAction } from './QueueAction';\nimport { QueueScheduler } from './QueueScheduler';\nexport var queueScheduler = new QueueScheduler(QueueAction);\nexport var queue = queueScheduler;\n//# sourceMappingURL=queue.js.map","import { __extends } from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nimport { animationFrameProvider } from './animationFrameProvider';\nvar AnimationFrameAction = (function (_super) {\n    __extends(AnimationFrameAction, _super);\n    function AnimationFrameAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        return _this;\n    }\n    AnimationFrameAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (delay !== null && delay > 0) {\n            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);\n        }\n        scheduler.actions.push(this);\n        return scheduler._scheduled || (scheduler._scheduled = animationFrameProvider.requestAnimationFrame(function () { return scheduler.flush(undefined); }));\n    };\n    AnimationFrameAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n        var _a;\n        if (delay === void 0) { delay = 0; }\n        if (delay != null ? delay > 0 : this.delay > 0) {\n            return _super.prototype.recycleAsyncId.call(this, scheduler, id, delay);\n        }\n        var actions = scheduler.actions;\n        if (id != null && ((_a = actions[actions.length - 1]) === null || _a === void 0 ? void 0 : _a.id) !== id) {\n            animationFrameProvider.cancelAnimationFrame(id);\n            scheduler._scheduled = undefined;\n        }\n        return undefined;\n    };\n    return AnimationFrameAction;\n}(AsyncAction));\nexport { AnimationFrameAction };\n//# sourceMappingURL=AnimationFrameAction.js.map","import { __extends } from \"tslib\";\nimport { AsyncScheduler } from './AsyncScheduler';\nvar AnimationFrameScheduler = (function (_super) {\n    __extends(AnimationFrameScheduler, _super);\n    function AnimationFrameScheduler() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AnimationFrameScheduler.prototype.flush = function (action) {\n        this._active = true;\n        var flushId = this._scheduled;\n        this._scheduled = undefined;\n        var actions = this.actions;\n        var error;\n        action = action || actions.shift();\n        do {\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        } while ((action = actions[0]) && action.id === flushId && actions.shift());\n        this._active = false;\n        if (error) {\n            while ((action = actions[0]) && action.id === flushId && actions.shift()) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    return AnimationFrameScheduler;\n}(AsyncScheduler));\nexport { AnimationFrameScheduler };\n//# sourceMappingURL=AnimationFrameScheduler.js.map","import { AnimationFrameAction } from './AnimationFrameAction';\nimport { AnimationFrameScheduler } from './AnimationFrameScheduler';\nexport var animationFrameScheduler = new AnimationFrameScheduler(AnimationFrameAction);\nexport var animationFrame = animationFrameScheduler;\n//# sourceMappingURL=animationFrame.js.map","import { __extends } from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nimport { Subscription } from '../Subscription';\nimport { AsyncScheduler } from './AsyncScheduler';\nvar VirtualTimeScheduler = (function (_super) {\n    __extends(VirtualTimeScheduler, _super);\n    function VirtualTimeScheduler(schedulerActionCtor, maxFrames) {\n        if (schedulerActionCtor === void 0) { schedulerActionCtor = VirtualAction; }\n        if (maxFrames === void 0) { maxFrames = Infinity; }\n        var _this = _super.call(this, schedulerActionCtor, function () { return _this.frame; }) || this;\n        _this.maxFrames = maxFrames;\n        _this.frame = 0;\n        _this.index = -1;\n        return _this;\n    }\n    VirtualTimeScheduler.prototype.flush = function () {\n        var _a = this, actions = _a.actions, maxFrames = _a.maxFrames;\n        var error;\n        var action;\n        while ((action = actions[0]) && action.delay <= maxFrames) {\n            actions.shift();\n            this.frame = action.delay;\n            if ((error = action.execute(action.state, action.delay))) {\n                break;\n            }\n        }\n        if (error) {\n            while ((action = actions.shift())) {\n                action.unsubscribe();\n            }\n            throw error;\n        }\n    };\n    VirtualTimeScheduler.frameTimeFactor = 10;\n    return VirtualTimeScheduler;\n}(AsyncScheduler));\nexport { VirtualTimeScheduler };\nvar VirtualAction = (function (_super) {\n    __extends(VirtualAction, _super);\n    function VirtualAction(scheduler, work, index) {\n        if (index === void 0) { index = (scheduler.index += 1); }\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        _this.index = index;\n        _this.active = true;\n        _this.index = scheduler.index = index;\n        return _this;\n    }\n    VirtualAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) { delay = 0; }\n        if (Number.isFinite(delay)) {\n            if (!this.id) {\n                return _super.prototype.schedule.call(this, state, delay);\n            }\n            this.active = false;\n            var action = new VirtualAction(this.scheduler, this.work);\n            this.add(action);\n            return action.schedule(state, delay);\n        }\n        else {\n            return Subscription.EMPTY;\n        }\n    };\n    VirtualAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        this.delay = scheduler.frame + delay;\n        var actions = scheduler.actions;\n        actions.push(this);\n        actions.sort(VirtualAction.sortActions);\n        return 1;\n    };\n    VirtualAction.prototype.recycleAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) { delay = 0; }\n        return undefined;\n    };\n    VirtualAction.prototype._execute = function (state, delay) {\n        if (this.active === true) {\n            return _super.prototype._execute.call(this, state, delay);\n        }\n    };\n    VirtualAction.sortActions = function (a, b) {\n        if (a.delay === b.delay) {\n            if (a.index === b.index) {\n                return 0;\n            }\n            else if (a.index > b.index) {\n                return 1;\n            }\n            else {\n                return -1;\n            }\n        }\n        else if (a.delay > b.delay) {\n            return 1;\n        }\n        else {\n            return -1;\n        }\n    };\n    return VirtualAction;\n}(AsyncAction));\nexport { VirtualAction };\n//# sourceMappingURL=VirtualTimeScheduler.js.map","import { Observable } from '../Observable';\nexport var EMPTY = new Observable(function (subscriber) { return subscriber.complete(); });\nexport function empty(scheduler) {\n    return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\nfunction emptyScheduled(scheduler) {\n    return new Observable(function (subscriber) { return scheduler.schedule(function () { return subscriber.complete(); }); });\n}\n//# sourceMappingURL=empty.js.map","import { isFunction } from './isFunction';\nexport function isScheduler(value) {\n    return value && isFunction(value.schedule);\n}\n//# sourceMappingURL=isScheduler.js.map","import { isFunction } from './isFunction';\nimport { isScheduler } from './isScheduler';\nfunction last(arr) {\n    return arr[arr.length - 1];\n}\nexport function popResultSelector(args) {\n    return isFunction(last(args)) ? args.pop() : undefined;\n}\nexport function popScheduler(args) {\n    return isScheduler(last(args)) ? args.pop() : undefined;\n}\nexport function popNumber(args, defaultValue) {\n    return typeof last(args) === 'number' ? args.pop() : defaultValue;\n}\n//# sourceMappingURL=args.js.map","export var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map","import { isFunction } from \"./isFunction\";\nexport function isPromise(value) {\n    return isFunction(value === null || value === void 0 ? void 0 : value.then);\n}\n//# sourceMappingURL=isPromise.js.map","import { observable as Symbol_observable } from '../symbol/observable';\nimport { isFunction } from './isFunction';\nexport function isInteropObservable(input) {\n    return isFunction(input[Symbol_observable]);\n}\n//# sourceMappingURL=isInteropObservable.js.map","import { isFunction } from './isFunction';\nexport function isAsyncIterable(obj) {\n    return Symbol.asyncIterator && isFunction(obj === null || obj === void 0 ? void 0 : obj[Symbol.asyncIterator]);\n}\n//# sourceMappingURL=isAsyncIterable.js.map","export function createInvalidObservableTypeError(input) {\n    return new TypeError(\"You provided \" + (input !== null && typeof input === 'object' ? 'an invalid object' : \"'\" + input + \"'\") + \" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.\");\n}\n//# sourceMappingURL=throwUnobservableError.js.map","export function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = getSymbolIterator();\n//# sourceMappingURL=iterator.js.map","import { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from './isFunction';\nexport function isIterable(input) {\n    return isFunction(input === null || input === void 0 ? void 0 : input[Symbol_iterator]);\n}\n//# sourceMappingURL=isIterable.js.map","import { __asyncGenerator, __await, __generator } from \"tslib\";\nimport { isFunction } from './isFunction';\nexport function readableStreamLikeToAsyncGenerator(readableStream) {\n    return __asyncGenerator(this, arguments, function readableStreamLikeToAsyncGenerator_1() {\n        var reader, _a, value, done;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    reader = readableStream.getReader();\n                    _b.label = 1;\n                case 1:\n                    _b.trys.push([1, , 9, 10]);\n                    _b.label = 2;\n                case 2:\n                    if (!true) return [3, 8];\n                    return [4, __await(reader.read())];\n                case 3:\n                    _a = _b.sent(), value = _a.value, done = _a.done;\n                    if (!done) return [3, 5];\n                    return [4, __await(void 0)];\n                case 4: return [2, _b.sent()];\n                case 5: return [4, __await(value)];\n                case 6: return [4, _b.sent()];\n                case 7:\n                    _b.sent();\n                    return [3, 2];\n                case 8: return [3, 10];\n                case 9:\n                    reader.releaseLock();\n                    return [7];\n                case 10: return [2];\n            }\n        });\n    });\n}\nexport function isReadableStreamLike(obj) {\n    return isFunction(obj === null || obj === void 0 ? void 0 : obj.getReader);\n}\n//# sourceMappingURL=isReadableStreamLike.js.map","import { __asyncValues, __awaiter, __generator, __values } from \"tslib\";\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isPromise } from '../util/isPromise';\nimport { Observable } from '../Observable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isIterable } from '../util/isIterable';\nimport { isReadableStreamLike, readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nimport { isFunction } from '../util/isFunction';\nimport { reportUnhandledError } from '../util/reportUnhandledError';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport function innerFrom(input) {\n    if (input instanceof Observable) {\n        return input;\n    }\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return fromInteropObservable(input);\n        }\n        if (isArrayLike(input)) {\n            return fromArrayLike(input);\n        }\n        if (isPromise(input)) {\n            return fromPromise(input);\n        }\n        if (isAsyncIterable(input)) {\n            return fromAsyncIterable(input);\n        }\n        if (isIterable(input)) {\n            return fromIterable(input);\n        }\n        if (isReadableStreamLike(input)) {\n            return fromReadableStreamLike(input);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\nexport function fromInteropObservable(obj) {\n    return new Observable(function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (isFunction(obs.subscribe)) {\n            return obs.subscribe(subscriber);\n        }\n        throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    });\n}\nexport function fromArrayLike(array) {\n    return new Observable(function (subscriber) {\n        for (var i = 0; i < array.length && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        subscriber.complete();\n    });\n}\nexport function fromPromise(promise) {\n    return new Observable(function (subscriber) {\n        promise\n            .then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, reportUnhandledError);\n    });\n}\nexport function fromIterable(iterable) {\n    return new Observable(function (subscriber) {\n        var e_1, _a;\n        try {\n            for (var iterable_1 = __values(iterable), iterable_1_1 = iterable_1.next(); !iterable_1_1.done; iterable_1_1 = iterable_1.next()) {\n                var value = iterable_1_1.value;\n                subscriber.next(value);\n                if (subscriber.closed) {\n                    return;\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (iterable_1_1 && !iterable_1_1.done && (_a = iterable_1.return)) _a.call(iterable_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        subscriber.complete();\n    });\n}\nexport function fromAsyncIterable(asyncIterable) {\n    return new Observable(function (subscriber) {\n        process(asyncIterable, subscriber).catch(function (err) { return subscriber.error(err); });\n    });\n}\nexport function fromReadableStreamLike(readableStream) {\n    return fromAsyncIterable(readableStreamLikeToAsyncGenerator(readableStream));\n}\nfunction process(asyncIterable, subscriber) {\n    var asyncIterable_1, asyncIterable_1_1;\n    var e_2, _a;\n    return __awaiter(this, void 0, void 0, function () {\n        var value, e_2_1;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 5, 6, 11]);\n                    asyncIterable_1 = __asyncValues(asyncIterable);\n                    _b.label = 1;\n                case 1: return [4, asyncIterable_1.next()];\n                case 2:\n                    if (!(asyncIterable_1_1 = _b.sent(), !asyncIterable_1_1.done)) return [3, 4];\n                    value = asyncIterable_1_1.value;\n                    subscriber.next(value);\n                    if (subscriber.closed) {\n                        return [2];\n                    }\n                    _b.label = 3;\n                case 3: return [3, 1];\n                case 4: return [3, 11];\n                case 5:\n                    e_2_1 = _b.sent();\n                    e_2 = { error: e_2_1 };\n                    return [3, 11];\n                case 6:\n                    _b.trys.push([6, , 9, 10]);\n                    if (!(asyncIterable_1_1 && !asyncIterable_1_1.done && (_a = asyncIterable_1.return))) return [3, 8];\n                    return [4, _a.call(asyncIterable_1)];\n                case 7:\n                    _b.sent();\n                    _b.label = 8;\n                case 8: return [3, 10];\n                case 9:\n                    if (e_2) throw e_2.error;\n                    return [7];\n                case 10: return [7];\n                case 11:\n                    subscriber.complete();\n                    return [2];\n            }\n        });\n    });\n}\n//# sourceMappingURL=innerFrom.js.map","export function executeSchedule(parentSubscription, scheduler, work, delay, repeat) {\n    if (delay === void 0) { delay = 0; }\n    if (repeat === void 0) { repeat = false; }\n    var scheduleSubscription = scheduler.schedule(function () {\n        work();\n        if (repeat) {\n            parentSubscription.add(this.schedule(null, delay));\n        }\n        else {\n            this.unsubscribe();\n        }\n    }, delay);\n    parentSubscription.add(scheduleSubscription);\n    if (!repeat) {\n        return scheduleSubscription;\n    }\n}\n//# sourceMappingURL=executeSchedule.js.map","import { executeSchedule } from '../util/executeSchedule';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function observeOn(scheduler, delay) {\n    if (delay === void 0) { delay = 0; }\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return executeSchedule(subscriber, scheduler, function () { return subscriber.next(value); }, delay); }, function () { return executeSchedule(subscriber, scheduler, function () { return subscriber.complete(); }, delay); }, function (err) { return executeSchedule(subscriber, scheduler, function () { return subscriber.error(err); }, delay); }));\n    });\n}\n//# sourceMappingURL=observeOn.js.map","import { operate } from '../util/lift';\nexport function subscribeOn(scheduler, delay) {\n    if (delay === void 0) { delay = 0; }\n    return operate(function (source, subscriber) {\n        subscriber.add(scheduler.schedule(function () { return source.subscribe(subscriber); }, delay));\n    });\n}\n//# sourceMappingURL=subscribeOn.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { observeOn } from '../operators/observeOn';\nimport { subscribeOn } from '../operators/subscribeOn';\nexport function scheduleObservable(input, scheduler) {\n    return innerFrom(input).pipe(subscribeOn(scheduler), observeOn(scheduler));\n}\n//# sourceMappingURL=scheduleObservable.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { observeOn } from '../operators/observeOn';\nimport { subscribeOn } from '../operators/subscribeOn';\nexport function schedulePromise(input, scheduler) {\n    return innerFrom(input).pipe(subscribeOn(scheduler), observeOn(scheduler));\n}\n//# sourceMappingURL=schedulePromise.js.map","import { Observable } from '../Observable';\nexport function scheduleArray(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var i = 0;\n        return scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n            }\n            else {\n                subscriber.next(input[i++]);\n                if (!subscriber.closed) {\n                    this.schedule();\n                }\n            }\n        });\n    });\n}\n//# sourceMappingURL=scheduleArray.js.map","import { Observable } from '../Observable';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { isFunction } from '../util/isFunction';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function scheduleIterable(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var iterator;\n        executeSchedule(subscriber, scheduler, function () {\n            iterator = input[Symbol_iterator]();\n            executeSchedule(subscriber, scheduler, function () {\n                var _a;\n                var value;\n                var done;\n                try {\n                    (_a = iterator.next(), value = _a.value, done = _a.done);\n                }\n                catch (err) {\n                    subscriber.error(err);\n                    return;\n                }\n                if (done) {\n                    subscriber.complete();\n                }\n                else {\n                    subscriber.next(value);\n                }\n            }, 0, true);\n        });\n        return function () { return isFunction(iterator === null || iterator === void 0 ? void 0 : iterator.return) && iterator.return(); };\n    });\n}\n//# sourceMappingURL=scheduleIterable.js.map","import { Observable } from '../Observable';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function scheduleAsyncIterable(input, scheduler) {\n    if (!input) {\n        throw new Error('Iterable cannot be null');\n    }\n    return new Observable(function (subscriber) {\n        executeSchedule(subscriber, scheduler, function () {\n            var iterator = input[Symbol.asyncIterator]();\n            executeSchedule(subscriber, scheduler, function () {\n                iterator.next().then(function (result) {\n                    if (result.done) {\n                        subscriber.complete();\n                    }\n                    else {\n                        subscriber.next(result.value);\n                    }\n                });\n            }, 0, true);\n        });\n    });\n}\n//# sourceMappingURL=scheduleAsyncIterable.js.map","import { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { readableStreamLikeToAsyncGenerator } from '../util/isReadableStreamLike';\nexport function scheduleReadableStreamLike(input, scheduler) {\n    return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(input), scheduler);\n}\n//# sourceMappingURL=scheduleReadableStreamLike.js.map","import { scheduleObservable } from './scheduleObservable';\nimport { schedulePromise } from './schedulePromise';\nimport { scheduleArray } from './scheduleArray';\nimport { scheduleIterable } from './scheduleIterable';\nimport { scheduleAsyncIterable } from './scheduleAsyncIterable';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isPromise } from '../util/isPromise';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isIterable } from '../util/isIterable';\nimport { isAsyncIterable } from '../util/isAsyncIterable';\nimport { createInvalidObservableTypeError } from '../util/throwUnobservableError';\nimport { isReadableStreamLike } from '../util/isReadableStreamLike';\nimport { scheduleReadableStreamLike } from './scheduleReadableStreamLike';\nexport function scheduled(input, scheduler) {\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return scheduleObservable(input, scheduler);\n        }\n        if (isArrayLike(input)) {\n            return scheduleArray(input, scheduler);\n        }\n        if (isPromise(input)) {\n            return schedulePromise(input, scheduler);\n        }\n        if (isAsyncIterable(input)) {\n            return scheduleAsyncIterable(input, scheduler);\n        }\n        if (isIterable(input)) {\n            return scheduleIterable(input, scheduler);\n        }\n        if (isReadableStreamLike(input)) {\n            return scheduleReadableStreamLike(input, scheduler);\n        }\n    }\n    throw createInvalidObservableTypeError(input);\n}\n//# sourceMappingURL=scheduled.js.map","import { scheduled } from '../scheduled/scheduled';\nimport { innerFrom } from './innerFrom';\nexport function from(input, scheduler) {\n    return scheduler ? scheduled(input, scheduler) : innerFrom(input);\n}\n//# sourceMappingURL=from.js.map","import { popScheduler } from '../util/args';\nimport { from } from './from';\nexport function of() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    return from(args, scheduler);\n}\n//# sourceMappingURL=of.js.map","import { Observable } from '../Observable';\nimport { isFunction } from '../util/isFunction';\nexport function throwError(errorOrErrorFactory, scheduler) {\n    var errorFactory = isFunction(errorOrErrorFactory) ? errorOrErrorFactory : function () { return errorOrErrorFactory; };\n    var init = function (subscriber) { return subscriber.error(errorFactory()); };\n    return new Observable(scheduler ? function (subscriber) { return scheduler.schedule(init, 0, subscriber); } : init);\n}\n//# sourceMappingURL=throwError.js.map","import { EMPTY } from './observable/empty';\nimport { of } from './observable/of';\nimport { throwError } from './observable/throwError';\nimport { isFunction } from './util/isFunction';\nexport var NotificationKind;\n(function (NotificationKind) {\n    NotificationKind[\"NEXT\"] = \"N\";\n    NotificationKind[\"ERROR\"] = \"E\";\n    NotificationKind[\"COMPLETE\"] = \"C\";\n})(NotificationKind || (NotificationKind = {}));\nvar Notification = (function () {\n    function Notification(kind, value, error) {\n        this.kind = kind;\n        this.value = value;\n        this.error = error;\n        this.hasValue = kind === 'N';\n    }\n    Notification.prototype.observe = function (observer) {\n        return observeNotification(this, observer);\n    };\n    Notification.prototype.do = function (nextHandler, errorHandler, completeHandler) {\n        var _a = this, kind = _a.kind, value = _a.value, error = _a.error;\n        return kind === 'N' ? nextHandler === null || nextHandler === void 0 ? void 0 : nextHandler(value) : kind === 'E' ? errorHandler === null || errorHandler === void 0 ? void 0 : errorHandler(error) : completeHandler === null || completeHandler === void 0 ? void 0 : completeHandler();\n    };\n    Notification.prototype.accept = function (nextOrObserver, error, complete) {\n        var _a;\n        return isFunction((_a = nextOrObserver) === null || _a === void 0 ? void 0 : _a.next)\n            ? this.observe(nextOrObserver)\n            : this.do(nextOrObserver, error, complete);\n    };\n    Notification.prototype.toObservable = function () {\n        var _a = this, kind = _a.kind, value = _a.value, error = _a.error;\n        var result = kind === 'N'\n            ?\n                of(value)\n            :\n                kind === 'E'\n                    ?\n                        throwError(function () { return error; })\n                    :\n                        kind === 'C'\n                            ?\n                                EMPTY\n                            :\n                                0;\n        if (!result) {\n            throw new TypeError(\"Unexpected notification kind \" + kind);\n        }\n        return result;\n    };\n    Notification.createNext = function (value) {\n        return new Notification('N', value);\n    };\n    Notification.createError = function (err) {\n        return new Notification('E', undefined, err);\n    };\n    Notification.createComplete = function () {\n        return Notification.completeNotification;\n    };\n    Notification.completeNotification = new Notification('C');\n    return Notification;\n}());\nexport { Notification };\nexport function observeNotification(notification, observer) {\n    var _a, _b, _c;\n    var _d = notification, kind = _d.kind, value = _d.value, error = _d.error;\n    if (typeof kind !== 'string') {\n        throw new TypeError('Invalid notification, missing \"kind\"');\n    }\n    kind === 'N' ? (_a = observer.next) === null || _a === void 0 ? void 0 : _a.call(observer, value) : kind === 'E' ? (_b = observer.error) === null || _b === void 0 ? void 0 : _b.call(observer, error) : (_c = observer.complete) === null || _c === void 0 ? void 0 : _c.call(observer);\n}\n//# sourceMappingURL=Notification.js.map","import { Observable } from '../Observable';\nimport { isFunction } from './isFunction';\nexport function isObservable(obj) {\n    return !!obj && (obj instanceof Observable || (isFunction(obj.lift) && isFunction(obj.subscribe)));\n}\n//# sourceMappingURL=isObservable.js.map","import { createErrorClass } from './createErrorClass';\nexport var EmptyError = createErrorClass(function (_super) { return function EmptyErrorImpl() {\n    _super(this);\n    this.name = 'EmptyError';\n    this.message = 'no elements in sequence';\n}; });\n//# sourceMappingURL=EmptyError.js.map","import { EmptyError } from './util/EmptyError';\nexport function lastValueFrom(source, config) {\n    var hasConfig = typeof config === 'object';\n    return new Promise(function (resolve, reject) {\n        var _hasValue = false;\n        var _value;\n        source.subscribe({\n            next: function (value) {\n                _value = value;\n                _hasValue = true;\n            },\n            error: reject,\n            complete: function () {\n                if (_hasValue) {\n                    resolve(_value);\n                }\n                else if (hasConfig) {\n                    resolve(config.defaultValue);\n                }\n                else {\n                    reject(new EmptyError());\n                }\n            },\n        });\n    });\n}\n//# sourceMappingURL=lastValueFrom.js.map","import { EmptyError } from './util/EmptyError';\nimport { SafeSubscriber } from './Subscriber';\nexport function firstValueFrom(source, config) {\n    var hasConfig = typeof config === 'object';\n    return new Promise(function (resolve, reject) {\n        var subscriber = new SafeSubscriber({\n            next: function (value) {\n                resolve(value);\n                subscriber.unsubscribe();\n            },\n            error: reject,\n            complete: function () {\n                if (hasConfig) {\n                    resolve(config.defaultValue);\n                }\n                else {\n                    reject(new EmptyError());\n                }\n            },\n        });\n        source.subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=firstValueFrom.js.map","import { createErrorClass } from './createErrorClass';\nexport var ArgumentOutOfRangeError = createErrorClass(function (_super) {\n    return function ArgumentOutOfRangeErrorImpl() {\n        _super(this);\n        this.name = 'ArgumentOutOfRangeError';\n        this.message = 'argument out of range';\n    };\n});\n//# sourceMappingURL=ArgumentOutOfRangeError.js.map","import { createErrorClass } from './createErrorClass';\nexport var NotFoundError = createErrorClass(function (_super) {\n    return function NotFoundErrorImpl(message) {\n        _super(this);\n        this.name = 'NotFoundError';\n        this.message = message;\n    };\n});\n//# sourceMappingURL=NotFoundError.js.map","import { createErrorClass } from './createErrorClass';\nexport var SequenceError = createErrorClass(function (_super) {\n    return function SequenceErrorImpl(message) {\n        _super(this);\n        this.name = 'SequenceError';\n        this.message = message;\n    };\n});\n//# sourceMappingURL=SequenceError.js.map","export function isValidDate(value) {\n    return value instanceof Date && !isNaN(value);\n}\n//# sourceMappingURL=isDate.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { isValidDate } from '../util/isDate';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createErrorClass } from '../util/createErrorClass';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport var TimeoutError = createErrorClass(function (_super) {\n    return function TimeoutErrorImpl(info) {\n        if (info === void 0) { info = null; }\n        _super(this);\n        this.message = 'Timeout has occurred';\n        this.name = 'TimeoutError';\n        this.info = info;\n    };\n});\nexport function timeout(config, schedulerArg) {\n    var _a = (isValidDate(config) ? { first: config } : typeof config === 'number' ? { each: config } : config), first = _a.first, each = _a.each, _b = _a.with, _with = _b === void 0 ? timeoutErrorFactory : _b, _c = _a.scheduler, scheduler = _c === void 0 ? schedulerArg !== null && schedulerArg !== void 0 ? schedulerArg : asyncScheduler : _c, _d = _a.meta, meta = _d === void 0 ? null : _d;\n    if (first == null && each == null) {\n        throw new TypeError('No timeout provided.');\n    }\n    return operate(function (source, subscriber) {\n        var originalSourceSubscription;\n        var timerSubscription;\n        var lastValue = null;\n        var seen = 0;\n        var startTimer = function (delay) {\n            timerSubscription = executeSchedule(subscriber, scheduler, function () {\n                try {\n                    originalSourceSubscription.unsubscribe();\n                    innerFrom(_with({\n                        meta: meta,\n                        lastValue: lastValue,\n                        seen: seen,\n                    })).subscribe(subscriber);\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }, delay);\n        };\n        originalSourceSubscription = source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n            seen++;\n            subscriber.next((lastValue = value));\n            each > 0 && startTimer(each);\n        }, undefined, undefined, function () {\n            if (!(timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.closed)) {\n                timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n            }\n            lastValue = null;\n        }));\n        !seen && startTimer(first != null ? (typeof first === 'number' ? first : +first - scheduler.now()) : each);\n    });\n}\nfunction timeoutErrorFactory(info) {\n    throw new TimeoutError(info);\n}\n//# sourceMappingURL=timeout.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function map(project, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            subscriber.next(project.call(thisArg, value, index++));\n        }));\n    });\n}\n//# sourceMappingURL=map.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { map } from \"../operators/map\";\nvar isArray = Array.isArray;\nfunction callOrApply(fn, args) {\n    return isArray(args) ? fn.apply(void 0, __spreadArray([], __read(args))) : fn(args);\n}\nexport function mapOneOrManyArgs(fn) {\n    return map(function (args) { return callOrApply(fn, args); });\n}\n//# sourceMappingURL=mapOneOrManyArgs.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { isScheduler } from '../util/isScheduler';\nimport { Observable } from '../Observable';\nimport { subscribeOn } from '../operators/subscribeOn';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { observeOn } from '../operators/observeOn';\nimport { AsyncSubject } from '../AsyncSubject';\nexport function bindCallbackInternals(isNodeStyle, callbackFunc, resultSelector, scheduler) {\n    if (resultSelector) {\n        if (isScheduler(resultSelector)) {\n            scheduler = resultSelector;\n        }\n        else {\n            return function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                return bindCallbackInternals(isNodeStyle, callbackFunc, scheduler)\n                    .apply(this, args)\n                    .pipe(mapOneOrManyArgs(resultSelector));\n            };\n        }\n    }\n    if (scheduler) {\n        return function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return bindCallbackInternals(isNodeStyle, callbackFunc)\n                .apply(this, args)\n                .pipe(subscribeOn(scheduler), observeOn(scheduler));\n        };\n    }\n    return function () {\n        var _this = this;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var subject = new AsyncSubject();\n        var uninitialized = true;\n        return new Observable(function (subscriber) {\n            var subs = subject.subscribe(subscriber);\n            if (uninitialized) {\n                uninitialized = false;\n                var isAsync_1 = false;\n                var isComplete_1 = false;\n                callbackFunc.apply(_this, __spreadArray(__spreadArray([], __read(args)), [\n                    function () {\n                        var results = [];\n                        for (var _i = 0; _i < arguments.length; _i++) {\n                            results[_i] = arguments[_i];\n                        }\n                        if (isNodeStyle) {\n                            var err = results.shift();\n                            if (err != null) {\n                                subject.error(err);\n                                return;\n                            }\n                        }\n                        subject.next(1 < results.length ? results : results[0]);\n                        isComplete_1 = true;\n                        if (isAsync_1) {\n                            subject.complete();\n                        }\n                    },\n                ]));\n                if (isComplete_1) {\n                    subject.complete();\n                }\n                isAsync_1 = true;\n            }\n            return subs;\n        });\n    };\n}\n//# sourceMappingURL=bindCallbackInternals.js.map","import { bindCallbackInternals } from './bindCallbackInternals';\nexport function bindCallback(callbackFunc, resultSelector, scheduler) {\n    return bindCallbackInternals(false, callbackFunc, resultSelector, scheduler);\n}\n//# sourceMappingURL=bindCallback.js.map","import { bindCallbackInternals } from './bindCallbackInternals';\nexport function bindNodeCallback(callbackFunc, resultSelector, scheduler) {\n    return bindCallbackInternals(true, callbackFunc, resultSelector, scheduler);\n}\n//# sourceMappingURL=bindNodeCallback.js.map","var isArray = Array.isArray;\nvar getPrototypeOf = Object.getPrototypeOf, objectProto = Object.prototype, getKeys = Object.keys;\nexport function argsArgArrayOrObject(args) {\n    if (args.length === 1) {\n        var first_1 = args[0];\n        if (isArray(first_1)) {\n            return { args: first_1, keys: null };\n        }\n        if (isPOJO(first_1)) {\n            var keys = getKeys(first_1);\n            return {\n                args: keys.map(function (key) { return first_1[key]; }),\n                keys: keys,\n            };\n        }\n    }\n    return { args: args, keys: null };\n}\nfunction isPOJO(obj) {\n    return obj && typeof obj === 'object' && getPrototypeOf(obj) === objectProto;\n}\n//# sourceMappingURL=argsArgArrayOrObject.js.map","export function createObject(keys, values) {\n    return keys.reduce(function (result, key, i) { return ((result[key] = values[i]), result); }, {});\n}\n//# sourceMappingURL=createObject.js.map","import { Observable } from '../Observable';\nimport { argsArgArrayOrObject } from '../util/argsArgArrayOrObject';\nimport { from } from './from';\nimport { identity } from '../util/identity';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { popResultSelector, popScheduler } from '../util/args';\nimport { createObject } from '../util/createObject';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function combineLatest() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    var resultSelector = popResultSelector(args);\n    var _a = argsArgArrayOrObject(args), observables = _a.args, keys = _a.keys;\n    if (observables.length === 0) {\n        return from([], scheduler);\n    }\n    var result = new Observable(combineLatestInit(observables, scheduler, keys\n        ?\n            function (values) { return createObject(keys, values); }\n        :\n            identity));\n    return resultSelector ? result.pipe(mapOneOrManyArgs(resultSelector)) : result;\n}\nexport function combineLatestInit(observables, scheduler, valueTransform) {\n    if (valueTransform === void 0) { valueTransform = identity; }\n    return function (subscriber) {\n        maybeSchedule(scheduler, function () {\n            var length = observables.length;\n            var values = new Array(length);\n            var active = length;\n            var remainingFirstValues = length;\n            var _loop_1 = function (i) {\n                maybeSchedule(scheduler, function () {\n                    var source = from(observables[i], scheduler);\n                    var hasFirstValue = false;\n                    source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                        values[i] = value;\n                        if (!hasFirstValue) {\n                            hasFirstValue = true;\n                            remainingFirstValues--;\n                        }\n                        if (!remainingFirstValues) {\n                            subscriber.next(valueTransform(values.slice()));\n                        }\n                    }, function () {\n                        if (!--active) {\n                            subscriber.complete();\n                        }\n                    }));\n                }, subscriber);\n            };\n            for (var i = 0; i < length; i++) {\n                _loop_1(i);\n            }\n        }, subscriber);\n    };\n}\nfunction maybeSchedule(scheduler, execute, subscription) {\n    if (scheduler) {\n        executeSchedule(subscription, scheduler, execute);\n    }\n    else {\n        execute();\n    }\n}\n//# sourceMappingURL=combineLatest.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { executeSchedule } from '../util/executeSchedule';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function mergeInternals(source, subscriber, project, concurrent, onBeforeNext, expand, innerSubScheduler, additionalFinalizer) {\n    var buffer = [];\n    var active = 0;\n    var index = 0;\n    var isComplete = false;\n    var checkComplete = function () {\n        if (isComplete && !buffer.length && !active) {\n            subscriber.complete();\n        }\n    };\n    var outerNext = function (value) { return (active < concurrent ? doInnerSub(value) : buffer.push(value)); };\n    var doInnerSub = function (value) {\n        expand && subscriber.next(value);\n        active++;\n        var innerComplete = false;\n        innerFrom(project(value, index++)).subscribe(createOperatorSubscriber(subscriber, function (innerValue) {\n            onBeforeNext === null || onBeforeNext === void 0 ? void 0 : onBeforeNext(innerValue);\n            if (expand) {\n                outerNext(innerValue);\n            }\n            else {\n                subscriber.next(innerValue);\n            }\n        }, function () {\n            innerComplete = true;\n        }, undefined, function () {\n            if (innerComplete) {\n                try {\n                    active--;\n                    var _loop_1 = function () {\n                        var bufferedValue = buffer.shift();\n                        if (innerSubScheduler) {\n                            executeSchedule(subscriber, innerSubScheduler, function () { return doInnerSub(bufferedValue); });\n                        }\n                        else {\n                            doInnerSub(bufferedValue);\n                        }\n                    };\n                    while (buffer.length && active < concurrent) {\n                        _loop_1();\n                    }\n                    checkComplete();\n                }\n                catch (err) {\n                    subscriber.error(err);\n                }\n            }\n        }));\n    };\n    source.subscribe(createOperatorSubscriber(subscriber, outerNext, function () {\n        isComplete = true;\n        checkComplete();\n    }));\n    return function () {\n        additionalFinalizer === null || additionalFinalizer === void 0 ? void 0 : additionalFinalizer();\n    };\n}\n//# sourceMappingURL=mergeInternals.js.map","import { map } from './map';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nimport { isFunction } from '../util/isFunction';\nexport function mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    if (isFunction(resultSelector)) {\n        return mergeMap(function (a, i) { return map(function (b, ii) { return resultSelector(a, b, i, ii); })(innerFrom(project(a, i))); }, concurrent);\n    }\n    else if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return operate(function (source, subscriber) { return mergeInternals(source, subscriber, project, concurrent); });\n}\n//# sourceMappingURL=mergeMap.js.map","import { mergeMap } from './mergeMap';\nimport { identity } from '../util/identity';\nexport function mergeAll(concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    return mergeMap(identity, concurrent);\n}\n//# sourceMappingURL=mergeAll.js.map","import { mergeAll } from './mergeAll';\nexport function concatAll() {\n    return mergeAll(1);\n}\n//# sourceMappingURL=concatAll.js.map","import { concatAll } from '../operators/concatAll';\nimport { popScheduler } from '../util/args';\nimport { from } from './from';\nexport function concat() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return concatAll()(from(args, popScheduler(args)));\n}\n//# sourceMappingURL=concat.js.map","import { Observable } from '../Observable';\nimport { innerFrom } from './innerFrom';\nexport function defer(observableFactory) {\n    return new Observable(function (subscriber) {\n        innerFrom(observableFactory()).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=defer.js.map","import { Subject } from '../Subject';\nimport { Observable } from '../Observable';\nimport { defer } from './defer';\nvar DEFAULT_CONFIG = {\n    connector: function () { return new Subject(); },\n    resetOnDisconnect: true,\n};\nexport function connectable(source, config) {\n    if (config === void 0) { config = DEFAULT_CONFIG; }\n    var connection = null;\n    var connector = config.connector, _a = config.resetOnDisconnect, resetOnDisconnect = _a === void 0 ? true : _a;\n    var subject = connector();\n    var result = new Observable(function (subscriber) {\n        return subject.subscribe(subscriber);\n    });\n    result.connect = function () {\n        if (!connection || connection.closed) {\n            connection = defer(function () { return source; }).subscribe(subject);\n            if (resetOnDisconnect) {\n                connection.add(function () { return (subject = connector()); });\n            }\n        }\n        return connection;\n    };\n    return result;\n}\n//# sourceMappingURL=connectable.js.map","import { Observable } from '../Observable';\nimport { argsArgArrayOrObject } from '../util/argsArgArrayOrObject';\nimport { innerFrom } from './innerFrom';\nimport { popResultSelector } from '../util/args';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { createObject } from '../util/createObject';\nexport function forkJoin() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var resultSelector = popResultSelector(args);\n    var _a = argsArgArrayOrObject(args), sources = _a.args, keys = _a.keys;\n    var result = new Observable(function (subscriber) {\n        var length = sources.length;\n        if (!length) {\n            subscriber.complete();\n            return;\n        }\n        var values = new Array(length);\n        var remainingCompletions = length;\n        var remainingEmissions = length;\n        var _loop_1 = function (sourceIndex) {\n            var hasValue = false;\n            innerFrom(sources[sourceIndex]).subscribe(createOperatorSubscriber(subscriber, function (value) {\n                if (!hasValue) {\n                    hasValue = true;\n                    remainingEmissions--;\n                }\n                values[sourceIndex] = value;\n            }, function () { return remainingCompletions--; }, undefined, function () {\n                if (!remainingCompletions || !hasValue) {\n                    if (!remainingEmissions) {\n                        subscriber.next(keys ? createObject(keys, values) : values);\n                    }\n                    subscriber.complete();\n                }\n            }));\n        };\n        for (var sourceIndex = 0; sourceIndex < length; sourceIndex++) {\n            _loop_1(sourceIndex);\n        }\n    });\n    return resultSelector ? result.pipe(mapOneOrManyArgs(resultSelector)) : result;\n}\n//# sourceMappingURL=forkJoin.js.map","import { __read } from \"tslib\";\nimport { innerFrom } from '../observable/innerFrom';\nimport { Observable } from '../Observable';\nimport { mergeMap } from '../operators/mergeMap';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isFunction } from '../util/isFunction';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nvar nodeEventEmitterMethods = ['addListener', 'removeListener'];\nvar eventTargetMethods = ['addEventListener', 'removeEventListener'];\nvar jqueryMethods = ['on', 'off'];\nexport function fromEvent(target, eventName, options, resultSelector) {\n    if (isFunction(options)) {\n        resultSelector = options;\n        options = undefined;\n    }\n    if (resultSelector) {\n        return fromEvent(target, eventName, options).pipe(mapOneOrManyArgs(resultSelector));\n    }\n    var _a = __read(isEventTarget(target)\n        ? eventTargetMethods.map(function (methodName) { return function (handler) { return target[methodName](eventName, handler, options); }; })\n        :\n            isNodeStyleEventEmitter(target)\n                ? nodeEventEmitterMethods.map(toCommonHandlerRegistry(target, eventName))\n                : isJQueryStyleEventEmitter(target)\n                    ? jqueryMethods.map(toCommonHandlerRegistry(target, eventName))\n                    : [], 2), add = _a[0], remove = _a[1];\n    if (!add) {\n        if (isArrayLike(target)) {\n            return mergeMap(function (subTarget) { return fromEvent(subTarget, eventName, options); })(innerFrom(target));\n        }\n    }\n    if (!add) {\n        throw new TypeError('Invalid event target');\n    }\n    return new Observable(function (subscriber) {\n        var handler = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return subscriber.next(1 < args.length ? args : args[0]);\n        };\n        add(handler);\n        return function () { return remove(handler); };\n    });\n}\nfunction toCommonHandlerRegistry(target, eventName) {\n    return function (methodName) { return function (handler) { return target[methodName](eventName, handler); }; };\n}\nfunction isNodeStyleEventEmitter(target) {\n    return isFunction(target.addListener) && isFunction(target.removeListener);\n}\nfunction isJQueryStyleEventEmitter(target) {\n    return isFunction(target.on) && isFunction(target.off);\n}\nfunction isEventTarget(target) {\n    return isFunction(target.addEventListener) && isFunction(target.removeEventListener);\n}\n//# sourceMappingURL=fromEvent.js.map","import { Observable } from '../Observable';\nimport { isFunction } from '../util/isFunction';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nexport function fromEventPattern(addHandler, removeHandler, resultSelector) {\n    if (resultSelector) {\n        return fromEventPattern(addHandler, removeHandler).pipe(mapOneOrManyArgs(resultSelector));\n    }\n    return new Observable(function (subscriber) {\n        var handler = function () {\n            var e = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                e[_i] = arguments[_i];\n            }\n            return subscriber.next(e.length === 1 ? e[0] : e);\n        };\n        var retValue = addHandler(handler);\n        return isFunction(removeHandler) ? function () { return removeHandler(handler, retValue); } : undefined;\n    });\n}\n//# sourceMappingURL=fromEventPattern.js.map","import { __generator } from \"tslib\";\nimport { identity } from '../util/identity';\nimport { isScheduler } from '../util/isScheduler';\nimport { defer } from './defer';\nimport { scheduleIterable } from '../scheduled/scheduleIterable';\nexport function generate(initialStateOrOptions, condition, iterate, resultSelectorOrScheduler, scheduler) {\n    var _a, _b;\n    var resultSelector;\n    var initialState;\n    if (arguments.length === 1) {\n        (_a = initialStateOrOptions, initialState = _a.initialState, condition = _a.condition, iterate = _a.iterate, _b = _a.resultSelector, resultSelector = _b === void 0 ? identity : _b, scheduler = _a.scheduler);\n    }\n    else {\n        initialState = initialStateOrOptions;\n        if (!resultSelectorOrScheduler || isScheduler(resultSelectorOrScheduler)) {\n            resultSelector = identity;\n            scheduler = resultSelectorOrScheduler;\n        }\n        else {\n            resultSelector = resultSelectorOrScheduler;\n        }\n    }\n    function gen() {\n        var state;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    state = initialState;\n                    _a.label = 1;\n                case 1:\n                    if (!(!condition || condition(state))) return [3, 4];\n                    return [4, resultSelector(state)];\n                case 2:\n                    _a.sent();\n                    _a.label = 3;\n                case 3:\n                    state = iterate(state);\n                    return [3, 1];\n                case 4: return [2];\n            }\n        });\n    }\n    return defer((scheduler\n        ?\n            function () { return scheduleIterable(gen(), scheduler); }\n        :\n            gen));\n}\n//# sourceMappingURL=generate.js.map","import { defer } from './defer';\nexport function iif(condition, trueResult, falseResult) {\n    return defer(function () { return (condition() ? trueResult : falseResult); });\n}\n//# sourceMappingURL=iif.js.map","import { Observable } from '../Observable';\nimport { async as asyncScheduler } from '../scheduler/async';\nimport { isScheduler } from '../util/isScheduler';\nimport { isValidDate } from '../util/isDate';\nexport function timer(dueTime, intervalOrScheduler, scheduler) {\n    if (dueTime === void 0) { dueTime = 0; }\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var intervalDuration = -1;\n    if (intervalOrScheduler != null) {\n        if (isScheduler(intervalOrScheduler)) {\n            scheduler = intervalOrScheduler;\n        }\n        else {\n            intervalDuration = intervalOrScheduler;\n        }\n    }\n    return new Observable(function (subscriber) {\n        var due = isValidDate(dueTime) ? +dueTime - scheduler.now() : dueTime;\n        if (due < 0) {\n            due = 0;\n        }\n        var n = 0;\n        return scheduler.schedule(function () {\n            if (!subscriber.closed) {\n                subscriber.next(n++);\n                if (0 <= intervalDuration) {\n                    this.schedule(undefined, intervalDuration);\n                }\n                else {\n                    subscriber.complete();\n                }\n            }\n        }, due);\n    });\n}\n//# sourceMappingURL=timer.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { timer } from './timer';\nexport function interval(period, scheduler) {\n    if (period === void 0) { period = 0; }\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    if (period < 0) {\n        period = 0;\n    }\n    return timer(period, period, scheduler);\n}\n//# sourceMappingURL=interval.js.map","import { mergeAll } from '../operators/mergeAll';\nimport { innerFrom } from './innerFrom';\nimport { EMPTY } from './empty';\nimport { popNumber, popScheduler } from '../util/args';\nimport { from } from './from';\nexport function merge() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    var concurrent = popNumber(args, Infinity);\n    var sources = args;\n    return !sources.length\n        ?\n            EMPTY\n        : sources.length === 1\n            ?\n                innerFrom(sources[0])\n            :\n                mergeAll(concurrent)(from(sources, scheduler));\n}\n//# sourceMappingURL=merge.js.map","import { Observable } from '../Observable';\nimport { noop } from '../util/noop';\nexport var NEVER = new Observable(noop);\nexport function never() {\n    return NEVER;\n}\n//# sourceMappingURL=never.js.map","var isArray = Array.isArray;\nexport function argsOrArgArray(args) {\n    return args.length === 1 && isArray(args[0]) ? args[0] : args;\n}\n//# sourceMappingURL=argsOrArgArray.js.map","import { Observable } from '../Observable';\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { OperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { noop } from '../util/noop';\nimport { innerFrom } from './innerFrom';\nexport function onErrorResumeNext() {\n    var sources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        sources[_i] = arguments[_i];\n    }\n    var nextSources = argsOrArgArray(sources);\n    return new Observable(function (subscriber) {\n        var sourceIndex = 0;\n        var subscribeNext = function () {\n            if (sourceIndex < nextSources.length) {\n                var nextSource = void 0;\n                try {\n                    nextSource = innerFrom(nextSources[sourceIndex++]);\n                }\n                catch (err) {\n                    subscribeNext();\n                    return;\n                }\n                var innerSubscriber = new OperatorSubscriber(subscriber, undefined, noop, noop);\n                nextSource.subscribe(innerSubscriber);\n                innerSubscriber.add(subscribeNext);\n            }\n            else {\n                subscriber.complete();\n            }\n        };\n        subscribeNext();\n    });\n}\n//# sourceMappingURL=onErrorResumeNext.js.map","import { from } from './from';\nexport function pairs(obj, scheduler) {\n    return from(Object.entries(obj), scheduler);\n}\n//# sourceMappingURL=pairs.js.map","export function not(pred, thisArg) {\n    return function (value, index) { return !pred.call(thisArg, value, index); };\n}\n//# sourceMappingURL=not.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function filter(predicate, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return predicate.call(thisArg, value, index++) && subscriber.next(value); }));\n    });\n}\n//# sourceMappingURL=filter.js.map","import { not } from '../util/not';\nimport { filter } from '../operators/filter';\nimport { innerFrom } from './innerFrom';\nexport function partition(source, predicate, thisArg) {\n    return [filter(predicate, thisArg)(innerFrom(source)), filter(not(predicate, thisArg))(innerFrom(source))];\n}\n//# sourceMappingURL=partition.js.map","import { Observable } from '../Observable';\nimport { innerFrom } from './innerFrom';\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nexport function race() {\n    var sources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        sources[_i] = arguments[_i];\n    }\n    sources = argsOrArgArray(sources);\n    return sources.length === 1 ? innerFrom(sources[0]) : new Observable(raceInit(sources));\n}\nexport function raceInit(sources) {\n    return function (subscriber) {\n        var subscriptions = [];\n        var _loop_1 = function (i) {\n            subscriptions.push(innerFrom(sources[i]).subscribe(createOperatorSubscriber(subscriber, function (value) {\n                if (subscriptions) {\n                    for (var s = 0; s < subscriptions.length; s++) {\n                        s !== i && subscriptions[s].unsubscribe();\n                    }\n                    subscriptions = null;\n                }\n                subscriber.next(value);\n            })));\n        };\n        for (var i = 0; subscriptions && !subscriber.closed && i < sources.length; i++) {\n            _loop_1(i);\n        }\n    };\n}\n//# sourceMappingURL=race.js.map","import { Observable } from '../Observable';\nimport { EMPTY } from './empty';\nexport function range(start, count, scheduler) {\n    if (count == null) {\n        count = start;\n        start = 0;\n    }\n    if (count <= 0) {\n        return EMPTY;\n    }\n    var end = count + start;\n    return new Observable(scheduler\n        ?\n            function (subscriber) {\n                var n = start;\n                return scheduler.schedule(function () {\n                    if (n < end) {\n                        subscriber.next(n++);\n                        this.schedule();\n                    }\n                    else {\n                        subscriber.complete();\n                    }\n                });\n            }\n        :\n            function (subscriber) {\n                var n = start;\n                while (n < end && !subscriber.closed) {\n                    subscriber.next(n++);\n                }\n                subscriber.complete();\n            });\n}\n//# sourceMappingURL=range.js.map","import { Observable } from '../Observable';\nimport { innerFrom } from './innerFrom';\nimport { EMPTY } from './empty';\nexport function using(resourceFactory, observableFactory) {\n    return new Observable(function (subscriber) {\n        var resource = resourceFactory();\n        var result = observableFactory(resource);\n        var source = result ? innerFrom(result) : EMPTY;\n        source.subscribe(subscriber);\n        return function () {\n            if (resource) {\n                resource.unsubscribe();\n            }\n        };\n    });\n}\n//# sourceMappingURL=using.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { Observable } from '../Observable';\nimport { innerFrom } from './innerFrom';\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { EMPTY } from './empty';\nimport { createOperatorSubscriber } from '../operators/OperatorSubscriber';\nimport { popResultSelector } from '../util/args';\nexport function zip() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var resultSelector = popResultSelector(args);\n    var sources = argsOrArgArray(args);\n    return sources.length\n        ? new Observable(function (subscriber) {\n            var buffers = sources.map(function () { return []; });\n            var completed = sources.map(function () { return false; });\n            subscriber.add(function () {\n                buffers = completed = null;\n            });\n            var _loop_1 = function (sourceIndex) {\n                innerFrom(sources[sourceIndex]).subscribe(createOperatorSubscriber(subscriber, function (value) {\n                    buffers[sourceIndex].push(value);\n                    if (buffers.every(function (buffer) { return buffer.length; })) {\n                        var result = buffers.map(function (buffer) { return buffer.shift(); });\n                        subscriber.next(resultSelector ? resultSelector.apply(void 0, __spreadArray([], __read(result))) : result);\n                        if (buffers.some(function (buffer, i) { return !buffer.length && completed[i]; })) {\n                            subscriber.complete();\n                        }\n                    }\n                }, function () {\n                    completed[sourceIndex] = true;\n                    !buffers[sourceIndex].length && subscriber.complete();\n                }));\n            };\n            for (var sourceIndex = 0; !subscriber.closed && sourceIndex < sources.length; sourceIndex++) {\n                _loop_1(sourceIndex);\n            }\n            return function () {\n                buffers = completed = null;\n            };\n        })\n        : EMPTY;\n}\n//# sourceMappingURL=zip.js.map","import { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function audit(durationSelector) {\n    return operate(function (source, subscriber) {\n        var hasValue = false;\n        var lastValue = null;\n        var durationSubscriber = null;\n        var isComplete = false;\n        var endDuration = function () {\n            durationSubscriber === null || durationSubscriber === void 0 ? void 0 : durationSubscriber.unsubscribe();\n            durationSubscriber = null;\n            if (hasValue) {\n                hasValue = false;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n            isComplete && subscriber.complete();\n        };\n        var cleanupDuration = function () {\n            durationSubscriber = null;\n            isComplete && subscriber.complete();\n        };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            hasValue = true;\n            lastValue = value;\n            if (!durationSubscriber) {\n                innerFrom(durationSelector(value)).subscribe((durationSubscriber = createOperatorSubscriber(subscriber, endDuration, cleanupDuration)));\n            }\n        }, function () {\n            isComplete = true;\n            (!hasValue || !durationSubscriber || durationSubscriber.closed) && subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=audit.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { audit } from './audit';\nimport { timer } from '../observable/timer';\nexport function auditTime(duration, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    return audit(function () { return timer(duration, scheduler); });\n}\n//# sourceMappingURL=auditTime.js.map","import { operate } from '../util/lift';\nimport { noop } from '../util/noop';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nexport function buffer(closingNotifier) {\n    return operate(function (source, subscriber) {\n        var currentBuffer = [];\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return currentBuffer.push(value); }, function () {\n            subscriber.next(currentBuffer);\n            subscriber.complete();\n        }));\n        innerFrom(closingNotifier).subscribe(createOperatorSubscriber(subscriber, function () {\n            var b = currentBuffer;\n            currentBuffer = [];\n            subscriber.next(b);\n        }, noop));\n        return function () {\n            currentBuffer = null;\n        };\n    });\n}\n//# sourceMappingURL=buffer.js.map","import { __values } from \"tslib\";\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { arrRemove } from '../util/arrRemove';\nexport function bufferCount(bufferSize, startBufferEvery) {\n    if (startBufferEvery === void 0) { startBufferEvery = null; }\n    startBufferEvery = startBufferEvery !== null && startBufferEvery !== void 0 ? startBufferEvery : bufferSize;\n    return operate(function (source, subscriber) {\n        var buffers = [];\n        var count = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var e_1, _a, e_2, _b;\n            var toEmit = null;\n            if (count++ % startBufferEvery === 0) {\n                buffers.push([]);\n            }\n            try {\n                for (var buffers_1 = __values(buffers), buffers_1_1 = buffers_1.next(); !buffers_1_1.done; buffers_1_1 = buffers_1.next()) {\n                    var buffer = buffers_1_1.value;\n                    buffer.push(value);\n                    if (bufferSize <= buffer.length) {\n                        toEmit = toEmit !== null && toEmit !== void 0 ? toEmit : [];\n                        toEmit.push(buffer);\n                    }\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (buffers_1_1 && !buffers_1_1.done && (_a = buffers_1.return)) _a.call(buffers_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            if (toEmit) {\n                try {\n                    for (var toEmit_1 = __values(toEmit), toEmit_1_1 = toEmit_1.next(); !toEmit_1_1.done; toEmit_1_1 = toEmit_1.next()) {\n                        var buffer = toEmit_1_1.value;\n                        arrRemove(buffers, buffer);\n                        subscriber.next(buffer);\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (toEmit_1_1 && !toEmit_1_1.done && (_b = toEmit_1.return)) _b.call(toEmit_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n        }, function () {\n            var e_3, _a;\n            try {\n                for (var buffers_2 = __values(buffers), buffers_2_1 = buffers_2.next(); !buffers_2_1.done; buffers_2_1 = buffers_2.next()) {\n                    var buffer = buffers_2_1.value;\n                    subscriber.next(buffer);\n                }\n            }\n            catch (e_3_1) { e_3 = { error: e_3_1 }; }\n            finally {\n                try {\n                    if (buffers_2_1 && !buffers_2_1.done && (_a = buffers_2.return)) _a.call(buffers_2);\n                }\n                finally { if (e_3) throw e_3.error; }\n            }\n            subscriber.complete();\n        }, undefined, function () {\n            buffers = null;\n        }));\n    });\n}\n//# sourceMappingURL=bufferCount.js.map","import { __values } from \"tslib\";\nimport { Subscription } from '../Subscription';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { arrRemove } from '../util/arrRemove';\nimport { asyncScheduler } from '../scheduler/async';\nimport { popScheduler } from '../util/args';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function bufferTime(bufferTimeSpan) {\n    var _a, _b;\n    var otherArgs = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        otherArgs[_i - 1] = arguments[_i];\n    }\n    var scheduler = (_a = popScheduler(otherArgs)) !== null && _a !== void 0 ? _a : asyncScheduler;\n    var bufferCreationInterval = (_b = otherArgs[0]) !== null && _b !== void 0 ? _b : null;\n    var maxBufferSize = otherArgs[1] || Infinity;\n    return operate(function (source, subscriber) {\n        var bufferRecords = [];\n        var restartOnEmit = false;\n        var emit = function (record) {\n            var buffer = record.buffer, subs = record.subs;\n            subs.unsubscribe();\n            arrRemove(bufferRecords, record);\n            subscriber.next(buffer);\n            restartOnEmit && startBuffer();\n        };\n        var startBuffer = function () {\n            if (bufferRecords) {\n                var subs = new Subscription();\n                subscriber.add(subs);\n                var buffer = [];\n                var record_1 = {\n                    buffer: buffer,\n                    subs: subs,\n                };\n                bufferRecords.push(record_1);\n                executeSchedule(subs, scheduler, function () { return emit(record_1); }, bufferTimeSpan);\n            }\n        };\n        if (bufferCreationInterval !== null && bufferCreationInterval >= 0) {\n            executeSchedule(subscriber, scheduler, startBuffer, bufferCreationInterval, true);\n        }\n        else {\n            restartOnEmit = true;\n        }\n        startBuffer();\n        var bufferTimeSubscriber = createOperatorSubscriber(subscriber, function (value) {\n            var e_1, _a;\n            var recordsCopy = bufferRecords.slice();\n            try {\n                for (var recordsCopy_1 = __values(recordsCopy), recordsCopy_1_1 = recordsCopy_1.next(); !recordsCopy_1_1.done; recordsCopy_1_1 = recordsCopy_1.next()) {\n                    var record = recordsCopy_1_1.value;\n                    var buffer = record.buffer;\n                    buffer.push(value);\n                    maxBufferSize <= buffer.length && emit(record);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (recordsCopy_1_1 && !recordsCopy_1_1.done && (_a = recordsCopy_1.return)) _a.call(recordsCopy_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }, function () {\n            while (bufferRecords === null || bufferRecords === void 0 ? void 0 : bufferRecords.length) {\n                subscriber.next(bufferRecords.shift().buffer);\n            }\n            bufferTimeSubscriber === null || bufferTimeSubscriber === void 0 ? void 0 : bufferTimeSubscriber.unsubscribe();\n            subscriber.complete();\n            subscriber.unsubscribe();\n        }, undefined, function () { return (bufferRecords = null); });\n        source.subscribe(bufferTimeSubscriber);\n    });\n}\n//# sourceMappingURL=bufferTime.js.map","import { __values } from \"tslib\";\nimport { Subscription } from '../Subscription';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nimport { arrRemove } from '../util/arrRemove';\nexport function bufferToggle(openings, closingSelector) {\n    return operate(function (source, subscriber) {\n        var buffers = [];\n        innerFrom(openings).subscribe(createOperatorSubscriber(subscriber, function (openValue) {\n            var buffer = [];\n            buffers.push(buffer);\n            var closingSubscription = new Subscription();\n            var emitBuffer = function () {\n                arrRemove(buffers, buffer);\n                subscriber.next(buffer);\n                closingSubscription.unsubscribe();\n            };\n            closingSubscription.add(innerFrom(closingSelector(openValue)).subscribe(createOperatorSubscriber(subscriber, emitBuffer, noop)));\n        }, noop));\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var e_1, _a;\n            try {\n                for (var buffers_1 = __values(buffers), buffers_1_1 = buffers_1.next(); !buffers_1_1.done; buffers_1_1 = buffers_1.next()) {\n                    var buffer = buffers_1_1.value;\n                    buffer.push(value);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (buffers_1_1 && !buffers_1_1.done && (_a = buffers_1.return)) _a.call(buffers_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }, function () {\n            while (buffers.length > 0) {\n                subscriber.next(buffers.shift());\n            }\n            subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=bufferToggle.js.map","import { operate } from '../util/lift';\nimport { noop } from '../util/noop';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nexport function bufferWhen(closingSelector) {\n    return operate(function (source, subscriber) {\n        var buffer = null;\n        var closingSubscriber = null;\n        var openBuffer = function () {\n            closingSubscriber === null || closingSubscriber === void 0 ? void 0 : closingSubscriber.unsubscribe();\n            var b = buffer;\n            buffer = [];\n            b && subscriber.next(b);\n            innerFrom(closingSelector()).subscribe((closingSubscriber = createOperatorSubscriber(subscriber, openBuffer, noop)));\n        };\n        openBuffer();\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return buffer === null || buffer === void 0 ? void 0 : buffer.push(value); }, function () {\n            buffer && subscriber.next(buffer);\n            subscriber.complete();\n        }, undefined, function () { return (buffer = closingSubscriber = null); }));\n    });\n}\n//# sourceMappingURL=bufferWhen.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { operate } from '../util/lift';\nexport function catchError(selector) {\n    return operate(function (source, subscriber) {\n        var innerSub = null;\n        var syncUnsub = false;\n        var handledResult;\n        innerSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, undefined, function (err) {\n            handledResult = innerFrom(selector(err, catchError(selector)(source)));\n            if (innerSub) {\n                innerSub.unsubscribe();\n                innerSub = null;\n                handledResult.subscribe(subscriber);\n            }\n            else {\n                syncUnsub = true;\n            }\n        }));\n        if (syncUnsub) {\n            innerSub.unsubscribe();\n            innerSub = null;\n            handledResult.subscribe(subscriber);\n        }\n    });\n}\n//# sourceMappingURL=catchError.js.map","import { createOperatorSubscriber } from './OperatorSubscriber';\nexport function scanInternals(accumulator, seed, hasSeed, emitOnNext, emitBeforeComplete) {\n    return function (source, subscriber) {\n        var hasState = hasSeed;\n        var state = seed;\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var i = index++;\n            state = hasState\n                ?\n                    accumulator(state, value, i)\n                :\n                    ((hasState = true), value);\n            emitOnNext && subscriber.next(state);\n        }, emitBeforeComplete &&\n            (function () {\n                hasState && subscriber.next(state);\n                subscriber.complete();\n            })));\n    };\n}\n//# sourceMappingURL=scanInternals.js.map","import { scanInternals } from './scanInternals';\nimport { operate } from '../util/lift';\nexport function reduce(accumulator, seed) {\n    return operate(scanInternals(accumulator, seed, arguments.length >= 2, false, true));\n}\n//# sourceMappingURL=reduce.js.map","import { reduce } from './reduce';\nimport { operate } from '../util/lift';\nvar arrReducer = function (arr, value) { return (arr.push(value), arr); };\nexport function toArray() {\n    return operate(function (source, subscriber) {\n        reduce(arrReducer, [])(source).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=toArray.js.map","import { identity } from '../util/identity';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { pipe } from '../util/pipe';\nimport { mergeMap } from './mergeMap';\nimport { toArray } from './toArray';\nexport function joinAllInternals(joinFn, project) {\n    return pipe(toArray(), mergeMap(function (sources) { return joinFn(sources); }), project ? mapOneOrManyArgs(project) : identity);\n}\n//# sourceMappingURL=joinAllInternals.js.map","import { combineLatest } from '../observable/combineLatest';\nimport { joinAllInternals } from './joinAllInternals';\nexport function combineLatestAll(project) {\n    return joinAllInternals(combineLatest, project);\n}\n//# sourceMappingURL=combineLatestAll.js.map","import { combineLatestAll } from './combineLatestAll';\nexport var combineAll = combineLatestAll;\n//# sourceMappingURL=combineAll.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { combineLatestInit } from '../observable/combineLatest';\nimport { operate } from '../util/lift';\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { pipe } from '../util/pipe';\nimport { popResultSelector } from '../util/args';\nexport function combineLatest() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var resultSelector = popResultSelector(args);\n    return resultSelector\n        ? pipe(combineLatest.apply(void 0, __spreadArray([], __read(args))), mapOneOrManyArgs(resultSelector))\n        : operate(function (source, subscriber) {\n            combineLatestInit(__spreadArray([source], __read(argsOrArgArray(args))))(subscriber);\n        });\n}\n//# sourceMappingURL=combineLatest.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { combineLatest } from './combineLatest';\nexport function combineLatestWith() {\n    var otherSources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        otherSources[_i] = arguments[_i];\n    }\n    return combineLatest.apply(void 0, __spreadArray([], __read(otherSources)));\n}\n//# sourceMappingURL=combineLatestWith.js.map","import { mergeMap } from './mergeMap';\nimport { isFunction } from '../util/isFunction';\nexport function concatMap(project, resultSelector) {\n    return isFunction(resultSelector) ? mergeMap(project, resultSelector, 1) : mergeMap(project, 1);\n}\n//# sourceMappingURL=concatMap.js.map","import { concatMap } from './concatMap';\nimport { isFunction } from '../util/isFunction';\nexport function concatMapTo(innerObservable, resultSelector) {\n    return isFunction(resultSelector) ? concatMap(function () { return innerObservable; }, resultSelector) : concatMap(function () { return innerObservable; });\n}\n//# sourceMappingURL=concatMapTo.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { operate } from '../util/lift';\nimport { concatAll } from './concatAll';\nimport { popScheduler } from '../util/args';\nimport { from } from '../observable/from';\nexport function concat() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    return operate(function (source, subscriber) {\n        concatAll()(from(__spreadArray([source], __read(args)), scheduler)).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=concat.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { concat } from './concat';\nexport function concatWith() {\n    var otherSources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        otherSources[_i] = arguments[_i];\n    }\n    return concat.apply(void 0, __spreadArray([], __read(otherSources)));\n}\n//# sourceMappingURL=concatWith.js.map","import { Observable } from '../Observable';\nexport function fromSubscribable(subscribable) {\n    return new Observable(function (subscriber) { return subscribable.subscribe(subscriber); });\n}\n//# sourceMappingURL=fromSubscribable.js.map","import { Subject } from '../Subject';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { fromSubscribable } from '../observable/fromSubscribable';\nvar DEFAULT_CONFIG = {\n    connector: function () { return new Subject(); },\n};\nexport function connect(selector, config) {\n    if (config === void 0) { config = DEFAULT_CONFIG; }\n    var connector = config.connector;\n    return operate(function (source, subscriber) {\n        var subject = connector();\n        innerFrom(selector(fromSubscribable(subject))).subscribe(subscriber);\n        subscriber.add(source.subscribe(subject));\n    });\n}\n//# sourceMappingURL=connect.js.map","import { reduce } from './reduce';\nexport function count(predicate) {\n    return reduce(function (total, value, i) { return (!predicate || predicate(value, i) ? total + 1 : total); }, 0);\n}\n//# sourceMappingURL=count.js.map","import { operate } from '../util/lift';\nimport { noop } from '../util/noop';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nexport function debounce(durationSelector) {\n    return operate(function (source, subscriber) {\n        var hasValue = false;\n        var lastValue = null;\n        var durationSubscriber = null;\n        var emit = function () {\n            durationSubscriber === null || durationSubscriber === void 0 ? void 0 : durationSubscriber.unsubscribe();\n            durationSubscriber = null;\n            if (hasValue) {\n                hasValue = false;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            durationSubscriber === null || durationSubscriber === void 0 ? void 0 : durationSubscriber.unsubscribe();\n            hasValue = true;\n            lastValue = value;\n            durationSubscriber = createOperatorSubscriber(subscriber, emit, noop);\n            innerFrom(durationSelector(value)).subscribe(durationSubscriber);\n        }, function () {\n            emit();\n            subscriber.complete();\n        }, undefined, function () {\n            lastValue = durationSubscriber = null;\n        }));\n    });\n}\n//# sourceMappingURL=debounce.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function debounceTime(dueTime, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    return operate(function (source, subscriber) {\n        var activeTask = null;\n        var lastValue = null;\n        var lastTime = null;\n        var emit = function () {\n            if (activeTask) {\n                activeTask.unsubscribe();\n                activeTask = null;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        };\n        function emitWhenIdle() {\n            var targetTime = lastTime + dueTime;\n            var now = scheduler.now();\n            if (now < targetTime) {\n                activeTask = this.schedule(undefined, targetTime - now);\n                subscriber.add(activeTask);\n                return;\n            }\n            emit();\n        }\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            lastValue = value;\n            lastTime = scheduler.now();\n            if (!activeTask) {\n                activeTask = scheduler.schedule(emitWhenIdle, dueTime);\n                subscriber.add(activeTask);\n            }\n        }, function () {\n            emit();\n            subscriber.complete();\n        }, undefined, function () {\n            lastValue = activeTask = null;\n        }));\n    });\n}\n//# sourceMappingURL=debounceTime.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function defaultIfEmpty(defaultValue) {\n    return operate(function (source, subscriber) {\n        var hasValue = false;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            hasValue = true;\n            subscriber.next(value);\n        }, function () {\n            if (!hasValue) {\n                subscriber.next(defaultValue);\n            }\n            subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=defaultIfEmpty.js.map","import { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function take(count) {\n    return count <= 0\n        ?\n            function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var seen = 0;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                if (++seen <= count) {\n                    subscriber.next(value);\n                    if (count <= seen) {\n                        subscriber.complete();\n                    }\n                }\n            }));\n        });\n}\n//# sourceMappingURL=take.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nexport function ignoreElements() {\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, noop));\n    });\n}\n//# sourceMappingURL=ignoreElements.js.map","import { map } from './map';\nexport function mapTo(value) {\n    return map(function () { return value; });\n}\n//# sourceMappingURL=mapTo.js.map","import { concat } from '../observable/concat';\nimport { take } from './take';\nimport { ignoreElements } from './ignoreElements';\nimport { mapTo } from './mapTo';\nimport { mergeMap } from './mergeMap';\nimport { innerFrom } from '../observable/innerFrom';\nexport function delayWhen(delayDurationSelector, subscriptionDelay) {\n    if (subscriptionDelay) {\n        return function (source) {\n            return concat(subscriptionDelay.pipe(take(1), ignoreElements()), source.pipe(delayWhen(delayDurationSelector)));\n        };\n    }\n    return mergeMap(function (value, index) { return innerFrom(delayDurationSelector(value, index)).pipe(take(1), mapTo(value)); });\n}\n//# sourceMappingURL=delayWhen.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { delayWhen } from './delayWhen';\nimport { timer } from '../observable/timer';\nexport function delay(due, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var duration = timer(due, scheduler);\n    return delayWhen(function () { return duration; });\n}\n//# sourceMappingURL=delay.js.map","import { observeNotification } from '../Notification';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function dematerialize() {\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, function (notification) { return observeNotification(notification, subscriber); }));\n    });\n}\n//# sourceMappingURL=dematerialize.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nimport { innerFrom } from '../observable/innerFrom';\nexport function distinct(keySelector, flushes) {\n    return operate(function (source, subscriber) {\n        var distinctKeys = new Set();\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var key = keySelector ? keySelector(value) : value;\n            if (!distinctKeys.has(key)) {\n                distinctKeys.add(key);\n                subscriber.next(value);\n            }\n        }));\n        flushes && innerFrom(flushes).subscribe(createOperatorSubscriber(subscriber, function () { return distinctKeys.clear(); }, noop));\n    });\n}\n//# sourceMappingURL=distinct.js.map","import { identity } from '../util/identity';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function distinctUntilChanged(comparator, keySelector) {\n    if (keySelector === void 0) { keySelector = identity; }\n    comparator = comparator !== null && comparator !== void 0 ? comparator : defaultCompare;\n    return operate(function (source, subscriber) {\n        var previousKey;\n        var first = true;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var currentKey = keySelector(value);\n            if (first || !comparator(previousKey, currentKey)) {\n                first = false;\n                previousKey = currentKey;\n                subscriber.next(value);\n            }\n        }));\n    });\n}\nfunction defaultCompare(a, b) {\n    return a === b;\n}\n//# sourceMappingURL=distinctUntilChanged.js.map","import { distinctUntilChanged } from './distinctUntilChanged';\nexport function distinctUntilKeyChanged(key, compare) {\n    return distinctUntilChanged(function (x, y) { return compare ? compare(x[key], y[key]) : x[key] === y[key]; });\n}\n//# sourceMappingURL=distinctUntilKeyChanged.js.map","import { EmptyError } from '../util/EmptyError';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function throwIfEmpty(errorFactory) {\n    if (errorFactory === void 0) { errorFactory = defaultErrorFactory; }\n    return operate(function (source, subscriber) {\n        var hasValue = false;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            hasValue = true;\n            subscriber.next(value);\n        }, function () { return (hasValue ? subscriber.complete() : subscriber.error(errorFactory())); }));\n    });\n}\nfunction defaultErrorFactory() {\n    return new EmptyError();\n}\n//# sourceMappingURL=throwIfEmpty.js.map","import { ArgumentOutOfRangeError } from '../util/ArgumentOutOfRangeError';\nimport { filter } from './filter';\nimport { throwIfEmpty } from './throwIfEmpty';\nimport { defaultIfEmpty } from './defaultIfEmpty';\nimport { take } from './take';\nexport function elementAt(index, defaultValue) {\n    if (index < 0) {\n        throw new ArgumentOutOfRangeError();\n    }\n    var hasDefaultValue = arguments.length >= 2;\n    return function (source) {\n        return source.pipe(filter(function (v, i) { return i === index; }), take(1), hasDefaultValue ? defaultIfEmpty(defaultValue) : throwIfEmpty(function () { return new ArgumentOutOfRangeError(); }));\n    };\n}\n//# sourceMappingURL=elementAt.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { concat } from '../observable/concat';\nimport { of } from '../observable/of';\nexport function endWith() {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    return function (source) { return concat(source, of.apply(void 0, __spreadArray([], __read(values)))); };\n}\n//# sourceMappingURL=endWith.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function every(predicate, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            if (!predicate.call(thisArg, value, index++, source)) {\n                subscriber.next(false);\n                subscriber.complete();\n            }\n        }, function () {\n            subscriber.next(true);\n            subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=every.js.map","import { map } from './map';\nimport { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function exhaustMap(project, resultSelector) {\n    if (resultSelector) {\n        return function (source) {\n            return source.pipe(exhaustMap(function (a, i) { return innerFrom(project(a, i)).pipe(map(function (b, ii) { return resultSelector(a, b, i, ii); })); }));\n        };\n    }\n    return operate(function (source, subscriber) {\n        var index = 0;\n        var innerSub = null;\n        var isComplete = false;\n        source.subscribe(createOperatorSubscriber(subscriber, function (outerValue) {\n            if (!innerSub) {\n                innerSub = createOperatorSubscriber(subscriber, undefined, function () {\n                    innerSub = null;\n                    isComplete && subscriber.complete();\n                });\n                innerFrom(project(outerValue, index++)).subscribe(innerSub);\n            }\n        }, function () {\n            isComplete = true;\n            !innerSub && subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=exhaustMap.js.map","import { exhaustMap } from './exhaustMap';\nimport { identity } from '../util/identity';\nexport function exhaustAll() {\n    return exhaustMap(identity);\n}\n//# sourceMappingURL=exhaustAll.js.map","import { exhaustAll } from './exhaustAll';\nexport var exhaust = exhaustAll;\n//# sourceMappingURL=exhaust.js.map","import { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nexport function expand(project, concurrent, scheduler) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    concurrent = (concurrent || 0) < 1 ? Infinity : concurrent;\n    return operate(function (source, subscriber) {\n        return mergeInternals(source, subscriber, project, concurrent, undefined, true, scheduler);\n    });\n}\n//# sourceMappingURL=expand.js.map","import { operate } from '../util/lift';\nexport function finalize(callback) {\n    return operate(function (source, subscriber) {\n        try {\n            source.subscribe(subscriber);\n        }\n        finally {\n            subscriber.add(callback);\n        }\n    });\n}\n//# sourceMappingURL=finalize.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function find(predicate, thisArg) {\n    return operate(createFind(predicate, thisArg, 'value'));\n}\nexport function createFind(predicate, thisArg, emit) {\n    var findIndex = emit === 'index';\n    return function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var i = index++;\n            if (predicate.call(thisArg, value, i, source)) {\n                subscriber.next(findIndex ? i : value);\n                subscriber.complete();\n            }\n        }, function () {\n            subscriber.next(findIndex ? -1 : undefined);\n            subscriber.complete();\n        }));\n    };\n}\n//# sourceMappingURL=find.js.map","import { operate } from '../util/lift';\nimport { createFind } from './find';\nexport function findIndex(predicate, thisArg) {\n    return operate(createFind(predicate, thisArg, 'index'));\n}\n//# sourceMappingURL=findIndex.js.map","import { EmptyError } from '../util/EmptyError';\nimport { filter } from './filter';\nimport { take } from './take';\nimport { defaultIfEmpty } from './defaultIfEmpty';\nimport { throwIfEmpty } from './throwIfEmpty';\nimport { identity } from '../util/identity';\nexport function first(predicate, defaultValue) {\n    var hasDefaultValue = arguments.length >= 2;\n    return function (source) {\n        return source.pipe(predicate ? filter(function (v, i) { return predicate(v, i, source); }) : identity, take(1), hasDefaultValue ? defaultIfEmpty(defaultValue) : throwIfEmpty(function () { return new EmptyError(); }));\n    };\n}\n//# sourceMappingURL=first.js.map","import { Observable } from '../Observable';\nimport { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber, OperatorSubscriber } from './OperatorSubscriber';\nexport function groupBy(keySelector, elementOrOptions, duration, connector) {\n    return operate(function (source, subscriber) {\n        var element;\n        if (!elementOrOptions || typeof elementOrOptions === 'function') {\n            element = elementOrOptions;\n        }\n        else {\n            (duration = elementOrOptions.duration, element = elementOrOptions.element, connector = elementOrOptions.connector);\n        }\n        var groups = new Map();\n        var notify = function (cb) {\n            groups.forEach(cb);\n            cb(subscriber);\n        };\n        var handleError = function (err) { return notify(function (consumer) { return consumer.error(err); }); };\n        var activeGroups = 0;\n        var teardownAttempted = false;\n        var groupBySourceSubscriber = new OperatorSubscriber(subscriber, function (value) {\n            try {\n                var key_1 = keySelector(value);\n                var group_1 = groups.get(key_1);\n                if (!group_1) {\n                    groups.set(key_1, (group_1 = connector ? connector() : new Subject()));\n                    var grouped = createGroupedObservable(key_1, group_1);\n                    subscriber.next(grouped);\n                    if (duration) {\n                        var durationSubscriber_1 = createOperatorSubscriber(group_1, function () {\n                            group_1.complete();\n                            durationSubscriber_1 === null || durationSubscriber_1 === void 0 ? void 0 : durationSubscriber_1.unsubscribe();\n                        }, undefined, undefined, function () { return groups.delete(key_1); });\n                        groupBySourceSubscriber.add(innerFrom(duration(grouped)).subscribe(durationSubscriber_1));\n                    }\n                }\n                group_1.next(element ? element(value) : value);\n            }\n            catch (err) {\n                handleError(err);\n            }\n        }, function () { return notify(function (consumer) { return consumer.complete(); }); }, handleError, function () { return groups.clear(); }, function () {\n            teardownAttempted = true;\n            return activeGroups === 0;\n        });\n        source.subscribe(groupBySourceSubscriber);\n        function createGroupedObservable(key, groupSubject) {\n            var result = new Observable(function (groupSubscriber) {\n                activeGroups++;\n                var innerSub = groupSubject.subscribe(groupSubscriber);\n                return function () {\n                    innerSub.unsubscribe();\n                    --activeGroups === 0 && teardownAttempted && groupBySourceSubscriber.unsubscribe();\n                };\n            });\n            result.key = key;\n            return result;\n        }\n    });\n}\n//# sourceMappingURL=groupBy.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function isEmpty() {\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, function () {\n            subscriber.next(false);\n            subscriber.complete();\n        }, function () {\n            subscriber.next(true);\n            subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=isEmpty.js.map","import { __values } from \"tslib\";\nimport { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function takeLast(count) {\n    return count <= 0\n        ? function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var buffer = [];\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                buffer.push(value);\n                count < buffer.length && buffer.shift();\n            }, function () {\n                var e_1, _a;\n                try {\n                    for (var buffer_1 = __values(buffer), buffer_1_1 = buffer_1.next(); !buffer_1_1.done; buffer_1_1 = buffer_1.next()) {\n                        var value = buffer_1_1.value;\n                        subscriber.next(value);\n                    }\n                }\n                catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                finally {\n                    try {\n                        if (buffer_1_1 && !buffer_1_1.done && (_a = buffer_1.return)) _a.call(buffer_1);\n                    }\n                    finally { if (e_1) throw e_1.error; }\n                }\n                subscriber.complete();\n            }, undefined, function () {\n                buffer = null;\n            }));\n        });\n}\n//# sourceMappingURL=takeLast.js.map","import { EmptyError } from '../util/EmptyError';\nimport { filter } from './filter';\nimport { takeLast } from './takeLast';\nimport { throwIfEmpty } from './throwIfEmpty';\nimport { defaultIfEmpty } from './defaultIfEmpty';\nimport { identity } from '../util/identity';\nexport function last(predicate, defaultValue) {\n    var hasDefaultValue = arguments.length >= 2;\n    return function (source) {\n        return source.pipe(predicate ? filter(function (v, i) { return predicate(v, i, source); }) : identity, takeLast(1), hasDefaultValue ? defaultIfEmpty(defaultValue) : throwIfEmpty(function () { return new EmptyError(); }));\n    };\n}\n//# sourceMappingURL=last.js.map","import { Notification } from '../Notification';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function materialize() {\n    return operate(function (source, subscriber) {\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            subscriber.next(Notification.createNext(value));\n        }, function () {\n            subscriber.next(Notification.createComplete());\n            subscriber.complete();\n        }, function (err) {\n            subscriber.next(Notification.createError(err));\n            subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=materialize.js.map","import { reduce } from './reduce';\nimport { isFunction } from '../util/isFunction';\nexport function max(comparer) {\n    return reduce(isFunction(comparer) ? function (x, y) { return (comparer(x, y) > 0 ? x : y); } : function (x, y) { return (x > y ? x : y); });\n}\n//# sourceMappingURL=max.js.map","import { mergeMap } from './mergeMap';\nexport var flatMap = mergeMap;\n//# sourceMappingURL=flatMap.js.map","import { mergeMap } from './mergeMap';\nimport { isFunction } from '../util/isFunction';\nexport function mergeMapTo(innerObservable, resultSelector, concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    if (isFunction(resultSelector)) {\n        return mergeMap(function () { return innerObservable; }, resultSelector, concurrent);\n    }\n    if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return mergeMap(function () { return innerObservable; }, concurrent);\n}\n//# sourceMappingURL=mergeMapTo.js.map","import { operate } from '../util/lift';\nimport { mergeInternals } from './mergeInternals';\nexport function mergeScan(accumulator, seed, concurrent) {\n    if (concurrent === void 0) { concurrent = Infinity; }\n    return operate(function (source, subscriber) {\n        var state = seed;\n        return mergeInternals(source, subscriber, function (value, index) { return accumulator(state, value, index); }, concurrent, function (value) {\n            state = value;\n        }, false, undefined, function () { return (state = null); });\n    });\n}\n//# sourceMappingURL=mergeScan.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { operate } from '../util/lift';\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { mergeAll } from './mergeAll';\nimport { popNumber, popScheduler } from '../util/args';\nimport { from } from '../observable/from';\nexport function merge() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(args);\n    var concurrent = popNumber(args, Infinity);\n    args = argsOrArgArray(args);\n    return operate(function (source, subscriber) {\n        mergeAll(concurrent)(from(__spreadArray([source], __read(args)), scheduler)).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=merge.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { merge } from './merge';\nexport function mergeWith() {\n    var otherSources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        otherSources[_i] = arguments[_i];\n    }\n    return merge.apply(void 0, __spreadArray([], __read(otherSources)));\n}\n//# sourceMappingURL=mergeWith.js.map","import { reduce } from './reduce';\nimport { isFunction } from '../util/isFunction';\nexport function min(comparer) {\n    return reduce(isFunction(comparer) ? function (x, y) { return (comparer(x, y) < 0 ? x : y); } : function (x, y) { return (x < y ? x : y); });\n}\n//# sourceMappingURL=min.js.map","import { ConnectableObservable } from '../observable/ConnectableObservable';\nimport { isFunction } from '../util/isFunction';\nimport { connect } from './connect';\nexport function multicast(subjectOrSubjectFactory, selector) {\n    var subjectFactory = isFunction(subjectOrSubjectFactory) ? subjectOrSubjectFactory : function () { return subjectOrSubjectFactory; };\n    if (isFunction(selector)) {\n        return connect(selector, {\n            connector: subjectFactory,\n        });\n    }\n    return function (source) { return new ConnectableObservable(source, subjectFactory); };\n}\n//# sourceMappingURL=multicast.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { onErrorResumeNext as oERNCreate } from '../observable/onErrorResumeNext';\nexport function onErrorResumeNextWith() {\n    var sources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        sources[_i] = arguments[_i];\n    }\n    var nextSources = argsOrArgArray(sources);\n    return function (source) { return oERNCreate.apply(void 0, __spreadArray([source], __read(nextSources))); };\n}\nexport var onErrorResumeNext = onErrorResumeNextWith;\n//# sourceMappingURL=onErrorResumeNextWith.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function pairwise() {\n    return operate(function (source, subscriber) {\n        var prev;\n        var hasPrev = false;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var p = prev;\n            prev = value;\n            hasPrev && subscriber.next([p, value]);\n            hasPrev = true;\n        }));\n    });\n}\n//# sourceMappingURL=pairwise.js.map","import { map } from './map';\nexport function pluck() {\n    var properties = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        properties[_i] = arguments[_i];\n    }\n    var length = properties.length;\n    if (length === 0) {\n        throw new Error('list of properties cannot be empty.');\n    }\n    return map(function (x) {\n        var currentProp = x;\n        for (var i = 0; i < length; i++) {\n            var p = currentProp === null || currentProp === void 0 ? void 0 : currentProp[properties[i]];\n            if (typeof p !== 'undefined') {\n                currentProp = p;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return currentProp;\n    });\n}\n//# sourceMappingURL=pluck.js.map","import { Subject } from '../Subject';\nimport { multicast } from './multicast';\nimport { connect } from './connect';\nexport function publish(selector) {\n    return selector ? function (source) { return connect(selector)(source); } : function (source) { return multicast(new Subject())(source); };\n}\n//# sourceMappingURL=publish.js.map","import { BehaviorSubject } from '../BehaviorSubject';\nimport { ConnectableObservable } from '../observable/ConnectableObservable';\nexport function publishBehavior(initialValue) {\n    return function (source) {\n        var subject = new BehaviorSubject(initialValue);\n        return new ConnectableObservable(source, function () { return subject; });\n    };\n}\n//# sourceMappingURL=publishBehavior.js.map","import { AsyncSubject } from '../AsyncSubject';\nimport { ConnectableObservable } from '../observable/ConnectableObservable';\nexport function publishLast() {\n    return function (source) {\n        var subject = new AsyncSubject();\n        return new ConnectableObservable(source, function () { return subject; });\n    };\n}\n//# sourceMappingURL=publishLast.js.map","import { ReplaySubject } from '../ReplaySubject';\nimport { multicast } from './multicast';\nimport { isFunction } from '../util/isFunction';\nexport function publishReplay(bufferSize, windowTime, selectorOrScheduler, timestampProvider) {\n    if (selectorOrScheduler && !isFunction(selectorOrScheduler)) {\n        timestampProvider = selectorOrScheduler;\n    }\n    var selector = isFunction(selectorOrScheduler) ? selectorOrScheduler : undefined;\n    return function (source) { return multicast(new ReplaySubject(bufferSize, windowTime, timestampProvider), selector)(source); };\n}\n//# sourceMappingURL=publishReplay.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { raceInit } from '../observable/race';\nimport { operate } from '../util/lift';\nimport { identity } from '../util/identity';\nexport function raceWith() {\n    var otherSources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        otherSources[_i] = arguments[_i];\n    }\n    return !otherSources.length\n        ? identity\n        : operate(function (source, subscriber) {\n            raceInit(__spreadArray([source], __read(otherSources)))(subscriber);\n        });\n}\n//# sourceMappingURL=raceWith.js.map","import { EMPTY } from '../observable/empty';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nimport { timer } from '../observable/timer';\nexport function repeat(countOrConfig) {\n    var _a;\n    var count = Infinity;\n    var delay;\n    if (countOrConfig != null) {\n        if (typeof countOrConfig === 'object') {\n            (_a = countOrConfig.count, count = _a === void 0 ? Infinity : _a, delay = countOrConfig.delay);\n        }\n        else {\n            count = countOrConfig;\n        }\n    }\n    return count <= 0\n        ? function () { return EMPTY; }\n        : operate(function (source, subscriber) {\n            var soFar = 0;\n            var sourceSub;\n            var resubscribe = function () {\n                sourceSub === null || sourceSub === void 0 ? void 0 : sourceSub.unsubscribe();\n                sourceSub = null;\n                if (delay != null) {\n                    var notifier = typeof delay === 'number' ? timer(delay) : innerFrom(delay(soFar));\n                    var notifierSubscriber_1 = createOperatorSubscriber(subscriber, function () {\n                        notifierSubscriber_1.unsubscribe();\n                        subscribeToSource();\n                    });\n                    notifier.subscribe(notifierSubscriber_1);\n                }\n                else {\n                    subscribeToSource();\n                }\n            };\n            var subscribeToSource = function () {\n                var syncUnsub = false;\n                sourceSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, function () {\n                    if (++soFar < count) {\n                        if (sourceSub) {\n                            resubscribe();\n                        }\n                        else {\n                            syncUnsub = true;\n                        }\n                    }\n                    else {\n                        subscriber.complete();\n                    }\n                }));\n                if (syncUnsub) {\n                    resubscribe();\n                }\n            };\n            subscribeToSource();\n        });\n}\n//# sourceMappingURL=repeat.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function repeatWhen(notifier) {\n    return operate(function (source, subscriber) {\n        var innerSub;\n        var syncResub = false;\n        var completions$;\n        var isNotifierComplete = false;\n        var isMainComplete = false;\n        var checkComplete = function () { return isMainComplete && isNotifierComplete && (subscriber.complete(), true); };\n        var getCompletionSubject = function () {\n            if (!completions$) {\n                completions$ = new Subject();\n                innerFrom(notifier(completions$)).subscribe(createOperatorSubscriber(subscriber, function () {\n                    if (innerSub) {\n                        subscribeForRepeatWhen();\n                    }\n                    else {\n                        syncResub = true;\n                    }\n                }, function () {\n                    isNotifierComplete = true;\n                    checkComplete();\n                }));\n            }\n            return completions$;\n        };\n        var subscribeForRepeatWhen = function () {\n            isMainComplete = false;\n            innerSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, function () {\n                isMainComplete = true;\n                !checkComplete() && getCompletionSubject().next();\n            }));\n            if (syncResub) {\n                innerSub.unsubscribe();\n                innerSub = null;\n                syncResub = false;\n                subscribeForRepeatWhen();\n            }\n        };\n        subscribeForRepeatWhen();\n    });\n}\n//# sourceMappingURL=repeatWhen.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { identity } from '../util/identity';\nimport { timer } from '../observable/timer';\nimport { innerFrom } from '../observable/innerFrom';\nexport function retry(configOrCount) {\n    if (configOrCount === void 0) { configOrCount = Infinity; }\n    var config;\n    if (configOrCount && typeof configOrCount === 'object') {\n        config = configOrCount;\n    }\n    else {\n        config = {\n            count: configOrCount,\n        };\n    }\n    var _a = config.count, count = _a === void 0 ? Infinity : _a, delay = config.delay, _b = config.resetOnSuccess, resetOnSuccess = _b === void 0 ? false : _b;\n    return count <= 0\n        ? identity\n        : operate(function (source, subscriber) {\n            var soFar = 0;\n            var innerSub;\n            var subscribeForRetry = function () {\n                var syncUnsub = false;\n                innerSub = source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                    if (resetOnSuccess) {\n                        soFar = 0;\n                    }\n                    subscriber.next(value);\n                }, undefined, function (err) {\n                    if (soFar++ < count) {\n                        var resub_1 = function () {\n                            if (innerSub) {\n                                innerSub.unsubscribe();\n                                innerSub = null;\n                                subscribeForRetry();\n                            }\n                            else {\n                                syncUnsub = true;\n                            }\n                        };\n                        if (delay != null) {\n                            var notifier = typeof delay === 'number' ? timer(delay) : innerFrom(delay(err, soFar));\n                            var notifierSubscriber_1 = createOperatorSubscriber(subscriber, function () {\n                                notifierSubscriber_1.unsubscribe();\n                                resub_1();\n                            }, function () {\n                                subscriber.complete();\n                            });\n                            notifier.subscribe(notifierSubscriber_1);\n                        }\n                        else {\n                            resub_1();\n                        }\n                    }\n                    else {\n                        subscriber.error(err);\n                    }\n                }));\n                if (syncUnsub) {\n                    innerSub.unsubscribe();\n                    innerSub = null;\n                    subscribeForRetry();\n                }\n            };\n            subscribeForRetry();\n        });\n}\n//# sourceMappingURL=retry.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function retryWhen(notifier) {\n    return operate(function (source, subscriber) {\n        var innerSub;\n        var syncResub = false;\n        var errors$;\n        var subscribeForRetryWhen = function () {\n            innerSub = source.subscribe(createOperatorSubscriber(subscriber, undefined, undefined, function (err) {\n                if (!errors$) {\n                    errors$ = new Subject();\n                    innerFrom(notifier(errors$)).subscribe(createOperatorSubscriber(subscriber, function () {\n                        return innerSub ? subscribeForRetryWhen() : (syncResub = true);\n                    }));\n                }\n                if (errors$) {\n                    errors$.next(err);\n                }\n            }));\n            if (syncResub) {\n                innerSub.unsubscribe();\n                innerSub = null;\n                syncResub = false;\n                subscribeForRetryWhen();\n            }\n        };\n        subscribeForRetryWhen();\n    });\n}\n//# sourceMappingURL=retryWhen.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { noop } from '../util/noop';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function sample(notifier) {\n    return operate(function (source, subscriber) {\n        var hasValue = false;\n        var lastValue = null;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            hasValue = true;\n            lastValue = value;\n        }));\n        innerFrom(notifier).subscribe(createOperatorSubscriber(subscriber, function () {\n            if (hasValue) {\n                hasValue = false;\n                var value = lastValue;\n                lastValue = null;\n                subscriber.next(value);\n            }\n        }, noop));\n    });\n}\n//# sourceMappingURL=sample.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { sample } from './sample';\nimport { interval } from '../observable/interval';\nexport function sampleTime(period, scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    return sample(interval(period, scheduler));\n}\n//# sourceMappingURL=sampleTime.js.map","import { operate } from '../util/lift';\nimport { scanInternals } from './scanInternals';\nexport function scan(accumulator, seed) {\n    return operate(scanInternals(accumulator, seed, arguments.length >= 2, true));\n}\n//# sourceMappingURL=scan.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nexport function sequenceEqual(compareTo, comparator) {\n    if (comparator === void 0) { comparator = function (a, b) { return a === b; }; }\n    return operate(function (source, subscriber) {\n        var aState = createState();\n        var bState = createState();\n        var emit = function (isEqual) {\n            subscriber.next(isEqual);\n            subscriber.complete();\n        };\n        var createSubscriber = function (selfState, otherState) {\n            var sequenceEqualSubscriber = createOperatorSubscriber(subscriber, function (a) {\n                var buffer = otherState.buffer, complete = otherState.complete;\n                if (buffer.length === 0) {\n                    complete ? emit(false) : selfState.buffer.push(a);\n                }\n                else {\n                    !comparator(a, buffer.shift()) && emit(false);\n                }\n            }, function () {\n                selfState.complete = true;\n                var complete = otherState.complete, buffer = otherState.buffer;\n                complete && emit(buffer.length === 0);\n                sequenceEqualSubscriber === null || sequenceEqualSubscriber === void 0 ? void 0 : sequenceEqualSubscriber.unsubscribe();\n            });\n            return sequenceEqualSubscriber;\n        };\n        source.subscribe(createSubscriber(aState, bState));\n        innerFrom(compareTo).subscribe(createSubscriber(bState, aState));\n    });\n}\nfunction createState() {\n    return {\n        buffer: [],\n        complete: false,\n    };\n}\n//# sourceMappingURL=sequenceEqual.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { innerFrom } from '../observable/innerFrom';\nimport { Subject } from '../Subject';\nimport { SafeSubscriber } from '../Subscriber';\nimport { operate } from '../util/lift';\nexport function share(options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.connector, connector = _a === void 0 ? function () { return new Subject(); } : _a, _b = options.resetOnError, resetOnError = _b === void 0 ? true : _b, _c = options.resetOnComplete, resetOnComplete = _c === void 0 ? true : _c, _d = options.resetOnRefCountZero, resetOnRefCountZero = _d === void 0 ? true : _d;\n    return function (wrapperSource) {\n        var connection;\n        var resetConnection;\n        var subject;\n        var refCount = 0;\n        var hasCompleted = false;\n        var hasErrored = false;\n        var cancelReset = function () {\n            resetConnection === null || resetConnection === void 0 ? void 0 : resetConnection.unsubscribe();\n            resetConnection = undefined;\n        };\n        var reset = function () {\n            cancelReset();\n            connection = subject = undefined;\n            hasCompleted = hasErrored = false;\n        };\n        var resetAndUnsubscribe = function () {\n            var conn = connection;\n            reset();\n            conn === null || conn === void 0 ? void 0 : conn.unsubscribe();\n        };\n        return operate(function (source, subscriber) {\n            refCount++;\n            if (!hasErrored && !hasCompleted) {\n                cancelReset();\n            }\n            var dest = (subject = subject !== null && subject !== void 0 ? subject : connector());\n            subscriber.add(function () {\n                refCount--;\n                if (refCount === 0 && !hasErrored && !hasCompleted) {\n                    resetConnection = handleReset(resetAndUnsubscribe, resetOnRefCountZero);\n                }\n            });\n            dest.subscribe(subscriber);\n            if (!connection &&\n                refCount > 0) {\n                connection = new SafeSubscriber({\n                    next: function (value) { return dest.next(value); },\n                    error: function (err) {\n                        hasErrored = true;\n                        cancelReset();\n                        resetConnection = handleReset(reset, resetOnError, err);\n                        dest.error(err);\n                    },\n                    complete: function () {\n                        hasCompleted = true;\n                        cancelReset();\n                        resetConnection = handleReset(reset, resetOnComplete);\n                        dest.complete();\n                    },\n                });\n                innerFrom(source).subscribe(connection);\n            }\n        })(wrapperSource);\n    };\n}\nfunction handleReset(reset, on) {\n    var args = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        args[_i - 2] = arguments[_i];\n    }\n    if (on === true) {\n        reset();\n        return;\n    }\n    if (on === false) {\n        return;\n    }\n    var onSubscriber = new SafeSubscriber({\n        next: function () {\n            onSubscriber.unsubscribe();\n            reset();\n        },\n    });\n    return innerFrom(on.apply(void 0, __spreadArray([], __read(args)))).subscribe(onSubscriber);\n}\n//# sourceMappingURL=share.js.map","import { ReplaySubject } from '../ReplaySubject';\nimport { share } from './share';\nexport function shareReplay(configOrBufferSize, windowTime, scheduler) {\n    var _a, _b, _c;\n    var bufferSize;\n    var refCount = false;\n    if (configOrBufferSize && typeof configOrBufferSize === 'object') {\n        (_a = configOrBufferSize.bufferSize, bufferSize = _a === void 0 ? Infinity : _a, _b = configOrBufferSize.windowTime, windowTime = _b === void 0 ? Infinity : _b, _c = configOrBufferSize.refCount, refCount = _c === void 0 ? false : _c, scheduler = configOrBufferSize.scheduler);\n    }\n    else {\n        bufferSize = (configOrBufferSize !== null && configOrBufferSize !== void 0 ? configOrBufferSize : Infinity);\n    }\n    return share({\n        connector: function () { return new ReplaySubject(bufferSize, windowTime, scheduler); },\n        resetOnError: true,\n        resetOnComplete: false,\n        resetOnRefCountZero: refCount,\n    });\n}\n//# sourceMappingURL=shareReplay.js.map","import { EmptyError } from '../util/EmptyError';\nimport { SequenceError } from '../util/SequenceError';\nimport { NotFoundError } from '../util/NotFoundError';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function single(predicate) {\n    return operate(function (source, subscriber) {\n        var hasValue = false;\n        var singleValue;\n        var seenValue = false;\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            seenValue = true;\n            if (!predicate || predicate(value, index++, source)) {\n                hasValue && subscriber.error(new SequenceError('Too many matching values'));\n                hasValue = true;\n                singleValue = value;\n            }\n        }, function () {\n            if (hasValue) {\n                subscriber.next(singleValue);\n                subscriber.complete();\n            }\n            else {\n                subscriber.error(seenValue ? new NotFoundError('No matching values') : new EmptyError());\n            }\n        }));\n    });\n}\n//# sourceMappingURL=single.js.map","import { filter } from './filter';\nexport function skip(count) {\n    return filter(function (_, index) { return count <= index; });\n}\n//# sourceMappingURL=skip.js.map","import { identity } from '../util/identity';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function skipLast(skipCount) {\n    return skipCount <= 0\n        ?\n            identity\n        : operate(function (source, subscriber) {\n            var ring = new Array(skipCount);\n            var seen = 0;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                var valueIndex = seen++;\n                if (valueIndex < skipCount) {\n                    ring[valueIndex] = value;\n                }\n                else {\n                    var index = valueIndex % skipCount;\n                    var oldValue = ring[index];\n                    ring[index] = value;\n                    subscriber.next(oldValue);\n                }\n            }));\n            return function () {\n                ring = null;\n            };\n        });\n}\n//# sourceMappingURL=skipLast.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nimport { noop } from '../util/noop';\nexport function skipUntil(notifier) {\n    return operate(function (source, subscriber) {\n        var taking = false;\n        var skipSubscriber = createOperatorSubscriber(subscriber, function () {\n            skipSubscriber === null || skipSubscriber === void 0 ? void 0 : skipSubscriber.unsubscribe();\n            taking = true;\n        }, noop);\n        innerFrom(notifier).subscribe(skipSubscriber);\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return taking && subscriber.next(value); }));\n    });\n}\n//# sourceMappingURL=skipUntil.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function skipWhile(predicate) {\n    return operate(function (source, subscriber) {\n        var taking = false;\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return (taking || (taking = !predicate(value, index++))) && subscriber.next(value); }));\n    });\n}\n//# sourceMappingURL=skipWhile.js.map","import { concat } from '../observable/concat';\nimport { popScheduler } from '../util/args';\nimport { operate } from '../util/lift';\nexport function startWith() {\n    var values = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n    }\n    var scheduler = popScheduler(values);\n    return operate(function (source, subscriber) {\n        (scheduler ? concat(values, source, scheduler) : concat(values, source)).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=startWith.js.map","import { innerFrom } from '../observable/innerFrom';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function switchMap(project, resultSelector) {\n    return operate(function (source, subscriber) {\n        var innerSubscriber = null;\n        var index = 0;\n        var isComplete = false;\n        var checkComplete = function () { return isComplete && !innerSubscriber && subscriber.complete(); };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            innerSubscriber === null || innerSubscriber === void 0 ? void 0 : innerSubscriber.unsubscribe();\n            var innerIndex = 0;\n            var outerIndex = index++;\n            innerFrom(project(value, outerIndex)).subscribe((innerSubscriber = createOperatorSubscriber(subscriber, function (innerValue) { return subscriber.next(resultSelector ? resultSelector(value, innerValue, outerIndex, innerIndex++) : innerValue); }, function () {\n                innerSubscriber = null;\n                checkComplete();\n            })));\n        }, function () {\n            isComplete = true;\n            checkComplete();\n        }));\n    });\n}\n//# sourceMappingURL=switchMap.js.map","import { switchMap } from './switchMap';\nimport { identity } from '../util/identity';\nexport function switchAll() {\n    return switchMap(identity);\n}\n//# sourceMappingURL=switchAll.js.map","import { switchMap } from './switchMap';\nimport { isFunction } from '../util/isFunction';\nexport function switchMapTo(innerObservable, resultSelector) {\n    return isFunction(resultSelector) ? switchMap(function () { return innerObservable; }, resultSelector) : switchMap(function () { return innerObservable; });\n}\n//# sourceMappingURL=switchMapTo.js.map","import { switchMap } from './switchMap';\nimport { operate } from '../util/lift';\nexport function switchScan(accumulator, seed) {\n    return operate(function (source, subscriber) {\n        var state = seed;\n        switchMap(function (value, index) { return accumulator(state, value, index); }, function (_, innerValue) { return ((state = innerValue), innerValue); })(source).subscribe(subscriber);\n        return function () {\n            state = null;\n        };\n    });\n}\n//# sourceMappingURL=switchScan.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nimport { noop } from '../util/noop';\nexport function takeUntil(notifier) {\n    return operate(function (source, subscriber) {\n        innerFrom(notifier).subscribe(createOperatorSubscriber(subscriber, function () { return subscriber.complete(); }, noop));\n        !subscriber.closed && source.subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=takeUntil.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function takeWhile(predicate, inclusive) {\n    if (inclusive === void 0) { inclusive = false; }\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var result = predicate(value, index++);\n            (result || inclusive) && subscriber.next(value);\n            !result && subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=takeWhile.js.map","import { isFunction } from '../util/isFunction';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { identity } from '../util/identity';\nexport function tap(observerOrNext, error, complete) {\n    var tapObserver = isFunction(observerOrNext) || error || complete\n        ?\n            { next: observerOrNext, error: error, complete: complete }\n        : observerOrNext;\n    return tapObserver\n        ? operate(function (source, subscriber) {\n            var _a;\n            (_a = tapObserver.subscribe) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n            var isUnsub = true;\n            source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n                var _a;\n                (_a = tapObserver.next) === null || _a === void 0 ? void 0 : _a.call(tapObserver, value);\n                subscriber.next(value);\n            }, function () {\n                var _a;\n                isUnsub = false;\n                (_a = tapObserver.complete) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n                subscriber.complete();\n            }, function (err) {\n                var _a;\n                isUnsub = false;\n                (_a = tapObserver.error) === null || _a === void 0 ? void 0 : _a.call(tapObserver, err);\n                subscriber.error(err);\n            }, function () {\n                var _a, _b;\n                if (isUnsub) {\n                    (_a = tapObserver.unsubscribe) === null || _a === void 0 ? void 0 : _a.call(tapObserver);\n                }\n                (_b = tapObserver.finalize) === null || _b === void 0 ? void 0 : _b.call(tapObserver);\n            }));\n        })\n        :\n            identity;\n}\n//# sourceMappingURL=tap.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nexport function throttle(durationSelector, config) {\n    return operate(function (source, subscriber) {\n        var _a = config !== null && config !== void 0 ? config : {}, _b = _a.leading, leading = _b === void 0 ? true : _b, _c = _a.trailing, trailing = _c === void 0 ? false : _c;\n        var hasValue = false;\n        var sendValue = null;\n        var throttled = null;\n        var isComplete = false;\n        var endThrottling = function () {\n            throttled === null || throttled === void 0 ? void 0 : throttled.unsubscribe();\n            throttled = null;\n            if (trailing) {\n                send();\n                isComplete && subscriber.complete();\n            }\n        };\n        var cleanupThrottling = function () {\n            throttled = null;\n            isComplete && subscriber.complete();\n        };\n        var startThrottle = function (value) {\n            return (throttled = innerFrom(durationSelector(value)).subscribe(createOperatorSubscriber(subscriber, endThrottling, cleanupThrottling)));\n        };\n        var send = function () {\n            if (hasValue) {\n                hasValue = false;\n                var value = sendValue;\n                sendValue = null;\n                subscriber.next(value);\n                !isComplete && startThrottle(value);\n            }\n        };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            hasValue = true;\n            sendValue = value;\n            !(throttled && !throttled.closed) && (leading ? send() : startThrottle(value));\n        }, function () {\n            isComplete = true;\n            !(trailing && hasValue && throttled && !throttled.closed) && subscriber.complete();\n        }));\n    });\n}\n//# sourceMappingURL=throttle.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { throttle } from './throttle';\nimport { timer } from '../observable/timer';\nexport function throttleTime(duration, scheduler, config) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    var duration$ = timer(duration, scheduler);\n    return throttle(function () { return duration$; }, config);\n}\n//# sourceMappingURL=throttleTime.js.map","import { asyncScheduler } from '../scheduler/async';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function timeInterval(scheduler) {\n    if (scheduler === void 0) { scheduler = asyncScheduler; }\n    return operate(function (source, subscriber) {\n        var last = scheduler.now();\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var now = scheduler.now();\n            var interval = now - last;\n            last = now;\n            subscriber.next(new TimeInterval(value, interval));\n        }));\n    });\n}\nvar TimeInterval = (function () {\n    function TimeInterval(value, interval) {\n        this.value = value;\n        this.interval = interval;\n    }\n    return TimeInterval;\n}());\nexport { TimeInterval };\n//# sourceMappingURL=timeInterval.js.map","import { async } from '../scheduler/async';\nimport { isValidDate } from '../util/isDate';\nimport { timeout } from './timeout';\nexport function timeoutWith(due, withObservable, scheduler) {\n    var first;\n    var each;\n    var _with;\n    scheduler = scheduler !== null && scheduler !== void 0 ? scheduler : async;\n    if (isValidDate(due)) {\n        first = due;\n    }\n    else if (typeof due === 'number') {\n        each = due;\n    }\n    if (withObservable) {\n        _with = function () { return withObservable; };\n    }\n    else {\n        throw new TypeError('No observable provided to switch to');\n    }\n    if (first == null && each == null) {\n        throw new TypeError('No timeout provided.');\n    }\n    return timeout({\n        first: first,\n        each: each,\n        scheduler: scheduler,\n        with: _with,\n    });\n}\n//# sourceMappingURL=timeoutWith.js.map","import { dateTimestampProvider } from '../scheduler/dateTimestampProvider';\nimport { map } from './map';\nexport function timestamp(timestampProvider) {\n    if (timestampProvider === void 0) { timestampProvider = dateTimestampProvider; }\n    return map(function (value) { return ({ value: value, timestamp: timestampProvider.now() }); });\n}\n//# sourceMappingURL=timestamp.js.map","import { Subject } from '../Subject';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nimport { innerFrom } from '../observable/innerFrom';\nexport function window(windowBoundaries) {\n    return operate(function (source, subscriber) {\n        var windowSubject = new Subject();\n        subscriber.next(windowSubject.asObservable());\n        var errorHandler = function (err) {\n            windowSubject.error(err);\n            subscriber.error(err);\n        };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return windowSubject === null || windowSubject === void 0 ? void 0 : windowSubject.next(value); }, function () {\n            windowSubject.complete();\n            subscriber.complete();\n        }, errorHandler));\n        innerFrom(windowBoundaries).subscribe(createOperatorSubscriber(subscriber, function () {\n            windowSubject.complete();\n            subscriber.next((windowSubject = new Subject()));\n        }, noop, errorHandler));\n        return function () {\n            windowSubject === null || windowSubject === void 0 ? void 0 : windowSubject.unsubscribe();\n            windowSubject = null;\n        };\n    });\n}\n//# sourceMappingURL=window.js.map","import { __values } from \"tslib\";\nimport { Subject } from '../Subject';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function windowCount(windowSize, startWindowEvery) {\n    if (startWindowEvery === void 0) { startWindowEvery = 0; }\n    var startEvery = startWindowEvery > 0 ? startWindowEvery : windowSize;\n    return operate(function (source, subscriber) {\n        var windows = [new Subject()];\n        var starts = [];\n        var count = 0;\n        subscriber.next(windows[0].asObservable());\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var e_1, _a;\n            try {\n                for (var windows_1 = __values(windows), windows_1_1 = windows_1.next(); !windows_1_1.done; windows_1_1 = windows_1.next()) {\n                    var window_1 = windows_1_1.value;\n                    window_1.next(value);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (windows_1_1 && !windows_1_1.done && (_a = windows_1.return)) _a.call(windows_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            var c = count - windowSize + 1;\n            if (c >= 0 && c % startEvery === 0) {\n                windows.shift().complete();\n            }\n            if (++count % startEvery === 0) {\n                var window_2 = new Subject();\n                windows.push(window_2);\n                subscriber.next(window_2.asObservable());\n            }\n        }, function () {\n            while (windows.length > 0) {\n                windows.shift().complete();\n            }\n            subscriber.complete();\n        }, function (err) {\n            while (windows.length > 0) {\n                windows.shift().error(err);\n            }\n            subscriber.error(err);\n        }, function () {\n            starts = null;\n            windows = null;\n        }));\n    });\n}\n//# sourceMappingURL=windowCount.js.map","import { Subject } from '../Subject';\nimport { asyncScheduler } from '../scheduler/async';\nimport { Subscription } from '../Subscription';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { arrRemove } from '../util/arrRemove';\nimport { popScheduler } from '../util/args';\nimport { executeSchedule } from '../util/executeSchedule';\nexport function windowTime(windowTimeSpan) {\n    var _a, _b;\n    var otherArgs = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        otherArgs[_i - 1] = arguments[_i];\n    }\n    var scheduler = (_a = popScheduler(otherArgs)) !== null && _a !== void 0 ? _a : asyncScheduler;\n    var windowCreationInterval = (_b = otherArgs[0]) !== null && _b !== void 0 ? _b : null;\n    var maxWindowSize = otherArgs[1] || Infinity;\n    return operate(function (source, subscriber) {\n        var windowRecords = [];\n        var restartOnClose = false;\n        var closeWindow = function (record) {\n            var window = record.window, subs = record.subs;\n            window.complete();\n            subs.unsubscribe();\n            arrRemove(windowRecords, record);\n            restartOnClose && startWindow();\n        };\n        var startWindow = function () {\n            if (windowRecords) {\n                var subs = new Subscription();\n                subscriber.add(subs);\n                var window_1 = new Subject();\n                var record_1 = {\n                    window: window_1,\n                    subs: subs,\n                    seen: 0,\n                };\n                windowRecords.push(record_1);\n                subscriber.next(window_1.asObservable());\n                executeSchedule(subs, scheduler, function () { return closeWindow(record_1); }, windowTimeSpan);\n            }\n        };\n        if (windowCreationInterval !== null && windowCreationInterval >= 0) {\n            executeSchedule(subscriber, scheduler, startWindow, windowCreationInterval, true);\n        }\n        else {\n            restartOnClose = true;\n        }\n        startWindow();\n        var loop = function (cb) { return windowRecords.slice().forEach(cb); };\n        var terminate = function (cb) {\n            loop(function (_a) {\n                var window = _a.window;\n                return cb(window);\n            });\n            cb(subscriber);\n            subscriber.unsubscribe();\n        };\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            loop(function (record) {\n                record.window.next(value);\n                maxWindowSize <= ++record.seen && closeWindow(record);\n            });\n        }, function () { return terminate(function (consumer) { return consumer.complete(); }); }, function (err) { return terminate(function (consumer) { return consumer.error(err); }); }));\n        return function () {\n            windowRecords = null;\n        };\n    });\n}\n//# sourceMappingURL=windowTime.js.map","import { __values } from \"tslib\";\nimport { Subject } from '../Subject';\nimport { Subscription } from '../Subscription';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { noop } from '../util/noop';\nimport { arrRemove } from '../util/arrRemove';\nexport function windowToggle(openings, closingSelector) {\n    return operate(function (source, subscriber) {\n        var windows = [];\n        var handleError = function (err) {\n            while (0 < windows.length) {\n                windows.shift().error(err);\n            }\n            subscriber.error(err);\n        };\n        innerFrom(openings).subscribe(createOperatorSubscriber(subscriber, function (openValue) {\n            var window = new Subject();\n            windows.push(window);\n            var closingSubscription = new Subscription();\n            var closeWindow = function () {\n                arrRemove(windows, window);\n                window.complete();\n                closingSubscription.unsubscribe();\n            };\n            var closingNotifier;\n            try {\n                closingNotifier = innerFrom(closingSelector(openValue));\n            }\n            catch (err) {\n                handleError(err);\n                return;\n            }\n            subscriber.next(window.asObservable());\n            closingSubscription.add(closingNotifier.subscribe(createOperatorSubscriber(subscriber, closeWindow, noop, handleError)));\n        }, noop));\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            var e_1, _a;\n            var windowsCopy = windows.slice();\n            try {\n                for (var windowsCopy_1 = __values(windowsCopy), windowsCopy_1_1 = windowsCopy_1.next(); !windowsCopy_1_1.done; windowsCopy_1_1 = windowsCopy_1.next()) {\n                    var window_1 = windowsCopy_1_1.value;\n                    window_1.next(value);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (windowsCopy_1_1 && !windowsCopy_1_1.done && (_a = windowsCopy_1.return)) _a.call(windowsCopy_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }, function () {\n            while (0 < windows.length) {\n                windows.shift().complete();\n            }\n            subscriber.complete();\n        }, handleError, function () {\n            while (0 < windows.length) {\n                windows.shift().unsubscribe();\n            }\n        }));\n    });\n}\n//# sourceMappingURL=windowToggle.js.map","import { Subject } from '../Subject';\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nexport function windowWhen(closingSelector) {\n    return operate(function (source, subscriber) {\n        var window;\n        var closingSubscriber;\n        var handleError = function (err) {\n            window.error(err);\n            subscriber.error(err);\n        };\n        var openWindow = function () {\n            closingSubscriber === null || closingSubscriber === void 0 ? void 0 : closingSubscriber.unsubscribe();\n            window === null || window === void 0 ? void 0 : window.complete();\n            window = new Subject();\n            subscriber.next(window.asObservable());\n            var closingNotifier;\n            try {\n                closingNotifier = innerFrom(closingSelector());\n            }\n            catch (err) {\n                handleError(err);\n                return;\n            }\n            closingNotifier.subscribe((closingSubscriber = createOperatorSubscriber(subscriber, openWindow, openWindow, handleError)));\n        };\n        openWindow();\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) { return window.next(value); }, function () {\n            window.complete();\n            subscriber.complete();\n        }, handleError, function () {\n            closingSubscriber === null || closingSubscriber === void 0 ? void 0 : closingSubscriber.unsubscribe();\n            window = null;\n        }));\n    });\n}\n//# sourceMappingURL=windowWhen.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { innerFrom } from '../observable/innerFrom';\nimport { identity } from '../util/identity';\nimport { noop } from '../util/noop';\nimport { popResultSelector } from '../util/args';\nexport function withLatestFrom() {\n    var inputs = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        inputs[_i] = arguments[_i];\n    }\n    var project = popResultSelector(inputs);\n    return operate(function (source, subscriber) {\n        var len = inputs.length;\n        var otherValues = new Array(len);\n        var hasValue = inputs.map(function () { return false; });\n        var ready = false;\n        var _loop_1 = function (i) {\n            innerFrom(inputs[i]).subscribe(createOperatorSubscriber(subscriber, function (value) {\n                otherValues[i] = value;\n                if (!ready && !hasValue[i]) {\n                    hasValue[i] = true;\n                    (ready = hasValue.every(identity)) && (hasValue = null);\n                }\n            }, noop));\n        };\n        for (var i = 0; i < len; i++) {\n            _loop_1(i);\n        }\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            if (ready) {\n                var values = __spreadArray([value], __read(otherValues));\n                subscriber.next(project ? project.apply(void 0, __spreadArray([], __read(values))) : values);\n            }\n        }));\n    });\n}\n//# sourceMappingURL=withLatestFrom.js.map","import { zip } from '../observable/zip';\nimport { joinAllInternals } from './joinAllInternals';\nexport function zipAll(project) {\n    return joinAllInternals(zip, project);\n}\n//# sourceMappingURL=zipAll.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { zip as zipStatic } from '../observable/zip';\nimport { operate } from '../util/lift';\nexport function zip() {\n    var sources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        sources[_i] = arguments[_i];\n    }\n    return operate(function (source, subscriber) {\n        zipStatic.apply(void 0, __spreadArray([source], __read(sources))).subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=zip.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { zip } from './zip';\nexport function zipWith() {\n    var otherInputs = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        otherInputs[_i] = arguments[_i];\n    }\n    return zip.apply(void 0, __spreadArray([], __read(otherInputs)));\n}\n//# sourceMappingURL=zipWith.js.map"],"file":"swyger-client-storage.min.js"}